(function(){const xt=document.createElement("link").relList;if(xt&&xt.supports&&xt.supports("modulepreload"))return;for(const Ei of document.querySelectorAll('link[rel="modulepreload"]'))Qi(Ei);new MutationObserver(Ei=>{for(const Sn of Ei)if(Sn.type==="childList")for(const de of Sn.addedNodes)de.tagName==="LINK"&&de.rel==="modulepreload"&&Qi(de)}).observe(document,{childList:!0,subtree:!0});function li(Ei){const Sn={};return Ei.integrity&&(Sn.integrity=Ei.integrity),Ei.referrerpolicy&&(Sn.referrerPolicy=Ei.referrerpolicy),Ei.crossorigin==="use-credentials"?Sn.credentials="include":Ei.crossorigin==="anonymous"?Sn.credentials="omit":Sn.credentials="same-origin",Sn}function Qi(Ei){if(Ei.ep)return;Ei.ep=!0;const Sn=li(Ei);fetch(Ei.href,Sn)}})();var L2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function O2(At){return At&&At.__esModule&&Object.prototype.hasOwnProperty.call(At,"default")?At.default:At}var _1={},P2={get exports(){return _1},set exports(At){_1=At}},y1={},kl={},B2={get exports(){return kl},set exports(At){kl=At}},Wv={},F2={get exports(){return Wv},set exports(At){Wv=At}};/**
 * @license React
 * react.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(At,xt){(function(){typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(new Error);var li="18.2.0",Qi=Symbol.for("react.element"),Ei=Symbol.for("react.portal"),Sn=Symbol.for("react.fragment"),de=Symbol.for("react.strict_mode"),u=Symbol.for("react.profiler"),Oe=Symbol.for("react.provider"),Ft=Symbol.for("react.context"),Hn=Symbol.for("react.forward_ref"),at=Symbol.for("react.suspense"),gt=Symbol.for("react.suspense_list"),bt=Symbol.for("react.memo"),en=Symbol.for("react.lazy"),Ir=Symbol.for("react.offscreen"),Ea=Symbol.iterator,kr="@@iterator";function zn(U){if(U===null||typeof U!="object")return null;var ge=Ea&&U[Ea]||U[kr];return typeof ge=="function"?ge:null}var Rn={current:null},Oi={transition:null},Ge={current:null,isBatchingLegacy:!1,didScheduleLegacyUpdate:!1},Nn={current:null},xn={},Wr=null;function Wt(U){Wr=U}xn.setExtraStackFrame=function(U){Wr=U},xn.getCurrentStack=null,xn.getStackAddendum=function(){var U="";Wr&&(U+=Wr);var ge=xn.getCurrentStack;return ge&&(U+=ge()||""),U};var In=!1,Ai=!1,ua=!1,_n=!1,On=!1,Ut={ReactCurrentDispatcher:Rn,ReactCurrentBatchConfig:Oi,ReactCurrentOwner:Nn};Ut.ReactDebugCurrentFrame=xn,Ut.ReactCurrentActQueue=Ge;function Hi(U){{for(var ge=arguments.length,Pe=new Array(ge>1?ge-1:0),He=1;He<ge;He++)Pe[He-1]=arguments[He];Xi("warn",U,Pe)}}function rn(U){{for(var ge=arguments.length,Pe=new Array(ge>1?ge-1:0),He=1;He<ge;He++)Pe[He-1]=arguments[He];Xi("error",U,Pe)}}function Xi(U,ge,Pe){{var He=Ut.ReactDebugCurrentFrame,dt=He.getStackAddendum();dt!==""&&(ge+="%s",Pe=Pe.concat([dt]));var Xt=Pe.map(function(Ot){return String(Ot)});Xt.unshift("Warning: "+ge),Function.prototype.apply.call(console[U],console,Xt)}}var ca={};function Kn(U,ge){{var Pe=U.constructor,He=Pe&&(Pe.displayName||Pe.name)||"ReactClass",dt=He+"."+ge;if(ca[dt])return;rn("Can't call %s on a component that is not yet mounted. This is a no-op, but it might indicate a bug in your application. Instead, assign to `this.state` directly or define a `state = {};` class property with the desired state in the %s component.",ge,He),ca[dt]=!0}}var ha={isMounted:function(U){return!1},enqueueForceUpdate:function(U,ge,Pe){Kn(U,"forceUpdate")},enqueueReplaceState:function(U,ge,Pe,He){Kn(U,"replaceState")},enqueueSetState:function(U,ge,Pe,He){Kn(U,"setState")}},rr=Object.assign,ar={};Object.freeze(ar);function or(U,ge,Pe){this.props=U,this.context=ge,this.refs=ar,this.updater=Pe||ha}or.prototype.isReactComponent={},or.prototype.setState=function(U,ge){if(typeof U!="object"&&typeof U!="function"&&U!=null)throw new Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,U,ge,"setState")},or.prototype.forceUpdate=function(U){this.updater.enqueueForceUpdate(this,U,"forceUpdate")};{var da={isMounted:["isMounted","Instead, make sure to clean up subscriptions and pending requests in componentWillUnmount to prevent memory leaks."],replaceState:["replaceState","Refactor your code to use setState instead (see https://github.com/facebook/react/issues/3236)."]},Yr=function(U,ge){Object.defineProperty(or.prototype,U,{get:function(){Hi("%s(...) is deprecated in plain JavaScript React classes. %s",ge[0],ge[1])}})};for(var er in da)da.hasOwnProperty(er)&&Yr(er,da[er])}function Lr(){}Lr.prototype=or.prototype;function mr(U,ge,Pe){this.props=U,this.context=ge,this.refs=ar,this.updater=Pe||ha}var Ui=mr.prototype=new Lr;Ui.constructor=mr,rr(Ui,or.prototype),Ui.isPureReactComponent=!0;function fa(){var U={current:null};return Object.seal(U),U}var Vn=Array.isArray;function mi(U){return Vn(U)}function Yt(U){{var ge=typeof Symbol=="function"&&Symbol.toStringTag,Pe=ge&&U[Symbol.toStringTag]||U.constructor.name||"Object";return Pe}}function Ri(U){try{return sr(U),!1}catch{return!0}}function sr(U){return""+U}function Pi(U){if(Ri(U))return rn("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",Yt(U)),sr(U)}function Vr(U,ge,Pe){var He=U.displayName;if(He)return He;var dt=ge.displayName||ge.name||"";return dt!==""?Pe+"("+dt+")":Pe}function pa(U){return U.displayName||"Context"}function gr(U){if(U==null)return null;if(typeof U.tag=="number"&&rn("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),typeof U=="function")return U.displayName||U.name||null;if(typeof U=="string")return U;switch(U){case Sn:return"Fragment";case Ei:return"Portal";case u:return"Profiler";case de:return"StrictMode";case at:return"Suspense";case gt:return"SuspenseList"}if(typeof U=="object")switch(U.$$typeof){case Ft:var ge=U;return pa(ge)+".Consumer";case Oe:var Pe=U;return pa(Pe._context)+".Provider";case Hn:return Vr(U,U.render,"ForwardRef");case bt:var He=U.displayName||null;return He!==null?He:gr(U.type)||"Memo";case en:{var dt=U,Xt=dt._payload,Ot=dt._init;try{return gr(Ot(Xt))}catch{return null}}}return null}var Ba=Object.prototype.hasOwnProperty,Ni={key:!0,ref:!0,__self:!0,__source:!0},lr,Kr,Cr;Cr={};function jr(U){if(Ba.call(U,"ref")){var ge=Object.getOwnPropertyDescriptor(U,"ref").get;if(ge&&ge.isReactWarning)return!1}return U.ref!==void 0}function Di(U){if(Ba.call(U,"key")){var ge=Object.getOwnPropertyDescriptor(U,"key").get;if(ge&&ge.isReactWarning)return!1}return U.key!==void 0}function ma(U,ge){var Pe=function(){lr||(lr=!0,rn("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",ge))};Pe.isReactWarning=!0,Object.defineProperty(U,"key",{get:Pe,configurable:!0})}function Fa(U,ge){var Pe=function(){Kr||(Kr=!0,rn("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",ge))};Pe.isReactWarning=!0,Object.defineProperty(U,"ref",{get:Pe,configurable:!0})}function _r(U){if(typeof U.ref=="string"&&Nn.current&&U.__self&&Nn.current.stateNode!==U.__self){var ge=gr(Nn.current.type);Cr[ge]||(rn('Component "%s" contains the string ref "%s". Support for string refs will be removed in a future major release. This case cannot be automatically converted to an arrow function. We ask you to manually fix this case by using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',ge,U.ref),Cr[ge]=!0)}}var vt=function(U,ge,Pe,He,dt,Xt,Ot){var tn={$$typeof:Qi,type:U,key:ge,ref:Pe,props:Ot,_owner:Xt};return tn._store={},Object.defineProperty(tn._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(tn,"_self",{configurable:!1,enumerable:!1,writable:!1,value:He}),Object.defineProperty(tn,"_source",{configurable:!1,enumerable:!1,writable:!1,value:dt}),Object.freeze&&(Object.freeze(tn.props),Object.freeze(tn)),tn};function Nt(U,ge,Pe){var He,dt={},Xt=null,Ot=null,tn=null,Cn=null;if(ge!=null){jr(ge)&&(Ot=ge.ref,_r(ge)),Di(ge)&&(Pi(ge.key),Xt=""+ge.key),tn=ge.__self===void 0?null:ge.__self,Cn=ge.__source===void 0?null:ge.__source;for(He in ge)Ba.call(ge,He)&&!Ni.hasOwnProperty(He)&&(dt[He]=ge[He])}var si=arguments.length-2;if(si===1)dt.children=Pe;else if(si>1){for(var zi=Array(si),ci=0;ci<si;ci++)zi[ci]=arguments[ci+2];Object.freeze&&Object.freeze(zi),dt.children=zi}if(U&&U.defaultProps){var Bi=U.defaultProps;for(He in Bi)dt[He]===void 0&&(dt[He]=Bi[He])}if(Xt||Ot){var Ii=typeof U=="function"?U.displayName||U.name||"Unknown":U;Xt&&ma(dt,Ii),Ot&&Fa(dt,Ii)}return vt(U,Xt,Ot,tn,Cn,Nn.current,dt)}function sn(U,ge){var Pe=vt(U.type,ge,U.ref,U._self,U._source,U._owner,U.props);return Pe}function Pn(U,ge,Pe){if(U==null)throw new Error("React.cloneElement(...): The argument must be a React element, but you passed "+U+".");var He,dt=rr({},U.props),Xt=U.key,Ot=U.ref,tn=U._self,Cn=U._source,si=U._owner;if(ge!=null){jr(ge)&&(Ot=ge.ref,si=Nn.current),Di(ge)&&(Pi(ge.key),Xt=""+ge.key);var zi;U.type&&U.type.defaultProps&&(zi=U.type.defaultProps);for(He in ge)Ba.call(ge,He)&&!Ni.hasOwnProperty(He)&&(ge[He]===void 0&&zi!==void 0?dt[He]=zi[He]:dt[He]=ge[He])}var ci=arguments.length-2;if(ci===1)dt.children=Pe;else if(ci>1){for(var Bi=Array(ci),Ii=0;Ii<ci;Ii++)Bi[Ii]=arguments[Ii+2];dt.children=Bi}return vt(U.type,Xt,Ot,tn,Cn,si,dt)}function Jn(U){return typeof U=="object"&&U!==null&&U.$$typeof===Qi}var ur=".",Vi=":";function yr(U){var ge=/[=:]/g,Pe={"=":"=0",":":"=2"},He=U.replace(ge,function(dt){return Pe[dt]});return"$"+He}var ri=!1,Gr=/\/+/g;function Zn(U){return U.replace(Gr,"$&/")}function gi(U,ge){return typeof U=="object"&&U!==null&&U.key!=null?(Pi(U.key),yr(""+U.key)):ge.toString(36)}function Wa(U,ge,Pe,He,dt){var Xt=typeof U;(Xt==="undefined"||Xt==="boolean")&&(U=null);var Ot=!1;if(U===null)Ot=!0;else switch(Xt){case"string":case"number":Ot=!0;break;case"object":switch(U.$$typeof){case Qi:case Ei:Ot=!0}}if(Ot){var tn=U,Cn=dt(tn),si=He===""?ur+gi(tn,0):He;if(mi(Cn)){var zi="";si!=null&&(zi=Zn(si)+"/"),Wa(Cn,ge,zi,"",function(Cc){return Cc})}else Cn!=null&&(Jn(Cn)&&(Cn.key&&(!tn||tn.key!==Cn.key)&&Pi(Cn.key),Cn=sn(Cn,Pe+(Cn.key&&(!tn||tn.key!==Cn.key)?Zn(""+Cn.key)+"/":"")+si)),ge.push(Cn));return 1}var ci,Bi,Ii=0,It=He===""?ur:He+Vi;if(mi(U))for(var Os=0;Os<U.length;Os++)ci=U[Os],Bi=It+gi(ci,Os),Ii+=Wa(ci,ge,Pe,Bi,dt);else{var is=zn(U);if(typeof is=="function"){var Bl=U;is===Bl.entries&&(ri||Hi("Using Maps as children is not supported. Use an array of keyed ReactElements instead."),ri=!0);for(var al=is.call(Bl),yo,Ps=0;!(yo=al.next()).done;)ci=yo.value,Bi=It+gi(ci,Ps++),Ii+=Wa(ci,ge,Pe,Bi,dt)}else if(Xt==="object"){var ol=String(U);throw new Error("Objects are not valid as a React child (found: "+(ol==="[object Object]"?"object with keys {"+Object.keys(U).join(", ")+"}":ol)+"). If you meant to render a collection of children, use an array instead.")}}return Ii}function ga(U,ge,Pe){if(U==null)return U;var He=[],dt=0;return Wa(U,He,"","",function(Xt){return ge.call(Pe,Xt,dt++)}),He}function Ya(U){var ge=0;return ga(U,function(){ge++}),ge}function zo(U,ge,Pe){ga(U,function(){ge.apply(this,arguments)},Pe)}function Sa(U){return ga(U,function(ge){return ge})||[]}function Ua(U){if(!Jn(U))throw new Error("React.Children.only expected to receive a single React element child.");return U}function Io(U){var ge={$$typeof:Ft,_currentValue:U,_currentValue2:U,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null};ge.Provider={$$typeof:Oe,_context:ge};var Pe=!1,He=!1,dt=!1;{var Xt={$$typeof:Ft,_context:ge};Object.defineProperties(Xt,{Provider:{get:function(){return He||(He=!0,rn("Rendering <Context.Consumer.Provider> is not supported and will be removed in a future major release. Did you mean to render <Context.Provider> instead?")),ge.Provider},set:function(Ot){ge.Provider=Ot}},_currentValue:{get:function(){return ge._currentValue},set:function(Ot){ge._currentValue=Ot}},_currentValue2:{get:function(){return ge._currentValue2},set:function(Ot){ge._currentValue2=Ot}},_threadCount:{get:function(){return ge._threadCount},set:function(Ot){ge._threadCount=Ot}},Consumer:{get:function(){return Pe||(Pe=!0,rn("Rendering <Context.Consumer.Consumer> is not supported and will be removed in a future major release. Did you mean to render <Context.Consumer> instead?")),ge.Consumer}},displayName:{get:function(){return ge.displayName},set:function(Ot){dt||(Hi("Setting `displayName` on Context.Consumer has no effect. You should set it directly on the context with Context.displayName = '%s'.",Ot),dt=!0)}}}),ge.Consumer=Xt}return ge._currentRenderer=null,ge._currentRenderer2=null,ge}var J=-1,P=0,V=1,K=2;function O(U){if(U._status===J){var ge=U._result,Pe=ge();if(Pe.then(function(Xt){if(U._status===P||U._status===J){var Ot=U;Ot._status=V,Ot._result=Xt}},function(Xt){if(U._status===P||U._status===J){var Ot=U;Ot._status=K,Ot._result=Xt}}),U._status===J){var He=U;He._status=P,He._result=Pe}}if(U._status===V){var dt=U._result;return dt===void 0&&rn(`lazy: Expected the result of a dynamic import() call. Instead received: %s

Your code should look like: 
  const MyComponent = lazy(() => import('./MyComponent'))

Did you accidentally put curly braces around the import?`,dt),"default"in dt||rn(`lazy: Expected the result of a dynamic import() call. Instead received: %s

Your code should look like: 
  const MyComponent = lazy(() => import('./MyComponent'))`,dt),dt.default}else throw U._result}function Z(U){var ge={_status:J,_result:U},Pe={$$typeof:en,_payload:ge,_init:O};{var He,dt;Object.defineProperties(Pe,{defaultProps:{configurable:!0,get:function(){return He},set:function(Xt){rn("React.lazy(...): It is not supported to assign `defaultProps` to a lazy component import. Either specify them where the component is defined, or create a wrapping component around it."),He=Xt,Object.defineProperty(Pe,"defaultProps",{enumerable:!0})}},propTypes:{configurable:!0,get:function(){return dt},set:function(Xt){rn("React.lazy(...): It is not supported to assign `propTypes` to a lazy component import. Either specify them where the component is defined, or create a wrapping component around it."),dt=Xt,Object.defineProperty(Pe,"propTypes",{enumerable:!0})}}})}return Pe}function se(U){U!=null&&U.$$typeof===bt?rn("forwardRef requires a render function but received a `memo` component. Instead of forwardRef(memo(...)), use memo(forwardRef(...))."):typeof U!="function"?rn("forwardRef requires a render function but was given %s.",U===null?"null":typeof U):U.length!==0&&U.length!==2&&rn("forwardRef render functions accept exactly two parameters: props and ref. %s",U.length===1?"Did you forget to use the ref parameter?":"Any additional parameter will be undefined."),U!=null&&(U.defaultProps!=null||U.propTypes!=null)&&rn("forwardRef render functions do not support propTypes or defaultProps. Did you accidentally pass a React component?");var ge={$$typeof:Hn,render:U};{var Pe;Object.defineProperty(ge,"displayName",{enumerable:!1,configurable:!0,get:function(){return Pe},set:function(He){Pe=He,!U.name&&!U.displayName&&(U.displayName=He)}})}return ge}var pe;pe=Symbol.for("react.module.reference");function ue(U){return!!(typeof U=="string"||typeof U=="function"||U===Sn||U===u||On||U===de||U===at||U===gt||_n||U===Ir||In||Ai||ua||typeof U=="object"&&U!==null&&(U.$$typeof===en||U.$$typeof===bt||U.$$typeof===Oe||U.$$typeof===Ft||U.$$typeof===Hn||U.$$typeof===pe||U.getModuleId!==void 0))}function _e(U,ge){ue(U)||rn("memo: The first argument must be a component. Instead received: %s",U===null?"null":typeof U);var Pe={$$typeof:bt,type:U,compare:ge===void 0?null:ge};{var He;Object.defineProperty(Pe,"displayName",{enumerable:!1,configurable:!0,get:function(){return He},set:function(dt){He=dt,!U.name&&!U.displayName&&(U.displayName=dt)}})}return Pe}function Te(){var U=Rn.current;return U===null&&rn(`Invalid hook call. Hooks can only be called inside of the body of a function component. This could happen for one of the following reasons:
1. You might have mismatching versions of React and the renderer (such as React DOM)
2. You might be breaking the Rules of Hooks
3. You might have more than one copy of React in the same app
See https://reactjs.org/link/invalid-hook-call for tips about how to debug and fix this problem.`),U}function We(U){var ge=Te();if(U._context!==void 0){var Pe=U._context;Pe.Consumer===U?rn("Calling useContext(Context.Consumer) is not supported, may cause bugs, and will be removed in a future major release. Did you mean to call useContext(Context) instead?"):Pe.Provider===U&&rn("Calling useContext(Context.Provider) is not supported. Did you mean to call useContext(Context) instead?")}return ge.useContext(U)}function qe(U){var ge=Te();return ge.useState(U)}function ct(U,ge,Pe){var He=Te();return He.useReducer(U,ge,Pe)}function ot(U){var ge=Te();return ge.useRef(U)}function _t(U,ge){var Pe=Te();return Pe.useEffect(U,ge)}function Lt(U,ge){var Pe=Te();return Pe.useInsertionEffect(U,ge)}function on(U,ge){var Pe=Te();return Pe.useLayoutEffect(U,ge)}function cn(U,ge){var Pe=Te();return Pe.useCallback(U,ge)}function Rt(U,ge){var Pe=Te();return Pe.useMemo(U,ge)}function ai(U,ge,Pe){var He=Te();return He.useImperativeHandle(U,ge,Pe)}function ui(U,ge){{var Pe=Te();return Pe.useDebugValue(U,ge)}}function co(){var U=Te();return U.useTransition()}function _a(U){var ge=Te();return ge.useDeferredValue(U)}function an(){var U=Te();return U.useId()}function Ne(U,ge,Pe){var He=Te();return He.useSyncExternalStore(U,ge,Pe)}var ya=0,Wi,Ka,Ec,Jr,el,Eu,Or;function ht(){}ht.__reactDisabledLog=!0;function bn(){{if(ya===0){Wi=console.log,Ka=console.info,Ec=console.warn,Jr=console.error,el=console.group,Eu=console.groupCollapsed,Or=console.groupEnd;var U={configurable:!0,enumerable:!0,value:ht,writable:!0};Object.defineProperties(console,{info:U,log:U,warn:U,error:U,group:U,groupCollapsed:U,groupEnd:U})}ya++}}function hn(){{if(ya--,ya===0){var U={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:rr({},U,{value:Wi}),info:rr({},U,{value:Ka}),warn:rr({},U,{value:Ec}),error:rr({},U,{value:Jr}),group:rr({},U,{value:el}),groupCollapsed:rr({},U,{value:Eu}),groupEnd:rr({},U,{value:Or})})}ya<0&&rn("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}}var Qr=Ut.ReactCurrentDispatcher,$r;function nn(U,ge,Pe){{if($r===void 0)try{throw Error()}catch(dt){var He=dt.stack.trim().match(/\n( *(at )?)/);$r=He&&He[1]||""}return`
`+$r+U}}var ho=!1,ko;{var fo=typeof WeakMap=="function"?WeakMap:Map;ko=new fo}function Mr(U,ge){if(!U||ho)return"";{var Pe=ko.get(U);if(Pe!==void 0)return Pe}var He;ho=!0;var dt=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var Xt;Xt=Qr.current,Qr.current=null,bn();try{if(ge){var Ot=function(){throw Error()};if(Object.defineProperty(Ot.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ot,[])}catch(It){He=It}Reflect.construct(U,[],Ot)}else{try{Ot.call()}catch(It){He=It}U.call(Ot.prototype)}}else{try{throw Error()}catch(It){He=It}U()}}catch(It){if(It&&He&&typeof It.stack=="string"){for(var tn=It.stack.split(`
`),Cn=He.stack.split(`
`),si=tn.length-1,zi=Cn.length-1;si>=1&&zi>=0&&tn[si]!==Cn[zi];)zi--;for(;si>=1&&zi>=0;si--,zi--)if(tn[si]!==Cn[zi]){if(si!==1||zi!==1)do if(si--,zi--,zi<0||tn[si]!==Cn[zi]){var ci=`
`+tn[si].replace(" at new "," at ");return U.displayName&&ci.includes("<anonymous>")&&(ci=ci.replace("<anonymous>",U.displayName)),typeof U=="function"&&ko.set(U,ci),ci}while(si>=1&&zi>=0);break}}}finally{ho=!1,Qr.current=Xt,hn(),Error.prepareStackTrace=dt}var Bi=U?U.displayName||U.name:"",Ii=Bi?nn(Bi):"";return typeof U=="function"&&ko.set(U,Ii),Ii}function Si(U,ge,Pe){return Mr(U,!1)}function po(U){var ge=U.prototype;return!!(ge&&ge.isReactComponent)}function mo(U,ge,Pe){if(U==null)return"";if(typeof U=="function")return Mr(U,po(U));if(typeof U=="string")return nn(U);switch(U){case at:return nn("Suspense");case gt:return nn("SuspenseList")}if(typeof U=="object")switch(U.$$typeof){case Hn:return Si(U.render);case bt:return mo(U.type,ge,Pe);case en:{var He=U,dt=He._payload,Xt=He._init;try{return mo(Xt(dt),ge,Pe)}catch{}}}return""}var tl={},Ds=Ut.ReactDebugCurrentFrame;function ts(U){if(U){var ge=U._owner,Pe=mo(U.type,U._source,ge?ge.type:null);Ds.setExtraStackFrame(Pe)}else Ds.setExtraStackFrame(null)}function Su(U,ge,Pe,He,dt){{var Xt=Function.call.bind(Ba);for(var Ot in U)if(Xt(U,Ot)){var tn=void 0;try{if(typeof U[Ot]!="function"){var Cn=Error((He||"React class")+": "+Pe+" type `"+Ot+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof U[Ot]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw Cn.name="Invariant Violation",Cn}tn=U[Ot](ge,Ot,He,Pe,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(si){tn=si}tn&&!(tn instanceof Error)&&(ts(dt),rn("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",He||"React class",Pe,Ot,typeof tn),ts(null)),tn instanceof Error&&!(tn.message in tl)&&(tl[tn.message]=!0,ts(dt),rn("Failed %s type: %s",Pe,tn.message),ts(null))}}}function Dn(U){if(U){var ge=U._owner,Pe=mo(U.type,U._source,ge?ge.type:null);Wt(Pe)}else Wt(null)}var zs;zs=!1;function nl(){if(Nn.current){var U=gr(Nn.current.type);if(U)return`

Check the render method of \``+U+"`."}return""}function dn(U){if(U!==void 0){var ge=U.fileName.replace(/^.*[\\\/]/,""),Pe=U.lineNumber;return`

Check your code at `+ge+":"+Pe+"."}return""}function ea(U){return U!=null?dn(U.__source):""}var kn={};function Lo(U){var ge=nl();if(!ge){var Pe=typeof U=="string"?U:U.displayName||U.name;Pe&&(ge=`

Check the top-level render call using <`+Pe+">.")}return ge}function ns(U,ge){if(!(!U._store||U._store.validated||U.key!=null)){U._store.validated=!0;var Pe=Lo(ge);if(!kn[Pe]){kn[Pe]=!0;var He="";U&&U._owner&&U._owner!==Nn.current&&(He=" It was passed a child from "+gr(U._owner.type)+"."),Dn(U),rn('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',Pe,He),Dn(null)}}}function Ar(U,ge){if(typeof U=="object"){if(mi(U))for(var Pe=0;Pe<U.length;Pe++){var He=U[Pe];Jn(He)&&ns(He,ge)}else if(Jn(U))U._store&&(U._store.validated=!0);else if(U){var dt=zn(U);if(typeof dt=="function"&&dt!==U.entries)for(var Xt=dt.call(U),Ot;!(Ot=Xt.next()).done;)Jn(Ot.value)&&ns(Ot.value,ge)}}}function Ci(U){{var ge=U.type;if(ge==null||typeof ge=="string")return;var Pe;if(typeof ge=="function")Pe=ge.propTypes;else if(typeof ge=="object"&&(ge.$$typeof===Hn||ge.$$typeof===bt))Pe=ge.propTypes;else return;if(Pe){var He=gr(ge);Su(Pe,U.props,"prop",He,U)}else if(ge.PropTypes!==void 0&&!zs){zs=!0;var dt=gr(ge);rn("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",dt||"Unknown")}typeof ge.getDefaultProps=="function"&&!ge.getDefaultProps.isReactClassApproved&&rn("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}function Yi(U){{for(var ge=Object.keys(U.props),Pe=0;Pe<ge.length;Pe++){var He=ge[Pe];if(He!=="children"&&He!=="key"){Dn(U),rn("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",He),Dn(null);break}}U.ref!==null&&(Dn(U),rn("Invalid attribute `ref` supplied to `React.Fragment`."),Dn(null))}}function Ll(U,ge,Pe){var He=ue(U);if(!He){var dt="";(U===void 0||typeof U=="object"&&U!==null&&Object.keys(U).length===0)&&(dt+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var Xt=ea(ge);Xt?dt+=Xt:dt+=nl();var Ot;U===null?Ot="null":mi(U)?Ot="array":U!==void 0&&U.$$typeof===Qi?(Ot="<"+(gr(U.type)||"Unknown")+" />",dt=" Did you accidentally export a JSX literal instead of a component?"):Ot=typeof U,rn("React.createElement: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",Ot,dt)}var tn=Nt.apply(this,arguments);if(tn==null)return tn;if(He)for(var Cn=2;Cn<arguments.length;Cn++)Ar(arguments[Cn],U);return U===Sn?Yi(tn):Ci(tn),tn}var oi=!1;function qr(U){var ge=Ll.bind(null,U);return ge.type=U,oi||(oi=!0,Hi("React.createFactory() is deprecated and will be removed in a future major release. Consider using JSX or use React.createElement() directly instead.")),Object.defineProperty(ge,"type",{enumerable:!1,get:function(){return Hi("Factory.type is deprecated. Access the class directly before passing it to createFactory."),Object.defineProperty(this,"type",{value:U}),U}}),ge}function go(U,ge,Pe){for(var He=Pn.apply(this,arguments),dt=2;dt<arguments.length;dt++)Ar(arguments[dt],He.type);return Ci(He),He}function Ol(U,ge){var Pe=Oi.transition;Oi.transition={};var He=Oi.transition;Oi.transition._updatedFibers=new Set;try{U()}finally{if(Oi.transition=Pe,Pe===null&&He._updatedFibers){var dt=He._updatedFibers.size;dt>10&&Hi("Detected a large number of updates inside startTransition. If this is due to a subscription please re-write it to use React provided hooks. Otherwise concurrent mode guarantees are off the table."),He._updatedFibers.clear()}}}var tr=!1,_o=null;function Cu(U){if(_o===null)try{var ge=("require"+Math.random()).slice(0,7),Pe=At&&At[ge];_o=Pe.call(At,"timers").setImmediate}catch{_o=function(dt){tr===!1&&(tr=!0,typeof MessageChannel>"u"&&rn("This browser does not have a MessageChannel implementation, so enqueuing tasks via await act(async () => ...) will fail. Please file an issue at https://github.com/facebook/react/issues if you encounter this warning."));var Xt=new MessageChannel;Xt.port1.onmessage=dt,Xt.port2.postMessage(void 0)}}return _o(U)}var va=0,il=!1;function Mu(U){{var ge=va;va++,Ge.current===null&&(Ge.current=[]);var Pe=Ge.isBatchingLegacy,He;try{if(Ge.isBatchingLegacy=!0,He=U(),!Pe&&Ge.didScheduleLegacyUpdate){var dt=Ge.current;dt!==null&&(Ge.didScheduleLegacyUpdate=!1,ks(dt))}}catch(Bi){throw Is(ge),Bi}finally{Ge.isBatchingLegacy=Pe}if(He!==null&&typeof He=="object"&&typeof He.then=="function"){var Xt=He,Ot=!1,tn={then:function(Bi,Ii){Ot=!0,Xt.then(function(It){Is(ge),va===0?rl(It,Bi,Ii):Bi(It)},function(It){Is(ge),Ii(It)})}};return!il&&typeof Promise<"u"&&Promise.resolve().then(function(){}).then(function(){Ot||(il=!0,rn("You called act(async () => ...) without await. This could lead to unexpected testing behaviour, interleaving multiple act calls and mixing their scopes. You should - await act(async () => ...);"))}),tn}else{var Cn=He;if(Is(ge),va===0){var si=Ge.current;si!==null&&(ks(si),Ge.current=null);var zi={then:function(Bi,Ii){Ge.current===null?(Ge.current=[],rl(Cn,Bi,Ii)):Bi(Cn)}};return zi}else{var ci={then:function(Bi,Ii){Bi(Cn)}};return ci}}}}function Is(U){U!==va-1&&rn("You seem to have overlapping act() calls, this is not supported. Be sure to await previous act() calls before making a new one. "),va=U}function rl(U,ge,Pe){{var He=Ge.current;if(He!==null)try{ks(He),Cu(function(){He.length===0?(Ge.current=null,ge(U)):rl(U,ge,Pe)})}catch(dt){Pe(dt)}else ge(U)}}var Na=!1;function ks(U){if(!Na){Na=!0;var ge=0;try{for(;ge<U.length;ge++){var Pe=U[ge];do Pe=Pe(!0);while(Pe!==null)}U.length=0}catch(He){throw U=U.slice(ge+1),He}finally{Na=!1}}}var Sc=Ll,Ls=go,Oo=qr,Pl={map:ga,forEach:zo,count:Ya,toArray:Sa,only:Ua};xt.Children=Pl,xt.Component=or,xt.Fragment=Sn,xt.Profiler=u,xt.PureComponent=mr,xt.StrictMode=de,xt.Suspense=at,xt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ut,xt.cloneElement=Ls,xt.createContext=Io,xt.createElement=Sc,xt.createFactory=Oo,xt.createRef=fa,xt.forwardRef=se,xt.isValidElement=Jn,xt.lazy=Z,xt.memo=_e,xt.startTransition=Ol,xt.unstable_act=Mu,xt.useCallback=cn,xt.useContext=We,xt.useDebugValue=ui,xt.useDeferredValue=_a,xt.useEffect=_t,xt.useId=an,xt.useImperativeHandle=ai,xt.useInsertionEffect=Lt,xt.useLayoutEffect=on,xt.useMemo=Rt,xt.useReducer=ct,xt.useRef=ot,xt.useState=qe,xt.useSyncExternalStore=Ne,xt.useTransition=co,xt.version=li,typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(new Error)})()})(F2,Wv);(function(At){At.exports=Wv})(B2);const U2=O2(kl);/**
 * @license React
 * react-jsx-dev-runtime.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(){var At=kl,xt=Symbol.for("react.element"),li=Symbol.for("react.portal"),Qi=Symbol.for("react.fragment"),Ei=Symbol.for("react.strict_mode"),Sn=Symbol.for("react.profiler"),de=Symbol.for("react.provider"),u=Symbol.for("react.context"),Oe=Symbol.for("react.forward_ref"),Ft=Symbol.for("react.suspense"),Hn=Symbol.for("react.suspense_list"),at=Symbol.for("react.memo"),gt=Symbol.for("react.lazy"),bt=Symbol.for("react.offscreen"),en=Symbol.iterator,Ir="@@iterator";function Ea(O){if(O===null||typeof O!="object")return null;var Z=en&&O[en]||O[Ir];return typeof Z=="function"?Z:null}var kr=At.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function zn(O){{for(var Z=arguments.length,se=new Array(Z>1?Z-1:0),pe=1;pe<Z;pe++)se[pe-1]=arguments[pe];Rn("error",O,se)}}function Rn(O,Z,se){{var pe=kr.ReactDebugCurrentFrame,ue=pe.getStackAddendum();ue!==""&&(Z+="%s",se=se.concat([ue]));var _e=se.map(function(Te){return String(Te)});_e.unshift("Warning: "+Z),Function.prototype.apply.call(console[O],console,_e)}}var Oi=!1,Ge=!1,Nn=!1,xn=!1,Wr=!1,Wt;Wt=Symbol.for("react.module.reference");function In(O){return!!(typeof O=="string"||typeof O=="function"||O===Qi||O===Sn||Wr||O===Ei||O===Ft||O===Hn||xn||O===bt||Oi||Ge||Nn||typeof O=="object"&&O!==null&&(O.$$typeof===gt||O.$$typeof===at||O.$$typeof===de||O.$$typeof===u||O.$$typeof===Oe||O.$$typeof===Wt||O.getModuleId!==void 0))}function Ai(O,Z,se){var pe=O.displayName;if(pe)return pe;var ue=Z.displayName||Z.name||"";return ue!==""?se+"("+ue+")":se}function ua(O){return O.displayName||"Context"}function _n(O){if(O==null)return null;if(typeof O.tag=="number"&&zn("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),typeof O=="function")return O.displayName||O.name||null;if(typeof O=="string")return O;switch(O){case Qi:return"Fragment";case li:return"Portal";case Sn:return"Profiler";case Ei:return"StrictMode";case Ft:return"Suspense";case Hn:return"SuspenseList"}if(typeof O=="object")switch(O.$$typeof){case u:var Z=O;return ua(Z)+".Consumer";case de:var se=O;return ua(se._context)+".Provider";case Oe:return Ai(O,O.render,"ForwardRef");case at:var pe=O.displayName||null;return pe!==null?pe:_n(O.type)||"Memo";case gt:{var ue=O,_e=ue._payload,Te=ue._init;try{return _n(Te(_e))}catch{return null}}}return null}var On=Object.assign,Ut=0,Hi,rn,Xi,ca,Kn,ha,rr;function ar(){}ar.__reactDisabledLog=!0;function or(){{if(Ut===0){Hi=console.log,rn=console.info,Xi=console.warn,ca=console.error,Kn=console.group,ha=console.groupCollapsed,rr=console.groupEnd;var O={configurable:!0,enumerable:!0,value:ar,writable:!0};Object.defineProperties(console,{info:O,log:O,warn:O,error:O,group:O,groupCollapsed:O,groupEnd:O})}Ut++}}function da(){{if(Ut--,Ut===0){var O={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:On({},O,{value:Hi}),info:On({},O,{value:rn}),warn:On({},O,{value:Xi}),error:On({},O,{value:ca}),group:On({},O,{value:Kn}),groupCollapsed:On({},O,{value:ha}),groupEnd:On({},O,{value:rr})})}Ut<0&&zn("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}}var Yr=kr.ReactCurrentDispatcher,er;function Lr(O,Z,se){{if(er===void 0)try{throw Error()}catch(ue){var pe=ue.stack.trim().match(/\n( *(at )?)/);er=pe&&pe[1]||""}return`
`+er+O}}var mr=!1,Ui;{var fa=typeof WeakMap=="function"?WeakMap:Map;Ui=new fa}function Vn(O,Z){if(!O||mr)return"";{var se=Ui.get(O);if(se!==void 0)return se}var pe;mr=!0;var ue=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var _e;_e=Yr.current,Yr.current=null,or();try{if(Z){var Te=function(){throw Error()};if(Object.defineProperty(Te.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Te,[])}catch(cn){pe=cn}Reflect.construct(O,[],Te)}else{try{Te.call()}catch(cn){pe=cn}O.call(Te.prototype)}}else{try{throw Error()}catch(cn){pe=cn}O()}}catch(cn){if(cn&&pe&&typeof cn.stack=="string"){for(var We=cn.stack.split(`
`),qe=pe.stack.split(`
`),ct=We.length-1,ot=qe.length-1;ct>=1&&ot>=0&&We[ct]!==qe[ot];)ot--;for(;ct>=1&&ot>=0;ct--,ot--)if(We[ct]!==qe[ot]){if(ct!==1||ot!==1)do if(ct--,ot--,ot<0||We[ct]!==qe[ot]){var _t=`
`+We[ct].replace(" at new "," at ");return O.displayName&&_t.includes("<anonymous>")&&(_t=_t.replace("<anonymous>",O.displayName)),typeof O=="function"&&Ui.set(O,_t),_t}while(ct>=1&&ot>=0);break}}}finally{mr=!1,Yr.current=_e,da(),Error.prepareStackTrace=ue}var Lt=O?O.displayName||O.name:"",on=Lt?Lr(Lt):"";return typeof O=="function"&&Ui.set(O,on),on}function mi(O,Z,se){return Vn(O,!1)}function Yt(O){var Z=O.prototype;return!!(Z&&Z.isReactComponent)}function Ri(O,Z,se){if(O==null)return"";if(typeof O=="function")return Vn(O,Yt(O));if(typeof O=="string")return Lr(O);switch(O){case Ft:return Lr("Suspense");case Hn:return Lr("SuspenseList")}if(typeof O=="object")switch(O.$$typeof){case Oe:return mi(O.render);case at:return Ri(O.type,Z,se);case gt:{var pe=O,ue=pe._payload,_e=pe._init;try{return Ri(_e(ue),Z,se)}catch{}}}return""}var sr=Object.prototype.hasOwnProperty,Pi={},Vr=kr.ReactDebugCurrentFrame;function pa(O){if(O){var Z=O._owner,se=Ri(O.type,O._source,Z?Z.type:null);Vr.setExtraStackFrame(se)}else Vr.setExtraStackFrame(null)}function gr(O,Z,se,pe,ue){{var _e=Function.call.bind(sr);for(var Te in O)if(_e(O,Te)){var We=void 0;try{if(typeof O[Te]!="function"){var qe=Error((pe||"React class")+": "+se+" type `"+Te+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof O[Te]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw qe.name="Invariant Violation",qe}We=O[Te](Z,Te,pe,se,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(ct){We=ct}We&&!(We instanceof Error)&&(pa(ue),zn("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",pe||"React class",se,Te,typeof We),pa(null)),We instanceof Error&&!(We.message in Pi)&&(Pi[We.message]=!0,pa(ue),zn("Failed %s type: %s",se,We.message),pa(null))}}}var Ba=Array.isArray;function Ni(O){return Ba(O)}function lr(O){{var Z=typeof Symbol=="function"&&Symbol.toStringTag,se=Z&&O[Symbol.toStringTag]||O.constructor.name||"Object";return se}}function Kr(O){try{return Cr(O),!1}catch{return!0}}function Cr(O){return""+O}function jr(O){if(Kr(O))return zn("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",lr(O)),Cr(O)}var Di=kr.ReactCurrentOwner,ma={key:!0,ref:!0,__self:!0,__source:!0},Fa,_r,vt;vt={};function Nt(O){if(sr.call(O,"ref")){var Z=Object.getOwnPropertyDescriptor(O,"ref").get;if(Z&&Z.isReactWarning)return!1}return O.ref!==void 0}function sn(O){if(sr.call(O,"key")){var Z=Object.getOwnPropertyDescriptor(O,"key").get;if(Z&&Z.isReactWarning)return!1}return O.key!==void 0}function Pn(O,Z){if(typeof O.ref=="string"&&Di.current&&Z&&Di.current.stateNode!==Z){var se=_n(Di.current.type);vt[se]||(zn('Component "%s" contains the string ref "%s". Support for string refs will be removed in a future major release. This case cannot be automatically converted to an arrow function. We ask you to manually fix this case by using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',_n(Di.current.type),O.ref),vt[se]=!0)}}function Jn(O,Z){{var se=function(){Fa||(Fa=!0,zn("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",Z))};se.isReactWarning=!0,Object.defineProperty(O,"key",{get:se,configurable:!0})}}function ur(O,Z){{var se=function(){_r||(_r=!0,zn("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",Z))};se.isReactWarning=!0,Object.defineProperty(O,"ref",{get:se,configurable:!0})}}var Vi=function(O,Z,se,pe,ue,_e,Te){var We={$$typeof:xt,type:O,key:Z,ref:se,props:Te,_owner:_e};return We._store={},Object.defineProperty(We._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(We,"_self",{configurable:!1,enumerable:!1,writable:!1,value:pe}),Object.defineProperty(We,"_source",{configurable:!1,enumerable:!1,writable:!1,value:ue}),Object.freeze&&(Object.freeze(We.props),Object.freeze(We)),We};function yr(O,Z,se,pe,ue){{var _e,Te={},We=null,qe=null;se!==void 0&&(jr(se),We=""+se),sn(Z)&&(jr(Z.key),We=""+Z.key),Nt(Z)&&(qe=Z.ref,Pn(Z,ue));for(_e in Z)sr.call(Z,_e)&&!ma.hasOwnProperty(_e)&&(Te[_e]=Z[_e]);if(O&&O.defaultProps){var ct=O.defaultProps;for(_e in ct)Te[_e]===void 0&&(Te[_e]=ct[_e])}if(We||qe){var ot=typeof O=="function"?O.displayName||O.name||"Unknown":O;We&&Jn(Te,ot),qe&&ur(Te,ot)}return Vi(O,We,qe,ue,pe,Di.current,Te)}}var ri=kr.ReactCurrentOwner,Gr=kr.ReactDebugCurrentFrame;function Zn(O){if(O){var Z=O._owner,se=Ri(O.type,O._source,Z?Z.type:null);Gr.setExtraStackFrame(se)}else Gr.setExtraStackFrame(null)}var gi;gi=!1;function Wa(O){return typeof O=="object"&&O!==null&&O.$$typeof===xt}function ga(){{if(ri.current){var O=_n(ri.current.type);if(O)return`

Check the render method of \``+O+"`."}return""}}function Ya(O){{if(O!==void 0){var Z=O.fileName.replace(/^.*[\\\/]/,""),se=O.lineNumber;return`

Check your code at `+Z+":"+se+"."}return""}}var zo={};function Sa(O){{var Z=ga();if(!Z){var se=typeof O=="string"?O:O.displayName||O.name;se&&(Z=`

Check the top-level render call using <`+se+">.")}return Z}}function Ua(O,Z){{if(!O._store||O._store.validated||O.key!=null)return;O._store.validated=!0;var se=Sa(Z);if(zo[se])return;zo[se]=!0;var pe="";O&&O._owner&&O._owner!==ri.current&&(pe=" It was passed a child from "+_n(O._owner.type)+"."),Zn(O),zn('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',se,pe),Zn(null)}}function Io(O,Z){{if(typeof O!="object")return;if(Ni(O))for(var se=0;se<O.length;se++){var pe=O[se];Wa(pe)&&Ua(pe,Z)}else if(Wa(O))O._store&&(O._store.validated=!0);else if(O){var ue=Ea(O);if(typeof ue=="function"&&ue!==O.entries)for(var _e=ue.call(O),Te;!(Te=_e.next()).done;)Wa(Te.value)&&Ua(Te.value,Z)}}}function J(O){{var Z=O.type;if(Z==null||typeof Z=="string")return;var se;if(typeof Z=="function")se=Z.propTypes;else if(typeof Z=="object"&&(Z.$$typeof===Oe||Z.$$typeof===at))se=Z.propTypes;else return;if(se){var pe=_n(Z);gr(se,O.props,"prop",pe,O)}else if(Z.PropTypes!==void 0&&!gi){gi=!0;var ue=_n(Z);zn("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",ue||"Unknown")}typeof Z.getDefaultProps=="function"&&!Z.getDefaultProps.isReactClassApproved&&zn("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}function P(O){{for(var Z=Object.keys(O.props),se=0;se<Z.length;se++){var pe=Z[se];if(pe!=="children"&&pe!=="key"){Zn(O),zn("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",pe),Zn(null);break}}O.ref!==null&&(Zn(O),zn("Invalid attribute `ref` supplied to `React.Fragment`."),Zn(null))}}function V(O,Z,se,pe,ue,_e){{var Te=In(O);if(!Te){var We="";(O===void 0||typeof O=="object"&&O!==null&&Object.keys(O).length===0)&&(We+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var qe=Ya(ue);qe?We+=qe:We+=ga();var ct;O===null?ct="null":Ni(O)?ct="array":O!==void 0&&O.$$typeof===xt?(ct="<"+(_n(O.type)||"Unknown")+" />",We=" Did you accidentally export a JSX literal instead of a component?"):ct=typeof O,zn("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",ct,We)}var ot=yr(O,Z,se,ue,_e);if(ot==null)return ot;if(Te){var _t=Z.children;if(_t!==void 0)if(pe)if(Ni(_t)){for(var Lt=0;Lt<_t.length;Lt++)Io(_t[Lt],O);Object.freeze&&Object.freeze(_t)}else zn("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else Io(_t,O)}return O===Qi?P(ot):J(ot),ot}}var K=V;y1.Fragment=Qi,y1.jsxDEV=K})();(function(At){At.exports=y1})(P2);const Fd=_1.jsxDEV;var v1={},x1={},N2={get exports(){return x1},set exports(At){x1=At}},Qs={},b1={},V2={get exports(){return b1},set exports(At){b1=At}},sE={};/**
 * @license React
 * scheduler.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(At){(function(){typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(new Error);var xt=!1,li=!1,Qi=5;function Ei(vt,Nt){var sn=vt.length;vt.push(Nt),u(vt,Nt,sn)}function Sn(vt){return vt.length===0?null:vt[0]}function de(vt){if(vt.length===0)return null;var Nt=vt[0],sn=vt.pop();return sn!==Nt&&(vt[0]=sn,Oe(vt,sn,0)),Nt}function u(vt,Nt,sn){for(var Pn=sn;Pn>0;){var Jn=Pn-1>>>1,ur=vt[Jn];if(Ft(ur,Nt)>0)vt[Jn]=Nt,vt[Pn]=ur,Pn=Jn;else return}}function Oe(vt,Nt,sn){for(var Pn=sn,Jn=vt.length,ur=Jn>>>1;Pn<ur;){var Vi=(Pn+1)*2-1,yr=vt[Vi],ri=Vi+1,Gr=vt[ri];if(Ft(yr,Nt)<0)ri<Jn&&Ft(Gr,yr)<0?(vt[Pn]=Gr,vt[ri]=Nt,Pn=ri):(vt[Pn]=yr,vt[Vi]=Nt,Pn=Vi);else if(ri<Jn&&Ft(Gr,Nt)<0)vt[Pn]=Gr,vt[ri]=Nt,Pn=ri;else return}}function Ft(vt,Nt){var sn=vt.sortIndex-Nt.sortIndex;return sn!==0?sn:vt.id-Nt.id}var Hn=1,at=2,gt=3,bt=4,en=5;function Ir(vt,Nt){}var Ea=typeof performance=="object"&&typeof performance.now=="function";if(Ea){var kr=performance;At.unstable_now=function(){return kr.now()}}else{var zn=Date,Rn=zn.now();At.unstable_now=function(){return zn.now()-Rn}}var Oi=1073741823,Ge=-1,Nn=250,xn=5e3,Wr=1e4,Wt=Oi,In=[],Ai=[],ua=1,_n=null,On=gt,Ut=!1,Hi=!1,rn=!1,Xi=typeof setTimeout=="function"?setTimeout:null,ca=typeof clearTimeout=="function"?clearTimeout:null,Kn=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function ha(vt){for(var Nt=Sn(Ai);Nt!==null;){if(Nt.callback===null)de(Ai);else if(Nt.startTime<=vt)de(Ai),Nt.sortIndex=Nt.expirationTime,Ei(In,Nt);else return;Nt=Sn(Ai)}}function rr(vt){if(rn=!1,ha(vt),!Hi)if(Sn(In)!==null)Hi=!0,jr(ar);else{var Nt=Sn(Ai);Nt!==null&&Di(rr,Nt.startTime-vt)}}function ar(vt,Nt){Hi=!1,rn&&(rn=!1,ma()),Ut=!0;var sn=On;try{var Pn;if(!li)return or(vt,Nt)}finally{_n=null,On=sn,Ut=!1}}function or(vt,Nt){var sn=Nt;for(ha(sn),_n=Sn(In);_n!==null&&!xt&&!(_n.expirationTime>sn&&(!vt||pa()));){var Pn=_n.callback;if(typeof Pn=="function"){_n.callback=null,On=_n.priorityLevel;var Jn=_n.expirationTime<=sn,ur=Pn(Jn);sn=At.unstable_now(),typeof ur=="function"?_n.callback=ur:_n===Sn(In)&&de(In),ha(sn)}else de(In);_n=Sn(In)}if(_n!==null)return!0;var Vi=Sn(Ai);return Vi!==null&&Di(rr,Vi.startTime-sn),!1}function da(vt,Nt){switch(vt){case Hn:case at:case gt:case bt:case en:break;default:vt=gt}var sn=On;On=vt;try{return Nt()}finally{On=sn}}function Yr(vt){var Nt;switch(On){case Hn:case at:case gt:Nt=gt;break;default:Nt=On;break}var sn=On;On=Nt;try{return vt()}finally{On=sn}}function er(vt){var Nt=On;return function(){var sn=On;On=Nt;try{return vt.apply(this,arguments)}finally{On=sn}}}function Lr(vt,Nt,sn){var Pn=At.unstable_now(),Jn;if(typeof sn=="object"&&sn!==null){var ur=sn.delay;typeof ur=="number"&&ur>0?Jn=Pn+ur:Jn=Pn}else Jn=Pn;var Vi;switch(vt){case Hn:Vi=Ge;break;case at:Vi=Nn;break;case en:Vi=Wt;break;case bt:Vi=Wr;break;case gt:default:Vi=xn;break}var yr=Jn+Vi,ri={id:ua++,callback:Nt,priorityLevel:vt,startTime:Jn,expirationTime:yr,sortIndex:-1};return Jn>Pn?(ri.sortIndex=Jn,Ei(Ai,ri),Sn(In)===null&&ri===Sn(Ai)&&(rn?ma():rn=!0,Di(rr,Jn-Pn))):(ri.sortIndex=yr,Ei(In,ri),!Hi&&!Ut&&(Hi=!0,jr(ar))),ri}function mr(){}function Ui(){!Hi&&!Ut&&(Hi=!0,jr(ar))}function fa(){return Sn(In)}function Vn(vt){vt.callback=null}function mi(){return On}var Yt=!1,Ri=null,sr=-1,Pi=Qi,Vr=-1;function pa(){var vt=At.unstable_now()-Vr;return!(vt<Pi)}function gr(){}function Ba(vt){if(vt<0||vt>125){console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported");return}vt>0?Pi=Math.floor(1e3/vt):Pi=Qi}var Ni=function(){if(Ri!==null){var vt=At.unstable_now();Vr=vt;var Nt=!0,sn=!0;try{sn=Ri(Nt,vt)}finally{sn?lr():(Yt=!1,Ri=null)}}else Yt=!1},lr;if(typeof Kn=="function")lr=function(){Kn(Ni)};else if(typeof MessageChannel<"u"){var Kr=new MessageChannel,Cr=Kr.port2;Kr.port1.onmessage=Ni,lr=function(){Cr.postMessage(null)}}else lr=function(){Xi(Ni,0)};function jr(vt){Ri=vt,Yt||(Yt=!0,lr())}function Di(vt,Nt){sr=Xi(function(){vt(At.unstable_now())},Nt)}function ma(){ca(sr),sr=-1}var Fa=gr,_r=null;At.unstable_IdlePriority=en,At.unstable_ImmediatePriority=Hn,At.unstable_LowPriority=bt,At.unstable_NormalPriority=gt,At.unstable_Profiling=_r,At.unstable_UserBlockingPriority=at,At.unstable_cancelCallback=Vn,At.unstable_continueExecution=Ui,At.unstable_forceFrameRate=Ba,At.unstable_getCurrentPriorityLevel=mi,At.unstable_getFirstCallbackNode=fa,At.unstable_next=Yr,At.unstable_pauseExecution=mr,At.unstable_requestPaint=Fa,At.unstable_runWithPriority=da,At.unstable_scheduleCallback=Lr,At.unstable_shouldYield=pa,At.unstable_wrapCallback=er,typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(new Error)})()})(sE);(function(At){At.exports=sE})(V2);/**
 * @license React
 * react-dom.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(){typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(new Error);var At=kl,xt=b1,li=At.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Qi=!1;function Ei(t){Qi=t}function Sn(t){if(!Qi){for(var a=arguments.length,c=new Array(a>1?a-1:0),m=1;m<a;m++)c[m-1]=arguments[m];u("warn",t,c)}}function de(t){if(!Qi){for(var a=arguments.length,c=new Array(a>1?a-1:0),m=1;m<a;m++)c[m-1]=arguments[m];u("error",t,c)}}function u(t,a,c){{var m=li.ReactDebugCurrentFrame,v=m.getStackAddendum();v!==""&&(a+="%s",c=c.concat([v]));var T=c.map(function(A){return String(A)});T.unshift("Warning: "+a),Function.prototype.apply.call(console[t],console,T)}}var Oe=0,Ft=1,Hn=2,at=3,gt=4,bt=5,en=6,Ir=7,Ea=8,kr=9,zn=10,Rn=11,Oi=12,Ge=13,Nn=14,xn=15,Wr=16,Wt=17,In=18,Ai=19,ua=21,_n=22,On=23,Ut=24,Hi=25,rn=!0,Xi=!1,ca=!1,Kn=!1,ha=!1,rr=!0,ar=!1,or=!1,da=!0,Yr=!0,er=!0,Lr=new Set,mr={},Ui={};function fa(t,a){Vn(t,a),Vn(t+"Capture",a)}function Vn(t,a){mr[t]&&de("EventRegistry: More than one plugin attempted to publish the same registration name, `%s`.",t),mr[t]=a;{var c=t.toLowerCase();Ui[c]=t,t==="onDoubleClick"&&(Ui.ondblclick=t)}for(var m=0;m<a.length;m++)Lr.add(a[m])}var mi=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Yt=Object.prototype.hasOwnProperty;function Ri(t){{var a=typeof Symbol=="function"&&Symbol.toStringTag,c=a&&t[Symbol.toStringTag]||t.constructor.name||"Object";return c}}function sr(t){try{return Pi(t),!1}catch{return!0}}function Pi(t){return""+t}function Vr(t,a){if(sr(t))return de("The provided `%s` attribute is an unsupported type %s. This value must be coerced to a string before before using it here.",a,Ri(t)),Pi(t)}function pa(t){if(sr(t))return de("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",Ri(t)),Pi(t)}function gr(t,a){if(sr(t))return de("The provided `%s` prop is an unsupported type %s. This value must be coerced to a string before before using it here.",a,Ri(t)),Pi(t)}function Ba(t,a){if(sr(t))return de("The provided `%s` CSS property is an unsupported type %s. This value must be coerced to a string before before using it here.",a,Ri(t)),Pi(t)}function Ni(t){if(sr(t))return de("The provided HTML markup uses a value of unsupported type %s. This value must be coerced to a string before before using it here.",Ri(t)),Pi(t)}function lr(t){if(sr(t))return de("Form field values (value, checked, defaultValue, or defaultChecked props) must be strings, not %s. This value must be coerced to a string before before using it here.",Ri(t)),Pi(t)}var Kr=0,Cr=1,jr=2,Di=3,ma=4,Fa=5,_r=6,vt=":A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",Nt=vt+"\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040",sn=new RegExp("^["+vt+"]["+Nt+"]*$"),Pn={},Jn={};function ur(t){return Yt.call(Jn,t)?!0:Yt.call(Pn,t)?!1:sn.test(t)?(Jn[t]=!0,!0):(Pn[t]=!0,de("Invalid attribute name: `%s`",t),!1)}function Vi(t,a,c){return a!==null?a.type===Kr:c?!1:t.length>2&&(t[0]==="o"||t[0]==="O")&&(t[1]==="n"||t[1]==="N")}function yr(t,a,c,m){if(c!==null&&c.type===Kr)return!1;switch(typeof a){case"function":case"symbol":return!0;case"boolean":{if(m)return!1;if(c!==null)return!c.acceptsBooleans;var v=t.toLowerCase().slice(0,5);return v!=="data-"&&v!=="aria-"}default:return!1}}function ri(t,a,c,m){if(a===null||typeof a>"u"||yr(t,a,c,m))return!0;if(m)return!1;if(c!==null)switch(c.type){case Di:return!a;case ma:return a===!1;case Fa:return isNaN(a);case _r:return isNaN(a)||a<1}return!1}function Gr(t){return gi.hasOwnProperty(t)?gi[t]:null}function Zn(t,a,c,m,v,T,A){this.acceptsBooleans=a===jr||a===Di||a===ma,this.attributeName=m,this.attributeNamespace=v,this.mustUseProperty=c,this.propertyName=t,this.type=a,this.sanitizeURL=T,this.removeEmptyString=A}var gi={},Wa=["children","dangerouslySetInnerHTML","defaultValue","defaultChecked","innerHTML","suppressContentEditableWarning","suppressHydrationWarning","style"];Wa.forEach(function(t){gi[t]=new Zn(t,Kr,!1,t,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var a=t[0],c=t[1];gi[a]=new Zn(a,Cr,!1,c,null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(t){gi[t]=new Zn(t,jr,!1,t.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){gi[t]=new Zn(t,jr,!1,t,null,!1,!1)}),["allowFullScreen","async","autoFocus","autoPlay","controls","default","defer","disabled","disablePictureInPicture","disableRemotePlayback","formNoValidate","hidden","loop","noModule","noValidate","open","playsInline","readOnly","required","reversed","scoped","seamless","itemScope"].forEach(function(t){gi[t]=new Zn(t,Di,!1,t.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(t){gi[t]=new Zn(t,Di,!0,t,null,!1,!1)}),["capture","download"].forEach(function(t){gi[t]=new Zn(t,ma,!1,t,null,!1,!1)}),["cols","rows","size","span"].forEach(function(t){gi[t]=new Zn(t,_r,!1,t,null,!1,!1)}),["rowSpan","start"].forEach(function(t){gi[t]=new Zn(t,Fa,!1,t.toLowerCase(),null,!1,!1)});var ga=/[\-\:]([a-z])/g,Ya=function(t){return t[1].toUpperCase()};["accent-height","alignment-baseline","arabic-form","baseline-shift","cap-height","clip-path","clip-rule","color-interpolation","color-interpolation-filters","color-profile","color-rendering","dominant-baseline","enable-background","fill-opacity","fill-rule","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","glyph-name","glyph-orientation-horizontal","glyph-orientation-vertical","horiz-adv-x","horiz-origin-x","image-rendering","letter-spacing","lighting-color","marker-end","marker-mid","marker-start","overline-position","overline-thickness","paint-order","panose-1","pointer-events","rendering-intent","shape-rendering","stop-color","stop-opacity","strikethrough-position","strikethrough-thickness","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","text-anchor","text-decoration","text-rendering","underline-position","underline-thickness","unicode-bidi","unicode-range","units-per-em","v-alphabetic","v-hanging","v-ideographic","v-mathematical","vector-effect","vert-adv-y","vert-origin-x","vert-origin-y","word-spacing","writing-mode","xmlns:xlink","x-height"].forEach(function(t){var a=t.replace(ga,Ya);gi[a]=new Zn(a,Cr,!1,t,null,!1,!1)}),["xlink:actuate","xlink:arcrole","xlink:role","xlink:show","xlink:title","xlink:type"].forEach(function(t){var a=t.replace(ga,Ya);gi[a]=new Zn(a,Cr,!1,t,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(t){var a=t.replace(ga,Ya);gi[a]=new Zn(a,Cr,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(t){gi[t]=new Zn(t,Cr,!1,t.toLowerCase(),null,!1,!1)});var zo="xlinkHref";gi[zo]=new Zn("xlinkHref",Cr,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(t){gi[t]=new Zn(t,Cr,!1,t.toLowerCase(),null,!0,!0)});var Sa=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*\:/i,Ua=!1;function Io(t){!Ua&&Sa.test(t)&&(Ua=!0,de("A future version of React will block javascript: URLs as a security precaution. Use event handlers instead if you can. If you need to generate unsafe HTML try using dangerouslySetInnerHTML instead. React was passed %s.",JSON.stringify(t)))}function J(t,a,c,m){if(m.mustUseProperty){var v=m.propertyName;return t[v]}else{Vr(c,a),m.sanitizeURL&&Io(""+c);var T=m.attributeName,A=null;if(m.type===ma){if(t.hasAttribute(T)){var k=t.getAttribute(T);return k===""?!0:ri(a,c,m,!1)?k:k===""+c?c:k}}else if(t.hasAttribute(T)){if(ri(a,c,m,!1))return t.getAttribute(T);if(m.type===Di)return c;A=t.getAttribute(T)}return ri(a,c,m,!1)?A===null?c:A:A===""+c?c:A}}function P(t,a,c,m){{if(!ur(a))return;if(!t.hasAttribute(a))return c===void 0?void 0:null;var v=t.getAttribute(a);return Vr(c,a),v===""+c?c:v}}function V(t,a,c,m){var v=Gr(a);if(!Vi(a,v,m)){if(ri(a,c,v,m)&&(c=null),m||v===null){if(ur(a)){var T=a;c===null?t.removeAttribute(T):(Vr(c,a),t.setAttribute(T,""+c))}return}var A=v.mustUseProperty;if(A){var k=v.propertyName;if(c===null){var F=v.type;t[k]=F===Di?!1:""}else t[k]=c;return}var H=v.attributeName,ie=v.attributeNamespace;if(c===null)t.removeAttribute(H);else{var xe=v.type,ye;xe===Di||xe===ma&&c===!0?ye="":(Vr(c,H),ye=""+c,v.sanitizeURL&&Io(ye.toString())),ie?t.setAttributeNS(ie,H,ye):t.setAttribute(H,ye)}}}var K=Symbol.for("react.element"),O=Symbol.for("react.portal"),Z=Symbol.for("react.fragment"),se=Symbol.for("react.strict_mode"),pe=Symbol.for("react.profiler"),ue=Symbol.for("react.provider"),_e=Symbol.for("react.context"),Te=Symbol.for("react.forward_ref"),We=Symbol.for("react.suspense"),qe=Symbol.for("react.suspense_list"),ct=Symbol.for("react.memo"),ot=Symbol.for("react.lazy"),_t=Symbol.for("react.scope"),Lt=Symbol.for("react.debug_trace_mode"),on=Symbol.for("react.offscreen"),cn=Symbol.for("react.legacy_hidden"),Rt=Symbol.for("react.cache"),ai=Symbol.for("react.tracing_marker"),ui=Symbol.iterator,co="@@iterator";function _a(t){if(t===null||typeof t!="object")return null;var a=ui&&t[ui]||t[co];return typeof a=="function"?a:null}var an=Object.assign,Ne=0,ya,Wi,Ka,Ec,Jr,el,Eu;function Or(){}Or.__reactDisabledLog=!0;function ht(){{if(Ne===0){ya=console.log,Wi=console.info,Ka=console.warn,Ec=console.error,Jr=console.group,el=console.groupCollapsed,Eu=console.groupEnd;var t={configurable:!0,enumerable:!0,value:Or,writable:!0};Object.defineProperties(console,{info:t,log:t,warn:t,error:t,group:t,groupCollapsed:t,groupEnd:t})}Ne++}}function bn(){{if(Ne--,Ne===0){var t={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:an({},t,{value:ya}),info:an({},t,{value:Wi}),warn:an({},t,{value:Ka}),error:an({},t,{value:Ec}),group:an({},t,{value:Jr}),groupCollapsed:an({},t,{value:el}),groupEnd:an({},t,{value:Eu})})}Ne<0&&de("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}}var hn=li.ReactCurrentDispatcher,Qr;function $r(t,a,c){{if(Qr===void 0)try{throw Error()}catch(v){var m=v.stack.trim().match(/\n( *(at )?)/);Qr=m&&m[1]||""}return`
`+Qr+t}}var nn=!1,ho;{var ko=typeof WeakMap=="function"?WeakMap:Map;ho=new ko}function fo(t,a){if(!t||nn)return"";{var c=ho.get(t);if(c!==void 0)return c}var m;nn=!0;var v=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var T;T=hn.current,hn.current=null,ht();try{if(a){var A=function(){throw Error()};if(Object.defineProperty(A.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(A,[])}catch(Ue){m=Ue}Reflect.construct(t,[],A)}else{try{A.call()}catch(Ue){m=Ue}t.call(A.prototype)}}else{try{throw Error()}catch(Ue){m=Ue}t()}}catch(Ue){if(Ue&&m&&typeof Ue.stack=="string"){for(var k=Ue.stack.split(`
`),F=m.stack.split(`
`),H=k.length-1,ie=F.length-1;H>=1&&ie>=0&&k[H]!==F[ie];)ie--;for(;H>=1&&ie>=0;H--,ie--)if(k[H]!==F[ie]){if(H!==1||ie!==1)do if(H--,ie--,ie<0||k[H]!==F[ie]){var xe=`
`+k[H].replace(" at new "," at ");return t.displayName&&xe.includes("<anonymous>")&&(xe=xe.replace("<anonymous>",t.displayName)),typeof t=="function"&&ho.set(t,xe),xe}while(H>=1&&ie>=0);break}}}finally{nn=!1,hn.current=T,bn(),Error.prepareStackTrace=v}var ye=t?t.displayName||t.name:"",Be=ye?$r(ye):"";return typeof t=="function"&&ho.set(t,Be),Be}function Mr(t,a,c){return fo(t,!0)}function Si(t,a,c){return fo(t,!1)}function po(t){var a=t.prototype;return!!(a&&a.isReactComponent)}function mo(t,a,c){if(t==null)return"";if(typeof t=="function")return fo(t,po(t));if(typeof t=="string")return $r(t);switch(t){case We:return $r("Suspense");case qe:return $r("SuspenseList")}if(typeof t=="object")switch(t.$$typeof){case Te:return Si(t.render);case ct:return mo(t.type,a,c);case ot:{var m=t,v=m._payload,T=m._init;try{return mo(T(v),a,c)}catch{}}}return""}function tl(t){switch(t._debugOwner&&t._debugOwner.type,t._debugSource,t.tag){case bt:return $r(t.type);case Wr:return $r("Lazy");case Ge:return $r("Suspense");case Ai:return $r("SuspenseList");case Oe:case Hn:case xn:return Si(t.type);case Rn:return Si(t.type.render);case Ft:return Mr(t.type);default:return""}}function Ds(t){try{var a="",c=t;do a+=tl(c),c=c.return;while(c);return a}catch(m){return`
Error generating stack: `+m.message+`
`+m.stack}}function ts(t,a,c){var m=t.displayName;if(m)return m;var v=a.displayName||a.name||"";return v!==""?c+"("+v+")":c}function Su(t){return t.displayName||"Context"}function Dn(t){if(t==null)return null;if(typeof t.tag=="number"&&de("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Z:return"Fragment";case O:return"Portal";case pe:return"Profiler";case se:return"StrictMode";case We:return"Suspense";case qe:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case _e:var a=t;return Su(a)+".Consumer";case ue:var c=t;return Su(c._context)+".Provider";case Te:return ts(t,t.render,"ForwardRef");case ct:var m=t.displayName||null;return m!==null?m:Dn(t.type)||"Memo";case ot:{var v=t,T=v._payload,A=v._init;try{return Dn(A(T))}catch{return null}}}return null}function zs(t,a,c){var m=a.displayName||a.name||"";return t.displayName||(m!==""?c+"("+m+")":c)}function nl(t){return t.displayName||"Context"}function dn(t){var a=t.tag,c=t.type;switch(a){case Ut:return"Cache";case kr:var m=c;return nl(m)+".Consumer";case zn:var v=c;return nl(v._context)+".Provider";case In:return"DehydratedFragment";case Rn:return zs(c,c.render,"ForwardRef");case Ir:return"Fragment";case bt:return c;case gt:return"Portal";case at:return"Root";case en:return"Text";case Wr:return Dn(c);case Ea:return c===se?"StrictMode":"Mode";case _n:return"Offscreen";case Oi:return"Profiler";case ua:return"Scope";case Ge:return"Suspense";case Ai:return"SuspenseList";case Hi:return"TracingMarker";case Ft:case Oe:case Wt:case Hn:case Nn:case xn:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c;break}return null}var ea=li.ReactDebugCurrentFrame,kn=null,Lo=!1;function ns(){{if(kn===null)return null;var t=kn._debugOwner;if(t!==null&&typeof t<"u")return dn(t)}return null}function Ar(){return kn===null?"":Ds(kn)}function Ci(){ea.getCurrentStack=null,kn=null,Lo=!1}function Yi(t){ea.getCurrentStack=t===null?null:Ar,kn=t,Lo=!1}function Ll(){return kn}function oi(t){Lo=t}function qr(t){return""+t}function go(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return lr(t),t;default:return""}}var Ol={button:!0,checkbox:!0,image:!0,hidden:!0,radio:!0,reset:!0,submit:!0};function tr(t,a){Ol[a.type]||a.onChange||a.onInput||a.readOnly||a.disabled||a.value==null||de("You provided a `value` prop to a form field without an `onChange` handler. This will render a read-only field. If the field should be mutable use `defaultValue`. Otherwise, set either `onChange` or `readOnly`."),a.onChange||a.readOnly||a.disabled||a.checked==null||de("You provided a `checked` prop to a form field without an `onChange` handler. This will render a read-only field. If the field should be mutable use `defaultChecked`. Otherwise, set either `onChange` or `readOnly`.")}function _o(t){var a=t.type,c=t.nodeName;return c&&c.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function Cu(t){return t._valueTracker}function va(t){t._valueTracker=null}function il(t){var a="";return t&&(_o(t)?a=t.checked?"true":"false":a=t.value),a}function Mu(t){var a=_o(t)?"checked":"value",c=Object.getOwnPropertyDescriptor(t.constructor.prototype,a);lr(t[a]);var m=""+t[a];if(!(t.hasOwnProperty(a)||typeof c>"u"||typeof c.get!="function"||typeof c.set!="function")){var v=c.get,T=c.set;Object.defineProperty(t,a,{configurable:!0,get:function(){return v.call(this)},set:function(k){lr(k),m=""+k,T.call(this,k)}}),Object.defineProperty(t,a,{enumerable:c.enumerable});var A={getValue:function(){return m},setValue:function(k){lr(k),m=""+k},stopTracking:function(){va(t),delete t[a]}};return A}}function Is(t){Cu(t)||(t._valueTracker=Mu(t))}function rl(t){if(!t)return!1;var a=Cu(t);if(!a)return!0;var c=a.getValue(),m=il(t);return m!==c?(a.setValue(m),!0):!1}function Na(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}var ks=!1,Sc=!1,Ls=!1,Oo=!1;function Pl(t){var a=t.type==="checkbox"||t.type==="radio";return a?t.checked!=null:t.value!=null}function U(t,a){var c=t,m=a.checked,v=an({},a,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:m??c._wrapperState.initialChecked});return v}function ge(t,a){tr("input",a),a.checked!==void 0&&a.defaultChecked!==void 0&&!Sc&&(de("%s contains an input of type %s with both checked and defaultChecked props. Input elements must be either controlled or uncontrolled (specify either the checked prop, or the defaultChecked prop, but not both). Decide between using a controlled or uncontrolled input element and remove one of these props. More info: https://reactjs.org/link/controlled-components",ns()||"A component",a.type),Sc=!0),a.value!==void 0&&a.defaultValue!==void 0&&!ks&&(de("%s contains an input of type %s with both value and defaultValue props. Input elements must be either controlled or uncontrolled (specify either the value prop, or the defaultValue prop, but not both). Decide between using a controlled or uncontrolled input element and remove one of these props. More info: https://reactjs.org/link/controlled-components",ns()||"A component",a.type),ks=!0);var c=t,m=a.defaultValue==null?"":a.defaultValue;c._wrapperState={initialChecked:a.checked!=null?a.checked:a.defaultChecked,initialValue:go(a.value!=null?a.value:m),controlled:Pl(a)}}function Pe(t,a){var c=t,m=a.checked;m!=null&&V(c,"checked",m,!1)}function He(t,a){var c=t;{var m=Pl(a);!c._wrapperState.controlled&&m&&!Oo&&(de("A component is changing an uncontrolled input to be controlled. This is likely caused by the value changing from undefined to a defined value, which should not happen. Decide between using a controlled or uncontrolled input element for the lifetime of the component. More info: https://reactjs.org/link/controlled-components"),Oo=!0),c._wrapperState.controlled&&!m&&!Ls&&(de("A component is changing a controlled input to be uncontrolled. This is likely caused by the value changing from a defined to undefined, which should not happen. Decide between using a controlled or uncontrolled input element for the lifetime of the component. More info: https://reactjs.org/link/controlled-components"),Ls=!0)}Pe(t,a);var v=go(a.value),T=a.type;if(v!=null)T==="number"?(v===0&&c.value===""||c.value!=v)&&(c.value=qr(v)):c.value!==qr(v)&&(c.value=qr(v));else if(T==="submit"||T==="reset"){c.removeAttribute("value");return}a.hasOwnProperty("value")?tn(c,a.type,v):a.hasOwnProperty("defaultValue")&&tn(c,a.type,go(a.defaultValue)),a.checked==null&&a.defaultChecked!=null&&(c.defaultChecked=!!a.defaultChecked)}function dt(t,a,c){var m=t;if(a.hasOwnProperty("value")||a.hasOwnProperty("defaultValue")){var v=a.type,T=v==="submit"||v==="reset";if(T&&(a.value===void 0||a.value===null))return;var A=qr(m._wrapperState.initialValue);c||A!==m.value&&(m.value=A),m.defaultValue=A}var k=m.name;k!==""&&(m.name=""),m.defaultChecked=!m.defaultChecked,m.defaultChecked=!!m._wrapperState.initialChecked,k!==""&&(m.name=k)}function Xt(t,a){var c=t;He(c,a),Ot(c,a)}function Ot(t,a){var c=a.name;if(a.type==="radio"&&c!=null){for(var m=t;m.parentNode;)m=m.parentNode;Vr(c,"name");for(var v=m.querySelectorAll("input[name="+JSON.stringify(""+c)+'][type="radio"]'),T=0;T<v.length;T++){var A=v[T];if(!(A===t||A.form!==t.form)){var k=wd(A);if(!k)throw new Error("ReactDOMInput: Mixing React and non-React radio inputs with the same `name` is not supported.");rl(A),He(A,k)}}}}function tn(t,a,c){(a!=="number"||Na(t.ownerDocument)!==t)&&(c==null?t.defaultValue=qr(t._wrapperState.initialValue):t.defaultValue!==qr(c)&&(t.defaultValue=qr(c)))}var Cn=!1,si=!1,zi=!1;function ci(t,a){a.value==null&&(typeof a.children=="object"&&a.children!==null?At.Children.forEach(a.children,function(c){c!=null&&(typeof c=="string"||typeof c=="number"||si||(si=!0,de("Cannot infer the option value of complex children. Pass a `value` prop or use a plain string as children to <option>.")))}):a.dangerouslySetInnerHTML!=null&&(zi||(zi=!0,de("Pass a `value` prop if you set dangerouslyInnerHTML so React knows which value should be selected.")))),a.selected!=null&&!Cn&&(de("Use the `defaultValue` or `value` props on <select> instead of setting `selected` on <option>."),Cn=!0)}function Bi(t,a){a.value!=null&&t.setAttribute("value",qr(go(a.value)))}var Ii=Array.isArray;function It(t){return Ii(t)}var Os;Os=!1;function is(){var t=ns();return t?`

Check the render method of \``+t+"`.":""}var Bl=["value","defaultValue"];function al(t){{tr("select",t);for(var a=0;a<Bl.length;a++){var c=Bl[a];if(t[c]!=null){var m=It(t[c]);t.multiple&&!m?de("The `%s` prop supplied to <select> must be an array if `multiple` is true.%s",c,is()):!t.multiple&&m&&de("The `%s` prop supplied to <select> must be a scalar value if `multiple` is false.%s",c,is())}}}}function yo(t,a,c,m){var v=t.options;if(a){for(var T=c,A={},k=0;k<T.length;k++)A["$"+T[k]]=!0;for(var F=0;F<v.length;F++){var H=A.hasOwnProperty("$"+v[F].value);v[F].selected!==H&&(v[F].selected=H),H&&m&&(v[F].defaultSelected=!0)}}else{for(var ie=qr(go(c)),xe=null,ye=0;ye<v.length;ye++){if(v[ye].value===ie){v[ye].selected=!0,m&&(v[ye].defaultSelected=!0);return}xe===null&&!v[ye].disabled&&(xe=v[ye])}xe!==null&&(xe.selected=!0)}}function Ps(t,a){return an({},a,{value:void 0})}function ol(t,a){var c=t;al(a),c._wrapperState={wasMultiple:!!a.multiple},a.value!==void 0&&a.defaultValue!==void 0&&!Os&&(de("Select elements must be either controlled or uncontrolled (specify either the value prop, or the defaultValue prop, but not both). Decide between using a controlled or uncontrolled select element and remove one of these props. More info: https://reactjs.org/link/controlled-components"),Os=!0)}function Cc(t,a){var c=t;c.multiple=!!a.multiple;var m=a.value;m!=null?yo(c,!!a.multiple,m,!1):a.defaultValue!=null&&yo(c,!!a.multiple,a.defaultValue,!0)}function Sh(t,a){var c=t,m=c._wrapperState.wasMultiple;c._wrapperState.wasMultiple=!!a.multiple;var v=a.value;v!=null?yo(c,!!a.multiple,v,!1):m!==!!a.multiple&&(a.defaultValue!=null?yo(c,!!a.multiple,a.defaultValue,!0):yo(c,!!a.multiple,a.multiple?[]:"",!1))}function Fl(t,a){var c=t,m=a.value;m!=null&&yo(c,!!a.multiple,m,!1)}var Ul=!1;function Au(t,a){var c=t;if(a.dangerouslySetInnerHTML!=null)throw new Error("`dangerouslySetInnerHTML` does not make sense on <textarea>.");var m=an({},a,{value:void 0,defaultValue:void 0,children:qr(c._wrapperState.initialValue)});return m}function Ru(t,a){var c=t;tr("textarea",a),a.value!==void 0&&a.defaultValue!==void 0&&!Ul&&(de("%s contains a textarea with both value and defaultValue props. Textarea elements must be either controlled or uncontrolled (specify either the value prop, or the defaultValue prop, but not both). Decide between using a controlled or uncontrolled textarea and remove one of these props. More info: https://reactjs.org/link/controlled-components",ns()||"A component"),Ul=!0);var m=a.value;if(m==null){var v=a.children,T=a.defaultValue;if(v!=null){de("Use the `defaultValue` or `value` props instead of setting children on <textarea>.");{if(T!=null)throw new Error("If you supply `defaultValue` on a <textarea>, do not pass children.");if(It(v)){if(v.length>1)throw new Error("<textarea> can only have at most one child.");v=v[0]}T=v}}T==null&&(T=""),m=T}c._wrapperState={initialValue:go(m)}}function Mc(t,a){var c=t,m=go(a.value),v=go(a.defaultValue);if(m!=null){var T=qr(m);T!==c.value&&(c.value=T),a.defaultValue==null&&c.defaultValue!==T&&(c.defaultValue=T)}v!=null&&(c.defaultValue=qr(v))}function Bn(t,a){var c=t,m=c.textContent;m===c._wrapperState.initialValue&&m!==""&&m!==null&&(c.value=m)}function Ch(t,a){Mc(t,a)}var Po="http://www.w3.org/1999/xhtml",np="http://www.w3.org/1998/Math/MathML",Ac="http://www.w3.org/2000/svg";function Du(t){switch(t){case"svg":return Ac;case"math":return np;default:return Po}}function Mh(t,a){return t==null||t===Po?Du(a):t===Ac&&a==="foreignObject"?Po:t}var ip=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(a,c,m,v){MSApp.execUnsafeLocalFunction(function(){return t(a,c,m,v)})}:t},Ah,Rc=ip(function(t,a){if(t.namespaceURI===Ac&&!("innerHTML"in t)){Ah=Ah||document.createElement("div"),Ah.innerHTML="<svg>"+a.valueOf().toString()+"</svg>";for(var c=Ah.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;c.firstChild;)t.appendChild(c.firstChild);return}t.innerHTML=a}),ta=1,Bo=3,cr=8,rs=9,Rh=11,Dh=function(t,a){if(a){var c=t.firstChild;if(c&&c===t.lastChild&&c.nodeType===Bo){c.nodeValue=a;return}}t.textContent=a},Dc={animation:["animationDelay","animationDirection","animationDuration","animationFillMode","animationIterationCount","animationName","animationPlayState","animationTimingFunction"],background:["backgroundAttachment","backgroundClip","backgroundColor","backgroundImage","backgroundOrigin","backgroundPositionX","backgroundPositionY","backgroundRepeat","backgroundSize"],backgroundPosition:["backgroundPositionX","backgroundPositionY"],border:["borderBottomColor","borderBottomStyle","borderBottomWidth","borderImageOutset","borderImageRepeat","borderImageSlice","borderImageSource","borderImageWidth","borderLeftColor","borderLeftStyle","borderLeftWidth","borderRightColor","borderRightStyle","borderRightWidth","borderTopColor","borderTopStyle","borderTopWidth"],borderBlockEnd:["borderBlockEndColor","borderBlockEndStyle","borderBlockEndWidth"],borderBlockStart:["borderBlockStartColor","borderBlockStartStyle","borderBlockStartWidth"],borderBottom:["borderBottomColor","borderBottomStyle","borderBottomWidth"],borderColor:["borderBottomColor","borderLeftColor","borderRightColor","borderTopColor"],borderImage:["borderImageOutset","borderImageRepeat","borderImageSlice","borderImageSource","borderImageWidth"],borderInlineEnd:["borderInlineEndColor","borderInlineEndStyle","borderInlineEndWidth"],borderInlineStart:["borderInlineStartColor","borderInlineStartStyle","borderInlineStartWidth"],borderLeft:["borderLeftColor","borderLeftStyle","borderLeftWidth"],borderRadius:["borderBottomLeftRadius","borderBottomRightRadius","borderTopLeftRadius","borderTopRightRadius"],borderRight:["borderRightColor","borderRightStyle","borderRightWidth"],borderStyle:["borderBottomStyle","borderLeftStyle","borderRightStyle","borderTopStyle"],borderTop:["borderTopColor","borderTopStyle","borderTopWidth"],borderWidth:["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth"],columnRule:["columnRuleColor","columnRuleStyle","columnRuleWidth"],columns:["columnCount","columnWidth"],flex:["flexBasis","flexGrow","flexShrink"],flexFlow:["flexDirection","flexWrap"],font:["fontFamily","fontFeatureSettings","fontKerning","fontLanguageOverride","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontVariantAlternates","fontVariantCaps","fontVariantEastAsian","fontVariantLigatures","fontVariantNumeric","fontVariantPosition","fontWeight","lineHeight"],fontVariant:["fontVariantAlternates","fontVariantCaps","fontVariantEastAsian","fontVariantLigatures","fontVariantNumeric","fontVariantPosition"],gap:["columnGap","rowGap"],grid:["gridAutoColumns","gridAutoFlow","gridAutoRows","gridTemplateAreas","gridTemplateColumns","gridTemplateRows"],gridArea:["gridColumnEnd","gridColumnStart","gridRowEnd","gridRowStart"],gridColumn:["gridColumnEnd","gridColumnStart"],gridColumnGap:["columnGap"],gridGap:["columnGap","rowGap"],gridRow:["gridRowEnd","gridRowStart"],gridRowGap:["rowGap"],gridTemplate:["gridTemplateAreas","gridTemplateColumns","gridTemplateRows"],listStyle:["listStyleImage","listStylePosition","listStyleType"],margin:["marginBottom","marginLeft","marginRight","marginTop"],marker:["markerEnd","markerMid","markerStart"],mask:["maskClip","maskComposite","maskImage","maskMode","maskOrigin","maskPositionX","maskPositionY","maskRepeat","maskSize"],maskPosition:["maskPositionX","maskPositionY"],outline:["outlineColor","outlineStyle","outlineWidth"],overflow:["overflowX","overflowY"],padding:["paddingBottom","paddingLeft","paddingRight","paddingTop"],placeContent:["alignContent","justifyContent"],placeItems:["alignItems","justifyItems"],placeSelf:["alignSelf","justifySelf"],textDecoration:["textDecorationColor","textDecorationLine","textDecorationStyle"],textEmphasis:["textEmphasisColor","textEmphasisStyle"],transition:["transitionDelay","transitionDuration","transitionProperty","transitionTimingFunction"],wordWrap:["overflowWrap"]},as={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0};function rp(t,a){return t+a.charAt(0).toUpperCase()+a.substring(1)}var zh=["Webkit","ms","Moz","O"];Object.keys(as).forEach(function(t){zh.forEach(function(a){as[rp(a,t)]=as[t]})});function zc(t,a,c){var m=a==null||typeof a=="boolean"||a==="";return m?"":!c&&typeof a=="number"&&a!==0&&!(as.hasOwnProperty(t)&&as[t])?a+"px":(Ba(a,t),(""+a).trim())}var os=/([A-Z])/g,Ih=/^ms-/;function Ud(t){return t.replace(os,"-$1").toLowerCase().replace(Ih,"-ms-")}var Ic=function(){};{var ap=/^(?:webkit|moz|o)[A-Z]/,Nd=/^-ms-/,op=/-(.)/g,kc=/;\s*$/,Nl={},zu={},sp=!1,kh=!1,Nm=function(t){return t.replace(op,function(a,c){return c.toUpperCase()})},Iu=function(t){Nl.hasOwnProperty(t)&&Nl[t]||(Nl[t]=!0,de("Unsupported style property %s. Did you mean %s?",t,Nm(t.replace(Nd,"ms-"))))},lp=function(t){Nl.hasOwnProperty(t)&&Nl[t]||(Nl[t]=!0,de("Unsupported vendor-prefixed style property %s. Did you mean %s?",t,t.charAt(0).toUpperCase()+t.slice(1)))},Lc=function(t,a){zu.hasOwnProperty(a)&&zu[a]||(zu[a]=!0,de(`Style property values shouldn't contain a semicolon. Try "%s: %s" instead.`,t,a.replace(kc,"")))},Vm=function(t,a){sp||(sp=!0,de("`NaN` is an invalid value for the `%s` css style property.",t))},up=function(t,a){kh||(kh=!0,de("`Infinity` is an invalid value for the `%s` css style property.",t))};Ic=function(t,a){t.indexOf("-")>-1?Iu(t):ap.test(t)?lp(t):kc.test(a)&&Lc(t,a),typeof a=="number"&&(isNaN(a)?Vm(t,a):isFinite(a)||up(t,a))}}var cp=Ic;function Vl(t){{var a="",c="";for(var m in t)if(t.hasOwnProperty(m)){var v=t[m];if(v!=null){var T=m.indexOf("--")===0;a+=c+(T?m:Ud(m))+":",a+=zc(m,v,T),c=";"}}return a||null}}function Vd(t,a){var c=t.style;for(var m in a)if(a.hasOwnProperty(m)){var v=m.indexOf("--")===0;v||cp(m,a[m]);var T=zc(m,a[m],v);m==="float"&&(m="cssFloat"),v?c.setProperty(m,T):c[m]=T}}function hp(t){return t==null||typeof t=="boolean"||t===""}function Lh(t){var a={};for(var c in t)for(var m=Dc[c]||[c],v=0;v<m.length;v++)a[m[v]]=c;return a}function jm(t,a){{if(!a)return;var c=Lh(t),m=Lh(a),v={};for(var T in c){var A=c[T],k=m[T];if(k&&A!==k){var F=A+","+k;if(v[F])continue;v[F]=!0,de("%s a style property during rerender (%s) when a conflicting property is set (%s) can lead to styling bugs. To avoid this, don't mix shorthand and non-shorthand properties for the same value; instead, replace the shorthand with separate values.",hp(t[A])?"Removing":"Updating",A,k)}}}}var Gm={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},$m=an({menuitem:!0},Gm),jd="__html";function Oc(t,a){if(a){if($m[t]&&(a.children!=null||a.dangerouslySetInnerHTML!=null))throw new Error(t+" is a void element tag and must neither have `children` nor use `dangerouslySetInnerHTML`.");if(a.dangerouslySetInnerHTML!=null){if(a.children!=null)throw new Error("Can only set one of `children` or `props.dangerouslySetInnerHTML`.");if(typeof a.dangerouslySetInnerHTML!="object"||!(jd in a.dangerouslySetInnerHTML))throw new Error("`props.dangerouslySetInnerHTML` must be in the form `{__html: ...}`. Please visit https://reactjs.org/link/dangerously-set-inner-html for more information.")}if(!a.suppressContentEditableWarning&&a.contentEditable&&a.children!=null&&de("A component is `contentEditable` and contains `children` managed by React. It is now your responsibility to guarantee that none of those nodes are unexpectedly modified or duplicated. This is probably not intentional."),a.style!=null&&typeof a.style!="object")throw new Error("The `style` prop expects a mapping from style properties to values, not a string. For example, style={{marginRight: spacing + 'em'}} when using JSX.")}}function sl(t,a){if(t.indexOf("-")===-1)return typeof a.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Pc={accept:"accept",acceptcharset:"acceptCharset","accept-charset":"acceptCharset",accesskey:"accessKey",action:"action",allowfullscreen:"allowFullScreen",alt:"alt",as:"as",async:"async",autocapitalize:"autoCapitalize",autocomplete:"autoComplete",autocorrect:"autoCorrect",autofocus:"autoFocus",autoplay:"autoPlay",autosave:"autoSave",capture:"capture",cellpadding:"cellPadding",cellspacing:"cellSpacing",challenge:"challenge",charset:"charSet",checked:"checked",children:"children",cite:"cite",class:"className",classid:"classID",classname:"className",cols:"cols",colspan:"colSpan",content:"content",contenteditable:"contentEditable",contextmenu:"contextMenu",controls:"controls",controlslist:"controlsList",coords:"coords",crossorigin:"crossOrigin",dangerouslysetinnerhtml:"dangerouslySetInnerHTML",data:"data",datetime:"dateTime",default:"default",defaultchecked:"defaultChecked",defaultvalue:"defaultValue",defer:"defer",dir:"dir",disabled:"disabled",disablepictureinpicture:"disablePictureInPicture",disableremoteplayback:"disableRemotePlayback",download:"download",draggable:"draggable",enctype:"encType",enterkeyhint:"enterKeyHint",for:"htmlFor",form:"form",formmethod:"formMethod",formaction:"formAction",formenctype:"formEncType",formnovalidate:"formNoValidate",formtarget:"formTarget",frameborder:"frameBorder",headers:"headers",height:"height",hidden:"hidden",high:"high",href:"href",hreflang:"hrefLang",htmlfor:"htmlFor",httpequiv:"httpEquiv","http-equiv":"httpEquiv",icon:"icon",id:"id",imagesizes:"imageSizes",imagesrcset:"imageSrcSet",innerhtml:"innerHTML",inputmode:"inputMode",integrity:"integrity",is:"is",itemid:"itemID",itemprop:"itemProp",itemref:"itemRef",itemscope:"itemScope",itemtype:"itemType",keyparams:"keyParams",keytype:"keyType",kind:"kind",label:"label",lang:"lang",list:"list",loop:"loop",low:"low",manifest:"manifest",marginwidth:"marginWidth",marginheight:"marginHeight",max:"max",maxlength:"maxLength",media:"media",mediagroup:"mediaGroup",method:"method",min:"min",minlength:"minLength",multiple:"multiple",muted:"muted",name:"name",nomodule:"noModule",nonce:"nonce",novalidate:"noValidate",open:"open",optimum:"optimum",pattern:"pattern",placeholder:"placeholder",playsinline:"playsInline",poster:"poster",preload:"preload",profile:"profile",radiogroup:"radioGroup",readonly:"readOnly",referrerpolicy:"referrerPolicy",rel:"rel",required:"required",reversed:"reversed",role:"role",rows:"rows",rowspan:"rowSpan",sandbox:"sandbox",scope:"scope",scoped:"scoped",scrolling:"scrolling",seamless:"seamless",selected:"selected",shape:"shape",size:"size",sizes:"sizes",span:"span",spellcheck:"spellCheck",src:"src",srcdoc:"srcDoc",srclang:"srcLang",srcset:"srcSet",start:"start",step:"step",style:"style",summary:"summary",tabindex:"tabIndex",target:"target",title:"title",type:"type",usemap:"useMap",value:"value",width:"width",wmode:"wmode",wrap:"wrap",about:"about",accentheight:"accentHeight","accent-height":"accentHeight",accumulate:"accumulate",additive:"additive",alignmentbaseline:"alignmentBaseline","alignment-baseline":"alignmentBaseline",allowreorder:"allowReorder",alphabetic:"alphabetic",amplitude:"amplitude",arabicform:"arabicForm","arabic-form":"arabicForm",ascent:"ascent",attributename:"attributeName",attributetype:"attributeType",autoreverse:"autoReverse",azimuth:"azimuth",basefrequency:"baseFrequency",baselineshift:"baselineShift","baseline-shift":"baselineShift",baseprofile:"baseProfile",bbox:"bbox",begin:"begin",bias:"bias",by:"by",calcmode:"calcMode",capheight:"capHeight","cap-height":"capHeight",clip:"clip",clippath:"clipPath","clip-path":"clipPath",clippathunits:"clipPathUnits",cliprule:"clipRule","clip-rule":"clipRule",color:"color",colorinterpolation:"colorInterpolation","color-interpolation":"colorInterpolation",colorinterpolationfilters:"colorInterpolationFilters","color-interpolation-filters":"colorInterpolationFilters",colorprofile:"colorProfile","color-profile":"colorProfile",colorrendering:"colorRendering","color-rendering":"colorRendering",contentscripttype:"contentScriptType",contentstyletype:"contentStyleType",cursor:"cursor",cx:"cx",cy:"cy",d:"d",datatype:"datatype",decelerate:"decelerate",descent:"descent",diffuseconstant:"diffuseConstant",direction:"direction",display:"display",divisor:"divisor",dominantbaseline:"dominantBaseline","dominant-baseline":"dominantBaseline",dur:"dur",dx:"dx",dy:"dy",edgemode:"edgeMode",elevation:"elevation",enablebackground:"enableBackground","enable-background":"enableBackground",end:"end",exponent:"exponent",externalresourcesrequired:"externalResourcesRequired",fill:"fill",fillopacity:"fillOpacity","fill-opacity":"fillOpacity",fillrule:"fillRule","fill-rule":"fillRule",filter:"filter",filterres:"filterRes",filterunits:"filterUnits",floodopacity:"floodOpacity","flood-opacity":"floodOpacity",floodcolor:"floodColor","flood-color":"floodColor",focusable:"focusable",fontfamily:"fontFamily","font-family":"fontFamily",fontsize:"fontSize","font-size":"fontSize",fontsizeadjust:"fontSizeAdjust","font-size-adjust":"fontSizeAdjust",fontstretch:"fontStretch","font-stretch":"fontStretch",fontstyle:"fontStyle","font-style":"fontStyle",fontvariant:"fontVariant","font-variant":"fontVariant",fontweight:"fontWeight","font-weight":"fontWeight",format:"format",from:"from",fx:"fx",fy:"fy",g1:"g1",g2:"g2",glyphname:"glyphName","glyph-name":"glyphName",glyphorientationhorizontal:"glyphOrientationHorizontal","glyph-orientation-horizontal":"glyphOrientationHorizontal",glyphorientationvertical:"glyphOrientationVertical","glyph-orientation-vertical":"glyphOrientationVertical",glyphref:"glyphRef",gradienttransform:"gradientTransform",gradientunits:"gradientUnits",hanging:"hanging",horizadvx:"horizAdvX","horiz-adv-x":"horizAdvX",horizoriginx:"horizOriginX","horiz-origin-x":"horizOriginX",ideographic:"ideographic",imagerendering:"imageRendering","image-rendering":"imageRendering",in2:"in2",in:"in",inlist:"inlist",intercept:"intercept",k1:"k1",k2:"k2",k3:"k3",k4:"k4",k:"k",kernelmatrix:"kernelMatrix",kernelunitlength:"kernelUnitLength",kerning:"kerning",keypoints:"keyPoints",keysplines:"keySplines",keytimes:"keyTimes",lengthadjust:"lengthAdjust",letterspacing:"letterSpacing","letter-spacing":"letterSpacing",lightingcolor:"lightingColor","lighting-color":"lightingColor",limitingconeangle:"limitingConeAngle",local:"local",markerend:"markerEnd","marker-end":"markerEnd",markerheight:"markerHeight",markermid:"markerMid","marker-mid":"markerMid",markerstart:"markerStart","marker-start":"markerStart",markerunits:"markerUnits",markerwidth:"markerWidth",mask:"mask",maskcontentunits:"maskContentUnits",maskunits:"maskUnits",mathematical:"mathematical",mode:"mode",numoctaves:"numOctaves",offset:"offset",opacity:"opacity",operator:"operator",order:"order",orient:"orient",orientation:"orientation",origin:"origin",overflow:"overflow",overlineposition:"overlinePosition","overline-position":"overlinePosition",overlinethickness:"overlineThickness","overline-thickness":"overlineThickness",paintorder:"paintOrder","paint-order":"paintOrder",panose1:"panose1","panose-1":"panose1",pathlength:"pathLength",patterncontentunits:"patternContentUnits",patterntransform:"patternTransform",patternunits:"patternUnits",pointerevents:"pointerEvents","pointer-events":"pointerEvents",points:"points",pointsatx:"pointsAtX",pointsaty:"pointsAtY",pointsatz:"pointsAtZ",prefix:"prefix",preservealpha:"preserveAlpha",preserveaspectratio:"preserveAspectRatio",primitiveunits:"primitiveUnits",property:"property",r:"r",radius:"radius",refx:"refX",refy:"refY",renderingintent:"renderingIntent","rendering-intent":"renderingIntent",repeatcount:"repeatCount",repeatdur:"repeatDur",requiredextensions:"requiredExtensions",requiredfeatures:"requiredFeatures",resource:"resource",restart:"restart",result:"result",results:"results",rotate:"rotate",rx:"rx",ry:"ry",scale:"scale",security:"security",seed:"seed",shaperendering:"shapeRendering","shape-rendering":"shapeRendering",slope:"slope",spacing:"spacing",specularconstant:"specularConstant",specularexponent:"specularExponent",speed:"speed",spreadmethod:"spreadMethod",startoffset:"startOffset",stddeviation:"stdDeviation",stemh:"stemh",stemv:"stemv",stitchtiles:"stitchTiles",stopcolor:"stopColor","stop-color":"stopColor",stopopacity:"stopOpacity","stop-opacity":"stopOpacity",strikethroughposition:"strikethroughPosition","strikethrough-position":"strikethroughPosition",strikethroughthickness:"strikethroughThickness","strikethrough-thickness":"strikethroughThickness",string:"string",stroke:"stroke",strokedasharray:"strokeDasharray","stroke-dasharray":"strokeDasharray",strokedashoffset:"strokeDashoffset","stroke-dashoffset":"strokeDashoffset",strokelinecap:"strokeLinecap","stroke-linecap":"strokeLinecap",strokelinejoin:"strokeLinejoin","stroke-linejoin":"strokeLinejoin",strokemiterlimit:"strokeMiterlimit","stroke-miterlimit":"strokeMiterlimit",strokewidth:"strokeWidth","stroke-width":"strokeWidth",strokeopacity:"strokeOpacity","stroke-opacity":"strokeOpacity",suppresscontenteditablewarning:"suppressContentEditableWarning",suppresshydrationwarning:"suppressHydrationWarning",surfacescale:"surfaceScale",systemlanguage:"systemLanguage",tablevalues:"tableValues",targetx:"targetX",targety:"targetY",textanchor:"textAnchor","text-anchor":"textAnchor",textdecoration:"textDecoration","text-decoration":"textDecoration",textlength:"textLength",textrendering:"textRendering","text-rendering":"textRendering",to:"to",transform:"transform",typeof:"typeof",u1:"u1",u2:"u2",underlineposition:"underlinePosition","underline-position":"underlinePosition",underlinethickness:"underlineThickness","underline-thickness":"underlineThickness",unicode:"unicode",unicodebidi:"unicodeBidi","unicode-bidi":"unicodeBidi",unicoderange:"unicodeRange","unicode-range":"unicodeRange",unitsperem:"unitsPerEm","units-per-em":"unitsPerEm",unselectable:"unselectable",valphabetic:"vAlphabetic","v-alphabetic":"vAlphabetic",values:"values",vectoreffect:"vectorEffect","vector-effect":"vectorEffect",version:"version",vertadvy:"vertAdvY","vert-adv-y":"vertAdvY",vertoriginx:"vertOriginX","vert-origin-x":"vertOriginX",vertoriginy:"vertOriginY","vert-origin-y":"vertOriginY",vhanging:"vHanging","v-hanging":"vHanging",videographic:"vIdeographic","v-ideographic":"vIdeographic",viewbox:"viewBox",viewtarget:"viewTarget",visibility:"visibility",vmathematical:"vMathematical","v-mathematical":"vMathematical",vocab:"vocab",widths:"widths",wordspacing:"wordSpacing","word-spacing":"wordSpacing",writingmode:"writingMode","writing-mode":"writingMode",x1:"x1",x2:"x2",x:"x",xchannelselector:"xChannelSelector",xheight:"xHeight","x-height":"xHeight",xlinkactuate:"xlinkActuate","xlink:actuate":"xlinkActuate",xlinkarcrole:"xlinkArcrole","xlink:arcrole":"xlinkArcrole",xlinkhref:"xlinkHref","xlink:href":"xlinkHref",xlinkrole:"xlinkRole","xlink:role":"xlinkRole",xlinkshow:"xlinkShow","xlink:show":"xlinkShow",xlinktitle:"xlinkTitle","xlink:title":"xlinkTitle",xlinktype:"xlinkType","xlink:type":"xlinkType",xmlbase:"xmlBase","xml:base":"xmlBase",xmllang:"xmlLang","xml:lang":"xmlLang",xmlns:"xmlns","xml:space":"xmlSpace",xmlnsxlink:"xmlnsXlink","xmlns:xlink":"xmlnsXlink",xmlspace:"xmlSpace",y1:"y1",y2:"y2",y:"y",ychannelselector:"yChannelSelector",z:"z",zoomandpan:"zoomAndPan"},Oh={"aria-current":0,"aria-description":0,"aria-details":0,"aria-disabled":0,"aria-hidden":0,"aria-invalid":0,"aria-keyshortcuts":0,"aria-label":0,"aria-roledescription":0,"aria-autocomplete":0,"aria-checked":0,"aria-expanded":0,"aria-haspopup":0,"aria-level":0,"aria-modal":0,"aria-multiline":0,"aria-multiselectable":0,"aria-orientation":0,"aria-placeholder":0,"aria-pressed":0,"aria-readonly":0,"aria-required":0,"aria-selected":0,"aria-sort":0,"aria-valuemax":0,"aria-valuemin":0,"aria-valuenow":0,"aria-valuetext":0,"aria-atomic":0,"aria-busy":0,"aria-live":0,"aria-relevant":0,"aria-dropeffect":0,"aria-grabbed":0,"aria-activedescendant":0,"aria-colcount":0,"aria-colindex":0,"aria-colspan":0,"aria-controls":0,"aria-describedby":0,"aria-errormessage":0,"aria-flowto":0,"aria-labelledby":0,"aria-owns":0,"aria-posinset":0,"aria-rowcount":0,"aria-rowindex":0,"aria-rowspan":0,"aria-setsize":0},Bs={},ss=new RegExp("^(aria)-["+Nt+"]*$"),Bc=new RegExp("^(aria)[A-Z]["+Nt+"]*$");function dp(t,a){{if(Yt.call(Bs,a)&&Bs[a])return!0;if(Bc.test(a)){var c="aria-"+a.slice(4).toLowerCase(),m=Oh.hasOwnProperty(c)?c:null;if(m==null)return de("Invalid ARIA attribute `%s`. ARIA attributes follow the pattern aria-* and must be lowercase.",a),Bs[a]=!0,!0;if(a!==m)return de("Invalid ARIA attribute `%s`. Did you mean `%s`?",a,m),Bs[a]=!0,!0}if(ss.test(a)){var v=a.toLowerCase(),T=Oh.hasOwnProperty(v)?v:null;if(T==null)return Bs[a]=!0,!1;if(a!==T)return de("Unknown ARIA attribute `%s`. Did you mean `%s`?",a,T),Bs[a]=!0,!0}}return!0}function Ja(t,a){{var c=[];for(var m in a){var v=dp(t,m);v||c.push(m)}var T=c.map(function(A){return"`"+A+"`"}).join(", ");c.length===1?de("Invalid aria prop %s on <%s> tag. For details, see https://reactjs.org/link/invalid-aria-props",T,t):c.length>1&&de("Invalid aria props %s on <%s> tag. For details, see https://reactjs.org/link/invalid-aria-props",T,t)}}function jl(t,a){sl(t,a)||Ja(t,a)}var ll=!1;function Gd(t,a){{if(t!=="input"&&t!=="textarea"&&t!=="select")return;a!=null&&a.value===null&&!ll&&(ll=!0,t==="select"&&a.multiple?de("`value` prop on `%s` should not be null. Consider using an empty array when `multiple` is set to `true` to clear the component or `undefined` for uncontrolled components.",t):de("`value` prop on `%s` should not be null. Consider using an empty string to clear the component or `undefined` for uncontrolled components.",t))}}var Xn=function(){};{var Pr={},fp=/^on./,Ph=/^on[^A-Z]/,ku=new RegExp("^(aria)-["+Nt+"]*$"),$d=new RegExp("^(aria)[A-Z]["+Nt+"]*$");Xn=function(t,a,c,m){if(Yt.call(Pr,a)&&Pr[a])return!0;var v=a.toLowerCase();if(v==="onfocusin"||v==="onfocusout")return de("React uses onFocus and onBlur instead of onFocusIn and onFocusOut. All React events are normalized to bubble, so onFocusIn and onFocusOut are not needed/supported by React."),Pr[a]=!0,!0;if(m!=null){var T=m.registrationNameDependencies,A=m.possibleRegistrationNames;if(T.hasOwnProperty(a))return!0;var k=A.hasOwnProperty(v)?A[v]:null;if(k!=null)return de("Invalid event handler property `%s`. Did you mean `%s`?",a,k),Pr[a]=!0,!0;if(fp.test(a))return de("Unknown event handler property `%s`. It will be ignored.",a),Pr[a]=!0,!0}else if(fp.test(a))return Ph.test(a)&&de("Invalid event handler property `%s`. React events use the camelCase naming convention, for example `onClick`.",a),Pr[a]=!0,!0;if(ku.test(a)||$d.test(a))return!0;if(v==="innerhtml")return de("Directly setting property `innerHTML` is not permitted. For more information, lookup documentation on `dangerouslySetInnerHTML`."),Pr[a]=!0,!0;if(v==="aria")return de("The `aria` attribute is reserved for future use in React. Pass individual `aria-` attributes instead."),Pr[a]=!0,!0;if(v==="is"&&c!==null&&c!==void 0&&typeof c!="string")return de("Received a `%s` for a string attribute `is`. If this is expected, cast the value to a string.",typeof c),Pr[a]=!0,!0;if(typeof c=="number"&&isNaN(c))return de("Received NaN for the `%s` attribute. If this is expected, cast the value to a string.",a),Pr[a]=!0,!0;var F=Gr(a),H=F!==null&&F.type===Kr;if(Pc.hasOwnProperty(v)){var ie=Pc[v];if(ie!==a)return de("Invalid DOM property `%s`. Did you mean `%s`?",a,ie),Pr[a]=!0,!0}else if(!H&&a!==v)return de("React does not recognize the `%s` prop on a DOM element. If you intentionally want it to appear in the DOM as a custom attribute, spell it as lowercase `%s` instead. If you accidentally passed it from a parent component, remove it from the DOM element.",a,v),Pr[a]=!0,!0;return typeof c=="boolean"&&yr(a,c,F,!1)?(c?de('Received `%s` for a non-boolean attribute `%s`.\n\nIf you want to write it to the DOM, pass a string instead: %s="%s" or %s={value.toString()}.',c,a,a,c,a):de('Received `%s` for a non-boolean attribute `%s`.\n\nIf you want to write it to the DOM, pass a string instead: %s="%s" or %s={value.toString()}.\n\nIf you used to conditionally omit it with %s={condition && value}, pass %s={condition ? value : undefined} instead.',c,a,a,c,a,a,a),Pr[a]=!0,!0):H?!0:yr(a,c,F,!1)?(Pr[a]=!0,!1):((c==="false"||c==="true")&&F!==null&&F.type===Di&&(de("Received the string `%s` for the boolean attribute `%s`. %s Did you mean %s={%s}?",c,a,c==="false"?"The browser will interpret it as a truthy value.":'Although this works, it will not work as expected if you pass the string "false".',a,c),Pr[a]=!0),!0)}}var pp=function(t,a,c){{var m=[];for(var v in a){var T=Xn(t,v,a[v],c);T||m.push(v)}var A=m.map(function(k){return"`"+k+"`"}).join(", ");m.length===1?de("Invalid value for prop %s on <%s> tag. Either remove it from the element, or pass a string or number value to keep it in the DOM. For details, see https://reactjs.org/link/attribute-behavior ",A,t):m.length>1&&de("Invalid values for props %s on <%s> tag. Either remove them from the element, or pass a string or number value to keep them in the DOM. For details, see https://reactjs.org/link/attribute-behavior ",A,t)}};function qd(t,a,c){sl(t,a)||pp(t,a,c)}var Bh=1,Lu=1<<1,Fs=1<<2,ul=Bh|Lu|Fs,vo=null;function Fh(t){vo!==null&&de("Expected currently replaying event to be null. This error is likely caused by a bug in React. Please file an issue."),vo=t}function Hd(){vo===null&&de("Expected currently replaying event to not be null. This error is likely caused by a bug in React. Please file an issue."),vo=null}function Ou(t){return t===vo}function Gl(t){var a=t.target||t.srcElement||window;return a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===Bo?a.parentNode:a}var mt=null,na=null,ls=null;function Zd(t){var a=pu(t);if(a){if(typeof mt!="function")throw new Error("setRestoreImplementation() needs to be called to handle a target for controlled events. This error is likely caused by a bug in React. Please file an issue.");var c=a.stateNode;if(c){var m=wd(c);mt(a.stateNode,a.type,m)}}}function mp(t){mt=t}function $l(t){na?ls?ls.push(t):ls=[t]:na=t}function gp(){return na!==null||ls!==null}function Fc(){if(na){var t=na,a=ls;if(na=null,ls=null,Zd(t),a)for(var c=0;c<a.length;c++)Zd(a[c])}}var ql=function(t,a){return t(a)},cl=function(){},xa=!1;function Uc(){var t=gp();t&&(cl(),Fc())}function Hl(t,a,c){if(xa)return t(a,c);xa=!0;try{return ql(t,a,c)}finally{xa=!1,Uc()}}function qm(t,a,c){ql=t,cl=c}function Hm(t){return t==="button"||t==="input"||t==="select"||t==="textarea"}function _p(t,a,c){switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":return!!(c.disabled&&Hm(a));default:return!1}}function us(t,a){var c=t.stateNode;if(c===null)return null;var m=wd(c);if(m===null)return null;var v=m[a];if(_p(a,t.type,m))return null;if(v&&typeof v!="function")throw new Error("Expected `"+a+"` listener to be a function, instead got a value of `"+typeof v+"` type.");return v}var Nc=!1;if(mi)try{var hl={};Object.defineProperty(hl,"passive",{get:function(){Nc=!0}}),window.addEventListener("test",hl,hl),window.removeEventListener("test",hl,hl)}catch{Nc=!1}function Xd(t,a,c,m,v,T,A,k,F){var H=Array.prototype.slice.call(arguments,3);try{a.apply(c,H)}catch(ie){this.onError(ie)}}var Vc=Xd;if(typeof window<"u"&&typeof window.dispatchEvent=="function"&&typeof document<"u"&&typeof document.createEvent=="function"){var Zl=document.createElement("react");Vc=function(a,c,m,v,T,A,k,F,H){if(typeof document>"u"||document===null)throw new Error("The `document` global was defined when React was initialized, but is not defined anymore. This can happen in a test environment if a component schedules an update from an asynchronous callback, but the test has already finished running. To solve this, you can either unmount the component at the end of your test (and ensure that any asynchronous operations get canceled in `componentWillUnmount`), or you can change the test itself to be asynchronous.");var ie=document.createEvent("Event"),xe=!1,ye=!0,Be=window.event,Ue=Object.getOwnPropertyDescriptor(window,"event");function Je(){Zl.removeEventListener(Qe,Qt,!1),typeof window.event<"u"&&window.hasOwnProperty("event")&&(window.event=Be)}var Dt=Array.prototype.slice.call(arguments,3);function Qt(){xe=!0,Je(),c.apply(m,Dt),ye=!1}var Zt,ii=!1,Yn=!1;function ze(Ie){if(Zt=Ie.error,ii=!0,Zt===null&&Ie.colno===0&&Ie.lineno===0&&(Yn=!0),Ie.defaultPrevented&&Zt!=null&&typeof Zt=="object")try{Zt._suppressLogging=!0}catch{}}var Qe="react-"+(a||"invokeguardedcallback");if(window.addEventListener("error",ze),Zl.addEventListener(Qe,Qt,!1),ie.initEvent(Qe,!1,!1),Zl.dispatchEvent(ie),Ue&&Object.defineProperty(window,"event",Ue),xe&&ye&&(ii?Yn&&(Zt=new Error("A cross-origin error was thrown. React doesn't have access to the actual error object in development. See https://reactjs.org/link/crossorigin-error for more information.")):Zt=new Error(`An error was thrown inside one of your components, but React doesn't know what it was. This is likely due to browser flakiness. React does its best to preserve the "Pause on exceptions" behavior of the DevTools, which requires some DEV-mode only tricks. It's possible that these don't work in your browser. Try triggering the error in production mode, or switching to a modern browser. If you suspect that this is actually an issue with React, please file an issue.`),this.onError(Zt)),window.removeEventListener("error",ze),!xe)return Je(),Xd.apply(this,arguments)}}var yp=Vc,dl=!1,Pu=null,jc=!1,Bu=null,Us={onError:function(t){dl=!0,Pu=t}};function Gc(t,a,c,m,v,T,A,k,F){dl=!1,Pu=null,yp.apply(Us,arguments)}function vp(t,a,c,m,v,T,A,k,F){if(Gc.apply(this,arguments),dl){var H=Fu();jc||(jc=!0,Bu=H)}}function xp(){if(jc){var t=Bu;throw jc=!1,Bu=null,t}}function bp(){return dl}function Fu(){if(dl){var t=Pu;return dl=!1,Pu=null,t}else throw new Error("clearCaughtError was called but no error was captured. This error is likely caused by a bug in React. Please file an issue.")}function Xl(t){return t._reactInternals}function wp(t){return t._reactInternals!==void 0}function ba(t,a){t._reactInternals=a}var Kt=0,fl=1,Rr=2,jn=4,Ca=16,Uu=32,pl=64,wn=128,xo=256,ft=512,ml=1024,bo=2048,wa=4096,Fo=8192,Nu=16384,Tp=bo|jn|pl|ft|ml|Nu,Wd=32767,Wl=32768,ia=65536,$c=131072,Yl=1048576,Kl=2097152,cs=4194304,Uh=8388608,Uo=16777216,qc=33554432,Nh=jn|ml|0,Vh=Rr|jn|Ca|Uu|ft|wa|Fo,Vu=jn|pl|ft|Fo,Jl=bo|Ca,No=cs|Uh|Kl,Ep=li.ReactCurrentOwner;function gl(t){var a=t,c=t;if(t.alternate)for(;a.return;)a=a.return;else{var m=a;do a=m,(a.flags&(Rr|wa))!==Kt&&(c=a.return),m=a.return;while(m)}return a.tag===at?c:null}function jh(t){if(t.tag===Ge){var a=t.memoizedState;if(a===null){var c=t.alternate;c!==null&&(a=c.memoizedState)}if(a!==null)return a.dehydrated}return null}function ju(t){return t.tag===at?t.stateNode.containerInfo:null}function h(t){return gl(t)===t}function r(t){{var a=Ep.current;if(a!==null&&a.tag===Ft){var c=a,m=c.stateNode;m._warnedAboutRefsInRender||de("%s is accessing isMounted inside its render() function. render() should be a pure function of props and state. It should never access something that requires stale data from the previous render, such as refs. Move this logic to componentDidMount and componentDidUpdate instead.",dn(c)||"A component"),m._warnedAboutRefsInRender=!0}}var v=Xl(t);return v?gl(v)===v:!1}function s(t){if(gl(t)!==t)throw new Error("Unable to find node on an unmounted component.")}function f(t){var a=t.alternate;if(!a){var c=gl(t);if(c===null)throw new Error("Unable to find node on an unmounted component.");return c!==t?null:t}for(var m=t,v=a;;){var T=m.return;if(T===null)break;var A=T.alternate;if(A===null){var k=T.return;if(k!==null){m=v=k;continue}break}if(T.child===A.child){for(var F=T.child;F;){if(F===m)return s(T),t;if(F===v)return s(T),a;F=F.sibling}throw new Error("Unable to find node on an unmounted component.")}if(m.return!==v.return)m=T,v=A;else{for(var H=!1,ie=T.child;ie;){if(ie===m){H=!0,m=T,v=A;break}if(ie===v){H=!0,v=T,m=A;break}ie=ie.sibling}if(!H){for(ie=A.child;ie;){if(ie===m){H=!0,m=A,v=T;break}if(ie===v){H=!0,v=A,m=T;break}ie=ie.sibling}if(!H)throw new Error("Child was not found in either parent set. This indicates a bug in React related to the return pointer. Please file an issue.")}}if(m.alternate!==v)throw new Error("Return fibers should always be each others' alternates. This error is likely caused by a bug in React. Please file an issue.")}if(m.tag!==at)throw new Error("Unable to find node on an unmounted component.");return m.stateNode.current===m?t:a}function g(t){var a=f(t);return a!==null?y(a):null}function y(t){if(t.tag===bt||t.tag===en)return t;for(var a=t.child;a!==null;){var c=y(a);if(c!==null)return c;a=a.sibling}return null}function w(t){var a=f(t);return a!==null?E(a):null}function E(t){if(t.tag===bt||t.tag===en)return t;for(var a=t.child;a!==null;){if(a.tag!==gt){var c=E(a);if(c!==null)return c}a=a.sibling}return null}var C=xt.unstable_scheduleCallback,z=xt.unstable_cancelCallback,D=xt.unstable_shouldYield,B=xt.unstable_requestPaint,j=xt.unstable_now,W=xt.unstable_getCurrentPriorityLevel,X=xt.unstable_ImmediatePriority,Y=xt.unstable_UserBlockingPriority,G=xt.unstable_NormalPriority,q=xt.unstable_LowPriority,ee=xt.unstable_IdlePriority,Q=xt.unstable_yieldValue,ae=xt.unstable_setDisableYieldValue,fe=null,le=null,re=null,Ce=!1,we=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u";function ve(t){if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")return!1;var a=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(a.isDisabled)return!0;if(!a.supportsFiber)return de("The installed version of React DevTools is too old and will not work with the current version of React. Please update React DevTools. https://reactjs.org/link/react-devtools"),!0;try{da&&(t=an({},t,{getLaneLabelMap:Ye,injectProfilingHooks:Le})),fe=a.inject(t),le=a}catch(c){de("React instrumentation encountered an error: %s.",c)}return!!a.checkDCE}function nt(t,a){if(le&&typeof le.onScheduleFiberRoot=="function")try{le.onScheduleFiberRoot(fe,t,a)}catch(c){Ce||(Ce=!0,de("React instrumentation encountered an error: %s",c))}}function Ee(t,a){if(le&&typeof le.onCommitFiberRoot=="function")try{var c=(t.current.flags&wn)===wn;if(Yr){var m;switch(a){case Go:m=X;break;case Hs:m=Y;break;case nu:m=G;break;case Xh:m=ee;break;default:m=G;break}le.onCommitFiberRoot(fe,t,m,c)}}catch(v){Ce||(Ce=!0,de("React instrumentation encountered an error: %s",v))}}function je(t){if(le&&typeof le.onPostCommitFiberRoot=="function")try{le.onPostCommitFiberRoot(fe,t)}catch(a){Ce||(Ce=!0,de("React instrumentation encountered an error: %s",a))}}function De(t){if(le&&typeof le.onCommitFiberUnmount=="function")try{le.onCommitFiberUnmount(fe,t)}catch(a){Ce||(Ce=!0,de("React instrumentation encountered an error: %s",a))}}function Ze(t){if(typeof Q=="function"&&(ae(t),Ei(t)),le&&typeof le.setStrictMode=="function")try{le.setStrictMode(fe,t)}catch(a){Ce||(Ce=!0,de("React instrumentation encountered an error: %s",a))}}function Le(t){re=t}function Ye(){{for(var t=new Map,a=1,c=0;c<wo;c++){var m=Zu(a);t.set(a,m),a*=2}return t}}function it(t){re!==null&&typeof re.markCommitStarted=="function"&&re.markCommitStarted(t)}function be(){re!==null&&typeof re.markCommitStopped=="function"&&re.markCommitStopped()}function Re(t){re!==null&&typeof re.markComponentRenderStarted=="function"&&re.markComponentRenderStarted(t)}function wt(){re!==null&&typeof re.markComponentRenderStopped=="function"&&re.markComponentRenderStopped()}function Pt(t){re!==null&&typeof re.markComponentPassiveEffectMountStarted=="function"&&re.markComponentPassiveEffectMountStarted(t)}function St(){re!==null&&typeof re.markComponentPassiveEffectMountStopped=="function"&&re.markComponentPassiveEffectMountStopped()}function Ht(t){re!==null&&typeof re.markComponentPassiveEffectUnmountStarted=="function"&&re.markComponentPassiveEffectUnmountStarted(t)}function fn(){re!==null&&typeof re.markComponentPassiveEffectUnmountStopped=="function"&&re.markComponentPassiveEffectUnmountStopped()}function Bt(t){re!==null&&typeof re.markComponentLayoutEffectMountStarted=="function"&&re.markComponentLayoutEffectMountStarted(t)}function yt(){re!==null&&typeof re.markComponentLayoutEffectMountStopped=="function"&&re.markComponentLayoutEffectMountStopped()}function ei(t){re!==null&&typeof re.markComponentLayoutEffectUnmountStarted=="function"&&re.markComponentLayoutEffectUnmountStarted(t)}function Gn(){re!==null&&typeof re.markComponentLayoutEffectUnmountStopped=="function"&&re.markComponentLayoutEffectUnmountStopped()}function _i(t,a,c){re!==null&&typeof re.markComponentErrored=="function"&&re.markComponentErrored(t,a,c)}function hi(t,a,c){re!==null&&typeof re.markComponentSuspended=="function"&&re.markComponentSuspended(t,a,c)}function Va(t){re!==null&&typeof re.markLayoutEffectsStarted=="function"&&re.markLayoutEffectsStarted(t)}function Qa(){re!==null&&typeof re.markLayoutEffectsStopped=="function"&&re.markLayoutEffectsStopped()}function Ma(t){re!==null&&typeof re.markPassiveEffectsStarted=="function"&&re.markPassiveEffectsStarted(t)}function hs(){re!==null&&typeof re.markPassiveEffectsStopped=="function"&&re.markPassiveEffectsStopped()}function Mi(t){re!==null&&typeof re.markRenderStarted=="function"&&re.markRenderStarted(t)}function yi(){re!==null&&typeof re.markRenderYielded=="function"&&re.markRenderYielded()}function Fn(){re!==null&&typeof re.markRenderStopped=="function"&&re.markRenderStopped()}function hr(t){re!==null&&typeof re.markRenderScheduled=="function"&&re.markRenderScheduled(t)}function Ta(t,a){re!==null&&typeof re.markForceUpdateScheduled=="function"&&re.markForceUpdateScheduled(t,a)}function di(t,a){re!==null&&typeof re.markStateUpdateScheduled=="function"&&re.markStateUpdateScheduled(t,a)}var kt=0,Mn=1,Ln=2,Wn=8,vr=16,Vo=Math.clz32?Math.clz32:Gu,ds=Math.log,Hc=Math.LN2;function Gu(t){var a=t>>>0;return a===0?32:31-(ds(a)/Hc|0)|0}var wo=31,rt=0,Br=0,ln=1,$u=2,_l=4,qu=8,Ns=16,Gh=32,Zc=4194240,$h=64,Sp=128,Cp=256,Mp=512,Zm=1024,Xm=2048,Hu=4096,Ap=8192,Rp=16384,Dp=32768,Wm=65536,qh=131072,zp=262144,Yd=524288,Hh=1048576,Vs=2097152,Xc=130023424,Wc=4194304,Ip=8388608,Ym=16777216,Km=33554432,Jm=67108864,kp=Wc,Ql=134217728,Yc=268435455,jo=268435456,Aa=536870912,Hr=1073741824;function Zu(t){{if(t&ln)return"Sync";if(t&$u)return"InputContinuousHydration";if(t&_l)return"InputContinuous";if(t&qu)return"DefaultHydration";if(t&Ns)return"Default";if(t&Gh)return"TransitionHydration";if(t&Zc)return"Transition";if(t&Xc)return"Retry";if(t&Ql)return"SelectiveHydration";if(t&jo)return"IdleHydration";if(t&Aa)return"Idle";if(t&Hr)return"Offscreen"}}var vi=-1,Lp=$h,Op=Wc;function Kd(t){switch(ra(t)){case ln:return ln;case $u:return $u;case _l:return _l;case qu:return qu;case Ns:return Ns;case Gh:return Gh;case $h:case Sp:case Cp:case Mp:case Zm:case Xm:case Hu:case Ap:case Rp:case Dp:case Wm:case qh:case zp:case Yd:case Hh:case Vs:return t&Zc;case Wc:case Ip:case Ym:case Km:case Jm:return t&Xc;case Ql:return Ql;case jo:return jo;case Aa:return Aa;case Hr:return Hr;default:return de("Should have found matching lanes. This is a bug in React."),t}}function Pp(t,a){var c=t.pendingLanes;if(c===rt)return rt;var m=rt,v=t.suspendedLanes,T=t.pingedLanes,A=c&Yc;if(A!==rt){var k=A&~v;if(k!==rt)m=Kd(k);else{var F=A&T;F!==rt&&(m=Kd(F))}}else{var H=c&~v;H!==rt?m=Kd(H):T!==rt&&(m=Kd(T))}if(m===rt)return rt;if(a!==rt&&a!==m&&(a&v)===rt){var ie=ra(m),xe=ra(a);if(ie>=xe||ie===Ns&&(xe&Zc)!==rt)return a}(m&_l)!==rt&&(m|=c&Ns);var ye=t.entangledLanes;if(ye!==rt)for(var Be=t.entanglements,Ue=m&ye;Ue>0;){var Je=Xu(Ue),Dt=1<<Je;m|=Be[Je],Ue&=~Dt}return m}function O_(t,a){for(var c=t.eventTimes,m=vi;a>0;){var v=Xu(a),T=1<<v,A=c[v];A>m&&(m=A),a&=~T}return m}function Bp(t,a){switch(t){case ln:case $u:case _l:return a+250;case qu:case Ns:case Gh:case $h:case Sp:case Cp:case Mp:case Zm:case Xm:case Hu:case Ap:case Rp:case Dp:case Wm:case qh:case zp:case Yd:case Hh:case Vs:return a+5e3;case Wc:case Ip:case Ym:case Km:case Jm:return vi;case Ql:case jo:case Aa:case Hr:return vi;default:return de("Should have found matching lanes. This is a bug in React."),vi}}function js(t,a){for(var c=t.pendingLanes,m=t.suspendedLanes,v=t.pingedLanes,T=t.expirationTimes,A=c;A>0;){var k=Xu(A),F=1<<k,H=T[k];H===vi?((F&m)===rt||(F&v)!==rt)&&(T[k]=Bp(F,a)):H<=a&&(t.expiredLanes|=F),A&=~F}}function Yv(t){return Kd(t.pendingLanes)}function Qm(t){var a=t.pendingLanes&~Hr;return a!==rt?a:a&Hr?Hr:rt}function Dr(t){return(t&ln)!==rt}function qt(t){return(t&Yc)!==rt}function eu(t){return(t&Xc)===t}function Fp(t){var a=ln|_l|Ns;return(t&a)===rt}function Un(t){return(t&Zc)===t}function Jd(t,a){var c=$u|_l|qu|Ns;return(a&c)!==rt}function eg(t,a){return(a&t.expiredLanes)!==rt}function Gs(t){return(t&Zc)!==rt}function $s(){var t=Lp;return Lp<<=1,(Lp&Zc)===rt&&(Lp=$h),t}function fs(){var t=Op;return Op<<=1,(Op&Xc)===rt&&(Op=Wc),t}function ra(t){return t&-t}function zr(t){return ra(t)}function Xu(t){return 31-Vo(t)}function ps(t){return Xu(t)}function To(t,a){return(t&a)!==rt}function qs(t,a){return(t&a)===a}function Tn(t,a){return t|a}function Qd(t,a){return t&~a}function Up(t,a){return t&a}function w1(t){return t}function tg(t,a){return t!==Br&&t<a?t:a}function Np(t){for(var a=[],c=0;c<wo;c++)a.push(t);return a}function ef(t,a,c){t.pendingLanes|=a,a!==Aa&&(t.suspendedLanes=rt,t.pingedLanes=rt);var m=t.eventTimes,v=ps(a);m[v]=c}function tu(t,a){t.suspendedLanes|=a,t.pingedLanes&=~a;for(var c=t.expirationTimes,m=a;m>0;){var v=Xu(m),T=1<<v;c[v]=vi,m&=~T}}function Wu(t,a,c){t.pingedLanes|=t.suspendedLanes&a}function Vp(t,a){var c=t.pendingLanes&~a;t.pendingLanes=a,t.suspendedLanes=rt,t.pingedLanes=rt,t.expiredLanes&=a,t.mutableReadLanes&=a,t.entangledLanes&=a;for(var m=t.entanglements,v=t.eventTimes,T=t.expirationTimes,A=c;A>0;){var k=Xu(A),F=1<<k;m[k]=rt,v[k]=vi,T[k]=vi,A&=~F}}function Zh(t,a){for(var c=t.entangledLanes|=a,m=t.entanglements,v=c;v;){var T=Xu(v),A=1<<T;A&a|m[T]&a&&(m[T]|=a),v&=~A}}function ng(t,a){var c=ra(a),m;switch(c){case _l:m=$u;break;case Ns:m=qu;break;case $h:case Sp:case Cp:case Mp:case Zm:case Xm:case Hu:case Ap:case Rp:case Dp:case Wm:case qh:case zp:case Yd:case Hh:case Vs:case Wc:case Ip:case Ym:case Km:case Jm:m=Gh;break;case Aa:m=jo;break;default:m=Br;break}return(m&(t.suspendedLanes|a))!==Br?Br:m}function ig(t,a,c){if(we)for(var m=t.pendingUpdatersLaneMap;c>0;){var v=ps(c),T=1<<v,A=m[v];A.add(a),c&=~T}}function P_(t,a){if(we)for(var c=t.pendingUpdatersLaneMap,m=t.memoizedUpdaters;a>0;){var v=ps(a),T=1<<v,A=c[v];A.size>0&&(A.forEach(function(k){var F=k.alternate;(F===null||!m.has(F))&&m.add(k)}),A.clear()),a&=~T}}function rg(t,a){return null}var Go=ln,Hs=_l,nu=Ns,Xh=Aa,Wh=Br;function ms(){return Wh}function dr(t){Wh=t}function B_(t,a){var c=Wh;try{return Wh=t,a()}finally{Wh=c}}function Kv(t,a){return t!==0&&t<a?t:a}function Yh(t,a){return t===0||t>a?t:a}function Kh(t,a){return t!==0&&t<a}function ag(t){var a=ra(t);return Kh(Go,a)?Kh(Hs,a)?qt(a)?nu:Xh:Hs:Go}function tf(t){var a=t.current.memoizedState;return a.isDehydrated}var F_;function Jv(t){F_=t}function jp(t){F_(t)}var ja;function U_(t){ja=t}var og;function Zs(t){og=t}var Gp;function Kc(t){Gp=t}var Jh;function Jc(t){Jh=t}var nf=!1,Qc=[],iu=null,ru=null,Yu=null,eh=new Map,Qh=new Map,gs=[],ed=["mousedown","mouseup","touchcancel","touchend","touchstart","auxclick","dblclick","pointercancel","pointerdown","pointerup","dragend","dragstart","drop","compositionend","compositionstart","keydown","keypress","keyup","input","textInput","copy","cut","paste","click","change","contextmenu","reset","submit"];function au(t){return ed.indexOf(t)>-1}function sg(t,a,c,m,v){return{blockedOn:t,domEventName:a,eventSystemFlags:c,nativeEvent:v,targetContainers:[m]}}function lg(t,a){switch(t){case"focusin":case"focusout":iu=null;break;case"dragenter":case"dragleave":ru=null;break;case"mouseover":case"mouseout":Yu=null;break;case"pointerover":case"pointerout":{var c=a.pointerId;eh.delete(c);break}case"gotpointercapture":case"lostpointercapture":{var m=a.pointerId;Qh.delete(m);break}}}function ou(t,a,c,m,v,T){if(t===null||t.nativeEvent!==T){var A=sg(a,c,m,v,T);if(a!==null){var k=pu(a);k!==null&&ja(k)}return A}t.eventSystemFlags|=m;var F=t.targetContainers;return v!==null&&F.indexOf(v)===-1&&F.push(v),t}function rf(t,a,c,m,v){switch(a){case"focusin":{var T=v;return iu=ou(iu,t,a,c,m,T),!0}case"dragenter":{var A=v;return ru=ou(ru,t,a,c,m,A),!0}case"mouseover":{var k=v;return Yu=ou(Yu,t,a,c,m,k),!0}case"pointerover":{var F=v,H=F.pointerId;return eh.set(H,ou(eh.get(H)||null,t,a,c,m,F)),!0}case"gotpointercapture":{var ie=v,xe=ie.pointerId;return Qh.set(xe,ou(Qh.get(xe)||null,t,a,c,m,ie)),!0}}return!1}function Eo(t){var a=uc(t.target);if(a!==null){var c=gl(a);if(c!==null){var m=c.tag;if(m===Ge){var v=jh(c);if(v!==null){t.blockedOn=v,Jh(t.priority,function(){og(c)});return}}else if(m===at){var T=c.stateNode;if(tf(T)){t.blockedOn=ju(c);return}}}}t.blockedOn=null}function af(t){for(var a=Gp(),c={blockedOn:null,target:t,priority:a},m=0;m<gs.length&&Kh(a,gs[m].priority);m++);gs.splice(m,0,c),m===0&&Eo(c)}function aa(t){if(t.blockedOn!==null)return!1;for(var a=t.targetContainers;a.length>0;){var c=a[0],m=qp(t.domEventName,t.eventSystemFlags,c,t.nativeEvent);if(m===null){var v=t.nativeEvent,T=new v.constructor(v.type,v);Fh(T),v.target.dispatchEvent(T),Hd()}else{var A=pu(m);return A!==null&&ja(A),t.blockedOn=m,!1}a.shift()}return!0}function $o(t,a,c){aa(t)&&c.delete(a)}function ug(){nf=!1,iu!==null&&aa(iu)&&(iu=null),ru!==null&&aa(ru)&&(ru=null),Yu!==null&&aa(Yu)&&(Yu=null),eh.forEach($o),Qh.forEach($o)}function ji(t,a){t.blockedOn===a&&(t.blockedOn=null,nf||(nf=!0,xt.unstable_scheduleCallback(xt.unstable_NormalPriority,ug)))}function td(t){if(Qc.length>0){ji(Qc[0],t);for(var a=1;a<Qc.length;a++){var c=Qc[a];c.blockedOn===t&&(c.blockedOn=null)}}iu!==null&&ji(iu,t),ru!==null&&ji(ru,t),Yu!==null&&ji(Yu,t);var m=function(k){return ji(k,t)};eh.forEach(m),Qh.forEach(m);for(var v=0;v<gs.length;v++){var T=gs[v];T.blockedOn===t&&(T.blockedOn=null)}for(;gs.length>0;){var A=gs[0];if(A.blockedOn!==null)break;Eo(A),A.blockedOn===null&&gs.shift()}}var yl=li.ReactCurrentBatchConfig,qo=!0;function N_(t){qo=!!t}function Qv(){return qo}function V_(t,a,c){var m=$_(a),v;switch(m){case Go:v=j_;break;case Hs:v=th;break;case nu:default:v=$p;break}return v.bind(null,a,c,t)}function j_(t,a,c,m){var v=ms(),T=yl.transition;yl.transition=null;try{dr(Go),$p(t,a,c,m)}finally{dr(v),yl.transition=T}}function th(t,a,c,m){var v=ms(),T=yl.transition;yl.transition=null;try{dr(Hs),$p(t,a,c,m)}finally{dr(v),yl.transition=T}}function $p(t,a,c,m){qo&&G_(t,a,c,m)}function G_(t,a,c,m){var v=qp(t,a,c,m);if(v===null){Tf(t,a,m,of,c),lg(t,m);return}if(rf(v,t,a,c,m)){m.stopPropagation();return}if(lg(t,m),a&Fs&&au(t)){for(;v!==null;){var T=pu(v);T!==null&&jp(T);var A=qp(t,a,c,m);if(A===null&&Tf(t,a,m,of,c),A===v)break;v=A}v!==null&&m.stopPropagation();return}Tf(t,a,m,null,c)}var of=null;function qp(t,a,c,m){of=null;var v=Gl(m),T=uc(v);if(T!==null){var A=gl(T);if(A===null)T=null;else{var k=A.tag;if(k===Ge){var F=jh(A);if(F!==null)return F;T=null}else if(k===at){var H=A.stateNode;if(tf(H))return ju(A);T=null}else A!==T&&(T=null)}}return of=T,null}function $_(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return Go;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return Hs;case"message":{var a=W();switch(a){case X:return Go;case Y:return Hs;case G:case q:return nu;case ee:return Xh;default:return nu}}default:return nu}}function cg(t,a,c){return t.addEventListener(a,c,!1),c}function hg(t,a,c){return t.addEventListener(a,c,!0),c}function dg(t,a,c,m){return t.addEventListener(a,c,{capture:!0,passive:m}),c}function Ga(t,a,c,m){return t.addEventListener(a,c,{passive:m}),c}var nd=null,fg=null,id=null;function ex(t){return nd=t,fg=mg(),!0}function tx(){nd=null,fg=null,id=null}function pg(){if(id)return id;var t,a=fg,c=a.length,m,v=mg(),T=v.length;for(t=0;t<c&&a[t]===v[t];t++);var A=c-t;for(m=1;m<=A&&a[c-m]===v[T-m];m++);var k=m>1?1-m:void 0;return id=v.slice(t,k),id}function mg(){return"value"in nd?nd.value:nd.textContent}function sf(t){var a,c=t.keyCode;return"charCode"in t?(a=t.charCode,a===0&&c===13&&(a=13)):a=c,a===10&&(a=13),a>=32||a===13?a:0}function rd(){return!0}function vl(){return!1}function Ki(t){function a(c,m,v,T,A){this._reactName=c,this._targetInst=v,this.type=m,this.nativeEvent=T,this.target=A,this.currentTarget=null;for(var k in t)if(t.hasOwnProperty(k)){var F=t[k];F?this[k]=F(T):this[k]=T[k]}var H=T.defaultPrevented!=null?T.defaultPrevented:T.returnValue===!1;return H?this.isDefaultPrevented=rd:this.isDefaultPrevented=vl,this.isPropagationStopped=vl,this}return an(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=rd)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=rd)},persist:function(){},isPersistent:rd}),a}var ad={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},lf=Ki(ad),uf=an({},ad,{view:0,detail:0}),nx=Ki(uf),gg,nh,Ku;function q_(t){t!==Ku&&(Ku&&t.type==="mousemove"?(gg=t.screenX-Ku.screenX,nh=t.screenY-Ku.screenY):(gg=0,nh=0),Ku=t)}var xl=an({},uf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:rh,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(q_(t),gg)},movementY:function(t){return"movementY"in t?t.movementY:nh}}),od=Ki(xl),ix=an({},xl,{dataTransfer:0}),rx=Ki(ix),ax=an({},uf,{relatedTarget:0}),_g=Ki(ax),ox=an({},ad,{animationName:0,elapsedTime:0,pseudoElement:0}),sx=Ki(ox),lx=an({},ad,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),yg=Ki(lx),ux=an({},ad,{data:0}),ih=Ki(ux),cx=ih,xr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Hp={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"};function H_(t){if(t.key){var a=xr[t.key]||t.key;if(a!=="Unidentified")return a}if(t.type==="keypress"){var c=sf(t);return c===13?"Enter":String.fromCharCode(c)}return t.type==="keydown"||t.type==="keyup"?Hp[t.keyCode]||"Unidentified":""}var Zp={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Xp(t){var a=this,c=a.nativeEvent;if(c.getModifierState)return c.getModifierState(t);var m=Zp[t];return m?!!c[m]:!1}function rh(t){return Xp}var Z_=an({},uf,{key:H_,code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:rh,charCode:function(t){return t.type==="keypress"?sf(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?sf(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),X_=Ki(Z_),cf=an({},xl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Wp=Ki(cf),vg=an({},uf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:rh}),hx=Ki(vg),W_=an({},ad,{propertyName:0,elapsedTime:0,pseudoElement:0}),hf=Ki(W_),dx=an({},xl,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),xg=Ki(dx),fx=[9,13,27,32],Yp=229,df=mi&&"CompositionEvent"in window,Ju=null;mi&&"documentMode"in document&&(Ju=document.documentMode);var px=mi&&"TextEvent"in window&&!Ju,Y_=mi&&(!df||Ju&&Ju>8&&Ju<=11),K_=32,J_=String.fromCharCode(K_);function mx(){fa("onBeforeInput",["compositionend","keypress","textInput","paste"]),fa("onCompositionEnd",["compositionend","focusout","keydown","keypress","keyup","mousedown"]),fa("onCompositionStart",["compositionstart","focusout","keydown","keypress","keyup","mousedown"]),fa("onCompositionUpdate",["compositionupdate","focusout","keydown","keypress","keyup","mousedown"])}var Q_=!1;function Kp(t){return(t.ctrlKey||t.altKey||t.metaKey)&&!(t.ctrlKey&&t.altKey)}function gx(t){switch(t){case"compositionstart":return"onCompositionStart";case"compositionend":return"onCompositionEnd";case"compositionupdate":return"onCompositionUpdate"}}function ey(t,a){return t==="keydown"&&a.keyCode===Yp}function ah(t,a){switch(t){case"keyup":return fx.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==Yp;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ty(t){var a=t.detail;return typeof a=="object"&&"data"in a?a.data:null}function ny(t){return t.locale==="ko"}var sd=!1;function iy(t,a,c,m,v){var T,A;if(df?T=gx(a):sd?ah(a,m)&&(T="onCompositionEnd"):ey(a,m)&&(T="onCompositionStart"),!T)return null;Y_&&!ny(m)&&(!sd&&T==="onCompositionStart"?sd=ex(v):T==="onCompositionEnd"&&sd&&(A=pg()));var k=qa(c,T);if(k.length>0){var F=new ih(T,a,null,m,v);if(t.push({event:F,listeners:k}),A)F.data=A;else{var H=ty(m);H!==null&&(F.data=H)}}}function ry(t,a){switch(t){case"compositionend":return ty(a);case"keypress":var c=a.which;return c!==K_?null:(Q_=!0,J_);case"textInput":var m=a.data;return m===J_&&Q_?null:m;default:return null}}function _x(t,a){if(sd){if(t==="compositionend"||!df&&ah(t,a)){var c=pg();return tx(),sd=!1,c}return null}switch(t){case"paste":return null;case"keypress":if(!Kp(a)){if(a.char&&a.char.length>1)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Y_&&!ny(a)?null:a.data;default:return null}}function yx(t,a,c,m,v){var T;if(px?T=ry(a,m):T=_x(a,m),!T)return null;var A=qa(c,"onBeforeInput");if(A.length>0){var k=new cx("onBeforeInput","beforeinput",null,m,v);t.push({event:k,listeners:A}),k.data=T}}function vx(t,a,c,m,v,T,A){iy(t,a,c,m,v),yx(t,a,c,m,v)}var bg={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ff(t){var a=t&&t.nodeName&&t.nodeName.toLowerCase();return a==="input"?!!bg[t.type]:a==="textarea"}/**
 * Checks if an event is supported in the current execution environment.
 *
 * NOTE: This will not work correctly for non-generic events such as `change`,
 * `reset`, `load`, `error`, and `select`.
 *
 * Borrows from Modernizr.
 *
 * @param {string} eventNameSuffix Event name, e.g. "click".
 * @return {boolean} True if the event is supported.
 * @internal
 * @license Modernizr 3.0.0pre (Custom Build) | MIT
 */function Jp(t){if(!mi)return!1;var a="on"+t,c=a in document;if(!c){var m=document.createElement("div");m.setAttribute(a,"return;"),c=typeof m[a]=="function"}return c}function xx(){fa("onChange",["change","click","focusin","focusout","input","keydown","keyup","selectionchange"])}function ay(t,a,c,m){$l(m);var v=qa(a,"onChange");if(v.length>0){var T=new lf("onChange","change",null,c,m);t.push({event:T,listeners:v})}}var su=null,lu=null;function oy(t){var a=t.nodeName&&t.nodeName.toLowerCase();return a==="select"||a==="input"&&t.type==="file"}function pf(t){var a=[];ay(a,lu,t,Gl(t)),Hl(sy,a)}function sy(t){by(t,0)}function Qp(t){var a=_h(t);if(rl(a))return t}function ly(t,a){if(t==="change")return a}var wg=!1;mi&&(wg=Jp("input")&&(!document.documentMode||document.documentMode>9));function uy(t,a){su=t,lu=a,su.attachEvent("onpropertychange",Eg)}function Tg(){su&&(su.detachEvent("onpropertychange",Eg),su=null,lu=null)}function Eg(t){t.propertyName==="value"&&Qp(lu)&&pf(t)}function cy(t,a,c){t==="focusin"?(Tg(),uy(a,c)):t==="focusout"&&Tg()}function bx(t,a){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Qp(lu)}function wx(t){var a=t.nodeName;return a&&a.toLowerCase()==="input"&&(t.type==="checkbox"||t.type==="radio")}function hy(t,a){if(t==="click")return Qp(a)}function em(t,a){if(t==="input"||t==="change")return Qp(a)}function dy(t){var a=t._wrapperState;!a||!a.controlled||t.type!=="number"||tn(t,"number",t.value)}function $a(t,a,c,m,v,T,A){var k=c?_h(c):window,F,H;if(oy(k)?F=ly:ff(k)?wg?F=em:(F=bx,H=cy):wx(k)&&(F=hy),F){var ie=F(a,c);if(ie){ay(t,ie,m,v);return}}H&&H(a,k,c),a==="focusout"&&dy(k)}function mf(){Vn("onMouseEnter",["mouseout","mouseover"]),Vn("onMouseLeave",["mouseout","mouseover"]),Vn("onPointerEnter",["pointerout","pointerover"]),Vn("onPointerLeave",["pointerout","pointerover"])}function ld(t,a,c,m,v,T,A){var k=a==="mouseover"||a==="pointerover",F=a==="mouseout"||a==="pointerout";if(k&&!Ou(m)){var H=m.relatedTarget||m.fromElement;if(H&&(uc(H)||lc(H)))return}if(!(!F&&!k)){var ie;if(v.window===v)ie=v;else{var xe=v.ownerDocument;xe?ie=xe.defaultView||xe.parentWindow:ie=window}var ye,Be;if(F){var Ue=m.relatedTarget||m.toElement;if(ye=c,Be=Ue?uc(Ue):null,Be!==null){var Je=gl(Be);(Be!==Je||Be.tag!==bt&&Be.tag!==en)&&(Be=null)}}else ye=null,Be=c;if(ye!==Be){var Dt=od,Qt="onMouseLeave",Zt="onMouseEnter",ii="mouse";(a==="pointerout"||a==="pointerover")&&(Dt=Wp,Qt="onPointerLeave",Zt="onPointerEnter",ii="pointer");var Yn=ye==null?ie:_h(ye),ze=Be==null?ie:_h(Be),Qe=new Dt(Qt,ii+"leave",ye,m,v);Qe.target=Yn,Qe.relatedTarget=ze;var Ie=null,ut=uc(v);if(ut===c){var zt=new Dt(Zt,ii+"enter",Be,m,v);zt.target=ze,zt.relatedTarget=Yn,Ie=zt}rm(t,Qe,Ie,ye,Be)}}}function gf(t,a){return t===a&&(t!==0||1/t===1/a)||t!==t&&a!==a}var So=typeof Object.is=="function"?Object.is:gf;function ud(t,a){if(So(t,a))return!0;if(typeof t!="object"||t===null||typeof a!="object"||a===null)return!1;var c=Object.keys(t),m=Object.keys(a);if(c.length!==m.length)return!1;for(var v=0;v<c.length;v++){var T=c[v];if(!Yt.call(a,T)||!So(t[T],a[T]))return!1}return!0}function fy(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Tx(t){for(;t;){if(t.nextSibling)return t.nextSibling;t=t.parentNode}}function py(t,a){for(var c=fy(t),m=0,v=0;c;){if(c.nodeType===Bo){if(v=m+c.textContent.length,m<=a&&v>=a)return{node:c,offset:a-m};m=v}c=fy(Tx(c))}}function Ex(t){var a=t.ownerDocument,c=a&&a.defaultView||window,m=c.getSelection&&c.getSelection();if(!m||m.rangeCount===0)return null;var v=m.anchorNode,T=m.anchorOffset,A=m.focusNode,k=m.focusOffset;try{v.nodeType,A.nodeType}catch{return null}return Sx(t,v,T,A,k)}function Sx(t,a,c,m,v){var T=0,A=-1,k=-1,F=0,H=0,ie=t,xe=null;e:for(;;){for(var ye=null;ie===a&&(c===0||ie.nodeType===Bo)&&(A=T+c),ie===m&&(v===0||ie.nodeType===Bo)&&(k=T+v),ie.nodeType===Bo&&(T+=ie.nodeValue.length),(ye=ie.firstChild)!==null;)xe=ie,ie=ye;for(;;){if(ie===t)break e;if(xe===a&&++F===c&&(A=T),xe===m&&++H===v&&(k=T),(ye=ie.nextSibling)!==null)break;ie=xe,xe=ie.parentNode}ie=ye}return A===-1||k===-1?null:{start:A,end:k}}function Cx(t,a){var c=t.ownerDocument||document,m=c&&c.defaultView||window;if(m.getSelection){var v=m.getSelection(),T=t.textContent.length,A=Math.min(a.start,T),k=a.end===void 0?A:Math.min(a.end,T);if(!v.extend&&A>k){var F=k;k=A,A=F}var H=py(t,A),ie=py(t,k);if(H&&ie){if(v.rangeCount===1&&v.anchorNode===H.node&&v.anchorOffset===H.offset&&v.focusNode===ie.node&&v.focusOffset===ie.offset)return;var xe=c.createRange();xe.setStart(H.node,H.offset),v.removeAllRanges(),A>k?(v.addRange(xe),v.extend(ie.node,ie.offset)):(xe.setEnd(ie.node,ie.offset),v.addRange(xe))}}}function _f(t){return t&&t.nodeType===Bo}function my(t,a){return!t||!a?!1:t===a?!0:_f(t)?!1:_f(a)?my(t,a.parentNode):"contains"in t?t.contains(a):t.compareDocumentPosition?!!(t.compareDocumentPosition(a)&16):!1}function gy(t){return t&&t.ownerDocument&&my(t.ownerDocument.documentElement,t)}function _y(t){try{return typeof t.contentWindow.location.href=="string"}catch{return!1}}function Sg(){for(var t=window,a=Na();a instanceof t.HTMLIFrameElement;){if(_y(a))t=a.contentWindow;else return a;a=Na(t.document)}return a}function Cg(t){var a=t&&t.nodeName&&t.nodeName.toLowerCase();return a&&(a==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||a==="textarea"||t.contentEditable==="true")}function Mx(){var t=Sg();return{focusedElem:t,selectionRange:Cg(t)?Rx(t):null}}function Ax(t){var a=Sg(),c=t.focusedElem,m=t.selectionRange;if(a!==c&&gy(c)){m!==null&&Cg(c)&&Dx(c,m);for(var v=[],T=c;T=T.parentNode;)T.nodeType===ta&&v.push({element:T,left:T.scrollLeft,top:T.scrollTop});typeof c.focus=="function"&&c.focus();for(var A=0;A<v.length;A++){var k=v[A];k.element.scrollLeft=k.left,k.element.scrollTop=k.top}}}function Rx(t){var a;return"selectionStart"in t?a={start:t.selectionStart,end:t.selectionEnd}:a=Ex(t),a||{start:0,end:0}}function Dx(t,a){var c=a.start,m=a.end;m===void 0&&(m=c),"selectionStart"in t?(t.selectionStart=c,t.selectionEnd=Math.min(m,t.value.length)):Cx(t,a)}var yy=mi&&"documentMode"in document&&document.documentMode<=11;function zx(){fa("onSelect",["focusout","contextmenu","dragend","focusin","keydown","keyup","mousedown","mouseup","selectionchange"])}var br=null,_s=null,oh=null,cd=!1;function hd(t){if("selectionStart"in t&&Cg(t))return{start:t.selectionStart,end:t.selectionEnd};var a=t.ownerDocument&&t.ownerDocument.defaultView||window,c=a.getSelection();return{anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}}function Ix(t){return t.window===t?t.document:t.nodeType===rs?t:t.ownerDocument}function vy(t,a,c){var m=Ix(c);if(!(cd||br==null||br!==Na(m))){var v=hd(br);if(!oh||!ud(oh,v)){oh=v;var T=qa(_s,"onSelect");if(T.length>0){var A=new lf("onSelect","select",null,a,c);t.push({event:A,listeners:T}),A.target=br}}}}function yf(t,a,c,m,v,T,A){var k=c?_h(c):window;switch(a){case"focusin":(ff(k)||k.contentEditable==="true")&&(br=k,_s=c,oh=null);break;case"focusout":br=null,_s=null,oh=null;break;case"mousedown":cd=!0;break;case"contextmenu":case"mouseup":case"dragend":cd=!1,vy(t,m,v);break;case"selectionchange":if(yy)break;case"keydown":case"keyup":vy(t,m,v)}}function tm(t,a){var c={};return c[t.toLowerCase()]=a.toLowerCase(),c["Webkit"+t]="webkit"+a,c["Moz"+t]="moz"+a,c}var dd={animationend:tm("Animation","AnimationEnd"),animationiteration:tm("Animation","AnimationIteration"),animationstart:tm("Animation","AnimationStart"),transitionend:tm("Transition","TransitionEnd")},sh={},Mg={};mi&&(Mg=document.createElement("div").style,"AnimationEvent"in window||(delete dd.animationend.animation,delete dd.animationiteration.animation,delete dd.animationstart.animation),"TransitionEvent"in window||delete dd.transitionend.transition);function vf(t){if(sh[t])return sh[t];if(!dd[t])return t;var a=dd[t];for(var c in a)if(a.hasOwnProperty(c)&&c in Mg)return sh[t]=a[c];return t}var xi=vf("animationend"),nm=vf("animationiteration"),Ag=vf("animationstart"),Rg=vf("transitionend"),bl=new Map,lh=["abort","auxClick","cancel","canPlay","canPlayThrough","click","close","contextMenu","copy","cut","drag","dragEnd","dragEnter","dragExit","dragLeave","dragOver","dragStart","drop","durationChange","emptied","encrypted","ended","error","gotPointerCapture","input","invalid","keyDown","keyPress","keyUp","load","loadedData","loadedMetadata","loadStart","lostPointerCapture","mouseDown","mouseMove","mouseOut","mouseOver","mouseUp","paste","pause","play","playing","pointerCancel","pointerDown","pointerMove","pointerOut","pointerOver","pointerUp","progress","rateChange","reset","resize","seeked","seeking","stalled","submit","suspend","timeUpdate","touchCancel","touchEnd","touchStart","volumeChange","scroll","toggle","touchMove","waiting","wheel"];function uu(t,a){bl.set(t,a),fa(a,[t])}function kx(){for(var t=0;t<lh.length;t++){var a=lh[t],c=a.toLowerCase(),m=a[0].toUpperCase()+a.slice(1);uu(c,"on"+m)}uu(xi,"onAnimationEnd"),uu(nm,"onAnimationIteration"),uu(Ag,"onAnimationStart"),uu("dblclick","onDoubleClick"),uu("focusin","onFocus"),uu("focusout","onBlur"),uu(Rg,"onTransitionEnd")}function Lx(t,a,c,m,v,T,A){var k=bl.get(a);if(k!==void 0){var F=lf,H=a;switch(a){case"keypress":if(sf(m)===0)return;case"keydown":case"keyup":F=X_;break;case"focusin":H="focus",F=_g;break;case"focusout":H="blur",F=_g;break;case"beforeblur":case"afterblur":F=_g;break;case"click":if(m.button===2)return;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":F=od;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":F=rx;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":F=hx;break;case xi:case nm:case Ag:F=sx;break;case Rg:F=hf;break;case"scroll":F=nx;break;case"wheel":F=xg;break;case"copy":case"cut":case"paste":F=yg;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":F=Wp;break}var ie=(T&Fs)!==0;{var xe=!ie&&a==="scroll",ye=Ey(c,k,m.type,ie,xe);if(ye.length>0){var Be=new F(k,H,null,m,v);t.push({event:Be,listeners:ye})}}}}kx(),mf(),xx(),zx(),mx();function Ox(t,a,c,m,v,T,A){Lx(t,a,c,m,v,T);var k=(T&ul)===0;k&&(ld(t,a,c,m,v),$a(t,a,c,m,v),yf(t,a,c,m,v),vx(t,a,c,m,v))}var xf=["abort","canplay","canplaythrough","durationchange","emptied","encrypted","ended","error","loadeddata","loadedmetadata","loadstart","pause","play","playing","progress","ratechange","resize","seeked","seeking","stalled","suspend","timeupdate","volumechange","waiting"],Dg=new Set(["cancel","close","invalid","load","scroll","toggle"].concat(xf));function xy(t,a,c){var m=t.type||"unknown-event";t.currentTarget=c,vp(m,a,void 0,t),t.currentTarget=null}function Px(t,a,c){var m;if(c)for(var v=a.length-1;v>=0;v--){var T=a[v],A=T.instance,k=T.currentTarget,F=T.listener;if(A!==m&&t.isPropagationStopped())return;xy(t,F,k),m=A}else for(var H=0;H<a.length;H++){var ie=a[H],xe=ie.instance,ye=ie.currentTarget,Be=ie.listener;if(xe!==m&&t.isPropagationStopped())return;xy(t,Be,ye),m=xe}}function by(t,a){for(var c=(a&Fs)!==0,m=0;m<t.length;m++){var v=t[m],T=v.event,A=v.listeners;Px(T,A,c)}xp()}function Bx(t,a,c,m,v){var T=Gl(c),A=[];Ox(A,t,m,c,T,a),by(A,a)}function Gi(t,a){Dg.has(t)||de('Did not expect a listenToNonDelegatedEvent() call for "%s". This is a bug in React. Please file an issue.',t);var c=!1,m=Zy(a),v=Fx(t,c);m.has(v)||(wy(a,t,Lu,c),m.add(v))}function Qu(t,a,c){Dg.has(t)&&!a&&de('Did not expect a listenToNativeEvent() call for "%s" in the bubble phase. This is a bug in React. Please file an issue.',t);var m=0;a&&(m|=Fs),wy(c,t,m,a)}var bf="_reactListening"+Math.random().toString(36).slice(2);function wf(t){if(!t[bf]){t[bf]=!0,Lr.forEach(function(c){c!=="selectionchange"&&(Dg.has(c)||Qu(c,!1,t),Qu(c,!0,t))});var a=t.nodeType===rs?t:t.ownerDocument;a!==null&&(a[bf]||(a[bf]=!0,Qu("selectionchange",!1,a)))}}function wy(t,a,c,m,v){var T=V_(t,a,c),A=void 0;Nc&&(a==="touchstart"||a==="touchmove"||a==="wheel")&&(A=!0),t=t,m?A!==void 0?dg(t,a,T,A):hg(t,a,T):A!==void 0?Ga(t,a,T,A):cg(t,a,T)}function Ty(t,a){return t===a||t.nodeType===cr&&t.parentNode===a}function Tf(t,a,c,m,v){var T=m;if(!(a&Bh)&&!(a&Lu)){var A=v;if(m!==null){var k=m;e:for(;;){if(k===null)return;var F=k.tag;if(F===at||F===gt){var H=k.stateNode.containerInfo;if(Ty(H,A))break;if(F===gt)for(var ie=k.return;ie!==null;){var xe=ie.tag;if(xe===at||xe===gt){var ye=ie.stateNode.containerInfo;if(Ty(ye,A))return}ie=ie.return}for(;H!==null;){var Be=uc(H);if(Be===null)return;var Ue=Be.tag;if(Ue===bt||Ue===en){k=T=Be;continue e}H=H.parentNode}}k=k.return}}}Hl(function(){return Bx(t,a,c,T)})}function uh(t,a,c){return{instance:t,listener:a,currentTarget:c}}function Ey(t,a,c,m,v,T){for(var A=a!==null?a+"Capture":null,k=m?A:a,F=[],H=t,ie=null;H!==null;){var xe=H,ye=xe.stateNode,Be=xe.tag;if(Be===bt&&ye!==null&&(ie=ye,k!==null)){var Ue=us(H,k);Ue!=null&&F.push(uh(H,Ue,ie))}if(v)break;H=H.return}return F}function qa(t,a){for(var c=a+"Capture",m=[],v=t;v!==null;){var T=v,A=T.stateNode,k=T.tag;if(k===bt&&A!==null){var F=A,H=us(v,c);H!=null&&m.unshift(uh(v,H,F));var ie=us(v,a);ie!=null&&m.push(uh(v,ie,F))}v=v.return}return m}function wl(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==bt);return t||null}function fd(t,a){for(var c=t,m=a,v=0,T=c;T;T=wl(T))v++;for(var A=0,k=m;k;k=wl(k))A++;for(;v-A>0;)c=wl(c),v--;for(;A-v>0;)m=wl(m),A--;for(var F=v;F--;){if(c===m||m!==null&&c===m.alternate)return c;c=wl(c),m=wl(m)}return null}function im(t,a,c,m,v){for(var T=a._reactName,A=[],k=c;k!==null&&k!==m;){var F=k,H=F.alternate,ie=F.stateNode,xe=F.tag;if(H!==null&&H===m)break;if(xe===bt&&ie!==null){var ye=ie;if(v){var Be=us(k,T);Be!=null&&A.unshift(uh(k,Be,ye))}else if(!v){var Ue=us(k,T);Ue!=null&&A.push(uh(k,Ue,ye))}}k=k.return}A.length!==0&&t.push({event:a,listeners:A})}function rm(t,a,c,m,v){var T=m&&v?fd(m,v):null;m!==null&&im(t,a,m,T,!1),v!==null&&c!==null&&im(t,c,v,T,!0)}function Fx(t,a){return t+"__"+(a?"capture":"bubble")}var eo=!1,pd="dangerouslySetInnerHTML",am="suppressContentEditableWarning",cu="suppressHydrationWarning",zg="autoFocus",hu="children",ec="style",om="__html",sm,ys,md,Ig,Ef,kg,Sy;sm={dialog:!0,webview:!0},ys=function(t,a){jl(t,a),Gd(t,a),qd(t,a,{registrationNameDependencies:mr,possibleRegistrationNames:Ui})},kg=mi&&!document.documentMode,md=function(t,a,c){if(!eo){var m=Sf(c),v=Sf(a);v!==m&&(eo=!0,de("Prop `%s` did not match. Server: %s Client: %s",t,JSON.stringify(v),JSON.stringify(m)))}},Ig=function(t){if(!eo){eo=!0;var a=[];t.forEach(function(c){a.push(c)}),de("Extra attributes from the server: %s",a)}},Ef=function(t,a){a===!1?de("Expected `%s` listener to be a function, instead got `false`.\n\nIf you used to conditionally omit it with %s={condition && value}, pass %s={condition ? value : undefined} instead.",t,t,t):de("Expected `%s` listener to be a function, instead got a value of `%s` type.",t,typeof a)},Sy=function(t,a){var c=t.namespaceURI===Po?t.ownerDocument.createElement(t.tagName):t.ownerDocument.createElementNS(t.namespaceURI,t.tagName);return c.innerHTML=a,c.innerHTML};var Ux=/\r\n?/g,Cy=/\u0000|\uFFFD/g;function Sf(t){Ni(t);var a=typeof t=="string"?t:""+t;return a.replace(Ux,`
`).replace(Cy,"")}function tc(t,a,c,m){var v=Sf(a),T=Sf(t);if(T!==v&&(m&&(eo||(eo=!0,de('Text content did not match. Server: "%s" Client: "%s"',T,v))),c&&rn))throw new Error("Text content does not match server-rendered HTML.")}function Lg(t){return t.nodeType===rs?t:t.ownerDocument}function My(){}function gd(t){t.onclick=My}function _d(t,a,c,m,v){for(var T in m)if(m.hasOwnProperty(T)){var A=m[T];if(T===ec)A&&Object.freeze(A),Vd(a,A);else if(T===pd){var k=A?A[om]:void 0;k!=null&&Rc(a,k)}else if(T===hu)if(typeof A=="string"){var F=t!=="textarea"||A!=="";F&&Dh(a,A)}else typeof A=="number"&&Dh(a,""+A);else T===am||T===cu||T===zg||(mr.hasOwnProperty(T)?A!=null&&(typeof A!="function"&&Ef(T,A),T==="onScroll"&&Gi("scroll",a)):A!=null&&V(a,T,A,v))}}function Ay(t,a,c,m){for(var v=0;v<a.length;v+=2){var T=a[v],A=a[v+1];T===ec?Vd(t,A):T===pd?Rc(t,A):T===hu?Dh(t,A):V(t,T,A,m)}}function lm(t,a,c,m){var v,T=Lg(c),A,k=m;if(k===Po&&(k=Du(t)),k===Po){if(v=sl(t,a),!v&&t!==t.toLowerCase()&&de("<%s /> is using incorrect casing. Use PascalCase for React components, or lowercase for HTML elements.",t),t==="script"){var F=T.createElement("div");F.innerHTML="<script><\/script>";var H=F.firstChild;A=F.removeChild(H)}else if(typeof a.is=="string")A=T.createElement(t,{is:a.is});else if(A=T.createElement(t),t==="select"){var ie=A;a.multiple?ie.multiple=!0:a.size&&(ie.size=a.size)}}else A=T.createElementNS(k,t);return k===Po&&!v&&Object.prototype.toString.call(A)==="[object HTMLUnknownElement]"&&!Yt.call(sm,t)&&(sm[t]=!0,de("The tag <%s> is unrecognized in this browser. If you meant to render a React component, start its name with an uppercase letter.",t)),A}function Ry(t,a){return Lg(a).createTextNode(t)}function um(t,a,c,m){var v=sl(a,c);ys(a,c);var T;switch(a){case"dialog":Gi("cancel",t),Gi("close",t),T=c;break;case"iframe":case"object":case"embed":Gi("load",t),T=c;break;case"video":case"audio":for(var A=0;A<xf.length;A++)Gi(xf[A],t);T=c;break;case"source":Gi("error",t),T=c;break;case"img":case"image":case"link":Gi("error",t),Gi("load",t),T=c;break;case"details":Gi("toggle",t),T=c;break;case"input":ge(t,c),T=U(t,c),Gi("invalid",t);break;case"option":ci(t,c),T=c;break;case"select":ol(t,c),T=Ps(t,c),Gi("invalid",t);break;case"textarea":Ru(t,c),T=Au(t,c),Gi("invalid",t);break;default:T=c}switch(Oc(a,T),_d(a,t,m,T,v),a){case"input":Is(t),dt(t,c,!1);break;case"textarea":Is(t),Bn(t);break;case"option":Bi(t,c);break;case"select":Cc(t,c);break;default:typeof T.onClick=="function"&&gd(t);break}}function cm(t,a,c,m,v){ys(a,m);var T=null,A,k;switch(a){case"input":A=U(t,c),k=U(t,m),T=[];break;case"select":A=Ps(t,c),k=Ps(t,m),T=[];break;case"textarea":A=Au(t,c),k=Au(t,m),T=[];break;default:A=c,k=m,typeof A.onClick!="function"&&typeof k.onClick=="function"&&gd(t);break}Oc(a,k);var F,H,ie=null;for(F in A)if(!(k.hasOwnProperty(F)||!A.hasOwnProperty(F)||A[F]==null))if(F===ec){var xe=A[F];for(H in xe)xe.hasOwnProperty(H)&&(ie||(ie={}),ie[H]="")}else F===pd||F===hu||F===am||F===cu||F===zg||(mr.hasOwnProperty(F)?T||(T=[]):(T=T||[]).push(F,null));for(F in k){var ye=k[F],Be=A!=null?A[F]:void 0;if(!(!k.hasOwnProperty(F)||ye===Be||ye==null&&Be==null))if(F===ec)if(ye&&Object.freeze(ye),Be){for(H in Be)Be.hasOwnProperty(H)&&(!ye||!ye.hasOwnProperty(H))&&(ie||(ie={}),ie[H]="");for(H in ye)ye.hasOwnProperty(H)&&Be[H]!==ye[H]&&(ie||(ie={}),ie[H]=ye[H])}else ie||(T||(T=[]),T.push(F,ie)),ie=ye;else if(F===pd){var Ue=ye?ye[om]:void 0,Je=Be?Be[om]:void 0;Ue!=null&&Je!==Ue&&(T=T||[]).push(F,Ue)}else F===hu?(typeof ye=="string"||typeof ye=="number")&&(T=T||[]).push(F,""+ye):F===am||F===cu||(mr.hasOwnProperty(F)?(ye!=null&&(typeof ye!="function"&&Ef(F,ye),F==="onScroll"&&Gi("scroll",t)),!T&&Be!==ye&&(T=[])):(T=T||[]).push(F,ye))}return ie&&(jm(ie,k[ec]),(T=T||[]).push(ec,ie)),T}function Nx(t,a,c,m,v){c==="input"&&v.type==="radio"&&v.name!=null&&Pe(t,v);var T=sl(c,m),A=sl(c,v);switch(Ay(t,a,T,A),c){case"input":He(t,v);break;case"textarea":Mc(t,v);break;case"select":Sh(t,v);break}}function Vx(t){{var a=t.toLowerCase();return Pc.hasOwnProperty(a)&&Pc[a]||null}}function jx(t,a,c,m,v,T,A){var k,F;switch(k=sl(a,c),ys(a,c),a){case"dialog":Gi("cancel",t),Gi("close",t);break;case"iframe":case"object":case"embed":Gi("load",t);break;case"video":case"audio":for(var H=0;H<xf.length;H++)Gi(xf[H],t);break;case"source":Gi("error",t);break;case"img":case"image":case"link":Gi("error",t),Gi("load",t);break;case"details":Gi("toggle",t);break;case"input":ge(t,c),Gi("invalid",t);break;case"option":ci(t,c);break;case"select":ol(t,c),Gi("invalid",t);break;case"textarea":Ru(t,c),Gi("invalid",t);break}Oc(a,c);{F=new Set;for(var ie=t.attributes,xe=0;xe<ie.length;xe++){var ye=ie[xe].name.toLowerCase();switch(ye){case"value":break;case"checked":break;case"selected":break;default:F.add(ie[xe].name)}}}var Be=null;for(var Ue in c)if(c.hasOwnProperty(Ue)){var Je=c[Ue];if(Ue===hu)typeof Je=="string"?t.textContent!==Je&&(c[cu]!==!0&&tc(t.textContent,Je,T,A),Be=[hu,Je]):typeof Je=="number"&&t.textContent!==""+Je&&(c[cu]!==!0&&tc(t.textContent,Je,T,A),Be=[hu,""+Je]);else if(mr.hasOwnProperty(Ue))Je!=null&&(typeof Je!="function"&&Ef(Ue,Je),Ue==="onScroll"&&Gi("scroll",t));else if(A&&typeof k=="boolean"){var Dt=void 0,Qt=k&&ar?null:Gr(Ue);if(c[cu]!==!0){if(!(Ue===am||Ue===cu||Ue==="value"||Ue==="checked"||Ue==="selected")){if(Ue===pd){var Zt=t.innerHTML,ii=Je?Je[om]:void 0;if(ii!=null){var Yn=Sy(t,ii);Yn!==Zt&&md(Ue,Zt,Yn)}}else if(Ue===ec){if(F.delete(Ue),kg){var ze=Vl(Je);Dt=t.getAttribute("style"),ze!==Dt&&md(Ue,Dt,ze)}}else if(k&&!ar)F.delete(Ue.toLowerCase()),Dt=P(t,Ue,Je),Je!==Dt&&md(Ue,Dt,Je);else if(!Vi(Ue,Qt,k)&&!ri(Ue,Je,Qt,k)){var Qe=!1;if(Qt!==null)F.delete(Qt.attributeName),Dt=J(t,Ue,Je,Qt);else{var Ie=m;if(Ie===Po&&(Ie=Du(a)),Ie===Po)F.delete(Ue.toLowerCase());else{var ut=Vx(Ue);ut!==null&&ut!==Ue&&(Qe=!0,F.delete(ut)),F.delete(Ue)}Dt=P(t,Ue,Je)}var zt=ar;!zt&&Je!==Dt&&!Qe&&md(Ue,Dt,Je)}}}}}switch(A&&F.size>0&&c[cu]!==!0&&Ig(F),a){case"input":Is(t),dt(t,c,!0);break;case"textarea":Is(t),Bn(t);break;case"select":case"option":break;default:typeof c.onClick=="function"&&gd(t);break}return Be}function Gx(t,a,c){var m=t.nodeValue!==a;return m}function Og(t,a){{if(eo)return;eo=!0,de("Did not expect server HTML to contain a <%s> in <%s>.",a.nodeName.toLowerCase(),t.nodeName.toLowerCase())}}function nc(t,a){{if(eo)return;eo=!0,de('Did not expect server HTML to contain the text node "%s" in <%s>.',a.nodeValue,t.nodeName.toLowerCase())}}function Cf(t,a,c){{if(eo)return;eo=!0,de("Expected server HTML to contain a matching <%s> in <%s>.",a,t.nodeName.toLowerCase())}}function Pg(t,a){{if(a===""||eo)return;eo=!0,de('Expected server HTML to contain a matching text node for "%s" in <%s>.',a,t.nodeName.toLowerCase())}}function Dy(t,a,c){switch(a){case"input":Xt(t,c);return;case"textarea":Ch(t,c);return;case"select":Fl(t,c);return}}var Mf=function(){},ch=function(){};{var $x=["address","applet","area","article","aside","base","basefont","bgsound","blockquote","body","br","button","caption","center","col","colgroup","dd","details","dir","div","dl","dt","embed","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","iframe","img","input","isindex","li","link","listing","main","marquee","menu","menuitem","meta","nav","noembed","noframes","noscript","object","ol","p","param","plaintext","pre","script","section","select","source","style","summary","table","tbody","td","template","textarea","tfoot","th","thead","title","tr","track","ul","wbr","xmp"],du=["applet","caption","html","table","td","th","marquee","object","template","foreignObject","desc","title"],zy=du.concat(["button"]),Iy=["dd","dt","li","option","optgroup","p","rp","rt"],Af={current:null,formTag:null,aTagInScope:null,buttonTagInScope:null,nobrTagInScope:null,pTagInButtonScope:null,listItemTagAutoclosing:null,dlItemTagAutoclosing:null};ch=function(t,a){var c=an({},t||Af),m={tag:a};return du.indexOf(a)!==-1&&(c.aTagInScope=null,c.buttonTagInScope=null,c.nobrTagInScope=null),zy.indexOf(a)!==-1&&(c.pTagInButtonScope=null),$x.indexOf(a)!==-1&&a!=="address"&&a!=="div"&&a!=="p"&&(c.listItemTagAutoclosing=null,c.dlItemTagAutoclosing=null),c.current=m,a==="form"&&(c.formTag=m),a==="a"&&(c.aTagInScope=m),a==="button"&&(c.buttonTagInScope=m),a==="nobr"&&(c.nobrTagInScope=m),a==="p"&&(c.pTagInButtonScope=m),a==="li"&&(c.listItemTagAutoclosing=m),(a==="dd"||a==="dt")&&(c.dlItemTagAutoclosing=m),c};var Bg=function(t,a){switch(a){case"select":return t==="option"||t==="optgroup"||t==="#text";case"optgroup":return t==="option"||t==="#text";case"option":return t==="#text";case"tr":return t==="th"||t==="td"||t==="style"||t==="script"||t==="template";case"tbody":case"thead":case"tfoot":return t==="tr"||t==="style"||t==="script"||t==="template";case"colgroup":return t==="col"||t==="template";case"table":return t==="caption"||t==="colgroup"||t==="tbody"||t==="tfoot"||t==="thead"||t==="style"||t==="script"||t==="template";case"head":return t==="base"||t==="basefont"||t==="bgsound"||t==="link"||t==="meta"||t==="title"||t==="noscript"||t==="noframes"||t==="style"||t==="script"||t==="template";case"html":return t==="head"||t==="body"||t==="frameset";case"frameset":return t==="frame";case"#document":return t==="html"}switch(t){case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":return a!=="h1"&&a!=="h2"&&a!=="h3"&&a!=="h4"&&a!=="h5"&&a!=="h6";case"rp":case"rt":return Iy.indexOf(a)===-1;case"body":case"caption":case"col":case"colgroup":case"frameset":case"frame":case"head":case"html":case"tbody":case"td":case"tfoot":case"th":case"thead":case"tr":return a==null}return!0},qx=function(t,a){switch(t){case"address":case"article":case"aside":case"blockquote":case"center":case"details":case"dialog":case"dir":case"div":case"dl":case"fieldset":case"figcaption":case"figure":case"footer":case"header":case"hgroup":case"main":case"menu":case"nav":case"ol":case"p":case"section":case"summary":case"ul":case"pre":case"listing":case"table":case"hr":case"xmp":case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":return a.pTagInButtonScope;case"form":return a.formTag||a.pTagInButtonScope;case"li":return a.listItemTagAutoclosing;case"dd":case"dt":return a.dlItemTagAutoclosing;case"button":return a.buttonTagInScope;case"a":return a.aTagInScope;case"nobr":return a.nobrTagInScope}return null},ky={};Mf=function(t,a,c){c=c||Af;var m=c.current,v=m&&m.tag;a!=null&&(t!=null&&de("validateDOMNesting: when childText is passed, childTag should be null"),t="#text");var T=Bg(t,v)?null:m,A=T?null:qx(t,c),k=T||A;if(k){var F=k.tag,H=!!T+"|"+t+"|"+F;if(!ky[H]){ky[H]=!0;var ie=t,xe="";if(t==="#text"?/\S/.test(a)?ie="Text nodes":(ie="Whitespace text nodes",xe=" Make sure you don't have any extra whitespace between tags on each line of your source code."):ie="<"+t+">",T){var ye="";F==="table"&&t==="tr"&&(ye+=" Add a <tbody>, <thead> or <tfoot> to your code to match the DOM tree generated by the browser."),de("validateDOMNesting(...): %s cannot appear as a child of <%s>.%s%s",ie,F,xe,ye)}else de("validateDOMNesting(...): %s cannot appear as a descendant of <%s>.",ie,F)}}}}var Rf="suppressHydrationWarning",Df="$",ic="/$",Ho="$?",hh="$!",yd="style",rc=null,Co=null;function vs(t){var a,c,m=t.nodeType;switch(m){case rs:case Rh:{a=m===rs?"#document":"#fragment";var v=t.documentElement;c=v?v.namespaceURI:Mh(null,"");break}default:{var T=m===cr?t.parentNode:t,A=T.namespaceURI||null;a=T.tagName,c=Mh(A,a);break}}{var k=a.toLowerCase(),F=ch(null,k);return{namespace:c,ancestorInfo:F}}}function Hx(t,a,c){{var m=t,v=Mh(m.namespace,a),T=ch(m.ancestorInfo,a);return{namespace:v,ancestorInfo:T}}}function Zx(t){return t}function Xx(t){rc=Qv(),Co=Mx();var a=null;return N_(!1),a}function Fg(t){Ax(Co),N_(rc),rc=null,Co=null}function Tl(t,a,c,m,v){var T;{var A=m;if(Mf(t,null,A.ancestorInfo),typeof a.children=="string"||typeof a.children=="number"){var k=""+a.children,F=ch(A.ancestorInfo,t);Mf(null,k,F)}T=A.namespace}var H=lm(t,a,c,T);return bs(v,H),Yg(H,a),H}function dh(t,a){t.appendChild(a)}function Ly(t,a,c,m,v){switch(um(t,a,c,m),a){case"button":case"input":case"select":case"textarea":return!!c.autoFocus;case"img":return!0;default:return!1}}function Oy(t,a,c,m,v,T){{var A=T;if(typeof m.children!=typeof c.children&&(typeof m.children=="string"||typeof m.children=="number")){var k=""+m.children,F=ch(A.ancestorInfo,a);Mf(null,k,F)}}return cm(t,a,c,m)}function Ug(t,a){return t==="textarea"||t==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}function hm(t,a,c,m){{var v=c;Mf(null,t,v.ancestorInfo)}var T=Ry(t,a);return bs(m,T),T}function Ng(){var t=window.event;return t===void 0?nu:$_(t.type)}var ac=typeof setTimeout=="function"?setTimeout:void 0,zf=typeof clearTimeout=="function"?clearTimeout:void 0,fh=-1,If=typeof Promise=="function"?Promise:void 0,Py=typeof queueMicrotask=="function"?queueMicrotask:typeof If<"u"?function(t){return If.resolve(null).then(t).catch(kf)}:ac;function kf(t){setTimeout(function(){throw t})}function Vg(t,a,c,m){switch(a){case"button":case"input":case"select":case"textarea":c.autoFocus&&t.focus();return;case"img":{c.src&&(t.src=c.src);return}}}function By(t,a,c,m,v,T){Nx(t,a,c,m,v),Yg(t,v)}function ph(t){Dh(t,"")}function Fy(t,a,c){t.nodeValue=c}function jg(t,a){t.appendChild(a)}function Uy(t,a){var c;t.nodeType===cr?(c=t.parentNode,c.insertBefore(a,t)):(c=t,c.appendChild(a));var m=t._reactRootContainer;m==null&&c.onclick===null&&gd(c)}function Wx(t,a,c){t.insertBefore(a,c)}function Yx(t,a,c){t.nodeType===cr?t.parentNode.insertBefore(a,c):t.insertBefore(a,c)}function Ny(t,a){t.removeChild(a)}function mh(t,a){t.nodeType===cr?t.parentNode.removeChild(a):t.removeChild(a)}function Gg(t,a){var c=a,m=0;do{var v=c.nextSibling;if(t.removeChild(c),v&&v.nodeType===cr){var T=v.data;if(T===ic)if(m===0){t.removeChild(v),td(a);return}else m--;else(T===Df||T===Ho||T===hh)&&m++}c=v}while(c);td(a)}function oc(t,a){t.nodeType===cr?Gg(t.parentNode,a):t.nodeType===ta&&Gg(t,a),td(t)}function Kx(t){t=t;var a=t.style;typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"}function Lf(t){t.nodeValue=""}function Of(t,a){t=t;var c=a[yd],m=c!=null&&c.hasOwnProperty("display")?c.display:null;t.style.display=zc("display",m)}function Pf(t,a){t.nodeValue=a}function Bf(t){t.nodeType===ta?t.textContent="":t.nodeType===rs&&t.documentElement&&t.removeChild(t.documentElement)}function dm(t,a,c){return t.nodeType!==ta||a.toLowerCase()!==t.nodeName.toLowerCase()?null:t}function Jx(t,a){return a===""||t.nodeType!==Bo?null:t}function Qx(t){return t.nodeType!==cr?null:t}function gh(t){return t.data===Ho}function vd(t){return t.data===hh}function e0(t){var a=t.nextSibling&&t.nextSibling.dataset,c,m,v;return a&&(c=a.dgst,m=a.msg,v=a.stck),{message:m,digest:c,stack:v}}function Vy(t,a){t._reactRetry=a}function Ff(t){for(;t!=null;t=t.nextSibling){var a=t.nodeType;if(a===ta||a===Bo)break;if(a===cr){var c=t.data;if(c===Df||c===hh||c===Ho)break;if(c===ic)return null}}return t}function Uf(t){return Ff(t.nextSibling)}function jy(t){return Ff(t.firstChild)}function t0(t){return Ff(t.firstChild)}function Gy(t){return Ff(t.nextSibling)}function n0(t,a,c,m,v,T,A){bs(T,t),Yg(t,c);var k;{var F=v;k=F.namespace}var H=(T.mode&Mn)!==kt;return jx(t,a,c,k,m,H,A)}function $y(t,a,c,m){return bs(c,t),c.mode&Mn,Gx(t,a)}function i0(t,a){bs(a,t)}function r0(t){for(var a=t.nextSibling,c=0;a;){if(a.nodeType===cr){var m=a.data;if(m===ic){if(c===0)return Uf(a);c--}else(m===Df||m===hh||m===Ho)&&c++}a=a.nextSibling}return null}function Nf(t){for(var a=t.previousSibling,c=0;a;){if(a.nodeType===cr){var m=a.data;if(m===Df||m===hh||m===Ho){if(c===0)return a;c--}else m===ic&&c++}a=a.previousSibling}return null}function fm(t){td(t)}function pm(t){td(t)}function a0(t){return t!=="head"&&t!=="body"}function $g(t,a,c,m){var v=!0;tc(a.nodeValue,c,m,v)}function qg(t,a,c,m,v,T){if(a[Rf]!==!0){var A=!0;tc(m.nodeValue,v,T,A)}}function sc(t,a){a.nodeType===ta?Og(t,a):a.nodeType===cr||nc(t,a)}function o0(t,a){{var c=t.parentNode;c!==null&&(a.nodeType===ta?Og(c,a):a.nodeType===cr||nc(c,a))}}function Hg(t,a,c,m,v){(v||a[Rf]!==!0)&&(m.nodeType===ta?Og(c,m):m.nodeType===cr||nc(c,m))}function qy(t,a,c){Cf(t,a)}function mm(t,a){Pg(t,a)}function s0(t,a,c){{var m=t.parentNode;m!==null&&Cf(m,a)}}function l0(t,a){{var c=t.parentNode;c!==null&&Pg(c,a)}}function u0(t,a,c,m,v,T){(T||a[Rf]!==!0)&&Cf(c,m)}function c0(t,a,c,m,v){(v||a[Rf]!==!0)&&Pg(c,m)}function Zg(t){de("An error occurred during hydration. The server HTML was replaced with client content in <%s>.",t.nodeName.toLowerCase())}function h0(t){wf(t)}var El=Math.random().toString(36).slice(2),xd="__reactFiber$"+El,Xg="__reactProps$"+El,bd="__reactContainer$"+El,Wg="__reactEvents$"+El,Hy="__reactListeners$"+El,xs="__reactHandles$"+El;function Sl(t){delete t[xd],delete t[Xg],delete t[Wg],delete t[Hy],delete t[xs]}function bs(t,a){a[xd]=t}function Zo(t,a){a[bd]=t}function fu(t){t[bd]=null}function lc(t){return!!t[bd]}function uc(t){var a=t[xd];if(a)return a;for(var c=t.parentNode;c;){if(a=c[bd]||c[xd],a){var m=a.alternate;if(a.child!==null||m!==null&&m.child!==null)for(var v=Nf(t);v!==null;){var T=v[xd];if(T)return T;v=Nf(v)}return a}t=c,c=t.parentNode}return null}function pu(t){var a=t[xd]||t[bd];return a&&(a.tag===bt||a.tag===en||a.tag===Ge||a.tag===at)?a:null}function _h(t){if(t.tag===bt||t.tag===en)return t.stateNode;throw new Error("getNodeFromInstance: Invalid argument.")}function wd(t){return t[Xg]||null}function Yg(t,a){t[Xg]=a}function Zy(t){var a=t[Wg];return a===void 0&&(a=t[Wg]=new Set),a}var Kg={},Jg=li.ReactDebugCurrentFrame;function Vf(t){if(t){var a=t._owner,c=mo(t.type,t._source,a?a.type:null);Jg.setExtraStackFrame(c)}else Jg.setExtraStackFrame(null)}function ws(t,a,c,m,v){{var T=Function.call.bind(Yt);for(var A in t)if(T(t,A)){var k=void 0;try{if(typeof t[A]!="function"){var F=Error((m||"React class")+": "+c+" type `"+A+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof t[A]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw F.name="Invariant Violation",F}k=t[A](a,A,m,c,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(H){k=H}k&&!(k instanceof Error)&&(Vf(v),de("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",m||"React class",c,A,typeof k),Vf(null)),k instanceof Error&&!(k.message in Kg)&&(Kg[k.message]=!0,Vf(v),de("Failed %s type: %s",c,k.message),Vf(null))}}}var gm=[],jf;jf=[];var Ha=-1;function mu(t){return{current:t}}function oa(t,a){if(Ha<0){de("Unexpected pop.");return}a!==jf[Ha]&&de("Unexpected Fiber popped."),t.current=gm[Ha],gm[Ha]=null,jf[Ha]=null,Ha--}function Za(t,a,c){Ha++,gm[Ha]=t.current,jf[Ha]=c,t.current=a}var cc;cc={};var to={};Object.freeze(to);var Xs=mu(to),sa=mu(!1),Gf=to;function hc(t,a,c){return c&&Ws(a)?Gf:Xs.current}function Ts(t,a,c){{var m=t.stateNode;m.__reactInternalMemoizedUnmaskedChildContext=a,m.__reactInternalMemoizedMaskedChildContext=c}}function Es(t,a){{var c=t.type,m=c.contextTypes;if(!m)return to;var v=t.stateNode;if(v&&v.__reactInternalMemoizedUnmaskedChildContext===a)return v.__reactInternalMemoizedMaskedChildContext;var T={};for(var A in m)T[A]=a[A];{var k=dn(t)||"Unknown";ws(m,T,"context",k)}return v&&Ts(t,a,T),T}}function $f(){return sa.current}function Ws(t){{var a=t.childContextTypes;return a!=null}}function dc(t){oa(sa,t),oa(Xs,t)}function Td(t){oa(sa,t),oa(Xs,t)}function Qg(t,a,c){{if(Xs.current!==to)throw new Error("Unexpected context found on stack. This error is likely caused by a bug in React. Please file an issue.");Za(Xs,a,t),Za(sa,c,t)}}function e_(t,a,c){{var m=t.stateNode,v=a.childContextTypes;if(typeof m.getChildContext!="function"){{var T=dn(t)||"Unknown";cc[T]||(cc[T]=!0,de("%s.childContextTypes is specified but there is no getChildContext() method on the instance. You can either define getChildContext() on %s or remove childContextTypes from it.",T,T))}return c}var A=m.getChildContext();for(var k in A)if(!(k in v))throw new Error((dn(t)||"Unknown")+'.getChildContext(): key "'+k+'" is not defined in childContextTypes.');{var F=dn(t)||"Unknown";ws(v,A,"child context",F)}return an({},c,A)}}function _m(t){{var a=t.stateNode,c=a&&a.__reactInternalMemoizedMergedChildContext||to;return Gf=Xs.current,Za(Xs,c,t),Za(sa,sa.current,t),!0}}function t_(t,a,c){{var m=t.stateNode;if(!m)throw new Error("Expected to have an instance by this point. This error is likely caused by a bug in React. Please file an issue.");if(c){var v=e_(t,a,Gf);m.__reactInternalMemoizedMergedChildContext=v,oa(sa,t),oa(Xs,t),Za(Xs,v,t),Za(sa,c,t)}else oa(sa,t),Za(sa,c,t)}}function Xy(t){{if(!h(t)||t.tag!==Ft)throw new Error("Expected subtree parent to be a mounted class component. This error is likely caused by a bug in React. Please file an issue.");var a=t;do{switch(a.tag){case at:return a.stateNode.context;case Ft:{var c=a.type;if(Ws(c))return a.stateNode.__reactInternalMemoizedMergedChildContext;break}}a=a.return}while(a!==null);throw new Error("Found unexpected detached subtree parent. This error is likely caused by a bug in React. Please file an issue.")}}var fc=0,Ed=1,Cl=null,ym=!1,n=!1;function e(t){Cl===null?Cl=[t]:Cl.push(t)}function i(t){ym=!0,e(t)}function o(){ym&&l()}function l(){if(!n&&Cl!==null){n=!0;var t=0,a=ms();try{var c=!0,m=Cl;for(dr(Go);t<m.length;t++){var v=m[t];do v=v(c);while(v!==null)}Cl=null,ym=!1}catch(T){throw Cl!==null&&(Cl=Cl.slice(t+1)),C(X,l),T}finally{dr(a),n=!1}}return null}var d=[],p=0,_=null,x=0,b=[],S=0,M=null,R=1,I="";function L(t){return Fe(),(t.flags&Yl)!==Kt}function N(t){return Fe(),x}function $(){var t=I,a=R,c=a&~me(a);return c.toString(32)+t}function te(t,a){Fe(),d[p++]=x,d[p++]=_,_=t,x=a}function ce(t,a,c){Fe(),b[S++]=R,b[S++]=I,b[S++]=M,M=t;var m=R,v=I,T=oe(m)-1,A=m&~(1<<T),k=c+1,F=oe(a)+T;if(F>30){var H=T-T%5,ie=(1<<H)-1,xe=(A&ie).toString(32),ye=A>>H,Be=T-H,Ue=oe(a)+Be,Je=k<<Be,Dt=Je|ye,Qt=xe+v;R=1<<Ue|Dt,I=Qt}else{var Zt=k<<T,ii=Zt|A,Yn=v;R=1<<F|ii,I=Yn}}function ne(t){Fe();var a=t.return;if(a!==null){var c=1,m=0;te(t,c),ce(t,c,m)}}function oe(t){return 32-Vo(t)}function me(t){return 1<<oe(t)-1}function he(t){for(;t===_;)_=d[--p],d[p]=null,x=d[--p],d[p]=null;for(;t===M;)M=b[--S],b[S]=null,I=b[--S],b[S]=null,R=b[--S],b[S]=null}function Ae(){return Fe(),M!==null?{id:R,overflow:I}:null}function Se(t,a){Fe(),b[S++]=R,b[S++]=I,b[S++]=M,R=a.id,I=a.overflow,M=t}function Fe(){$n()||de("Expected to be hydrating. This is a bug in React. Please file an issue.")}var Xe=null,Me=null,Ve=!1,$e=!1,Ke=null;function tt(){Ve&&de("We should not be hydrating here. This is a bug in React. Please file a bug.")}function ke(){$e=!0}function st(){return $e}function jt(t){var a=t.stateNode.containerInfo;return Me=t0(a),Xe=t,Ve=!0,Ke=null,$e=!1,!0}function pt(t,a,c){return Me=Gy(a),Xe=t,Ve=!0,Ke=null,$e=!1,c!==null&&Se(t,c),!0}function Et(t,a){switch(t.tag){case at:{sc(t.stateNode.containerInfo,a);break}case bt:{var c=(t.mode&Mn)!==kt;Hg(t.type,t.memoizedProps,t.stateNode,a,c);break}case Ge:{var m=t.memoizedState;m.dehydrated!==null&&o0(m.dehydrated,a);break}}}function lt(t,a){Et(t,a);var c=t2();c.stateNode=a,c.return=t;var m=t.deletions;m===null?(t.deletions=[c],t.flags|=Ca):m.push(c)}function Gt(t,a){{if($e)return;switch(t.tag){case at:{var c=t.stateNode.containerInfo;switch(a.tag){case bt:var m=a.type;a.pendingProps,qy(c,m);break;case en:var v=a.pendingProps;mm(c,v);break}break}case bt:{var T=t.type,A=t.memoizedProps,k=t.stateNode;switch(a.tag){case bt:{var F=a.type,H=a.pendingProps,ie=(t.mode&Mn)!==kt;u0(T,A,k,F,H,ie);break}case en:{var xe=a.pendingProps,ye=(t.mode&Mn)!==kt;c0(T,A,k,xe,ye);break}}break}case Ge:{var Be=t.memoizedState,Ue=Be.dehydrated;if(Ue!==null)switch(a.tag){case bt:var Je=a.type;a.pendingProps,s0(Ue,Je);break;case en:var Dt=a.pendingProps;l0(Ue,Dt);break}break}default:return}}}function yn(t,a){a.flags=a.flags&~wa|Rr,Gt(t,a)}function mn(t,a){switch(t.tag){case bt:{var c=t.type;t.pendingProps;var m=dm(a,c);return m!==null?(t.stateNode=m,Xe=t,Me=jy(m),!0):!1}case en:{var v=t.pendingProps,T=Jx(a,v);return T!==null?(t.stateNode=T,Xe=t,Me=null,!0):!1}case Ge:{var A=Qx(a);if(A!==null){var k={dehydrated:A,treeContext:Ae(),retryLane:Hr};t.memoizedState=k;var F=n2(A);return F.return=t,t.child=F,Xe=t,Me=null,!0}return!1}default:return!1}}function pn(t){return(t.mode&Mn)!==kt&&(t.flags&wn)===Kt}function $t(t){throw new Error("Hydration failed because the initial UI does not match what was rendered on the server.")}function Qn(t){if(Ve){var a=Me;if(!a){pn(t)&&(Gt(Xe,t),$t()),yn(Xe,t),Ve=!1,Xe=t;return}var c=a;if(!mn(t,a)){pn(t)&&(Gt(Xe,t),$t()),a=Uf(c);var m=Xe;if(!a||!mn(t,a)){yn(Xe,t),Ve=!1,Xe=t;return}lt(m,c)}}}function Jt(t,a,c){var m=t.stateNode,v=!$e,T=n0(m,t.type,t.memoizedProps,a,c,t,v);return t.updateQueue=T,T!==null}function En(t){var a=t.stateNode,c=t.memoizedProps,m=$y(a,c,t);if(m){var v=Xe;if(v!==null)switch(v.tag){case at:{var T=v.stateNode.containerInfo,A=(v.mode&Mn)!==kt;$g(T,a,c,A);break}case bt:{var k=v.type,F=v.memoizedProps,H=v.stateNode,ie=(v.mode&Mn)!==kt;qg(k,F,H,a,c,ie);break}}}return m}function fi(t){var a=t.memoizedState,c=a!==null?a.dehydrated:null;if(!c)throw new Error("Expected to have a hydrated suspense instance. This error is likely caused by a bug in React. Please file an issue.");i0(c,t)}function ki(t){var a=t.memoizedState,c=a!==null?a.dehydrated:null;if(!c)throw new Error("Expected to have a hydrated suspense instance. This error is likely caused by a bug in React. Please file an issue.");return r0(c)}function bi(t){for(var a=t.return;a!==null&&a.tag!==bt&&a.tag!==at&&a.tag!==Ge;)a=a.return;Xe=a}function pi(t){if(t!==Xe)return!1;if(!Ve)return bi(t),Ve=!0,!1;if(t.tag!==at&&(t.tag!==bt||a0(t.type)&&!Ug(t.type,t.memoizedProps))){var a=Me;if(a)if(pn(t))Ji(t),$t();else for(;a;)lt(t,a),a=Uf(a)}return bi(t),t.tag===Ge?Me=ki(t):Me=Xe?Uf(t.stateNode):null,!0}function Fi(){return Ve&&Me!==null}function Ji(t){for(var a=Me;a;)Et(t,a),a=Uf(a)}function fr(){Xe=null,Me=null,Ve=!1,$e=!1}function ti(){Ke!==null&&(dT(Ke),Ke=null)}function $n(){return Ve}function nr(t){Ke===null?Ke=[t]:Ke.push(t)}var qn=li.ReactCurrentBatchConfig,Zi=null;function Fr(){return qn.transition}var An={recordUnsafeLifecycleWarnings:function(t,a){},flushPendingUnsafeLifecycleWarnings:function(){},recordLegacyContextWarning:function(t,a){},flushLegacyContextWarning:function(){},discardPendingWarnings:function(){}};{var pr=function(t){for(var a=null,c=t;c!==null;)c.mode&Wn&&(a=c),c=c.return;return a},wr=function(t){var a=[];return t.forEach(function(c){a.push(c)}),a.sort().join(", ")},Tr=[],Er=[],Zr=[],Sr=[],Xo=[],Ml=[],Ys=new Set;An.recordUnsafeLifecycleWarnings=function(t,a){Ys.has(t.type)||(typeof a.componentWillMount=="function"&&a.componentWillMount.__suppressDeprecationWarning!==!0&&Tr.push(t),t.mode&Wn&&typeof a.UNSAFE_componentWillMount=="function"&&Er.push(t),typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps.__suppressDeprecationWarning!==!0&&Zr.push(t),t.mode&Wn&&typeof a.UNSAFE_componentWillReceiveProps=="function"&&Sr.push(t),typeof a.componentWillUpdate=="function"&&a.componentWillUpdate.__suppressDeprecationWarning!==!0&&Xo.push(t),t.mode&Wn&&typeof a.UNSAFE_componentWillUpdate=="function"&&Ml.push(t))},An.flushPendingUnsafeLifecycleWarnings=function(){var t=new Set;Tr.length>0&&(Tr.forEach(function(ye){t.add(dn(ye)||"Component"),Ys.add(ye.type)}),Tr=[]);var a=new Set;Er.length>0&&(Er.forEach(function(ye){a.add(dn(ye)||"Component"),Ys.add(ye.type)}),Er=[]);var c=new Set;Zr.length>0&&(Zr.forEach(function(ye){c.add(dn(ye)||"Component"),Ys.add(ye.type)}),Zr=[]);var m=new Set;Sr.length>0&&(Sr.forEach(function(ye){m.add(dn(ye)||"Component"),Ys.add(ye.type)}),Sr=[]);var v=new Set;Xo.length>0&&(Xo.forEach(function(ye){v.add(dn(ye)||"Component"),Ys.add(ye.type)}),Xo=[]);var T=new Set;if(Ml.length>0&&(Ml.forEach(function(ye){T.add(dn(ye)||"Component"),Ys.add(ye.type)}),Ml=[]),a.size>0){var A=wr(a);de(`Using UNSAFE_componentWillMount in strict mode is not recommended and may indicate bugs in your code. See https://reactjs.org/link/unsafe-component-lifecycles for details.

* Move code with side effects to componentDidMount, and set initial state in the constructor.

Please update the following components: %s`,A)}if(m.size>0){var k=wr(m);de(`Using UNSAFE_componentWillReceiveProps in strict mode is not recommended and may indicate bugs in your code. See https://reactjs.org/link/unsafe-component-lifecycles for details.

* Move data fetching code or side effects to componentDidUpdate.
* If you're updating state whenever props change, refactor your code to use memoization techniques or move it to static getDerivedStateFromProps. Learn more at: https://reactjs.org/link/derived-state

Please update the following components: %s`,k)}if(T.size>0){var F=wr(T);de(`Using UNSAFE_componentWillUpdate in strict mode is not recommended and may indicate bugs in your code. See https://reactjs.org/link/unsafe-component-lifecycles for details.

* Move data fetching code or side effects to componentDidUpdate.

Please update the following components: %s`,F)}if(t.size>0){var H=wr(t);Sn(`componentWillMount has been renamed, and is not recommended for use. See https://reactjs.org/link/unsafe-component-lifecycles for details.

* Move code with side effects to componentDidMount, and set initial state in the constructor.
* Rename componentWillMount to UNSAFE_componentWillMount to suppress this warning in non-strict mode. In React 18.x, only the UNSAFE_ name will work. To rename all deprecated lifecycles to their new names, you can run \`npx react-codemod rename-unsafe-lifecycles\` in your project source folder.

Please update the following components: %s`,H)}if(c.size>0){var ie=wr(c);Sn(`componentWillReceiveProps has been renamed, and is not recommended for use. See https://reactjs.org/link/unsafe-component-lifecycles for details.

* Move data fetching code or side effects to componentDidUpdate.
* If you're updating state whenever props change, refactor your code to use memoization techniques or move it to static getDerivedStateFromProps. Learn more at: https://reactjs.org/link/derived-state
* Rename componentWillReceiveProps to UNSAFE_componentWillReceiveProps to suppress this warning in non-strict mode. In React 18.x, only the UNSAFE_ name will work. To rename all deprecated lifecycles to their new names, you can run \`npx react-codemod rename-unsafe-lifecycles\` in your project source folder.

Please update the following components: %s`,ie)}if(v.size>0){var xe=wr(v);Sn(`componentWillUpdate has been renamed, and is not recommended for use. See https://reactjs.org/link/unsafe-component-lifecycles for details.

* Move data fetching code or side effects to componentDidUpdate.
* Rename componentWillUpdate to UNSAFE_componentWillUpdate to suppress this warning in non-strict mode. In React 18.x, only the UNSAFE_ name will work. To rename all deprecated lifecycles to their new names, you can run \`npx react-codemod rename-unsafe-lifecycles\` in your project source folder.

Please update the following components: %s`,xe)}};var pc=new Map,n_=new Set;An.recordLegacyContextWarning=function(t,a){var c=pr(t);if(c===null){de("Expected to find a StrictMode component in a strict mode tree. This error is likely caused by a bug in React. Please file an issue.");return}if(!n_.has(t.type)){var m=pc.get(c);(t.type.contextTypes!=null||t.type.childContextTypes!=null||a!==null&&typeof a.getChildContext=="function")&&(m===void 0&&(m=[],pc.set(c,m)),m.push(t))}},An.flushLegacyContextWarning=function(){pc.forEach(function(t,a){if(t.length!==0){var c=t[0],m=new Set;t.forEach(function(T){m.add(dn(T)||"Component"),n_.add(T.type)});var v=wr(m);try{Yi(c),de(`Legacy context API has been detected within a strict-mode tree.

The old API will be supported in all 16.x releases, but applications using it should migrate to the new version.

Please update the following components: %s

Learn more about this warning here: https://reactjs.org/link/legacy-context`,v)}finally{Ci()}}})},An.discardPendingWarnings=function(){Tr=[],Er=[],Zr=[],Sr=[],Xo=[],Ml=[],pc=new Map}}function Ss(t,a){if(t&&t.defaultProps){var c=an({},a),m=t.defaultProps;for(var v in m)c[v]===void 0&&(c[v]=m[v]);return c}return a}var vm=mu(null),qf;qf={};var Sd=null,no=null,xm=null,Al=!1;function Cd(){Sd=null,no=null,xm=null,Al=!1}function bm(){Al=!0}function gu(){Al=!1}function wm(t,a,c){Za(vm,a._currentValue,t),a._currentValue=c,a._currentRenderer!==void 0&&a._currentRenderer!==null&&a._currentRenderer!==qf&&de("Detected multiple renderers concurrently rendering the same context provider. This is currently unsupported."),a._currentRenderer=qf}function i_(t,a){var c=vm.current;oa(vm,a),t._currentValue=c}function Xa(t,a,c){for(var m=t;m!==null;){var v=m.alternate;if(qs(m.childLanes,a)?v!==null&&!qs(v.childLanes,a)&&(v.childLanes=Tn(v.childLanes,a)):(m.childLanes=Tn(m.childLanes,a),v!==null&&(v.childLanes=Tn(v.childLanes,a))),m===c)break;m=m.return}m!==c&&de("Expected to find the propagation root when scheduling context work. This error is likely caused by a bug in React. Please file an issue.")}function Mo(t,a,c){Hf(t,a,c)}function Hf(t,a,c){var m=t.child;for(m!==null&&(m.return=t);m!==null;){var v=void 0,T=m.dependencies;if(T!==null){v=m.child;for(var A=T.firstContext;A!==null;){if(A.context===a){if(m.tag===Ft){var k=zr(c),F=yh(vi,k);F.tag=Yy;var H=m.updateQueue;if(H!==null){var ie=H.shared,xe=ie.pending;xe===null?F.next=F:(F.next=xe.next,xe.next=F),ie.pending=F}}m.lanes=Tn(m.lanes,c);var ye=m.alternate;ye!==null&&(ye.lanes=Tn(ye.lanes,c)),Xa(m.return,c,t),T.lanes=Tn(T.lanes,c);break}A=A.next}}else if(m.tag===zn)v=m.type===t.type?null:m.child;else if(m.tag===In){var Be=m.return;if(Be===null)throw new Error("We just came from a parent so we must have had a parent. This is a bug in React.");Be.lanes=Tn(Be.lanes,c);var Ue=Be.alternate;Ue!==null&&(Ue.lanes=Tn(Ue.lanes,c)),Xa(Be,c,t),v=m.sibling}else v=m.child;if(v!==null)v.return=m;else for(v=m;v!==null;){if(v===t){v=null;break}var Je=v.sibling;if(Je!==null){Je.return=v.return,v=Je;break}v=v.return}m=v}}function mc(t,a){Sd=t,no=null,xm=null;var c=t.dependencies;if(c!==null){var m=c.firstContext;m!==null&&(To(c.lanes,a)&&__(),c.firstContext=null)}}function Ur(t){Al&&de("Context can only be read while React is rendering. In classes, you can read it in the render method or getDerivedStateFromProps. In function components, you can read it directly in the function body, but not inside Hooks like useReducer() or useMemo().");var a=t._currentValue;if(xm!==t){var c={context:t,memoizedValue:a,next:null};if(no===null){if(Sd===null)throw new Error("Context can only be read while React is rendering. In classes, you can read it in the render method or getDerivedStateFromProps. In function components, you can read it directly in the function body, but not inside Hooks like useReducer() or useMemo().");no=c,Sd.dependencies={lanes:rt,firstContext:c}}else no=no.next=c}return a}var Wo=null;function d0(t){Wo===null?Wo=[t]:Wo.push(t)}function cE(){if(Wo!==null){for(var t=0;t<Wo.length;t++){var a=Wo[t],c=a.interleaved;if(c!==null){a.interleaved=null;var m=c.next,v=a.pending;if(v!==null){var T=v.next;v.next=m,c.next=T}a.pending=c}}Wo=null}}function T1(t,a,c,m){var v=a.interleaved;return v===null?(c.next=c,d0(a)):(c.next=v.next,v.next=c),a.interleaved=c,Wy(t,m)}function hE(t,a,c,m){var v=a.interleaved;v===null?(c.next=c,d0(a)):(c.next=v.next,v.next=c),a.interleaved=c}function dE(t,a,c,m){var v=a.interleaved;return v===null?(c.next=c,d0(a)):(c.next=v.next,v.next=c),a.interleaved=c,Wy(t,m)}function Cs(t,a){return Wy(t,a)}var fE=Wy;function Wy(t,a){t.lanes=Tn(t.lanes,a);var c=t.alternate;c!==null&&(c.lanes=Tn(c.lanes,a)),c===null&&(t.flags&(Rr|wa))!==Kt&&ET(t);for(var m=t,v=t.return;v!==null;)v.childLanes=Tn(v.childLanes,a),c=v.alternate,c!==null?c.childLanes=Tn(c.childLanes,a):(v.flags&(Rr|wa))!==Kt&&ET(t),m=v,v=v.return;if(m.tag===at){var T=m.stateNode;return T}else return null}var E1=0,S1=1,Yy=2,f0=3,Ky=!1,p0,Jy;p0=!1,Jy=null;function m0(t){var a={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:rt},effects:null};t.updateQueue=a}function C1(t,a){var c=a.updateQueue,m=t.updateQueue;if(c===m){var v={baseState:m.baseState,firstBaseUpdate:m.firstBaseUpdate,lastBaseUpdate:m.lastBaseUpdate,shared:m.shared,effects:m.effects};a.updateQueue=v}}function yh(t,a){var c={eventTime:t,lane:a,tag:E1,payload:null,callback:null,next:null};return c}function Md(t,a,c){var m=t.updateQueue;if(m===null)return null;var v=m.shared;if(Jy===v&&!p0&&(de("An update (setState, replaceState, or forceUpdate) was scheduled from inside an update function. Update functions should be pure, with zero side-effects. Consider using componentDidUpdate or a callback."),p0=!0),fC()){var T=v.pending;return T===null?a.next=a:(a.next=T.next,T.next=a),v.pending=a,fE(t,c)}else return dE(t,v,a,c)}function Qy(t,a,c){var m=a.updateQueue;if(m!==null){var v=m.shared;if(Gs(c)){var T=v.lanes;T=Up(T,t.pendingLanes);var A=Tn(T,c);v.lanes=A,Zh(t,A)}}}function g0(t,a){var c=t.updateQueue,m=t.alternate;if(m!==null){var v=m.updateQueue;if(c===v){var T=null,A=null,k=c.firstBaseUpdate;if(k!==null){var F=k;do{var H={eventTime:F.eventTime,lane:F.lane,tag:F.tag,payload:F.payload,callback:F.callback,next:null};A===null?T=A=H:(A.next=H,A=H),F=F.next}while(F!==null);A===null?T=A=a:(A.next=a,A=a)}else T=A=a;c={baseState:v.baseState,firstBaseUpdate:T,lastBaseUpdate:A,shared:v.shared,effects:v.effects},t.updateQueue=c;return}}var ie=c.lastBaseUpdate;ie===null?c.firstBaseUpdate=a:ie.next=a,c.lastBaseUpdate=a}function pE(t,a,c,m,v,T){switch(c.tag){case S1:{var A=c.payload;if(typeof A=="function"){bm();var k=A.call(T,m,v);{if(t.mode&Wn){Ze(!0);try{A.call(T,m,v)}finally{Ze(!1)}}gu()}return k}return A}case f0:t.flags=t.flags&~ia|wn;case E1:{var F=c.payload,H;if(typeof F=="function"){bm(),H=F.call(T,m,v);{if(t.mode&Wn){Ze(!0);try{F.call(T,m,v)}finally{Ze(!1)}}gu()}}else H=F;return H==null?m:an({},m,H)}case Yy:return Ky=!0,m}return m}function ev(t,a,c,m){var v=t.updateQueue;Ky=!1,Jy=v.shared;var T=v.firstBaseUpdate,A=v.lastBaseUpdate,k=v.shared.pending;if(k!==null){v.shared.pending=null;var F=k,H=F.next;F.next=null,A===null?T=H:A.next=H,A=F;var ie=t.alternate;if(ie!==null){var xe=ie.updateQueue,ye=xe.lastBaseUpdate;ye!==A&&(ye===null?xe.firstBaseUpdate=H:ye.next=H,xe.lastBaseUpdate=F)}}if(T!==null){var Be=v.baseState,Ue=rt,Je=null,Dt=null,Qt=null,Zt=T;do{var ii=Zt.lane,Yn=Zt.eventTime;if(qs(m,ii)){if(Qt!==null){var Qe={eventTime:Yn,lane:Br,tag:Zt.tag,payload:Zt.payload,callback:Zt.callback,next:null};Qt=Qt.next=Qe}Be=pE(t,v,Zt,Be,a,c);var Ie=Zt.callback;if(Ie!==null&&Zt.lane!==Br){t.flags|=pl;var ut=v.effects;ut===null?v.effects=[Zt]:ut.push(Zt)}}else{var ze={eventTime:Yn,lane:ii,tag:Zt.tag,payload:Zt.payload,callback:Zt.callback,next:null};Qt===null?(Dt=Qt=ze,Je=Be):Qt=Qt.next=ze,Ue=Tn(Ue,ii)}if(Zt=Zt.next,Zt===null){if(k=v.shared.pending,k===null)break;var zt=k,Ct=zt.next;zt.next=null,Zt=Ct,v.lastBaseUpdate=zt,v.shared.pending=null}}while(!0);Qt===null&&(Je=Be),v.baseState=Je,v.firstBaseUpdate=Dt,v.lastBaseUpdate=Qt;var un=v.shared.interleaved;if(un!==null){var vn=un;do Ue=Tn(Ue,vn.lane),vn=vn.next;while(vn!==un)}else T===null&&(v.shared.lanes=rt);R_(Ue),t.lanes=Ue,t.memoizedState=Be}Jy=null}function mE(t,a){if(typeof t!="function")throw new Error("Invalid argument passed as callback. Expected a function. Instead "+("received: "+t));t.call(a)}function M1(){Ky=!1}function tv(){return Ky}function A1(t,a,c){var m=a.effects;if(a.effects=null,m!==null)for(var v=0;v<m.length;v++){var T=m[v],A=T.callback;A!==null&&(T.callback=null,mE(A,c))}}var _0={},R1=new At.Component().refs,y0,v0,x0,b0,w0,D1,nv,T0,E0,S0;{y0=new Set,v0=new Set,x0=new Set,b0=new Set,T0=new Set,w0=new Set,E0=new Set,S0=new Set;var z1=new Set;nv=function(t,a){if(!(t===null||typeof t=="function")){var c=a+"_"+t;z1.has(c)||(z1.add(c),de("%s(...): Expected the last optional `callback` argument to be a function. Instead received: %s.",a,t))}},D1=function(t,a){if(a===void 0){var c=Dn(t)||"Component";w0.has(c)||(w0.add(c),de("%s.getDerivedStateFromProps(): A valid state object (or null) must be returned. You have returned undefined.",c))}},Object.defineProperty(_0,"_processChildContext",{enumerable:!1,value:function(){throw new Error("_processChildContext is not available in React 16+. This likely means you have multiple copies of React and are attempting to nest a React 15 tree inside a React 16 tree using unstable_renderSubtreeIntoContainer, which isn't supported. Try to make sure you have only one copy of React (and ideally, switch to ReactDOM.createPortal).")}}),Object.freeze(_0)}function C0(t,a,c,m){var v=t.memoizedState,T=c(m,v);{if(t.mode&Wn){Ze(!0);try{T=c(m,v)}finally{Ze(!1)}}D1(a,T)}var A=T==null?v:an({},v,T);if(t.memoizedState=A,t.lanes===rt){var k=t.updateQueue;k.baseState=A}}var M0={isMounted:r,enqueueSetState:function(t,a,c){var m=Xl(t),v=Jo(),T=Od(m),A=yh(v,T);A.payload=a,c!=null&&(nv(c,"setState"),A.callback=c);var k=Md(m,A,T);k!==null&&(Pa(k,m,T,v),Qy(k,m,T)),di(m,T)},enqueueReplaceState:function(t,a,c){var m=Xl(t),v=Jo(),T=Od(m),A=yh(v,T);A.tag=S1,A.payload=a,c!=null&&(nv(c,"replaceState"),A.callback=c);var k=Md(m,A,T);k!==null&&(Pa(k,m,T,v),Qy(k,m,T)),di(m,T)},enqueueForceUpdate:function(t,a){var c=Xl(t),m=Jo(),v=Od(c),T=yh(m,v);T.tag=Yy,a!=null&&(nv(a,"forceUpdate"),T.callback=a);var A=Md(c,T,v);A!==null&&(Pa(A,c,v,m),Qy(A,c,v)),Ta(c,v)}};function I1(t,a,c,m,v,T,A){var k=t.stateNode;if(typeof k.shouldComponentUpdate=="function"){var F=k.shouldComponentUpdate(m,T,A);{if(t.mode&Wn){Ze(!0);try{F=k.shouldComponentUpdate(m,T,A)}finally{Ze(!1)}}F===void 0&&de("%s.shouldComponentUpdate(): Returned undefined instead of a boolean value. Make sure to return true or false.",Dn(a)||"Component")}return F}return a.prototype&&a.prototype.isPureReactComponent?!ud(c,m)||!ud(v,T):!0}function gE(t,a,c){var m=t.stateNode;{var v=Dn(a)||"Component",T=m.render;T||(a.prototype&&typeof a.prototype.render=="function"?de("%s(...): No `render` method found on the returned component instance: did you accidentally return an object from the constructor?",v):de("%s(...): No `render` method found on the returned component instance: you may have forgotten to define `render`.",v)),m.getInitialState&&!m.getInitialState.isReactClassApproved&&!m.state&&de("getInitialState was defined on %s, a plain JavaScript class. This is only supported for classes created using React.createClass. Did you mean to define a state property instead?",v),m.getDefaultProps&&!m.getDefaultProps.isReactClassApproved&&de("getDefaultProps was defined on %s, a plain JavaScript class. This is only supported for classes created using React.createClass. Use a static property to define defaultProps instead.",v),m.propTypes&&de("propTypes was defined as an instance property on %s. Use a static property to define propTypes instead.",v),m.contextType&&de("contextType was defined as an instance property on %s. Use a static property to define contextType instead.",v),m.contextTypes&&de("contextTypes was defined as an instance property on %s. Use a static property to define contextTypes instead.",v),a.contextType&&a.contextTypes&&!E0.has(a)&&(E0.add(a),de("%s declares both contextTypes and contextType static properties. The legacy contextTypes property will be ignored.",v)),typeof m.componentShouldUpdate=="function"&&de("%s has a method called componentShouldUpdate(). Did you mean shouldComponentUpdate()? The name is phrased as a question because the function is expected to return a value.",v),a.prototype&&a.prototype.isPureReactComponent&&typeof m.shouldComponentUpdate<"u"&&de("%s has a method called shouldComponentUpdate(). shouldComponentUpdate should not be used when extending React.PureComponent. Please extend React.Component if shouldComponentUpdate is used.",Dn(a)||"A pure component"),typeof m.componentDidUnmount=="function"&&de("%s has a method called componentDidUnmount(). But there is no such lifecycle method. Did you mean componentWillUnmount()?",v),typeof m.componentDidReceiveProps=="function"&&de("%s has a method called componentDidReceiveProps(). But there is no such lifecycle method. If you meant to update the state in response to changing props, use componentWillReceiveProps(). If you meant to fetch data or run side-effects or mutations after React has updated the UI, use componentDidUpdate().",v),typeof m.componentWillRecieveProps=="function"&&de("%s has a method called componentWillRecieveProps(). Did you mean componentWillReceiveProps()?",v),typeof m.UNSAFE_componentWillRecieveProps=="function"&&de("%s has a method called UNSAFE_componentWillRecieveProps(). Did you mean UNSAFE_componentWillReceiveProps()?",v);var A=m.props!==c;m.props!==void 0&&A&&de("%s(...): When calling super() in `%s`, make sure to pass up the same props that your component's constructor was passed.",v,v),m.defaultProps&&de("Setting defaultProps as an instance property on %s is not supported and will be ignored. Instead, define defaultProps as a static property on %s.",v,v),typeof m.getSnapshotBeforeUpdate=="function"&&typeof m.componentDidUpdate!="function"&&!x0.has(a)&&(x0.add(a),de("%s: getSnapshotBeforeUpdate() should be used with componentDidUpdate(). This component defines getSnapshotBeforeUpdate() only.",Dn(a))),typeof m.getDerivedStateFromProps=="function"&&de("%s: getDerivedStateFromProps() is defined as an instance method and will be ignored. Instead, declare it as a static method.",v),typeof m.getDerivedStateFromError=="function"&&de("%s: getDerivedStateFromError() is defined as an instance method and will be ignored. Instead, declare it as a static method.",v),typeof a.getSnapshotBeforeUpdate=="function"&&de("%s: getSnapshotBeforeUpdate() is defined as a static method and will be ignored. Instead, declare it as an instance method.",v);var k=m.state;k&&(typeof k!="object"||It(k))&&de("%s.state: must be set to an object or null",v),typeof m.getChildContext=="function"&&typeof a.childContextTypes!="object"&&de("%s.getChildContext(): childContextTypes must be defined in order to use getChildContext().",v)}}function k1(t,a){a.updater=M0,t.stateNode=a,ba(a,t),a._reactInternalInstance=_0}function L1(t,a,c){var m=!1,v=to,T=to,A=a.contextType;if("contextType"in a){var k=A===null||A!==void 0&&A.$$typeof===_e&&A._context===void 0;if(!k&&!S0.has(a)){S0.add(a);var F="";A===void 0?F=" However, it is set to undefined. This can be caused by a typo or by mixing up named and default imports. This can also happen due to a circular dependency, so try moving the createContext() call to a separate file.":typeof A!="object"?F=" However, it is set to a "+typeof A+".":A.$$typeof===ue?F=" Did you accidentally pass the Context.Provider instead?":A._context!==void 0?F=" Did you accidentally pass the Context.Consumer instead?":F=" However, it is set to an object with keys {"+Object.keys(A).join(", ")+"}.",de("%s defines an invalid contextType. contextType should point to the Context object returned by React.createContext().%s",Dn(a)||"Component",F)}}if(typeof A=="object"&&A!==null)T=Ur(A);else{v=hc(t,a,!0);var H=a.contextTypes;m=H!=null,T=m?Es(t,v):to}var ie=new a(c,T);if(t.mode&Wn){Ze(!0);try{ie=new a(c,T)}finally{Ze(!1)}}var xe=t.memoizedState=ie.state!==null&&ie.state!==void 0?ie.state:null;k1(t,ie);{if(typeof a.getDerivedStateFromProps=="function"&&xe===null){var ye=Dn(a)||"Component";v0.has(ye)||(v0.add(ye),de("`%s` uses `getDerivedStateFromProps` but its initial state is %s. This is not recommended. Instead, define the initial state by assigning an object to `this.state` in the constructor of `%s`. This ensures that `getDerivedStateFromProps` arguments have a consistent shape.",ye,ie.state===null?"null":"undefined",ye))}if(typeof a.getDerivedStateFromProps=="function"||typeof ie.getSnapshotBeforeUpdate=="function"){var Be=null,Ue=null,Je=null;if(typeof ie.componentWillMount=="function"&&ie.componentWillMount.__suppressDeprecationWarning!==!0?Be="componentWillMount":typeof ie.UNSAFE_componentWillMount=="function"&&(Be="UNSAFE_componentWillMount"),typeof ie.componentWillReceiveProps=="function"&&ie.componentWillReceiveProps.__suppressDeprecationWarning!==!0?Ue="componentWillReceiveProps":typeof ie.UNSAFE_componentWillReceiveProps=="function"&&(Ue="UNSAFE_componentWillReceiveProps"),typeof ie.componentWillUpdate=="function"&&ie.componentWillUpdate.__suppressDeprecationWarning!==!0?Je="componentWillUpdate":typeof ie.UNSAFE_componentWillUpdate=="function"&&(Je="UNSAFE_componentWillUpdate"),Be!==null||Ue!==null||Je!==null){var Dt=Dn(a)||"Component",Qt=typeof a.getDerivedStateFromProps=="function"?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";b0.has(Dt)||(b0.add(Dt),de(`Unsafe legacy lifecycles will not be called for components using new component APIs.

%s uses %s but also contains the following legacy lifecycles:%s%s%s

The above lifecycles should be removed. Learn more about this warning here:
https://reactjs.org/link/unsafe-component-lifecycles`,Dt,Qt,Be!==null?`
  `+Be:"",Ue!==null?`
  `+Ue:"",Je!==null?`
  `+Je:""))}}}return m&&Ts(t,v,T),ie}function _E(t,a){var c=a.state;typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),c!==a.state&&(de("%s.componentWillMount(): Assigning directly to this.state is deprecated (except inside a component's constructor). Use setState instead.",dn(t)||"Component"),M0.enqueueReplaceState(a,a.state,null))}function O1(t,a,c,m){var v=a.state;if(typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(c,m),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(c,m),a.state!==v){{var T=dn(t)||"Component";y0.has(T)||(y0.add(T),de("%s.componentWillReceiveProps(): Assigning directly to this.state is deprecated (except inside a component's constructor). Use setState instead.",T))}M0.enqueueReplaceState(a,a.state,null)}}function A0(t,a,c,m){gE(t,a,c);var v=t.stateNode;v.props=c,v.state=t.memoizedState,v.refs=R1,m0(t);var T=a.contextType;if(typeof T=="object"&&T!==null)v.context=Ur(T);else{var A=hc(t,a,!0);v.context=Es(t,A)}{if(v.state===c){var k=Dn(a)||"Component";T0.has(k)||(T0.add(k),de("%s: It is not recommended to assign props directly to state because updates to props won't be reflected in state. In most cases, it is better to use props directly.",k))}t.mode&Wn&&An.recordLegacyContextWarning(t,v),An.recordUnsafeLifecycleWarnings(t,v)}v.state=t.memoizedState;var F=a.getDerivedStateFromProps;if(typeof F=="function"&&(C0(t,a,F,c),v.state=t.memoizedState),typeof a.getDerivedStateFromProps!="function"&&typeof v.getSnapshotBeforeUpdate!="function"&&(typeof v.UNSAFE_componentWillMount=="function"||typeof v.componentWillMount=="function")&&(_E(t,v),ev(t,c,v,m),v.state=t.memoizedState),typeof v.componentDidMount=="function"){var H=jn;H|=cs,(t.mode&vr)!==kt&&(H|=Uo),t.flags|=H}}function yE(t,a,c,m){var v=t.stateNode,T=t.memoizedProps;v.props=T;var A=v.context,k=a.contextType,F=to;if(typeof k=="object"&&k!==null)F=Ur(k);else{var H=hc(t,a,!0);F=Es(t,H)}var ie=a.getDerivedStateFromProps,xe=typeof ie=="function"||typeof v.getSnapshotBeforeUpdate=="function";!xe&&(typeof v.UNSAFE_componentWillReceiveProps=="function"||typeof v.componentWillReceiveProps=="function")&&(T!==c||A!==F)&&O1(t,v,c,F),M1();var ye=t.memoizedState,Be=v.state=ye;if(ev(t,c,v,m),Be=t.memoizedState,T===c&&ye===Be&&!$f()&&!tv()){if(typeof v.componentDidMount=="function"){var Ue=jn;Ue|=cs,(t.mode&vr)!==kt&&(Ue|=Uo),t.flags|=Ue}return!1}typeof ie=="function"&&(C0(t,a,ie,c),Be=t.memoizedState);var Je=tv()||I1(t,a,T,c,ye,Be,F);if(Je){if(!xe&&(typeof v.UNSAFE_componentWillMount=="function"||typeof v.componentWillMount=="function")&&(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"){var Dt=jn;Dt|=cs,(t.mode&vr)!==kt&&(Dt|=Uo),t.flags|=Dt}}else{if(typeof v.componentDidMount=="function"){var Qt=jn;Qt|=cs,(t.mode&vr)!==kt&&(Qt|=Uo),t.flags|=Qt}t.memoizedProps=c,t.memoizedState=Be}return v.props=c,v.state=Be,v.context=F,Je}function vE(t,a,c,m,v){var T=a.stateNode;C1(t,a);var A=a.memoizedProps,k=a.type===a.elementType?A:Ss(a.type,A);T.props=k;var F=a.pendingProps,H=T.context,ie=c.contextType,xe=to;if(typeof ie=="object"&&ie!==null)xe=Ur(ie);else{var ye=hc(a,c,!0);xe=Es(a,ye)}var Be=c.getDerivedStateFromProps,Ue=typeof Be=="function"||typeof T.getSnapshotBeforeUpdate=="function";!Ue&&(typeof T.UNSAFE_componentWillReceiveProps=="function"||typeof T.componentWillReceiveProps=="function")&&(A!==F||H!==xe)&&O1(a,T,m,xe),M1();var Je=a.memoizedState,Dt=T.state=Je;if(ev(a,m,T,v),Dt=a.memoizedState,A===F&&Je===Dt&&!$f()&&!tv()&&!ca)return typeof T.componentDidUpdate=="function"&&(A!==t.memoizedProps||Je!==t.memoizedState)&&(a.flags|=jn),typeof T.getSnapshotBeforeUpdate=="function"&&(A!==t.memoizedProps||Je!==t.memoizedState)&&(a.flags|=ml),!1;typeof Be=="function"&&(C0(a,c,Be,m),Dt=a.memoizedState);var Qt=tv()||I1(a,c,k,m,Je,Dt,xe)||ca;return Qt?(!Ue&&(typeof T.UNSAFE_componentWillUpdate=="function"||typeof T.componentWillUpdate=="function")&&(typeof T.componentWillUpdate=="function"&&T.componentWillUpdate(m,Dt,xe),typeof T.UNSAFE_componentWillUpdate=="function"&&T.UNSAFE_componentWillUpdate(m,Dt,xe)),typeof T.componentDidUpdate=="function"&&(a.flags|=jn),typeof T.getSnapshotBeforeUpdate=="function"&&(a.flags|=ml)):(typeof T.componentDidUpdate=="function"&&(A!==t.memoizedProps||Je!==t.memoizedState)&&(a.flags|=jn),typeof T.getSnapshotBeforeUpdate=="function"&&(A!==t.memoizedProps||Je!==t.memoizedState)&&(a.flags|=ml),a.memoizedProps=m,a.memoizedState=Dt),T.props=m,T.state=Dt,T.context=xe,Qt}var R0,D0,z0,I0,k0,P1=function(t,a){};R0=!1,D0=!1,z0={},I0={},k0={},P1=function(t,a){if(!(t===null||typeof t!="object")&&!(!t._store||t._store.validated||t.key!=null)){if(typeof t._store!="object")throw new Error("React Component in warnForMissingKey should have a _store. This error is likely caused by a bug in React. Please file an issue.");t._store.validated=!0;var c=dn(a)||"Component";I0[c]||(I0[c]=!0,de('Each child in a list should have a unique "key" prop. See https://reactjs.org/link/warning-keys for more information.'))}};function r_(t,a,c){var m=c.ref;if(m!==null&&typeof m!="function"&&typeof m!="object"){if((t.mode&Wn||or)&&!(c._owner&&c._self&&c._owner.stateNode!==c._self)){var v=dn(t)||"Component";z0[v]||(de('A string ref, "%s", has been found within a strict mode tree. String refs are a source of potential bugs and should be avoided. We recommend using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',m),z0[v]=!0)}if(c._owner){var T=c._owner,A;if(T){var k=T;if(k.tag!==Ft)throw new Error("Function components cannot have string refs. We recommend using useRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref");A=k.stateNode}if(!A)throw new Error("Missing owner for string ref "+m+". This error is likely caused by a bug in React. Please file an issue.");var F=A;gr(m,"ref");var H=""+m;if(a!==null&&a.ref!==null&&typeof a.ref=="function"&&a.ref._stringRef===H)return a.ref;var ie=function(xe){var ye=F.refs;ye===R1&&(ye=F.refs={}),xe===null?delete ye[H]:ye[H]=xe};return ie._stringRef=H,ie}else{if(typeof m!="string")throw new Error("Expected ref to be a function, a string, an object returned by React.createRef(), or null.");if(!c._owner)throw new Error("Element ref was specified as a string ("+m+`) but no owner was set. This could happen for one of the following reasons:
1. You may be adding a ref to a function component
2. You may be adding a ref to a component that was not created inside a component's render method
3. You have multiple copies of React loaded
See https://reactjs.org/link/refs-must-have-owner for more information.`)}}return m}function iv(t,a){var c=Object.prototype.toString.call(a);throw new Error("Objects are not valid as a React child (found: "+(c==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":c)+"). If you meant to render a collection of children, use an array instead.")}function rv(t){{var a=dn(t)||"Component";if(k0[a])return;k0[a]=!0,de("Functions are not valid as a React child. This may happen if you return a Component instead of <Component /> from render. Or maybe you meant to call this function rather than return it.")}}function B1(t){var a=t._payload,c=t._init;return c(a)}function F1(t){function a(ze,Qe){if(t){var Ie=ze.deletions;Ie===null?(ze.deletions=[Qe],ze.flags|=Ca):Ie.push(Qe)}}function c(ze,Qe){if(!t)return null;for(var Ie=Qe;Ie!==null;)a(ze,Ie),Ie=Ie.sibling;return null}function m(ze,Qe){for(var Ie=new Map,ut=Qe;ut!==null;)ut.key!==null?Ie.set(ut.key,ut):Ie.set(ut.index,ut),ut=ut.sibling;return Ie}function v(ze,Qe){var Ie=ep(ze,Qe);return Ie.index=0,Ie.sibling=null,Ie}function T(ze,Qe,Ie){if(ze.index=Ie,!t)return ze.flags|=Yl,Qe;var ut=ze.alternate;if(ut!==null){var zt=ut.index;return zt<Qe?(ze.flags|=Rr,Qe):zt}else return ze.flags|=Rr,Qe}function A(ze){return t&&ze.alternate===null&&(ze.flags|=Rr),ze}function k(ze,Qe,Ie,ut){if(Qe===null||Qe.tag!==en){var zt=o1(Ie,ze.mode,ut);return zt.return=ze,zt}else{var Ct=v(Qe,Ie);return Ct.return=ze,Ct}}function F(ze,Qe,Ie,ut){var zt=Ie.type;if(zt===Z)return ie(ze,Qe,Ie.props.children,ut,Ie.key);if(Qe!==null&&(Qe.elementType===zt||AT(Qe,Ie)||typeof zt=="object"&&zt!==null&&zt.$$typeof===ot&&B1(zt)===Qe.type)){var Ct=v(Qe,Ie.props);return Ct.ref=r_(ze,Qe,Ie),Ct.return=ze,Ct._debugSource=Ie._source,Ct._debugOwner=Ie._owner,Ct}var un=a1(Ie,ze.mode,ut);return un.ref=r_(ze,Qe,Ie),un.return=ze,un}function H(ze,Qe,Ie,ut){if(Qe===null||Qe.tag!==gt||Qe.stateNode.containerInfo!==Ie.containerInfo||Qe.stateNode.implementation!==Ie.implementation){var zt=s1(Ie,ze.mode,ut);return zt.return=ze,zt}else{var Ct=v(Qe,Ie.children||[]);return Ct.return=ze,Ct}}function ie(ze,Qe,Ie,ut,zt){if(Qe===null||Qe.tag!==Ir){var Ct=Bd(Ie,ze.mode,ut,zt);return Ct.return=ze,Ct}else{var un=v(Qe,Ie);return un.return=ze,un}}function xe(ze,Qe,Ie){if(typeof Qe=="string"&&Qe!==""||typeof Qe=="number"){var ut=o1(""+Qe,ze.mode,Ie);return ut.return=ze,ut}if(typeof Qe=="object"&&Qe!==null){switch(Qe.$$typeof){case K:{var zt=a1(Qe,ze.mode,Ie);return zt.ref=r_(ze,null,Qe),zt.return=ze,zt}case O:{var Ct=s1(Qe,ze.mode,Ie);return Ct.return=ze,Ct}case ot:{var un=Qe._payload,vn=Qe._init;return xe(ze,vn(un),Ie)}}if(It(Qe)||_a(Qe)){var qi=Bd(Qe,ze.mode,Ie,null);return qi.return=ze,qi}iv(ze,Qe)}return typeof Qe=="function"&&rv(ze),null}function ye(ze,Qe,Ie,ut){var zt=Qe!==null?Qe.key:null;if(typeof Ie=="string"&&Ie!==""||typeof Ie=="number")return zt!==null?null:k(ze,Qe,""+Ie,ut);if(typeof Ie=="object"&&Ie!==null){switch(Ie.$$typeof){case K:return Ie.key===zt?F(ze,Qe,Ie,ut):null;case O:return Ie.key===zt?H(ze,Qe,Ie,ut):null;case ot:{var Ct=Ie._payload,un=Ie._init;return ye(ze,Qe,un(Ct),ut)}}if(It(Ie)||_a(Ie))return zt!==null?null:ie(ze,Qe,Ie,ut,null);iv(ze,Ie)}return typeof Ie=="function"&&rv(ze),null}function Be(ze,Qe,Ie,ut,zt){if(typeof ut=="string"&&ut!==""||typeof ut=="number"){var Ct=ze.get(Ie)||null;return k(Qe,Ct,""+ut,zt)}if(typeof ut=="object"&&ut!==null){switch(ut.$$typeof){case K:{var un=ze.get(ut.key===null?Ie:ut.key)||null;return F(Qe,un,ut,zt)}case O:{var vn=ze.get(ut.key===null?Ie:ut.key)||null;return H(Qe,vn,ut,zt)}case ot:var qi=ut._payload,wi=ut._init;return Be(ze,Qe,Ie,wi(qi),zt)}if(It(ut)||_a(ut)){var la=ze.get(Ie)||null;return ie(Qe,la,ut,zt,null)}iv(Qe,ut)}return typeof ut=="function"&&rv(Qe),null}function Ue(ze,Qe,Ie){{if(typeof ze!="object"||ze===null)return Qe;switch(ze.$$typeof){case K:case O:P1(ze,Ie);var ut=ze.key;if(typeof ut!="string")break;if(Qe===null){Qe=new Set,Qe.add(ut);break}if(!Qe.has(ut)){Qe.add(ut);break}de("Encountered two children with the same key, `%s`. Keys should be unique so that components maintain their identity across updates. Non-unique keys may cause children to be duplicated and/or omitted — the behavior is unsupported and could change in a future version.",ut);break;case ot:var zt=ze._payload,Ct=ze._init;Ue(Ct(zt),Qe,Ie);break}}return Qe}function Je(ze,Qe,Ie,ut){for(var zt=null,Ct=0;Ct<Ie.length;Ct++){var un=Ie[Ct];zt=Ue(un,zt,ze)}for(var vn=null,qi=null,wi=Qe,la=0,Ti=0,Xr=null;wi!==null&&Ti<Ie.length;Ti++){wi.index>Ti?(Xr=wi,wi=null):Xr=wi.sibling;var Ro=ye(ze,wi,Ie[Ti],ut);if(Ro===null){wi===null&&(wi=Xr);break}t&&wi&&Ro.alternate===null&&a(ze,wi),la=T(Ro,la,Ti),qi===null?vn=Ro:qi.sibling=Ro,qi=Ro,wi=Xr}if(Ti===Ie.length){if(c(ze,wi),$n()){var uo=Ti;te(ze,uo)}return vn}if(wi===null){for(;Ti<Ie.length;Ti++){var Js=xe(ze,Ie[Ti],ut);Js!==null&&(la=T(Js,la,Ti),qi===null?vn=Js:qi.sibling=Js,qi=Js)}if($n()){var Qo=Ti;te(ze,Qo)}return vn}for(var es=m(ze,wi);Ti<Ie.length;Ti++){var Do=Be(es,ze,Ti,Ie[Ti],ut);Do!==null&&(t&&Do.alternate!==null&&es.delete(Do.key===null?Ti:Do.key),la=T(Do,la,Ti),qi===null?vn=Do:qi.sibling=Do,qi=Do)}if(t&&es.forEach(function(Um){return a(ze,Um)}),$n()){var Eh=Ti;te(ze,Eh)}return vn}function Dt(ze,Qe,Ie,ut){var zt=_a(Ie);if(typeof zt!="function")throw new Error("An object is not an iterable. This error is likely caused by a bug in React. Please file an issue.");{typeof Symbol=="function"&&Ie[Symbol.toStringTag]==="Generator"&&(D0||de("Using Generators as children is unsupported and will likely yield unexpected results because enumerating a generator mutates it. You may convert it to an array with `Array.from()` or the `[...spread]` operator before rendering. Keep in mind you might need to polyfill these features for older browsers."),D0=!0),Ie.entries===zt&&(R0||de("Using Maps as children is not supported. Use an array of keyed ReactElements instead."),R0=!0);var Ct=zt.call(Ie);if(Ct)for(var un=null,vn=Ct.next();!vn.done;vn=Ct.next()){var qi=vn.value;un=Ue(qi,un,ze)}}var wi=zt.call(Ie);if(wi==null)throw new Error("An iterable object provided no iterator.");for(var la=null,Ti=null,Xr=Qe,Ro=0,uo=0,Js=null,Qo=wi.next();Xr!==null&&!Qo.done;uo++,Qo=wi.next()){Xr.index>uo?(Js=Xr,Xr=null):Js=Xr.sibling;var es=ye(ze,Xr,Qo.value,ut);if(es===null){Xr===null&&(Xr=Js);break}t&&Xr&&es.alternate===null&&a(ze,Xr),Ro=T(es,Ro,uo),Ti===null?la=es:Ti.sibling=es,Ti=es,Xr=Js}if(Qo.done){if(c(ze,Xr),$n()){var Do=uo;te(ze,Do)}return la}if(Xr===null){for(;!Qo.done;uo++,Qo=wi.next()){var Eh=xe(ze,Qo.value,ut);Eh!==null&&(Ro=T(Eh,Ro,uo),Ti===null?la=Eh:Ti.sibling=Eh,Ti=Eh)}if($n()){var Um=uo;te(ze,Um)}return la}for(var L_=m(ze,Xr);!Qo.done;uo++,Qo=wi.next()){var Tc=Be(L_,ze,uo,Qo.value,ut);Tc!==null&&(t&&Tc.alternate!==null&&L_.delete(Tc.key===null?uo:Tc.key),Ro=T(Tc,Ro,uo),Ti===null?la=Tc:Ti.sibling=Tc,Ti=Tc)}if(t&&L_.forEach(function(k2){return a(ze,k2)}),$n()){var I2=uo;te(ze,I2)}return la}function Qt(ze,Qe,Ie,ut){if(Qe!==null&&Qe.tag===en){c(ze,Qe.sibling);var zt=v(Qe,Ie);return zt.return=ze,zt}c(ze,Qe);var Ct=o1(Ie,ze.mode,ut);return Ct.return=ze,Ct}function Zt(ze,Qe,Ie,ut){for(var zt=Ie.key,Ct=Qe;Ct!==null;){if(Ct.key===zt){var un=Ie.type;if(un===Z){if(Ct.tag===Ir){c(ze,Ct.sibling);var vn=v(Ct,Ie.props.children);return vn.return=ze,vn._debugSource=Ie._source,vn._debugOwner=Ie._owner,vn}}else if(Ct.elementType===un||AT(Ct,Ie)||typeof un=="object"&&un!==null&&un.$$typeof===ot&&B1(un)===Ct.type){c(ze,Ct.sibling);var qi=v(Ct,Ie.props);return qi.ref=r_(ze,Ct,Ie),qi.return=ze,qi._debugSource=Ie._source,qi._debugOwner=Ie._owner,qi}c(ze,Ct);break}else a(ze,Ct);Ct=Ct.sibling}if(Ie.type===Z){var wi=Bd(Ie.props.children,ze.mode,ut,Ie.key);return wi.return=ze,wi}else{var la=a1(Ie,ze.mode,ut);return la.ref=r_(ze,Qe,Ie),la.return=ze,la}}function ii(ze,Qe,Ie,ut){for(var zt=Ie.key,Ct=Qe;Ct!==null;){if(Ct.key===zt)if(Ct.tag===gt&&Ct.stateNode.containerInfo===Ie.containerInfo&&Ct.stateNode.implementation===Ie.implementation){c(ze,Ct.sibling);var un=v(Ct,Ie.children||[]);return un.return=ze,un}else{c(ze,Ct);break}else a(ze,Ct);Ct=Ct.sibling}var vn=s1(Ie,ze.mode,ut);return vn.return=ze,vn}function Yn(ze,Qe,Ie,ut){var zt=typeof Ie=="object"&&Ie!==null&&Ie.type===Z&&Ie.key===null;if(zt&&(Ie=Ie.props.children),typeof Ie=="object"&&Ie!==null){switch(Ie.$$typeof){case K:return A(Zt(ze,Qe,Ie,ut));case O:return A(ii(ze,Qe,Ie,ut));case ot:var Ct=Ie._payload,un=Ie._init;return Yn(ze,Qe,un(Ct),ut)}if(It(Ie))return Je(ze,Qe,Ie,ut);if(_a(Ie))return Dt(ze,Qe,Ie,ut);iv(ze,Ie)}return typeof Ie=="string"&&Ie!==""||typeof Ie=="number"?A(Qt(ze,Qe,""+Ie,ut)):(typeof Ie=="function"&&rv(ze),c(ze,Qe))}return Yn}var Tm=F1(!0),U1=F1(!1);function xE(t,a){if(t!==null&&a.child!==t.child)throw new Error("Resuming work not yet implemented.");if(a.child!==null){var c=a.child,m=ep(c,c.pendingProps);for(a.child=m,m.return=a;c.sibling!==null;)c=c.sibling,m=m.sibling=ep(c,c.pendingProps),m.return=a;m.sibling=null}}function bE(t,a){for(var c=t.child;c!==null;)YC(c,a),c=c.sibling}var a_={},Ad=mu(a_),o_=mu(a_),av=mu(a_);function ov(t){if(t===a_)throw new Error("Expected host context to exist. This error is likely caused by a bug in React. Please file an issue.");return t}function N1(){var t=ov(av.current);return t}function L0(t,a){Za(av,a,t),Za(o_,t,t),Za(Ad,a_,t);var c=vs(a);oa(Ad,t),Za(Ad,c,t)}function Em(t){oa(Ad,t),oa(o_,t),oa(av,t)}function O0(){var t=ov(Ad.current);return t}function V1(t){ov(av.current);var a=ov(Ad.current),c=Hx(a,t.type);a!==c&&(Za(o_,t,t),Za(Ad,c,t))}function P0(t){o_.current===t&&(oa(Ad,t),oa(o_,t))}var wE=0,j1=1,G1=1,s_=2,_u=mu(wE);function B0(t,a){return(t&a)!==0}function Sm(t){return t&j1}function F0(t,a){return t&j1|a}function TE(t,a){return t|a}function Rd(t,a){Za(_u,a,t)}function Cm(t){oa(_u,t)}function EE(t,a){var c=t.memoizedState;return c!==null?c.dehydrated!==null:(t.memoizedProps,!0)}function sv(t){for(var a=t;a!==null;){if(a.tag===Ge){var c=a.memoizedState;if(c!==null){var m=c.dehydrated;if(m===null||gh(m)||vd(m))return a}}else if(a.tag===Ai&&a.memoizedProps.revealOrder!==void 0){var v=(a.flags&wn)!==Kt;if(v)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===t)return null;for(;a.sibling===null;){if(a.return===null||a.return===t)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var Ms=0,Ra=1,gc=2,Da=4,io=8,U0=[];function N0(){for(var t=0;t<U0.length;t++){var a=U0[t];a._workInProgressVersionPrimary=null}U0.length=0}function SE(t,a){var c=a._getVersion,m=c(a._source);t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[a,m]:t.mutableSourceEagerHydrationData.push(a,m)}var Mt=li.ReactCurrentDispatcher,l_=li.ReactCurrentBatchConfig,V0,Mm;V0=new Set;var Zf=rt,$i=null,za=null,Ia=null,lv=!1,u_=!1,c_=0,CE=0,ME=25,et=null,Rl=null,Dd=-1,j0=!1;function Li(){{var t=et;Rl===null?Rl=[t]:Rl.push(t)}}function Tt(){{var t=et;Rl!==null&&(Dd++,Rl[Dd]!==t&&AE(t))}}function Am(t){t!=null&&!It(t)&&de("%s received a final argument that is not an array (instead, received `%s`). When specified, the final argument must be an array.",et,typeof t)}function AE(t){{var a=dn($i);if(!V0.has(a)&&(V0.add(a),Rl!==null)){for(var c="",m=30,v=0;v<=Dd;v++){for(var T=Rl[v],A=v===Dd?t:T,k=v+1+". "+T;k.length<m;)k+=" ";k+=A+`
`,c+=k}de(`React has detected a change in the order of Hooks called by %s. This will lead to bugs and errors if not fixed. For more information, read the Rules of Hooks: https://reactjs.org/link/rules-of-hooks

   Previous render            Next render
   ------------------------------------------------------
%s   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
`,a,c)}}}function Ao(){throw new Error(`Invalid hook call. Hooks can only be called inside of the body of a function component. This could happen for one of the following reasons:
1. You might have mismatching versions of React and the renderer (such as React DOM)
2. You might be breaking the Rules of Hooks
3. You might have more than one copy of React in the same app
See https://reactjs.org/link/invalid-hook-call for tips about how to debug and fix this problem.`)}function G0(t,a){if(j0)return!1;if(a===null)return de("%s received a final argument during this render, but not during the previous render. Even though the final argument is optional, its type cannot change between renders.",et),!1;t.length!==a.length&&de(`The final argument passed to %s changed size between renders. The order and size of this array must remain constant.

Previous: %s
Incoming: %s`,et,"["+a.join(", ")+"]","["+t.join(", ")+"]");for(var c=0;c<a.length&&c<t.length;c++)if(!So(t[c],a[c]))return!1;return!0}function Rm(t,a,c,m,v,T){Zf=T,$i=a,Rl=t!==null?t._debugHookTypes:null,Dd=-1,j0=t!==null&&t.type!==a.type,a.memoizedState=null,a.updateQueue=null,a.lanes=rt,t!==null&&t.memoizedState!==null?Mt.current=hw:Rl!==null?Mt.current=cw:Mt.current=uw;var A=c(m,v);if(u_){var k=0;do{if(u_=!1,c_=0,k>=ME)throw new Error("Too many re-renders. React limits the number of renders to prevent an infinite loop.");k+=1,j0=!1,za=null,Ia=null,a.updateQueue=null,Dd=-1,Mt.current=dw,A=c(m,v)}while(u_)}Mt.current=bv,a._debugHookTypes=Rl;var F=za!==null&&za.next!==null;if(Zf=rt,$i=null,za=null,Ia=null,et=null,Rl=null,Dd=-1,t!==null&&(t.flags&No)!==(a.flags&No)&&(t.mode&Mn)!==kt&&de("Internal React error: Expected static flag was missing. Please notify the React team."),lv=!1,F)throw new Error("Rendered fewer hooks than expected. This may be caused by an accidental early return statement.");return A}function Dm(){var t=c_!==0;return c_=0,t}function $1(t,a,c){a.updateQueue=t.updateQueue,(a.mode&vr)!==kt?a.flags&=~(qc|Uo|bo|jn):a.flags&=~(bo|jn),t.lanes=Qd(t.lanes,c)}function q1(){if(Mt.current=bv,lv){for(var t=$i.memoizedState;t!==null;){var a=t.queue;a!==null&&(a.pending=null),t=t.next}lv=!1}Zf=rt,$i=null,za=null,Ia=null,Rl=null,Dd=-1,et=null,rw=!1,u_=!1,c_=0}function _c(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ia===null?$i.memoizedState=Ia=t:Ia=Ia.next=t,Ia}function Dl(){var t;if(za===null){var a=$i.alternate;a!==null?t=a.memoizedState:t=null}else t=za.next;var c;if(Ia===null?c=$i.memoizedState:c=Ia.next,c!==null)Ia=c,c=Ia.next,za=t;else{if(t===null)throw new Error("Rendered more hooks than during the previous render.");za=t;var m={memoizedState:za.memoizedState,baseState:za.baseState,baseQueue:za.baseQueue,queue:za.queue,next:null};Ia===null?$i.memoizedState=Ia=m:Ia=Ia.next=m}return Ia}function H1(){return{lastEffect:null,stores:null}}function $0(t,a){return typeof a=="function"?a(t):a}function q0(t,a,c){var m=_c(),v;c!==void 0?v=c(a):v=a,m.memoizedState=m.baseState=v;var T={pending:null,interleaved:null,lanes:rt,dispatch:null,lastRenderedReducer:t,lastRenderedState:v};m.queue=T;var A=T.dispatch=IE.bind(null,$i,T);return[m.memoizedState,A]}function H0(t,a,c){var m=Dl(),v=m.queue;if(v===null)throw new Error("Should have a queue. This is likely a bug in React. Please file an issue.");v.lastRenderedReducer=t;var T=za,A=T.baseQueue,k=v.pending;if(k!==null){if(A!==null){var F=A.next,H=k.next;A.next=H,k.next=F}T.baseQueue!==A&&de("Internal error: Expected work-in-progress queue to be a clone. This is a bug in React."),T.baseQueue=A=k,v.pending=null}if(A!==null){var ie=A.next,xe=T.baseState,ye=null,Be=null,Ue=null,Je=ie;do{var Dt=Je.lane;if(qs(Zf,Dt)){if(Ue!==null){var Zt={lane:Br,action:Je.action,hasEagerState:Je.hasEagerState,eagerState:Je.eagerState,next:null};Ue=Ue.next=Zt}if(Je.hasEagerState)xe=Je.eagerState;else{var ii=Je.action;xe=t(xe,ii)}}else{var Qt={lane:Dt,action:Je.action,hasEagerState:Je.hasEagerState,eagerState:Je.eagerState,next:null};Ue===null?(Be=Ue=Qt,ye=xe):Ue=Ue.next=Qt,$i.lanes=Tn($i.lanes,Dt),R_(Dt)}Je=Je.next}while(Je!==null&&Je!==ie);Ue===null?ye=xe:Ue.next=Be,So(xe,m.memoizedState)||__(),m.memoizedState=xe,m.baseState=ye,m.baseQueue=Ue,v.lastRenderedState=xe}var Yn=v.interleaved;if(Yn!==null){var ze=Yn;do{var Qe=ze.lane;$i.lanes=Tn($i.lanes,Qe),R_(Qe),ze=ze.next}while(ze!==Yn)}else A===null&&(v.lanes=rt);var Ie=v.dispatch;return[m.memoizedState,Ie]}function Z0(t,a,c){var m=Dl(),v=m.queue;if(v===null)throw new Error("Should have a queue. This is likely a bug in React. Please file an issue.");v.lastRenderedReducer=t;var T=v.dispatch,A=v.pending,k=m.memoizedState;if(A!==null){v.pending=null;var F=A.next,H=F;do{var ie=H.action;k=t(k,ie),H=H.next}while(H!==F);So(k,m.memoizedState)||__(),m.memoizedState=k,m.baseQueue===null&&(m.baseState=k),v.lastRenderedState=k}return[k,T]}function q2(t,a,c){}function H2(t,a,c){}function X0(t,a,c){var m=$i,v=_c(),T,A=$n();if(A){if(c===void 0)throw new Error("Missing getServerSnapshot, which is required for server-rendered content. Will revert to client rendering.");T=c(),Mm||T!==c()&&(de("The result of getServerSnapshot should be cached to avoid an infinite loop"),Mm=!0)}else{if(T=a(),!Mm){var k=a();So(T,k)||(de("The result of getSnapshot should be cached to avoid an infinite loop"),Mm=!0)}var F=Uv();if(F===null)throw new Error("Expected a work-in-progress root. This is a bug in React. Please file an issue.");Jd(F,Zf)||Z1(m,a,T)}v.memoizedState=T;var H={value:T,getSnapshot:a};return v.queue=H,fv(W1.bind(null,m,H,t),[t]),m.flags|=bo,h_(Ra|io,X1.bind(null,m,H,T,a),void 0,null),T}function uv(t,a,c){var m=$i,v=Dl(),T=a();if(!Mm){var A=a();So(T,A)||(de("The result of getSnapshot should be cached to avoid an infinite loop"),Mm=!0)}var k=v.memoizedState,F=!So(k,T);F&&(v.memoizedState=T,__());var H=v.queue;if(f_(W1.bind(null,m,H,t),[t]),H.getSnapshot!==a||F||Ia!==null&&Ia.memoizedState.tag&Ra){m.flags|=bo,h_(Ra|io,X1.bind(null,m,H,T,a),void 0,null);var ie=Uv();if(ie===null)throw new Error("Expected a work-in-progress root. This is a bug in React. Please file an issue.");Jd(ie,Zf)||Z1(m,a,T)}return T}function Z1(t,a,c){t.flags|=Nu;var m={getSnapshot:a,value:c},v=$i.updateQueue;if(v===null)v=H1(),$i.updateQueue=v,v.stores=[m];else{var T=v.stores;T===null?v.stores=[m]:T.push(m)}}function X1(t,a,c,m){a.value=c,a.getSnapshot=m,Y1(a)&&K1(t)}function W1(t,a,c){var m=function(){Y1(a)&&K1(t)};return c(m)}function Y1(t){var a=t.getSnapshot,c=t.value;try{var m=a();return!So(c,m)}catch{return!0}}function K1(t){var a=Cs(t,ln);a!==null&&Pa(a,t,ln,vi)}function cv(t){var a=_c();typeof t=="function"&&(t=t()),a.memoizedState=a.baseState=t;var c={pending:null,interleaved:null,lanes:rt,dispatch:null,lastRenderedReducer:$0,lastRenderedState:t};a.queue=c;var m=c.dispatch=kE.bind(null,$i,c);return[a.memoizedState,m]}function W0(t){return H0($0)}function Y0(t){return Z0($0)}function h_(t,a,c,m){var v={tag:t,create:a,destroy:c,deps:m,next:null},T=$i.updateQueue;if(T===null)T=H1(),$i.updateQueue=T,T.lastEffect=v.next=v;else{var A=T.lastEffect;if(A===null)T.lastEffect=v.next=v;else{var k=A.next;A.next=v,v.next=k,T.lastEffect=v}}return v}function K0(t){var a=_c();{var c={current:t};return a.memoizedState=c,c}}function hv(t){var a=Dl();return a.memoizedState}function d_(t,a,c,m){var v=_c(),T=m===void 0?null:m;$i.flags|=t,v.memoizedState=h_(Ra|a,c,void 0,T)}function dv(t,a,c,m){var v=Dl(),T=m===void 0?null:m,A=void 0;if(za!==null){var k=za.memoizedState;if(A=k.destroy,T!==null){var F=k.deps;if(G0(T,F)){v.memoizedState=h_(a,c,A,T);return}}}$i.flags|=t,v.memoizedState=h_(Ra|a,c,A,T)}function fv(t,a){return($i.mode&vr)!==kt?d_(qc|bo|Uh,io,t,a):d_(bo|Uh,io,t,a)}function f_(t,a){return dv(bo,io,t,a)}function J0(t,a){return d_(jn,gc,t,a)}function pv(t,a){return dv(jn,gc,t,a)}function Q0(t,a){var c=jn;return c|=cs,($i.mode&vr)!==kt&&(c|=Uo),d_(c,Da,t,a)}function mv(t,a){return dv(jn,Da,t,a)}function J1(t,a){if(typeof a=="function"){var c=a,m=t();return c(m),function(){c(null)}}else if(a!=null){var v=a;v.hasOwnProperty("current")||de("Expected useImperativeHandle() first argument to either be a ref callback or React.createRef() object. Instead received: %s.","an object with keys {"+Object.keys(v).join(", ")+"}");var T=t();return v.current=T,function(){v.current=null}}}function eb(t,a,c){typeof a!="function"&&de("Expected useImperativeHandle() second argument to be a function that creates a handle. Instead received: %s.",a!==null?typeof a:"null");var m=c!=null?c.concat([t]):null,v=jn;return v|=cs,($i.mode&vr)!==kt&&(v|=Uo),d_(v,Da,J1.bind(null,a,t),m)}function gv(t,a,c){typeof a!="function"&&de("Expected useImperativeHandle() second argument to be a function that creates a handle. Instead received: %s.",a!==null?typeof a:"null");var m=c!=null?c.concat([t]):null;return dv(jn,Da,J1.bind(null,a,t),m)}function RE(t,a){}var _v=RE;function tb(t,a){var c=_c(),m=a===void 0?null:a;return c.memoizedState=[t,m],t}function yv(t,a){var c=Dl(),m=a===void 0?null:a,v=c.memoizedState;if(v!==null&&m!==null){var T=v[1];if(G0(m,T))return v[0]}return c.memoizedState=[t,m],t}function nb(t,a){var c=_c(),m=a===void 0?null:a,v=t();return c.memoizedState=[v,m],v}function vv(t,a){var c=Dl(),m=a===void 0?null:a,v=c.memoizedState;if(v!==null&&m!==null){var T=v[1];if(G0(m,T))return v[0]}var A=t();return c.memoizedState=[A,m],A}function ib(t){var a=_c();return a.memoizedState=t,t}function Q1(t){var a=Dl(),c=za,m=c.memoizedState;return tw(a,m,t)}function ew(t){var a=Dl();if(za===null)return a.memoizedState=t,t;var c=za.memoizedState;return tw(a,c,t)}function tw(t,a,c){var m=!Fp(Zf);if(m){if(!So(c,a)){var v=$s();$i.lanes=Tn($i.lanes,v),R_(v),t.baseState=!0}return a}else return t.baseState&&(t.baseState=!1,__()),t.memoizedState=c,c}function DE(t,a,c){var m=ms();dr(Kv(m,Hs)),t(!0);var v=l_.transition;l_.transition={};var T=l_.transition;l_.transition._updatedFibers=new Set;try{t(!1),a()}finally{if(dr(m),l_.transition=v,v===null&&T._updatedFibers){var A=T._updatedFibers.size;A>10&&Sn("Detected a large number of updates inside startTransition. If this is due to a subscription please re-write it to use React provided hooks. Otherwise concurrent mode guarantees are off the table."),T._updatedFibers.clear()}}}function rb(){var t=cv(!1),a=t[0],c=t[1],m=DE.bind(null,c),v=_c();return v.memoizedState=m,[a,m]}function nw(){var t=W0(),a=t[0],c=Dl(),m=c.memoizedState;return[a,m]}function iw(){var t=Y0(),a=t[0],c=Dl(),m=c.memoizedState;return[a,m]}var rw=!1;function zE(){return rw}function ab(){var t=_c(),a=Uv(),c=a.identifierPrefix,m;if($n()){var v=$();m=":"+c+"R"+v;var T=c_++;T>0&&(m+="H"+T.toString(32)),m+=":"}else{var A=CE++;m=":"+c+"r"+A.toString(32)+":"}return t.memoizedState=m,m}function xv(){var t=Dl(),a=t.memoizedState;return a}function IE(t,a,c){typeof arguments[3]=="function"&&de("State updates from the useState() and useReducer() Hooks don't support the second callback argument. To execute a side effect after rendering, declare it in the component body with useEffect().");var m=Od(t),v={lane:m,action:c,hasEagerState:!1,eagerState:null,next:null};if(aw(t))ow(a,v);else{var T=T1(t,a,v,m);if(T!==null){var A=Jo();Pa(T,t,m,A),sw(T,a,m)}}lw(t,m)}function kE(t,a,c){typeof arguments[3]=="function"&&de("State updates from the useState() and useReducer() Hooks don't support the second callback argument. To execute a side effect after rendering, declare it in the component body with useEffect().");var m=Od(t),v={lane:m,action:c,hasEagerState:!1,eagerState:null,next:null};if(aw(t))ow(a,v);else{var T=t.alternate;if(t.lanes===rt&&(T===null||T.lanes===rt)){var A=a.lastRenderedReducer;if(A!==null){var k;k=Mt.current,Mt.current=yu;try{var F=a.lastRenderedState,H=A(F,c);if(v.hasEagerState=!0,v.eagerState=H,So(H,F)){hE(t,a,v,m);return}}catch{}finally{Mt.current=k}}}var ie=T1(t,a,v,m);if(ie!==null){var xe=Jo();Pa(ie,t,m,xe),sw(ie,a,m)}}lw(t,m)}function aw(t){var a=t.alternate;return t===$i||a!==null&&a===$i}function ow(t,a){u_=lv=!0;var c=t.pending;c===null?a.next=a:(a.next=c.next,c.next=a),t.pending=a}function sw(t,a,c){if(Gs(c)){var m=a.lanes;m=Up(m,t.pendingLanes);var v=Tn(m,c);a.lanes=v,Zh(t,v)}}function lw(t,a,c){di(t,a)}var bv={readContext:Ur,useCallback:Ao,useContext:Ao,useEffect:Ao,useImperativeHandle:Ao,useInsertionEffect:Ao,useLayoutEffect:Ao,useMemo:Ao,useReducer:Ao,useRef:Ao,useState:Ao,useDebugValue:Ao,useDeferredValue:Ao,useTransition:Ao,useMutableSource:Ao,useSyncExternalStore:Ao,useId:Ao,unstable_isNewReconciler:Xi},uw=null,cw=null,hw=null,dw=null,yc=null,yu=null,wv=null;{var ob=function(){de("Context can only be read while React is rendering. In classes, you can read it in the render method or getDerivedStateFromProps. In function components, you can read it directly in the function body, but not inside Hooks like useReducer() or useMemo().")},gn=function(){de("Do not call Hooks inside useEffect(...), useMemo(...), or other built-in Hooks. You can only call Hooks at the top level of your React function. For more information, see https://reactjs.org/link/rules-of-hooks")};uw={readContext:function(t){return Ur(t)},useCallback:function(t,a){return et="useCallback",Li(),Am(a),tb(t,a)},useContext:function(t){return et="useContext",Li(),Ur(t)},useEffect:function(t,a){return et="useEffect",Li(),Am(a),fv(t,a)},useImperativeHandle:function(t,a,c){return et="useImperativeHandle",Li(),Am(c),eb(t,a,c)},useInsertionEffect:function(t,a){return et="useInsertionEffect",Li(),Am(a),J0(t,a)},useLayoutEffect:function(t,a){return et="useLayoutEffect",Li(),Am(a),Q0(t,a)},useMemo:function(t,a){et="useMemo",Li(),Am(a);var c=Mt.current;Mt.current=yc;try{return nb(t,a)}finally{Mt.current=c}},useReducer:function(t,a,c){et="useReducer",Li();var m=Mt.current;Mt.current=yc;try{return q0(t,a,c)}finally{Mt.current=m}},useRef:function(t){return et="useRef",Li(),K0(t)},useState:function(t){et="useState",Li();var a=Mt.current;Mt.current=yc;try{return cv(t)}finally{Mt.current=a}},useDebugValue:function(t,a){return et="useDebugValue",Li(),void 0},useDeferredValue:function(t){return et="useDeferredValue",Li(),ib(t)},useTransition:function(){return et="useTransition",Li(),rb()},useMutableSource:function(t,a,c){return et="useMutableSource",Li(),void 0},useSyncExternalStore:function(t,a,c){return et="useSyncExternalStore",Li(),X0(t,a,c)},useId:function(){return et="useId",Li(),ab()},unstable_isNewReconciler:Xi},cw={readContext:function(t){return Ur(t)},useCallback:function(t,a){return et="useCallback",Tt(),tb(t,a)},useContext:function(t){return et="useContext",Tt(),Ur(t)},useEffect:function(t,a){return et="useEffect",Tt(),fv(t,a)},useImperativeHandle:function(t,a,c){return et="useImperativeHandle",Tt(),eb(t,a,c)},useInsertionEffect:function(t,a){return et="useInsertionEffect",Tt(),J0(t,a)},useLayoutEffect:function(t,a){return et="useLayoutEffect",Tt(),Q0(t,a)},useMemo:function(t,a){et="useMemo",Tt();var c=Mt.current;Mt.current=yc;try{return nb(t,a)}finally{Mt.current=c}},useReducer:function(t,a,c){et="useReducer",Tt();var m=Mt.current;Mt.current=yc;try{return q0(t,a,c)}finally{Mt.current=m}},useRef:function(t){return et="useRef",Tt(),K0(t)},useState:function(t){et="useState",Tt();var a=Mt.current;Mt.current=yc;try{return cv(t)}finally{Mt.current=a}},useDebugValue:function(t,a){return et="useDebugValue",Tt(),void 0},useDeferredValue:function(t){return et="useDeferredValue",Tt(),ib(t)},useTransition:function(){return et="useTransition",Tt(),rb()},useMutableSource:function(t,a,c){return et="useMutableSource",Tt(),void 0},useSyncExternalStore:function(t,a,c){return et="useSyncExternalStore",Tt(),X0(t,a,c)},useId:function(){return et="useId",Tt(),ab()},unstable_isNewReconciler:Xi},hw={readContext:function(t){return Ur(t)},useCallback:function(t,a){return et="useCallback",Tt(),yv(t,a)},useContext:function(t){return et="useContext",Tt(),Ur(t)},useEffect:function(t,a){return et="useEffect",Tt(),f_(t,a)},useImperativeHandle:function(t,a,c){return et="useImperativeHandle",Tt(),gv(t,a,c)},useInsertionEffect:function(t,a){return et="useInsertionEffect",Tt(),pv(t,a)},useLayoutEffect:function(t,a){return et="useLayoutEffect",Tt(),mv(t,a)},useMemo:function(t,a){et="useMemo",Tt();var c=Mt.current;Mt.current=yu;try{return vv(t,a)}finally{Mt.current=c}},useReducer:function(t,a,c){et="useReducer",Tt();var m=Mt.current;Mt.current=yu;try{return H0(t,a,c)}finally{Mt.current=m}},useRef:function(t){return et="useRef",Tt(),hv()},useState:function(t){et="useState",Tt();var a=Mt.current;Mt.current=yu;try{return W0(t)}finally{Mt.current=a}},useDebugValue:function(t,a){return et="useDebugValue",Tt(),_v()},useDeferredValue:function(t){return et="useDeferredValue",Tt(),Q1(t)},useTransition:function(){return et="useTransition",Tt(),nw()},useMutableSource:function(t,a,c){return et="useMutableSource",Tt(),void 0},useSyncExternalStore:function(t,a,c){return et="useSyncExternalStore",Tt(),uv(t,a)},useId:function(){return et="useId",Tt(),xv()},unstable_isNewReconciler:Xi},dw={readContext:function(t){return Ur(t)},useCallback:function(t,a){return et="useCallback",Tt(),yv(t,a)},useContext:function(t){return et="useContext",Tt(),Ur(t)},useEffect:function(t,a){return et="useEffect",Tt(),f_(t,a)},useImperativeHandle:function(t,a,c){return et="useImperativeHandle",Tt(),gv(t,a,c)},useInsertionEffect:function(t,a){return et="useInsertionEffect",Tt(),pv(t,a)},useLayoutEffect:function(t,a){return et="useLayoutEffect",Tt(),mv(t,a)},useMemo:function(t,a){et="useMemo",Tt();var c=Mt.current;Mt.current=wv;try{return vv(t,a)}finally{Mt.current=c}},useReducer:function(t,a,c){et="useReducer",Tt();var m=Mt.current;Mt.current=wv;try{return Z0(t,a,c)}finally{Mt.current=m}},useRef:function(t){return et="useRef",Tt(),hv()},useState:function(t){et="useState",Tt();var a=Mt.current;Mt.current=wv;try{return Y0(t)}finally{Mt.current=a}},useDebugValue:function(t,a){return et="useDebugValue",Tt(),_v()},useDeferredValue:function(t){return et="useDeferredValue",Tt(),ew(t)},useTransition:function(){return et="useTransition",Tt(),iw()},useMutableSource:function(t,a,c){return et="useMutableSource",Tt(),void 0},useSyncExternalStore:function(t,a,c){return et="useSyncExternalStore",Tt(),uv(t,a)},useId:function(){return et="useId",Tt(),xv()},unstable_isNewReconciler:Xi},yc={readContext:function(t){return ob(),Ur(t)},useCallback:function(t,a){return et="useCallback",gn(),Li(),tb(t,a)},useContext:function(t){return et="useContext",gn(),Li(),Ur(t)},useEffect:function(t,a){return et="useEffect",gn(),Li(),fv(t,a)},useImperativeHandle:function(t,a,c){return et="useImperativeHandle",gn(),Li(),eb(t,a,c)},useInsertionEffect:function(t,a){return et="useInsertionEffect",gn(),Li(),J0(t,a)},useLayoutEffect:function(t,a){return et="useLayoutEffect",gn(),Li(),Q0(t,a)},useMemo:function(t,a){et="useMemo",gn(),Li();var c=Mt.current;Mt.current=yc;try{return nb(t,a)}finally{Mt.current=c}},useReducer:function(t,a,c){et="useReducer",gn(),Li();var m=Mt.current;Mt.current=yc;try{return q0(t,a,c)}finally{Mt.current=m}},useRef:function(t){return et="useRef",gn(),Li(),K0(t)},useState:function(t){et="useState",gn(),Li();var a=Mt.current;Mt.current=yc;try{return cv(t)}finally{Mt.current=a}},useDebugValue:function(t,a){return et="useDebugValue",gn(),Li(),void 0},useDeferredValue:function(t){return et="useDeferredValue",gn(),Li(),ib(t)},useTransition:function(){return et="useTransition",gn(),Li(),rb()},useMutableSource:function(t,a,c){return et="useMutableSource",gn(),Li(),void 0},useSyncExternalStore:function(t,a,c){return et="useSyncExternalStore",gn(),Li(),X0(t,a,c)},useId:function(){return et="useId",gn(),Li(),ab()},unstable_isNewReconciler:Xi},yu={readContext:function(t){return ob(),Ur(t)},useCallback:function(t,a){return et="useCallback",gn(),Tt(),yv(t,a)},useContext:function(t){return et="useContext",gn(),Tt(),Ur(t)},useEffect:function(t,a){return et="useEffect",gn(),Tt(),f_(t,a)},useImperativeHandle:function(t,a,c){return et="useImperativeHandle",gn(),Tt(),gv(t,a,c)},useInsertionEffect:function(t,a){return et="useInsertionEffect",gn(),Tt(),pv(t,a)},useLayoutEffect:function(t,a){return et="useLayoutEffect",gn(),Tt(),mv(t,a)},useMemo:function(t,a){et="useMemo",gn(),Tt();var c=Mt.current;Mt.current=yu;try{return vv(t,a)}finally{Mt.current=c}},useReducer:function(t,a,c){et="useReducer",gn(),Tt();var m=Mt.current;Mt.current=yu;try{return H0(t,a,c)}finally{Mt.current=m}},useRef:function(t){return et="useRef",gn(),Tt(),hv()},useState:function(t){et="useState",gn(),Tt();var a=Mt.current;Mt.current=yu;try{return W0(t)}finally{Mt.current=a}},useDebugValue:function(t,a){return et="useDebugValue",gn(),Tt(),_v()},useDeferredValue:function(t){return et="useDeferredValue",gn(),Tt(),Q1(t)},useTransition:function(){return et="useTransition",gn(),Tt(),nw()},useMutableSource:function(t,a,c){return et="useMutableSource",gn(),Tt(),void 0},useSyncExternalStore:function(t,a,c){return et="useSyncExternalStore",gn(),Tt(),uv(t,a)},useId:function(){return et="useId",gn(),Tt(),xv()},unstable_isNewReconciler:Xi},wv={readContext:function(t){return ob(),Ur(t)},useCallback:function(t,a){return et="useCallback",gn(),Tt(),yv(t,a)},useContext:function(t){return et="useContext",gn(),Tt(),Ur(t)},useEffect:function(t,a){return et="useEffect",gn(),Tt(),f_(t,a)},useImperativeHandle:function(t,a,c){return et="useImperativeHandle",gn(),Tt(),gv(t,a,c)},useInsertionEffect:function(t,a){return et="useInsertionEffect",gn(),Tt(),pv(t,a)},useLayoutEffect:function(t,a){return et="useLayoutEffect",gn(),Tt(),mv(t,a)},useMemo:function(t,a){et="useMemo",gn(),Tt();var c=Mt.current;Mt.current=yu;try{return vv(t,a)}finally{Mt.current=c}},useReducer:function(t,a,c){et="useReducer",gn(),Tt();var m=Mt.current;Mt.current=yu;try{return Z0(t,a,c)}finally{Mt.current=m}},useRef:function(t){return et="useRef",gn(),Tt(),hv()},useState:function(t){et="useState",gn(),Tt();var a=Mt.current;Mt.current=yu;try{return Y0(t)}finally{Mt.current=a}},useDebugValue:function(t,a){return et="useDebugValue",gn(),Tt(),_v()},useDeferredValue:function(t){return et="useDeferredValue",gn(),Tt(),ew(t)},useTransition:function(){return et="useTransition",gn(),Tt(),iw()},useMutableSource:function(t,a,c){return et="useMutableSource",gn(),Tt(),void 0},useSyncExternalStore:function(t,a,c){return et="useSyncExternalStore",gn(),Tt(),uv(t,a)},useId:function(){return et="useId",gn(),Tt(),xv()},unstable_isNewReconciler:Xi}}var zd=xt.unstable_now,fw=0,Tv=-1,p_=-1,Ev=-1,sb=!1,Sv=!1;function pw(){return sb}function LE(){Sv=!0}function OE(){sb=!1,Sv=!1}function PE(){sb=Sv,Sv=!1}function mw(){return fw}function gw(){fw=zd()}function lb(t){p_=zd(),t.actualStartTime<0&&(t.actualStartTime=zd())}function _w(t){p_=-1}function Cv(t,a){if(p_>=0){var c=zd()-p_;t.actualDuration+=c,a&&(t.selfBaseDuration=c),p_=-1}}function vc(t){if(Tv>=0){var a=zd()-Tv;Tv=-1;for(var c=t.return;c!==null;){switch(c.tag){case at:var m=c.stateNode;m.effectDuration+=a;return;case Oi:var v=c.stateNode;v.effectDuration+=a;return}c=c.return}}}function ub(t){if(Ev>=0){var a=zd()-Ev;Ev=-1;for(var c=t.return;c!==null;){switch(c.tag){case at:var m=c.stateNode;m!==null&&(m.passiveEffectDuration+=a);return;case Oi:var v=c.stateNode;v!==null&&(v.passiveEffectDuration+=a);return}c=c.return}}}function xc(){Tv=zd()}function cb(){Ev=zd()}function hb(t){for(var a=t.child;a;)t.actualDuration+=a.actualDuration,a=a.sibling}function Xf(t,a){return{value:t,source:a,stack:Ds(a),digest:null}}function db(t,a,c){return{value:t,source:null,stack:c??null,digest:a??null}}function BE(t,a){return!0}function fb(t,a){try{var c=BE(t,a);if(c===!1)return;var m=a.value,v=a.source,T=a.stack,A=T!==null?T:"";if(m!=null&&m._suppressLogging){if(t.tag===Ft)return;console.error(m)}var k=v?dn(v):null,F=k?"The above error occurred in the <"+k+"> component:":"The above error occurred in one of your React components:",H;if(t.tag===at)H=`Consider adding an error boundary to your tree to customize error handling behavior.
Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.`;else{var ie=dn(t)||"Anonymous";H="React will try to recreate this component tree from scratch "+("using the error boundary you provided, "+ie+".")}var xe=F+`
`+A+`

`+(""+H);console.error(xe)}catch(ye){setTimeout(function(){throw ye})}}var FE=typeof WeakMap=="function"?WeakMap:Map;function yw(t,a,c){var m=yh(vi,c);m.tag=f0,m.payload={element:null};var v=a.value;return m.callback=function(){DC(v),fb(t,a)},m}function pb(t,a,c){var m=yh(vi,c);m.tag=f0;var v=t.type.getDerivedStateFromError;if(typeof v=="function"){var T=a.value;m.payload=function(){return v(T)},m.callback=function(){RT(t),fb(t,a)}}var A=t.stateNode;return A!==null&&typeof A.componentDidCatch=="function"&&(m.callback=function(){RT(t),fb(t,a),typeof v!="function"&&AC(this);var F=a.value,H=a.stack;this.componentDidCatch(F,{componentStack:H!==null?H:""}),typeof v!="function"&&(To(t.lanes,ln)||de("%s: Error boundaries should implement getDerivedStateFromError(). In that method, return a state update to display an error message or fallback UI.",dn(t)||"Unknown"))}),m}function vw(t,a,c){var m=t.pingCache,v;if(m===null?(m=t.pingCache=new FE,v=new Set,m.set(a,v)):(v=m.get(a),v===void 0&&(v=new Set,m.set(a,v))),!v.has(c)){v.add(c);var T=zC.bind(null,t,a,c);we&&D_(t,c),a.then(T,T)}}function UE(t,a,c,m){var v=t.updateQueue;if(v===null){var T=new Set;T.add(c),t.updateQueue=T}else v.add(c)}function NE(t,a){var c=t.tag;if((t.mode&Mn)===kt&&(c===Oe||c===Rn||c===xn)){var m=t.alternate;m?(t.updateQueue=m.updateQueue,t.memoizedState=m.memoizedState,t.lanes=m.lanes):(t.updateQueue=null,t.memoizedState=null)}}function xw(t){var a=t;do{if(a.tag===Ge&&EE(a))return a;a=a.return}while(a!==null);return null}function bw(t,a,c,m,v){if((t.mode&Mn)===kt){if(t===a)t.flags|=ia;else{if(t.flags|=wn,c.flags|=$c,c.flags&=~(Tp|Wl),c.tag===Ft){var T=c.alternate;if(T===null)c.tag=Wt;else{var A=yh(vi,ln);A.tag=Yy,Md(c,A,ln)}}c.lanes=Tn(c.lanes,ln)}return t}return t.flags|=ia,t.lanes=v,t}function VE(t,a,c,m,v){if(c.flags|=Wl,we&&D_(t,v),m!==null&&typeof m=="object"&&typeof m.then=="function"){var T=m;NE(c),$n()&&c.mode&Mn&&ke();var A=xw(a);if(A!==null){A.flags&=~xo,bw(A,a,c,t,v),A.mode&Mn&&vw(t,T,v),UE(A,t,T);return}else{if(!Dr(v)){vw(t,T,v),Zb();return}var k=new Error("A component suspended while responding to synchronous input. This will cause the UI to be replaced with a loading indicator. To fix, updates that suspend should be wrapped with startTransition.");m=k}}else if($n()&&c.mode&Mn){ke();var F=xw(a);if(F!==null){(F.flags&ia)===Kt&&(F.flags|=xo),bw(F,a,c,t,v),nr(Xf(m,c));return}}m=Xf(m,c),xC(m);var H=a;do{switch(H.tag){case at:{var ie=m;H.flags|=ia;var xe=zr(v);H.lanes=Tn(H.lanes,xe);var ye=yw(H,ie,xe);g0(H,ye);return}case Ft:var Be=m,Ue=H.type,Je=H.stateNode;if((H.flags&wn)===Kt&&(typeof Ue.getDerivedStateFromError=="function"||Je!==null&&typeof Je.componentDidCatch=="function"&&!xT(Je))){H.flags|=ia;var Dt=zr(v);H.lanes=Tn(H.lanes,Dt);var Qt=pb(H,Be,Dt);g0(H,Qt);return}break}H=H.return}while(H!==null)}function jE(){return null}var m_=li.ReactCurrentOwner,vu=!1,mb,g_,gb,_b,yb,Wf,vb,Mv;mb={},g_={},gb={},_b={},yb={},Wf=!1,vb={},Mv={};function Yo(t,a,c,m){t===null?a.child=U1(a,null,c,m):a.child=Tm(a,t.child,c,m)}function GE(t,a,c,m){a.child=Tm(a,t.child,null,m),a.child=Tm(a,null,c,m)}function ww(t,a,c,m,v){if(a.type!==a.elementType){var T=c.propTypes;T&&ws(T,m,"prop",Dn(c))}var A=c.render,k=a.ref,F,H;mc(a,v),Re(a);{if(m_.current=a,oi(!0),F=Rm(t,a,A,m,k,v),H=Dm(),a.mode&Wn){Ze(!0);try{F=Rm(t,a,A,m,k,v),H=Dm()}finally{Ze(!1)}}oi(!1)}return wt(),t!==null&&!vu?($1(t,a,v),vh(t,a,v)):($n()&&H&&ne(a),a.flags|=fl,Yo(t,a,F,v),a.child)}function Tw(t,a,c,m,v){if(t===null){var T=c.type;if(XC(T)&&c.compare===null&&c.defaultProps===void 0){var A=T;return A=Fm(T),a.tag=xn,a.type=A,wb(a,T),Ew(t,a,A,m,v)}{var k=T.propTypes;k&&ws(k,m,"prop",Dn(T))}var F=r1(c.type,null,m,a,a.mode,v);return F.ref=a.ref,F.return=a,a.child=F,F}{var H=c.type,ie=H.propTypes;ie&&ws(ie,m,"prop",Dn(H))}var xe=t.child,ye=Ab(t,v);if(!ye){var Be=xe.memoizedProps,Ue=c.compare;if(Ue=Ue!==null?Ue:ud,Ue(Be,m)&&t.ref===a.ref)return vh(t,a,v)}a.flags|=fl;var Je=ep(xe,m);return Je.ref=a.ref,Je.return=a,a.child=Je,Je}function Ew(t,a,c,m,v){if(a.type!==a.elementType){var T=a.elementType;if(T.$$typeof===ot){var A=T,k=A._payload,F=A._init;try{T=F(k)}catch{T=null}var H=T&&T.propTypes;H&&ws(H,m,"prop",Dn(T))}}if(t!==null){var ie=t.memoizedProps;if(ud(ie,m)&&t.ref===a.ref&&a.type===t.type)if(vu=!1,a.pendingProps=m=ie,Ab(t,v))(t.flags&$c)!==Kt&&(vu=!0);else return a.lanes=t.lanes,vh(t,a,v)}return xb(t,a,c,m,v)}function Sw(t,a,c){var m=a.pendingProps,v=m.children,T=t!==null?t.memoizedState:null;if(m.mode==="hidden"||Kn)if((a.mode&Mn)===kt){var A={baseLanes:rt,cachePool:null,transitions:null};a.memoizedState=A,Nv(a,c)}else if(To(c,Hr)){var xe={baseLanes:rt,cachePool:null,transitions:null};a.memoizedState=xe;var ye=T!==null?T.baseLanes:c;Nv(a,ye)}else{var k=null,F;if(T!==null){var H=T.baseLanes;F=Tn(H,c)}else F=c;a.lanes=a.childLanes=Hr;var ie={baseLanes:F,cachePool:k,transitions:null};return a.memoizedState=ie,a.updateQueue=null,Nv(a,F),null}else{var Be;T!==null?(Be=Tn(T.baseLanes,c),a.memoizedState=null):Be=c,Nv(a,Be)}return Yo(t,a,v,c),a.child}function $E(t,a,c){var m=a.pendingProps;return Yo(t,a,m,c),a.child}function qE(t,a,c){var m=a.pendingProps.children;return Yo(t,a,m,c),a.child}function HE(t,a,c){{a.flags|=jn;{var m=a.stateNode;m.effectDuration=0,m.passiveEffectDuration=0}}var v=a.pendingProps,T=v.children;return Yo(t,a,T,c),a.child}function Cw(t,a){var c=a.ref;(t===null&&c!==null||t!==null&&t.ref!==c)&&(a.flags|=ft,a.flags|=Kl)}function xb(t,a,c,m,v){if(a.type!==a.elementType){var T=c.propTypes;T&&ws(T,m,"prop",Dn(c))}var A;{var k=hc(a,c,!0);A=Es(a,k)}var F,H;mc(a,v),Re(a);{if(m_.current=a,oi(!0),F=Rm(t,a,c,m,A,v),H=Dm(),a.mode&Wn){Ze(!0);try{F=Rm(t,a,c,m,A,v),H=Dm()}finally{Ze(!1)}}oi(!1)}return wt(),t!==null&&!vu?($1(t,a,v),vh(t,a,v)):($n()&&H&&ne(a),a.flags|=fl,Yo(t,a,F,v),a.child)}function Mw(t,a,c,m,v){{switch(u2(a)){case!1:{var T=a.stateNode,A=a.type,k=new A(a.memoizedProps,T.context),F=k.state;T.updater.enqueueSetState(T,F,null);break}case!0:{a.flags|=wn,a.flags|=ia;var H=new Error("Simulated error coming from DevTools"),ie=zr(v);a.lanes=Tn(a.lanes,ie);var xe=pb(a,Xf(H,a),ie);g0(a,xe);break}}if(a.type!==a.elementType){var ye=c.propTypes;ye&&ws(ye,m,"prop",Dn(c))}}var Be;Ws(c)?(Be=!0,_m(a)):Be=!1,mc(a,v);var Ue=a.stateNode,Je;Ue===null?(Rv(t,a),L1(a,c,m),A0(a,c,m,v),Je=!0):t===null?Je=yE(a,c,m,v):Je=vE(t,a,c,m,v);var Dt=bb(t,a,c,Je,Be,v);{var Qt=a.stateNode;Je&&Qt.props!==m&&(Wf||de("It looks like %s is reassigning its own `this.props` while rendering. This is not supported and can lead to confusing bugs.",dn(a)||"a component"),Wf=!0)}return Dt}function bb(t,a,c,m,v,T){Cw(t,a);var A=(a.flags&wn)!==Kt;if(!m&&!A)return v&&t_(a,c,!1),vh(t,a,T);var k=a.stateNode;m_.current=a;var F;if(A&&typeof c.getDerivedStateFromError!="function")F=null,_w();else{Re(a);{if(oi(!0),F=k.render(),a.mode&Wn){Ze(!0);try{k.render()}finally{Ze(!1)}}oi(!1)}wt()}return a.flags|=fl,t!==null&&A?GE(t,a,F,T):Yo(t,a,F,T),a.memoizedState=k.state,v&&t_(a,c,!0),a.child}function Aw(t){var a=t.stateNode;a.pendingContext?Qg(t,a.pendingContext,a.pendingContext!==a.context):a.context&&Qg(t,a.context,!1),L0(t,a.containerInfo)}function ZE(t,a,c){if(Aw(a),t===null)throw new Error("Should have a current fiber. This is a bug in React.");var m=a.pendingProps,v=a.memoizedState,T=v.element;C1(t,a),ev(a,m,null,c);var A=a.memoizedState;a.stateNode;var k=A.element;if(v.isDehydrated){var F={element:k,isDehydrated:!1,cache:A.cache,pendingSuspenseBoundaries:A.pendingSuspenseBoundaries,transitions:A.transitions},H=a.updateQueue;if(H.baseState=F,a.memoizedState=F,a.flags&xo){var ie=Xf(new Error("There was an error while hydrating. Because the error happened outside of a Suspense boundary, the entire root will switch to client rendering."),a);return Rw(t,a,k,c,ie)}else if(k!==T){var xe=Xf(new Error("This root received an early update, before anything was able hydrate. Switched the entire root to client rendering."),a);return Rw(t,a,k,c,xe)}else{jt(a);var ye=U1(a,null,k,c);a.child=ye;for(var Be=ye;Be;)Be.flags=Be.flags&~Rr|wa,Be=Be.sibling}}else{if(fr(),k===T)return vh(t,a,c);Yo(t,a,k,c)}return a.child}function Rw(t,a,c,m,v){return fr(),nr(v),a.flags|=xo,Yo(t,a,c,m),a.child}function XE(t,a,c){V1(a),t===null&&Qn(a);var m=a.type,v=a.pendingProps,T=t!==null?t.memoizedProps:null,A=v.children,k=Ug(m,v);return k?A=null:T!==null&&Ug(m,T)&&(a.flags|=Uu),Cw(t,a),Yo(t,a,A,c),a.child}function WE(t,a){return t===null&&Qn(a),null}function YE(t,a,c,m){Rv(t,a);var v=a.pendingProps,T=c,A=T._payload,k=T._init,F=k(A);a.type=F;var H=a.tag=WC(F),ie=Ss(F,v),xe;switch(H){case Oe:return wb(a,F),a.type=F=Fm(F),xe=xb(null,a,F,ie,m),xe;case Ft:return a.type=F=Jb(F),xe=Mw(null,a,F,ie,m),xe;case Rn:return a.type=F=Qb(F),xe=ww(null,a,F,ie,m),xe;case Nn:{if(a.type!==a.elementType){var ye=F.propTypes;ye&&ws(ye,ie,"prop",Dn(F))}return xe=Tw(null,a,F,Ss(F.type,ie),m),xe}}var Be="";throw F!==null&&typeof F=="object"&&F.$$typeof===ot&&(Be=" Did you wrap a component in React.lazy() more than once?"),new Error("Element type is invalid. Received a promise that resolves to: "+F+". "+("Lazy element type must resolve to a class or function."+Be))}function KE(t,a,c,m,v){Rv(t,a),a.tag=Ft;var T;return Ws(c)?(T=!0,_m(a)):T=!1,mc(a,v),L1(a,c,m),A0(a,c,m,v),bb(null,a,c,!0,T,v)}function JE(t,a,c,m){Rv(t,a);var v=a.pendingProps,T;{var A=hc(a,c,!1);T=Es(a,A)}mc(a,m);var k,F;Re(a);{if(c.prototype&&typeof c.prototype.render=="function"){var H=Dn(c)||"Unknown";mb[H]||(de("The <%s /> component appears to have a render method, but doesn't extend React.Component. This is likely to cause errors. Change %s to extend React.Component instead.",H,H),mb[H]=!0)}a.mode&Wn&&An.recordLegacyContextWarning(a,null),oi(!0),m_.current=a,k=Rm(null,a,c,v,T,m),F=Dm(),oi(!1)}if(wt(),a.flags|=fl,typeof k=="object"&&k!==null&&typeof k.render=="function"&&k.$$typeof===void 0){var ie=Dn(c)||"Unknown";g_[ie]||(de("The <%s /> component appears to be a function component that returns a class instance. Change %s to a class that extends React.Component instead. If you can't use a class try assigning the prototype on the function as a workaround. `%s.prototype = React.Component.prototype`. Don't use an arrow function since it cannot be called with `new` by React.",ie,ie,ie),g_[ie]=!0)}if(typeof k=="object"&&k!==null&&typeof k.render=="function"&&k.$$typeof===void 0){{var xe=Dn(c)||"Unknown";g_[xe]||(de("The <%s /> component appears to be a function component that returns a class instance. Change %s to a class that extends React.Component instead. If you can't use a class try assigning the prototype on the function as a workaround. `%s.prototype = React.Component.prototype`. Don't use an arrow function since it cannot be called with `new` by React.",xe,xe,xe),g_[xe]=!0)}a.tag=Ft,a.memoizedState=null,a.updateQueue=null;var ye=!1;return Ws(c)?(ye=!0,_m(a)):ye=!1,a.memoizedState=k.state!==null&&k.state!==void 0?k.state:null,m0(a),k1(a,k),A0(a,c,v,m),bb(null,a,c,!0,ye,m)}else{if(a.tag=Oe,a.mode&Wn){Ze(!0);try{k=Rm(null,a,c,v,T,m),F=Dm()}finally{Ze(!1)}}return $n()&&F&&ne(a),Yo(null,a,k,m),wb(a,c),a.child}}function wb(t,a){{if(a&&a.childContextTypes&&de("%s(...): childContextTypes cannot be defined on a function component.",a.displayName||a.name||"Component"),t.ref!==null){var c="",m=ns();m&&(c+=`

Check the render method of \``+m+"`.");var v=m||"",T=t._debugSource;T&&(v=T.fileName+":"+T.lineNumber),yb[v]||(yb[v]=!0,de("Function components cannot be given refs. Attempts to access this ref will fail. Did you mean to use React.forwardRef()?%s",c))}if(typeof a.getDerivedStateFromProps=="function"){var A=Dn(a)||"Unknown";_b[A]||(de("%s: Function components do not support getDerivedStateFromProps.",A),_b[A]=!0)}if(typeof a.contextType=="object"&&a.contextType!==null){var k=Dn(a)||"Unknown";gb[k]||(de("%s: Function components do not support contextType.",k),gb[k]=!0)}}}var Tb={dehydrated:null,treeContext:null,retryLane:Br};function Eb(t){return{baseLanes:t,cachePool:jE(),transitions:null}}function QE(t,a){var c=null;return{baseLanes:Tn(t.baseLanes,a),cachePool:c,transitions:t.transitions}}function eS(t,a,c,m){if(a!==null){var v=a.memoizedState;if(v===null)return!1}return B0(t,s_)}function tS(t,a){return Qd(t.childLanes,a)}function Dw(t,a,c){var m=a.pendingProps;c2(a)&&(a.flags|=wn);var v=_u.current,T=!1,A=(a.flags&wn)!==Kt;if(A||eS(v,t)?(T=!0,a.flags&=~wn):(t===null||t.memoizedState!==null)&&(v=TE(v,G1)),v=Sm(v),Rd(a,v),t===null){Qn(a);var k=a.memoizedState;if(k!==null){var F=k.dehydrated;if(F!==null)return oS(a,F)}var H=m.children,ie=m.fallback;if(T){var xe=nS(a,H,ie,c),ye=a.child;return ye.memoizedState=Eb(c),a.memoizedState=Tb,xe}else return Sb(a,H)}else{var Be=t.memoizedState;if(Be!==null){var Ue=Be.dehydrated;if(Ue!==null)return sS(t,a,A,m,Ue,Be,c)}if(T){var Je=m.fallback,Dt=m.children,Qt=rS(t,a,Dt,Je,c),Zt=a.child,ii=t.child.memoizedState;return Zt.memoizedState=ii===null?Eb(c):QE(ii,c),Zt.childLanes=tS(t,c),a.memoizedState=Tb,Qt}else{var Yn=m.children,ze=iS(t,a,Yn,c);return a.memoizedState=null,ze}}}function Sb(t,a,c){var m=t.mode,v={mode:"visible",children:a},T=Cb(v,m);return T.return=t,t.child=T,T}function nS(t,a,c,m){var v=t.mode,T=t.child,A={mode:"hidden",children:a},k,F;return(v&Mn)===kt&&T!==null?(k=T,k.childLanes=rt,k.pendingProps=A,t.mode&Ln&&(k.actualDuration=0,k.actualStartTime=-1,k.selfBaseDuration=0,k.treeBaseDuration=0),F=Bd(c,v,m,null)):(k=Cb(A,v),F=Bd(c,v,m,null)),k.return=t,F.return=t,k.sibling=F,t.child=k,F}function Cb(t,a,c){return zT(t,a,rt,null)}function zw(t,a){return ep(t,a)}function iS(t,a,c,m){var v=t.child,T=v.sibling,A=zw(v,{mode:"visible",children:c});if((a.mode&Mn)===kt&&(A.lanes=m),A.return=a,A.sibling=null,T!==null){var k=a.deletions;k===null?(a.deletions=[T],a.flags|=Ca):k.push(T)}return a.child=A,A}function rS(t,a,c,m,v){var T=a.mode,A=t.child,k=A.sibling,F={mode:"hidden",children:c},H;if((T&Mn)===kt&&a.child!==A){var ie=a.child;H=ie,H.childLanes=rt,H.pendingProps=F,a.mode&Ln&&(H.actualDuration=0,H.actualStartTime=-1,H.selfBaseDuration=A.selfBaseDuration,H.treeBaseDuration=A.treeBaseDuration),a.deletions=null}else H=zw(A,F),H.subtreeFlags=A.subtreeFlags&No;var xe;return k!==null?xe=ep(k,m):(xe=Bd(m,T,v,null),xe.flags|=Rr),xe.return=a,H.return=a,H.sibling=xe,a.child=H,xe}function Av(t,a,c,m){m!==null&&nr(m),Tm(a,t.child,null,c);var v=a.pendingProps,T=v.children,A=Sb(a,T);return A.flags|=Rr,a.memoizedState=null,A}function aS(t,a,c,m,v){var T=a.mode,A={mode:"visible",children:c},k=Cb(A,T),F=Bd(m,T,v,null);return F.flags|=Rr,k.return=a,F.return=a,k.sibling=F,a.child=k,(a.mode&Mn)!==kt&&Tm(a,t.child,null,v),F}function oS(t,a,c){return(t.mode&Mn)===kt?(de("Cannot hydrate Suspense in legacy mode. Switch from ReactDOM.hydrate(element, container) to ReactDOMClient.hydrateRoot(container, <App />).render(element) or remove the Suspense components from the server rendered components."),t.lanes=ln):vd(a)?t.lanes=qu:t.lanes=Hr,null}function sS(t,a,c,m,v,T,A){if(c)if(a.flags&xo){a.flags&=~xo;var ze=db(new Error("There was an error while hydrating this Suspense boundary. Switched to client rendering."));return Av(t,a,A,ze)}else{if(a.memoizedState!==null)return a.child=t.child,a.flags|=wn,null;var Qe=m.children,Ie=m.fallback,ut=aS(t,a,Qe,Ie,A),zt=a.child;return zt.memoizedState=Eb(A),a.memoizedState=Tb,ut}else{if(tt(),(a.mode&Mn)===kt)return Av(t,a,A,null);if(vd(v)){var k,F,H;{var ie=e0(v);k=ie.digest,F=ie.message,H=ie.stack}var xe;F?xe=new Error(F):xe=new Error("The server could not finish this Suspense boundary, likely due to an error during server rendering. Switched to client rendering.");var ye=db(xe,k,H);return Av(t,a,A,ye)}var Be=To(A,t.childLanes);if(vu||Be){var Ue=Uv();if(Ue!==null){var Je=ng(Ue,A);if(Je!==Br&&Je!==T.retryLane){T.retryLane=Je;var Dt=vi;Cs(t,Je),Pa(Ue,t,Je,Dt)}}Zb();var Qt=db(new Error("This Suspense boundary received an update before it finished hydrating. This caused the boundary to switch to client rendering. The usual way to fix this is to wrap the original update in startTransition."));return Av(t,a,A,Qt)}else if(gh(v)){a.flags|=wn,a.child=t.child;var Zt=IC.bind(null,t);return Vy(v,Zt),null}else{pt(a,v,T.treeContext);var ii=m.children,Yn=Sb(a,ii);return Yn.flags|=wa,Yn}}}function Iw(t,a,c){t.lanes=Tn(t.lanes,a);var m=t.alternate;m!==null&&(m.lanes=Tn(m.lanes,a)),Xa(t.return,a,c)}function lS(t,a,c){for(var m=a;m!==null;){if(m.tag===Ge){var v=m.memoizedState;v!==null&&Iw(m,c,t)}else if(m.tag===Ai)Iw(m,c,t);else if(m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)return;for(;m.sibling===null;){if(m.return===null||m.return===t)return;m=m.return}m.sibling.return=m.return,m=m.sibling}}function uS(t){for(var a=t,c=null;a!==null;){var m=a.alternate;m!==null&&sv(m)===null&&(c=a),a=a.sibling}return c}function cS(t){if(t!==void 0&&t!=="forwards"&&t!=="backwards"&&t!=="together"&&!vb[t])if(vb[t]=!0,typeof t=="string")switch(t.toLowerCase()){case"together":case"forwards":case"backwards":{de('"%s" is not a valid value for revealOrder on <SuspenseList />. Use lowercase "%s" instead.',t,t.toLowerCase());break}case"forward":case"backward":{de('"%s" is not a valid value for revealOrder on <SuspenseList />. React uses the -s suffix in the spelling. Use "%ss" instead.',t,t.toLowerCase());break}default:de('"%s" is not a supported revealOrder on <SuspenseList />. Did you mean "together", "forwards" or "backwards"?',t);break}else de('%s is not a supported value for revealOrder on <SuspenseList />. Did you mean "together", "forwards" or "backwards"?',t)}function hS(t,a){t!==void 0&&!Mv[t]&&(t!=="collapsed"&&t!=="hidden"?(Mv[t]=!0,de('"%s" is not a supported value for tail on <SuspenseList />. Did you mean "collapsed" or "hidden"?',t)):a!=="forwards"&&a!=="backwards"&&(Mv[t]=!0,de('<SuspenseList tail="%s" /> is only valid if revealOrder is "forwards" or "backwards". Did you mean to specify revealOrder="forwards"?',t)))}function kw(t,a){{var c=It(t),m=!c&&typeof _a(t)=="function";if(c||m){var v=c?"array":"iterable";return de("A nested %s was passed to row #%s in <SuspenseList />. Wrap it in an additional SuspenseList to configure its revealOrder: <SuspenseList revealOrder=...> ... <SuspenseList revealOrder=...>{%s}</SuspenseList> ... </SuspenseList>",v,a,v),!1}}return!0}function dS(t,a){if((a==="forwards"||a==="backwards")&&t!==void 0&&t!==null&&t!==!1)if(It(t)){for(var c=0;c<t.length;c++)if(!kw(t[c],c))return}else{var m=_a(t);if(typeof m=="function"){var v=m.call(t);if(v)for(var T=v.next(),A=0;!T.done;T=v.next()){if(!kw(T.value,A))return;A++}}else de('A single row was passed to a <SuspenseList revealOrder="%s" />. This is not useful since it needs multiple rows. Did you mean to pass multiple children or an array?',a)}}function Mb(t,a,c,m,v){var T=t.memoizedState;T===null?t.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:m,tail:c,tailMode:v}:(T.isBackwards=a,T.rendering=null,T.renderingStartTime=0,T.last=m,T.tail=c,T.tailMode=v)}function Lw(t,a,c){var m=a.pendingProps,v=m.revealOrder,T=m.tail,A=m.children;cS(v),hS(T,v),dS(A,v),Yo(t,a,A,c);var k=_u.current,F=B0(k,s_);if(F)k=F0(k,s_),a.flags|=wn;else{var H=t!==null&&(t.flags&wn)!==Kt;H&&lS(a,a.child,c),k=Sm(k)}if(Rd(a,k),(a.mode&Mn)===kt)a.memoizedState=null;else switch(v){case"forwards":{var ie=uS(a.child),xe;ie===null?(xe=a.child,a.child=null):(xe=ie.sibling,ie.sibling=null),Mb(a,!1,xe,ie,T);break}case"backwards":{var ye=null,Be=a.child;for(a.child=null;Be!==null;){var Ue=Be.alternate;if(Ue!==null&&sv(Ue)===null){a.child=Be;break}var Je=Be.sibling;Be.sibling=ye,ye=Be,Be=Je}Mb(a,!0,ye,null,T);break}case"together":{Mb(a,!1,null,null,void 0);break}default:a.memoizedState=null}return a.child}function fS(t,a,c){L0(a,a.stateNode.containerInfo);var m=a.pendingProps;return t===null?a.child=Tm(a,null,m,c):Yo(t,a,m,c),a.child}var Ow=!1;function pS(t,a,c){var m=a.type,v=m._context,T=a.pendingProps,A=a.memoizedProps,k=T.value;{"value"in T||Ow||(Ow=!0,de("The `value` prop is required for the `<Context.Provider>`. Did you misspell it or forget to pass it?"));var F=a.type.propTypes;F&&ws(F,T,"prop","Context.Provider")}if(wm(a,v,k),A!==null){var H=A.value;if(So(H,k)){if(A.children===T.children&&!$f())return vh(t,a,c)}else Mo(a,v,c)}var ie=T.children;return Yo(t,a,ie,c),a.child}var Pw=!1;function mS(t,a,c){var m=a.type;m._context===void 0?m!==m.Consumer&&(Pw||(Pw=!0,de("Rendering <Context> directly is not supported and will be removed in a future major release. Did you mean to render <Context.Consumer> instead?"))):m=m._context;var v=a.pendingProps,T=v.children;typeof T!="function"&&de("A context consumer was rendered with multiple children, or a child that isn't a function. A context consumer expects a single child that is a function. If you did pass a function, make sure there is no trailing or leading whitespace around it."),mc(a,c);var A=Ur(m);Re(a);var k;return m_.current=a,oi(!0),k=T(A),oi(!1),wt(),a.flags|=fl,Yo(t,a,k,c),a.child}function __(){vu=!0}function Rv(t,a){(a.mode&Mn)===kt&&t!==null&&(t.alternate=null,a.alternate=null,a.flags|=Rr)}function vh(t,a,c){return t!==null&&(a.dependencies=t.dependencies),_w(),R_(a.lanes),To(c,a.childLanes)?(xE(t,a),a.child):null}function gS(t,a,c){{var m=a.return;if(m===null)throw new Error("Cannot swap the root fiber.");if(t.alternate=null,a.alternate=null,c.index=a.index,c.sibling=a.sibling,c.return=a.return,c.ref=a.ref,a===m.child)m.child=c;else{var v=m.child;if(v===null)throw new Error("Expected parent to have a child.");for(;v.sibling!==a;)if(v=v.sibling,v===null)throw new Error("Expected to find the previous sibling.");v.sibling=c}var T=m.deletions;return T===null?(m.deletions=[t],m.flags|=Ca):T.push(t),c.flags|=Rr,c}}function Ab(t,a){var c=t.lanes;return!!To(c,a)}function _S(t,a,c){switch(a.tag){case at:Aw(a),a.stateNode,fr();break;case bt:V1(a);break;case Ft:{var m=a.type;Ws(m)&&_m(a);break}case gt:L0(a,a.stateNode.containerInfo);break;case zn:{var v=a.memoizedProps.value,T=a.type._context;wm(a,T,v);break}case Oi:{var A=To(c,a.childLanes);A&&(a.flags|=jn);{var k=a.stateNode;k.effectDuration=0,k.passiveEffectDuration=0}}break;case Ge:{var F=a.memoizedState;if(F!==null){if(F.dehydrated!==null)return Rd(a,Sm(_u.current)),a.flags|=wn,null;var H=a.child,ie=H.childLanes;if(To(c,ie))return Dw(t,a,c);Rd(a,Sm(_u.current));var xe=vh(t,a,c);return xe!==null?xe.sibling:null}else Rd(a,Sm(_u.current));break}case Ai:{var ye=(t.flags&wn)!==Kt,Be=To(c,a.childLanes);if(ye){if(Be)return Lw(t,a,c);a.flags|=wn}var Ue=a.memoizedState;if(Ue!==null&&(Ue.rendering=null,Ue.tail=null,Ue.lastEffect=null),Rd(a,_u.current),Be)break;return null}case _n:case On:return a.lanes=rt,Sw(t,a,c)}return vh(t,a,c)}function Bw(t,a,c){if(a._debugNeedsRemount&&t!==null)return gS(t,a,r1(a.type,a.key,a.pendingProps,a._debugOwner||null,a.mode,a.lanes));if(t!==null){var m=t.memoizedProps,v=a.pendingProps;if(m!==v||$f()||a.type!==t.type)vu=!0;else{var T=Ab(t,c);if(!T&&(a.flags&wn)===Kt)return vu=!1,_S(t,a,c);(t.flags&$c)!==Kt?vu=!0:vu=!1}}else if(vu=!1,$n()&&L(a)){var A=a.index,k=N();ce(a,k,A)}switch(a.lanes=rt,a.tag){case Hn:return JE(t,a,a.type,c);case Wr:{var F=a.elementType;return YE(t,a,F,c)}case Oe:{var H=a.type,ie=a.pendingProps,xe=a.elementType===H?ie:Ss(H,ie);return xb(t,a,H,xe,c)}case Ft:{var ye=a.type,Be=a.pendingProps,Ue=a.elementType===ye?Be:Ss(ye,Be);return Mw(t,a,ye,Ue,c)}case at:return ZE(t,a,c);case bt:return XE(t,a,c);case en:return WE(t,a);case Ge:return Dw(t,a,c);case gt:return fS(t,a,c);case Rn:{var Je=a.type,Dt=a.pendingProps,Qt=a.elementType===Je?Dt:Ss(Je,Dt);return ww(t,a,Je,Qt,c)}case Ir:return $E(t,a,c);case Ea:return qE(t,a,c);case Oi:return HE(t,a,c);case zn:return pS(t,a,c);case kr:return mS(t,a,c);case Nn:{var Zt=a.type,ii=a.pendingProps,Yn=Ss(Zt,ii);if(a.type!==a.elementType){var ze=Zt.propTypes;ze&&ws(ze,Yn,"prop",Dn(Zt))}return Yn=Ss(Zt.type,Yn),Tw(t,a,Zt,Yn,c)}case xn:return Ew(t,a,a.type,a.pendingProps,c);case Wt:{var Qe=a.type,Ie=a.pendingProps,ut=a.elementType===Qe?Ie:Ss(Qe,Ie);return KE(t,a,Qe,ut,c)}case Ai:return Lw(t,a,c);case ua:break;case _n:return Sw(t,a,c)}throw new Error("Unknown unit of work tag ("+a.tag+"). This error is likely caused by a bug in React. Please file an issue.")}function zm(t){t.flags|=jn}function Fw(t){t.flags|=ft,t.flags|=Kl}var Uw,Rb,Nw,Vw;Uw=function(t,a,c,m){for(var v=a.child;v!==null;){if(v.tag===bt||v.tag===en)dh(t,v.stateNode);else if(v.tag!==gt){if(v.child!==null){v.child.return=v,v=v.child;continue}}if(v===a)return;for(;v.sibling===null;){if(v.return===null||v.return===a)return;v=v.return}v.sibling.return=v.return,v=v.sibling}},Rb=function(t,a){},Nw=function(t,a,c,m,v){var T=t.memoizedProps;if(T!==m){var A=a.stateNode,k=O0(),F=Oy(A,c,T,m,v,k);a.updateQueue=F,F&&zm(a)}},Vw=function(t,a,c,m){c!==m&&zm(a)};function y_(t,a){if(!$n())switch(t.tailMode){case"hidden":{for(var c=t.tail,m=null;c!==null;)c.alternate!==null&&(m=c),c=c.sibling;m===null?t.tail=null:m.sibling=null;break}case"collapsed":{for(var v=t.tail,T=null;v!==null;)v.alternate!==null&&(T=v),v=v.sibling;T===null?!a&&t.tail!==null?t.tail.sibling=null:t.tail=null:T.sibling=null;break}}}function ro(t){var a=t.alternate!==null&&t.alternate.child===t.child,c=rt,m=Kt;if(a){if((t.mode&Ln)!==kt){for(var F=t.selfBaseDuration,H=t.child;H!==null;)c=Tn(c,Tn(H.lanes,H.childLanes)),m|=H.subtreeFlags&No,m|=H.flags&No,F+=H.treeBaseDuration,H=H.sibling;t.treeBaseDuration=F}else for(var ie=t.child;ie!==null;)c=Tn(c,Tn(ie.lanes,ie.childLanes)),m|=ie.subtreeFlags&No,m|=ie.flags&No,ie.return=t,ie=ie.sibling;t.subtreeFlags|=m}else{if((t.mode&Ln)!==kt){for(var v=t.actualDuration,T=t.selfBaseDuration,A=t.child;A!==null;)c=Tn(c,Tn(A.lanes,A.childLanes)),m|=A.subtreeFlags,m|=A.flags,v+=A.actualDuration,T+=A.treeBaseDuration,A=A.sibling;t.actualDuration=v,t.treeBaseDuration=T}else for(var k=t.child;k!==null;)c=Tn(c,Tn(k.lanes,k.childLanes)),m|=k.subtreeFlags,m|=k.flags,k.return=t,k=k.sibling;t.subtreeFlags|=m}return t.childLanes=c,a}function yS(t,a,c){if(Fi()&&(a.mode&Mn)!==kt&&(a.flags&wn)===Kt)return Ji(a),fr(),a.flags|=xo|Wl|ia,!1;var m=pi(a);if(c!==null&&c.dehydrated!==null)if(t===null){if(!m)throw new Error("A dehydrated suspense component was completed without a hydrated node. This is probably a bug in React.");if(fi(a),ro(a),(a.mode&Ln)!==kt){var v=c!==null;if(v){var T=a.child;T!==null&&(a.treeBaseDuration-=T.treeBaseDuration)}}return!1}else{if(fr(),(a.flags&wn)===Kt&&(a.memoizedState=null),a.flags|=jn,ro(a),(a.mode&Ln)!==kt){var A=c!==null;if(A){var k=a.child;k!==null&&(a.treeBaseDuration-=k.treeBaseDuration)}}return!1}else return ti(),!0}function jw(t,a,c){var m=a.pendingProps;switch(he(a),a.tag){case Hn:case Wr:case xn:case Oe:case Rn:case Ir:case Ea:case Oi:case kr:case Nn:return ro(a),null;case Ft:{var v=a.type;return Ws(v)&&dc(a),ro(a),null}case at:{var T=a.stateNode;if(Em(a),Td(a),N0(),T.pendingContext&&(T.context=T.pendingContext,T.pendingContext=null),t===null||t.child===null){var A=pi(a);if(A)zm(a);else if(t!==null){var k=t.memoizedState;(!k.isDehydrated||(a.flags&xo)!==Kt)&&(a.flags|=ml,ti())}}return Rb(t,a),ro(a),null}case bt:{P0(a);var F=N1(),H=a.type;if(t!==null&&a.stateNode!=null)Nw(t,a,H,m,F),t.ref!==a.ref&&Fw(a);else{if(!m){if(a.stateNode===null)throw new Error("We must have new props for new mounts. This error is likely caused by a bug in React. Please file an issue.");return ro(a),null}var ie=O0(),xe=pi(a);if(xe)Jt(a,F,ie)&&zm(a);else{var ye=Tl(H,m,F,ie,a);Uw(ye,a,!1,!1),a.stateNode=ye,Ly(ye,H,m,F)&&zm(a)}a.ref!==null&&Fw(a)}return ro(a),null}case en:{var Be=m;if(t&&a.stateNode!=null){var Ue=t.memoizedProps;Vw(t,a,Ue,Be)}else{if(typeof Be!="string"&&a.stateNode===null)throw new Error("We must have new props for new mounts. This error is likely caused by a bug in React. Please file an issue.");var Je=N1(),Dt=O0(),Qt=pi(a);Qt?En(a)&&zm(a):a.stateNode=hm(Be,Je,Dt,a)}return ro(a),null}case Ge:{Cm(a);var Zt=a.memoizedState;if(t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){var ii=yS(t,a,Zt);if(!ii)return a.flags&ia?a:null}if((a.flags&wn)!==Kt)return a.lanes=c,(a.mode&Ln)!==kt&&hb(a),a;var Yn=Zt!==null,ze=t!==null&&t.memoizedState!==null;if(Yn!==ze&&Yn){var Qe=a.child;if(Qe.flags|=Fo,(a.mode&Mn)!==kt){var Ie=t===null&&(a.memoizedProps.unstable_avoidThisFallback!==!0||!ha);Ie||B0(_u.current,G1)?vC():Zb()}}var ut=a.updateQueue;if(ut!==null&&(a.flags|=jn),ro(a),(a.mode&Ln)!==kt&&Yn){var zt=a.child;zt!==null&&(a.treeBaseDuration-=zt.treeBaseDuration)}return null}case gt:return Em(a),Rb(t,a),t===null&&h0(a.stateNode.containerInfo),ro(a),null;case zn:var Ct=a.type._context;return i_(Ct,a),ro(a),null;case Wt:{var un=a.type;return Ws(un)&&dc(a),ro(a),null}case Ai:{Cm(a);var vn=a.memoizedState;if(vn===null)return ro(a),null;var qi=(a.flags&wn)!==Kt,wi=vn.rendering;if(wi===null)if(qi)y_(vn,!1);else{var la=bC()&&(t===null||(t.flags&wn)===Kt);if(!la)for(var Ti=a.child;Ti!==null;){var Xr=sv(Ti);if(Xr!==null){qi=!0,a.flags|=wn,y_(vn,!1);var Ro=Xr.updateQueue;return Ro!==null&&(a.updateQueue=Ro,a.flags|=jn),a.subtreeFlags=Kt,bE(a,c),Rd(a,F0(_u.current,s_)),a.child}Ti=Ti.sibling}vn.tail!==null&&j()>uT()&&(a.flags|=wn,qi=!0,y_(vn,!1),a.lanes=kp)}else{if(!qi){var uo=sv(wi);if(uo!==null){a.flags|=wn,qi=!0;var Js=uo.updateQueue;if(Js!==null&&(a.updateQueue=Js,a.flags|=jn),y_(vn,!0),vn.tail===null&&vn.tailMode==="hidden"&&!wi.alternate&&!$n())return ro(a),null}else j()*2-vn.renderingStartTime>uT()&&c!==Hr&&(a.flags|=wn,qi=!0,y_(vn,!1),a.lanes=kp)}if(vn.isBackwards)wi.sibling=a.child,a.child=wi;else{var Qo=vn.last;Qo!==null?Qo.sibling=wi:a.child=wi,vn.last=wi}}if(vn.tail!==null){var es=vn.tail;vn.rendering=es,vn.tail=es.sibling,vn.renderingStartTime=j(),es.sibling=null;var Do=_u.current;return qi?Do=F0(Do,s_):Do=Sm(Do),Rd(a,Do),es}return ro(a),null}case ua:break;case _n:case On:{Hb(a);var Eh=a.memoizedState,Um=Eh!==null;if(t!==null){var L_=t.memoizedState,Tc=L_!==null;Tc!==Um&&!Kn&&(a.flags|=Fo)}return!Um||(a.mode&Mn)===kt?ro(a):To(wc,Hr)&&(ro(a),a.subtreeFlags&(Rr|jn)&&(a.flags|=Fo)),null}case Ut:return null;case Hi:return null}throw new Error("Unknown unit of work tag ("+a.tag+"). This error is likely caused by a bug in React. Please file an issue.")}function vS(t,a,c){switch(he(a),a.tag){case Ft:{var m=a.type;Ws(m)&&dc(a);var v=a.flags;return v&ia?(a.flags=v&~ia|wn,(a.mode&Ln)!==kt&&hb(a),a):null}case at:{a.stateNode,Em(a),Td(a),N0();var T=a.flags;return(T&ia)!==Kt&&(T&wn)===Kt?(a.flags=T&~ia|wn,a):null}case bt:return P0(a),null;case Ge:{Cm(a);var A=a.memoizedState;if(A!==null&&A.dehydrated!==null){if(a.alternate===null)throw new Error("Threw in newly mounted dehydrated component. This is likely a bug in React. Please file an issue.");fr()}var k=a.flags;return k&ia?(a.flags=k&~ia|wn,(a.mode&Ln)!==kt&&hb(a),a):null}case Ai:return Cm(a),null;case gt:return Em(a),null;case zn:var F=a.type._context;return i_(F,a),null;case _n:case On:return Hb(a),null;case Ut:return null;default:return null}}function Gw(t,a,c){switch(he(a),a.tag){case Ft:{var m=a.type.childContextTypes;m!=null&&dc(a);break}case at:{a.stateNode,Em(a),Td(a),N0();break}case bt:{P0(a);break}case gt:Em(a);break;case Ge:Cm(a);break;case Ai:Cm(a);break;case zn:var v=a.type._context;i_(v,a);break;case _n:case On:Hb(a);break}}var $w=null;$w=new Set;var Dv=!1,ao=!1,xS=typeof WeakSet=="function"?WeakSet:Set,Vt=null,Im=null,km=null;function bS(t){Gc(null,function(){throw t}),Fu()}var wS=function(t,a){if(a.props=t.memoizedProps,a.state=t.memoizedState,t.mode&Ln)try{xc(),a.componentWillUnmount()}finally{vc(t)}else a.componentWillUnmount()};function qw(t,a){try{Id(Da,t)}catch(c){ir(t,a,c)}}function Db(t,a,c){try{wS(t,c)}catch(m){ir(t,a,m)}}function TS(t,a,c){try{c.componentDidMount()}catch(m){ir(t,a,m)}}function Hw(t,a){try{Xw(t)}catch(c){ir(t,a,c)}}function Lm(t,a){var c=t.ref;if(c!==null)if(typeof c=="function"){var m;try{if(Yr&&er&&t.mode&Ln)try{xc(),m=c(null)}finally{vc(t)}else m=c(null)}catch(v){ir(t,a,v)}typeof m=="function"&&de("Unexpected return value from a callback ref in %s. A callback ref should not return a function.",dn(t))}else c.current=null}function zv(t,a,c){try{c()}catch(m){ir(t,a,m)}}var Zw=!1;function ES(t,a){Xx(t.containerInfo),Vt=a,SS();var c=Zw;return Zw=!1,c}function SS(){for(;Vt!==null;){var t=Vt,a=t.child;(t.subtreeFlags&Nh)!==Kt&&a!==null?(a.return=t,Vt=a):CS()}}function CS(){for(;Vt!==null;){var t=Vt;Yi(t);try{MS(t)}catch(c){ir(t,t.return,c)}Ci();var a=t.sibling;if(a!==null){a.return=t.return,Vt=a;return}Vt=t.return}}function MS(t){var a=t.alternate,c=t.flags;if((c&ml)!==Kt){switch(Yi(t),t.tag){case Oe:case Rn:case xn:break;case Ft:{if(a!==null){var m=a.memoizedProps,v=a.memoizedState,T=t.stateNode;t.type===t.elementType&&!Wf&&(T.props!==t.memoizedProps&&de("Expected %s props to match memoized props before getSnapshotBeforeUpdate. This might either be because of a bug in React, or because a component reassigns its own `this.props`. Please file an issue.",dn(t)||"instance"),T.state!==t.memoizedState&&de("Expected %s state to match memoized state before getSnapshotBeforeUpdate. This might either be because of a bug in React, or because a component reassigns its own `this.state`. Please file an issue.",dn(t)||"instance"));var A=T.getSnapshotBeforeUpdate(t.elementType===t.type?m:Ss(t.type,m),v);{var k=$w;A===void 0&&!k.has(t.type)&&(k.add(t.type),de("%s.getSnapshotBeforeUpdate(): A snapshot value (or null) must be returned. You have returned undefined.",dn(t)))}T.__reactInternalSnapshotBeforeUpdate=A}break}case at:{{var F=t.stateNode;Bf(F.containerInfo)}break}case bt:case en:case gt:case Wt:break;default:throw new Error("This unit of work tag should not have side-effects. This error is likely caused by a bug in React. Please file an issue.")}Ci()}}function xu(t,a,c){var m=a.updateQueue,v=m!==null?m.lastEffect:null;if(v!==null){var T=v.next,A=T;do{if((A.tag&t)===t){var k=A.destroy;A.destroy=void 0,k!==void 0&&((t&io)!==Ms?Ht(a):(t&Da)!==Ms&&ei(a),(t&gc)!==Ms&&z_(!0),zv(a,c,k),(t&gc)!==Ms&&z_(!1),(t&io)!==Ms?fn():(t&Da)!==Ms&&Gn())}A=A.next}while(A!==T)}}function Id(t,a){var c=a.updateQueue,m=c!==null?c.lastEffect:null;if(m!==null){var v=m.next,T=v;do{if((T.tag&t)===t){(t&io)!==Ms?Pt(a):(t&Da)!==Ms&&Bt(a);var A=T.create;(t&gc)!==Ms&&z_(!0),T.destroy=A(),(t&gc)!==Ms&&z_(!1),(t&io)!==Ms?St():(t&Da)!==Ms&&yt();{var k=T.destroy;if(k!==void 0&&typeof k!="function"){var F=void 0;(T.tag&Da)!==Kt?F="useLayoutEffect":(T.tag&gc)!==Kt?F="useInsertionEffect":F="useEffect";var H=void 0;k===null?H=" You returned null. If your effect does not require clean up, return undefined (or nothing).":typeof k.then=="function"?H=`

It looks like you wrote `+F+`(async () => ...) or returned a Promise. Instead, write the async function inside your effect and call it immediately:

`+F+`(() => {
  async function fetchData() {
    // You can await here
    const response = await MyAPI.getData(someId);
    // ...
  }
  fetchData();
}, [someId]); // Or [] if effect doesn't need props or state

Learn more about data fetching with Hooks: https://reactjs.org/link/hooks-data-fetching`:H=" You returned: "+k,de("%s must not return anything besides a function, which is used for clean-up.%s",F,H)}}}T=T.next}while(T!==v)}}function AS(t,a){if((a.flags&jn)!==Kt)switch(a.tag){case Oi:{var c=a.stateNode.passiveEffectDuration,m=a.memoizedProps,v=m.id,T=m.onPostCommit,A=mw(),k=a.alternate===null?"mount":"update";pw()&&(k="nested-update"),typeof T=="function"&&T(v,k,c,A);var F=a.return;e:for(;F!==null;){switch(F.tag){case at:var H=F.stateNode;H.passiveEffectDuration+=c;break e;case Oi:var ie=F.stateNode;ie.passiveEffectDuration+=c;break e}F=F.return}break}}}function RS(t,a,c,m){if((c.flags&Vu)!==Kt)switch(c.tag){case Oe:case Rn:case xn:{if(!ao)if(c.mode&Ln)try{xc(),Id(Da|Ra,c)}finally{vc(c)}else Id(Da|Ra,c);break}case Ft:{var v=c.stateNode;if(c.flags&jn&&!ao)if(a===null)if(c.type===c.elementType&&!Wf&&(v.props!==c.memoizedProps&&de("Expected %s props to match memoized props before componentDidMount. This might either be because of a bug in React, or because a component reassigns its own `this.props`. Please file an issue.",dn(c)||"instance"),v.state!==c.memoizedState&&de("Expected %s state to match memoized state before componentDidMount. This might either be because of a bug in React, or because a component reassigns its own `this.state`. Please file an issue.",dn(c)||"instance")),c.mode&Ln)try{xc(),v.componentDidMount()}finally{vc(c)}else v.componentDidMount();else{var T=c.elementType===c.type?a.memoizedProps:Ss(c.type,a.memoizedProps),A=a.memoizedState;if(c.type===c.elementType&&!Wf&&(v.props!==c.memoizedProps&&de("Expected %s props to match memoized props before componentDidUpdate. This might either be because of a bug in React, or because a component reassigns its own `this.props`. Please file an issue.",dn(c)||"instance"),v.state!==c.memoizedState&&de("Expected %s state to match memoized state before componentDidUpdate. This might either be because of a bug in React, or because a component reassigns its own `this.state`. Please file an issue.",dn(c)||"instance")),c.mode&Ln)try{xc(),v.componentDidUpdate(T,A,v.__reactInternalSnapshotBeforeUpdate)}finally{vc(c)}else v.componentDidUpdate(T,A,v.__reactInternalSnapshotBeforeUpdate)}var k=c.updateQueue;k!==null&&(c.type===c.elementType&&!Wf&&(v.props!==c.memoizedProps&&de("Expected %s props to match memoized props before processing the update queue. This might either be because of a bug in React, or because a component reassigns its own `this.props`. Please file an issue.",dn(c)||"instance"),v.state!==c.memoizedState&&de("Expected %s state to match memoized state before processing the update queue. This might either be because of a bug in React, or because a component reassigns its own `this.state`. Please file an issue.",dn(c)||"instance")),A1(c,k,v));break}case at:{var F=c.updateQueue;if(F!==null){var H=null;if(c.child!==null)switch(c.child.tag){case bt:H=c.child.stateNode;break;case Ft:H=c.child.stateNode;break}A1(c,F,H)}break}case bt:{var ie=c.stateNode;if(a===null&&c.flags&jn){var xe=c.type,ye=c.memoizedProps;Vg(ie,xe,ye)}break}case en:break;case gt:break;case Oi:{{var Be=c.memoizedProps,Ue=Be.onCommit,Je=Be.onRender,Dt=c.stateNode.effectDuration,Qt=mw(),Zt=a===null?"mount":"update";pw()&&(Zt="nested-update"),typeof Je=="function"&&Je(c.memoizedProps.id,Zt,c.actualDuration,c.treeBaseDuration,c.actualStartTime,Qt);{typeof Ue=="function"&&Ue(c.memoizedProps.id,Zt,Dt,Qt),CC(c);var ii=c.return;e:for(;ii!==null;){switch(ii.tag){case at:var Yn=ii.stateNode;Yn.effectDuration+=Dt;break e;case Oi:var ze=ii.stateNode;ze.effectDuration+=Dt;break e}ii=ii.return}}}break}case Ge:{BS(t,c);break}case Ai:case Wt:case ua:case _n:case On:case Hi:break;default:throw new Error("This unit of work tag should not have side-effects. This error is likely caused by a bug in React. Please file an issue.")}ao||c.flags&ft&&Xw(c)}function DS(t){switch(t.tag){case Oe:case Rn:case xn:{if(t.mode&Ln)try{xc(),qw(t,t.return)}finally{vc(t)}else qw(t,t.return);break}case Ft:{var a=t.stateNode;typeof a.componentDidMount=="function"&&TS(t,t.return,a),Hw(t,t.return);break}case bt:{Hw(t,t.return);break}}}function zS(t,a){for(var c=null,m=t;;){if(m.tag===bt){if(c===null){c=m;try{var v=m.stateNode;a?Kx(v):Of(m.stateNode,m.memoizedProps)}catch(A){ir(t,t.return,A)}}}else if(m.tag===en){if(c===null)try{var T=m.stateNode;a?Lf(T):Pf(T,m.memoizedProps)}catch(A){ir(t,t.return,A)}}else if(!((m.tag===_n||m.tag===On)&&m.memoizedState!==null&&m!==t)){if(m.child!==null){m.child.return=m,m=m.child;continue}}if(m===t)return;for(;m.sibling===null;){if(m.return===null||m.return===t)return;c===m&&(c=null),m=m.return}c===m&&(c=null),m.sibling.return=m.return,m=m.sibling}}function Xw(t){var a=t.ref;if(a!==null){var c=t.stateNode,m;switch(t.tag){case bt:m=c;break;default:m=c}if(typeof a=="function"){var v;if(t.mode&Ln)try{xc(),v=a(m)}finally{vc(t)}else v=a(m);typeof v=="function"&&de("Unexpected return value from a callback ref in %s. A callback ref should not return a function.",dn(t))}else a.hasOwnProperty("current")||de("Unexpected ref object provided for %s. Use either a ref-setter function or React.createRef().",dn(t)),a.current=m}}function IS(t){var a=t.alternate;a!==null&&(a.return=null),t.return=null}function Ww(t){var a=t.alternate;a!==null&&(t.alternate=null,Ww(a));{if(t.child=null,t.deletions=null,t.sibling=null,t.tag===bt){var c=t.stateNode;c!==null&&Sl(c)}t.stateNode=null,t._debugOwner=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}}function kS(t){for(var a=t.return;a!==null;){if(Yw(a))return a;a=a.return}throw new Error("Expected to find a host parent. This error is likely caused by a bug in React. Please file an issue.")}function Yw(t){return t.tag===bt||t.tag===at||t.tag===gt}function Kw(t){var a=t;e:for(;;){for(;a.sibling===null;){if(a.return===null||Yw(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==bt&&a.tag!==en&&a.tag!==In;){if(a.flags&Rr||a.child===null||a.tag===gt)continue e;a.child.return=a,a=a.child}if(!(a.flags&Rr))return a.stateNode}}function LS(t){var a=kS(t);switch(a.tag){case bt:{var c=a.stateNode;a.flags&Uu&&(ph(c),a.flags&=~Uu);var m=Kw(t);Ib(t,m,c);break}case at:case gt:{var v=a.stateNode.containerInfo,T=Kw(t);zb(t,T,v);break}default:throw new Error("Invalid host parent fiber. This error is likely caused by a bug in React. Please file an issue.")}}function zb(t,a,c){var m=t.tag,v=m===bt||m===en;if(v){var T=t.stateNode;a?Yx(c,T,a):Uy(c,T)}else if(m!==gt){var A=t.child;if(A!==null){zb(A,a,c);for(var k=A.sibling;k!==null;)zb(k,a,c),k=k.sibling}}}function Ib(t,a,c){var m=t.tag,v=m===bt||m===en;if(v){var T=t.stateNode;a?Wx(c,T,a):jg(c,T)}else if(m!==gt){var A=t.child;if(A!==null){Ib(A,a,c);for(var k=A.sibling;k!==null;)Ib(k,a,c),k=k.sibling}}}var oo=null,bu=!1;function OS(t,a,c){{var m=a;e:for(;m!==null;){switch(m.tag){case bt:{oo=m.stateNode,bu=!1;break e}case at:{oo=m.stateNode.containerInfo,bu=!0;break e}case gt:{oo=m.stateNode.containerInfo,bu=!0;break e}}m=m.return}if(oo===null)throw new Error("Expected to find a host parent. This error is likely caused by a bug in React. Please file an issue.");Jw(t,a,c),oo=null,bu=!1}IS(c)}function kd(t,a,c){for(var m=c.child;m!==null;)Jw(t,a,m),m=m.sibling}function Jw(t,a,c){switch(De(c),c.tag){case bt:ao||Lm(c,a);case en:{{var m=oo,v=bu;oo=null,kd(t,a,c),oo=m,bu=v,oo!==null&&(bu?mh(oo,c.stateNode):Ny(oo,c.stateNode))}return}case In:{oo!==null&&(bu?oc(oo,c.stateNode):Gg(oo,c.stateNode));return}case gt:{{var T=oo,A=bu;oo=c.stateNode.containerInfo,bu=!0,kd(t,a,c),oo=T,bu=A}return}case Oe:case Rn:case Nn:case xn:{if(!ao){var k=c.updateQueue;if(k!==null){var F=k.lastEffect;if(F!==null){var H=F.next,ie=H;do{var xe=ie,ye=xe.destroy,Be=xe.tag;ye!==void 0&&((Be&gc)!==Ms?zv(c,a,ye):(Be&Da)!==Ms&&(ei(c),c.mode&Ln?(xc(),zv(c,a,ye),vc(c)):zv(c,a,ye),Gn())),ie=ie.next}while(ie!==H)}}}kd(t,a,c);return}case Ft:{if(!ao){Lm(c,a);var Ue=c.stateNode;typeof Ue.componentWillUnmount=="function"&&Db(c,a,Ue)}kd(t,a,c);return}case ua:{kd(t,a,c);return}case _n:{if(c.mode&Mn){var Je=ao;ao=Je||c.memoizedState!==null,kd(t,a,c),ao=Je}else kd(t,a,c);break}default:{kd(t,a,c);return}}}function PS(t){t.memoizedState}function BS(t,a){var c=a.memoizedState;if(c===null){var m=a.alternate;if(m!==null){var v=m.memoizedState;if(v!==null){var T=v.dehydrated;T!==null&&pm(T)}}}}function Qw(t){var a=t.updateQueue;if(a!==null){t.updateQueue=null;var c=t.stateNode;c===null&&(c=t.stateNode=new xS),a.forEach(function(m){var v=kC.bind(null,t,m);if(!c.has(m)){if(c.add(m),we)if(Im!==null&&km!==null)D_(km,Im);else throw Error("Expected finished root and lanes to be set. This is a bug in React.");m.then(v,v)}})}}function FS(t,a,c){Im=c,km=t,Yi(a),eT(a,t),Yi(a),Im=null,km=null}function wu(t,a,c){var m=a.deletions;if(m!==null)for(var v=0;v<m.length;v++){var T=m[v];try{OS(t,a,T)}catch(F){ir(T,a,F)}}var A=Ll();if(a.subtreeFlags&Vh)for(var k=a.child;k!==null;)Yi(k),eT(k,t),k=k.sibling;Yi(A)}function eT(t,a,c){var m=t.alternate,v=t.flags;switch(t.tag){case Oe:case Rn:case Nn:case xn:{if(wu(a,t),bc(t),v&jn){try{xu(gc|Ra,t,t.return),Id(gc|Ra,t)}catch(un){ir(t,t.return,un)}if(t.mode&Ln){try{xc(),xu(Da|Ra,t,t.return)}catch(un){ir(t,t.return,un)}vc(t)}else try{xu(Da|Ra,t,t.return)}catch(un){ir(t,t.return,un)}}return}case Ft:{wu(a,t),bc(t),v&ft&&m!==null&&Lm(m,m.return);return}case bt:{wu(a,t),bc(t),v&ft&&m!==null&&Lm(m,m.return);{if(t.flags&Uu){var T=t.stateNode;try{ph(T)}catch(un){ir(t,t.return,un)}}if(v&jn){var A=t.stateNode;if(A!=null){var k=t.memoizedProps,F=m!==null?m.memoizedProps:k,H=t.type,ie=t.updateQueue;if(t.updateQueue=null,ie!==null)try{By(A,ie,H,F,k,t)}catch(un){ir(t,t.return,un)}}}}return}case en:{if(wu(a,t),bc(t),v&jn){if(t.stateNode===null)throw new Error("This should have a text node initialized. This error is likely caused by a bug in React. Please file an issue.");var xe=t.stateNode,ye=t.memoizedProps,Be=m!==null?m.memoizedProps:ye;try{Fy(xe,Be,ye)}catch(un){ir(t,t.return,un)}}return}case at:{if(wu(a,t),bc(t),v&jn&&m!==null){var Ue=m.memoizedState;if(Ue.isDehydrated)try{fm(a.containerInfo)}catch(un){ir(t,t.return,un)}}return}case gt:{wu(a,t),bc(t);return}case Ge:{wu(a,t),bc(t);var Je=t.child;if(Je.flags&Fo){var Dt=Je.stateNode,Qt=Je.memoizedState,Zt=Qt!==null;if(Dt.isHidden=Zt,Zt){var ii=Je.alternate!==null&&Je.alternate.memoizedState!==null;ii||yC()}}if(v&jn){try{PS(t)}catch(un){ir(t,t.return,un)}Qw(t)}return}case _n:{var Yn=m!==null&&m.memoizedState!==null;if(t.mode&Mn){var ze=ao;ao=ze||Yn,wu(a,t),ao=ze}else wu(a,t);if(bc(t),v&Fo){var Qe=t.stateNode,Ie=t.memoizedState,ut=Ie!==null,zt=t;if(Qe.isHidden=ut,ut&&!Yn&&(zt.mode&Mn)!==kt){Vt=zt;for(var Ct=zt.child;Ct!==null;)Vt=Ct,NS(Ct),Ct=Ct.sibling}zS(zt,ut)}return}case Ai:{wu(a,t),bc(t),v&jn&&Qw(t);return}case ua:return;default:{wu(a,t),bc(t);return}}}function bc(t){var a=t.flags;if(a&Rr){try{LS(t)}catch(c){ir(t,t.return,c)}t.flags&=~Rr}a&wa&&(t.flags&=~wa)}function US(t,a,c){Im=c,km=a,Vt=t,tT(t,a,c),Im=null,km=null}function tT(t,a,c){for(var m=(t.mode&Mn)!==kt;Vt!==null;){var v=Vt,T=v.child;if(v.tag===_n&&m){var A=v.memoizedState!==null,k=A||Dv;if(k){kb(t,a,c);continue}else{var F=v.alternate,H=F!==null&&F.memoizedState!==null,ie=H||ao,xe=Dv,ye=ao;Dv=k,ao=ie,ao&&!ye&&(Vt=v,VS(v));for(var Be=T;Be!==null;)Vt=Be,tT(Be,a,c),Be=Be.sibling;Vt=v,Dv=xe,ao=ye,kb(t,a,c);continue}}(v.subtreeFlags&Vu)!==Kt&&T!==null?(T.return=v,Vt=T):kb(t,a,c)}}function kb(t,a,c){for(;Vt!==null;){var m=Vt;if((m.flags&Vu)!==Kt){var v=m.alternate;Yi(m);try{RS(a,v,m,c)}catch(A){ir(m,m.return,A)}Ci()}if(m===t){Vt=null;return}var T=m.sibling;if(T!==null){T.return=m.return,Vt=T;return}Vt=m.return}}function NS(t){for(;Vt!==null;){var a=Vt,c=a.child;switch(a.tag){case Oe:case Rn:case Nn:case xn:{if(a.mode&Ln)try{xc(),xu(Da,a,a.return)}finally{vc(a)}else xu(Da,a,a.return);break}case Ft:{Lm(a,a.return);var m=a.stateNode;typeof m.componentWillUnmount=="function"&&Db(a,a.return,m);break}case bt:{Lm(a,a.return);break}case _n:{var v=a.memoizedState!==null;if(v){nT(t);continue}break}}c!==null?(c.return=a,Vt=c):nT(t)}}function nT(t){for(;Vt!==null;){var a=Vt;if(a===t){Vt=null;return}var c=a.sibling;if(c!==null){c.return=a.return,Vt=c;return}Vt=a.return}}function VS(t){for(;Vt!==null;){var a=Vt,c=a.child;if(a.tag===_n){var m=a.memoizedState!==null;if(m){iT(t);continue}}c!==null?(c.return=a,Vt=c):iT(t)}}function iT(t){for(;Vt!==null;){var a=Vt;Yi(a);try{DS(a)}catch(m){ir(a,a.return,m)}if(Ci(),a===t){Vt=null;return}var c=a.sibling;if(c!==null){c.return=a.return,Vt=c;return}Vt=a.return}}function jS(t,a,c,m){Vt=a,GS(a,t,c,m)}function GS(t,a,c,m){for(;Vt!==null;){var v=Vt,T=v.child;(v.subtreeFlags&Jl)!==Kt&&T!==null?(T.return=v,Vt=T):$S(t,a,c,m)}}function $S(t,a,c,m){for(;Vt!==null;){var v=Vt;if((v.flags&bo)!==Kt){Yi(v);try{qS(a,v,c,m)}catch(A){ir(v,v.return,A)}Ci()}if(v===t){Vt=null;return}var T=v.sibling;if(T!==null){T.return=v.return,Vt=T;return}Vt=v.return}}function qS(t,a,c,m){switch(a.tag){case Oe:case Rn:case xn:{if(a.mode&Ln){cb();try{Id(io|Ra,a)}finally{ub(a)}}else Id(io|Ra,a);break}}}function HS(t){Vt=t,ZS()}function ZS(){for(;Vt!==null;){var t=Vt,a=t.child;if((Vt.flags&Ca)!==Kt){var c=t.deletions;if(c!==null){for(var m=0;m<c.length;m++){var v=c[m];Vt=v,YS(v,t)}{var T=t.alternate;if(T!==null){var A=T.child;if(A!==null){T.child=null;do{var k=A.sibling;A.sibling=null,A=k}while(A!==null)}}}Vt=t}}(t.subtreeFlags&Jl)!==Kt&&a!==null?(a.return=t,Vt=a):XS()}}function XS(){for(;Vt!==null;){var t=Vt;(t.flags&bo)!==Kt&&(Yi(t),WS(t),Ci());var a=t.sibling;if(a!==null){a.return=t.return,Vt=a;return}Vt=t.return}}function WS(t){switch(t.tag){case Oe:case Rn:case xn:{t.mode&Ln?(cb(),xu(io|Ra,t,t.return),ub(t)):xu(io|Ra,t,t.return);break}}}function YS(t,a){for(;Vt!==null;){var c=Vt;Yi(c),JS(c,a),Ci();var m=c.child;m!==null?(m.return=c,Vt=m):KS(t)}}function KS(t){for(;Vt!==null;){var a=Vt,c=a.sibling,m=a.return;if(Ww(a),a===t){Vt=null;return}if(c!==null){c.return=m,Vt=c;return}Vt=m}}function JS(t,a){switch(t.tag){case Oe:case Rn:case xn:{t.mode&Ln?(cb(),xu(io,t,a),ub(t)):xu(io,t,a);break}}}function QS(t){switch(t.tag){case Oe:case Rn:case xn:{try{Id(Da|Ra,t)}catch(c){ir(t,t.return,c)}break}case Ft:{var a=t.stateNode;try{a.componentDidMount()}catch(c){ir(t,t.return,c)}break}}}function eC(t){switch(t.tag){case Oe:case Rn:case xn:{try{Id(io|Ra,t)}catch(a){ir(t,t.return,a)}break}}}function tC(t){switch(t.tag){case Oe:case Rn:case xn:{try{xu(Da|Ra,t,t.return)}catch(c){ir(t,t.return,c)}break}case Ft:{var a=t.stateNode;typeof a.componentWillUnmount=="function"&&Db(t,t.return,a);break}}}function nC(t){switch(t.tag){case Oe:case Rn:case xn:try{xu(io|Ra,t,t.return)}catch(a){ir(t,t.return,a)}}}if(typeof Symbol=="function"&&Symbol.for){var v_=Symbol.for;v_("selector.component"),v_("selector.has_pseudo_class"),v_("selector.role"),v_("selector.test_id"),v_("selector.text")}var iC=[];function rC(){iC.forEach(function(t){return t()})}var aC=li.ReactCurrentActQueue;function oC(t){{var a=typeof IS_REACT_ACT_ENVIRONMENT<"u"?IS_REACT_ACT_ENVIRONMENT:void 0,c=typeof jest<"u";return c&&a!==!1}}function rT(){{var t=typeof IS_REACT_ACT_ENVIRONMENT<"u"?IS_REACT_ACT_ENVIRONMENT:void 0;return!t&&aC.current!==null&&de("The current testing environment is not configured to support act(...)"),t}}var sC=Math.ceil,Lb=li.ReactCurrentDispatcher,Ob=li.ReactCurrentOwner,so=li.ReactCurrentBatchConfig,Tu=li.ReactCurrentActQueue,ka=0,aT=1,lo=2,zl=4,xh=0,x_=1,Yf=2,Iv=3,b_=4,oT=5,Pb=6,ni=ka,Ko=null,Nr=null,La=rt,wc=rt,Bb=mu(rt),Oa=xh,w_=null,kv=rt,T_=rt,Lv=rt,E_=null,As=null,Fb=0,sT=500,lT=1/0,lC=500,bh=null;function S_(){lT=j()+lC}function uT(){return lT}var Ov=!1,Ub=null,Om=null,Kf=!1,Ld=null,C_=rt,Nb=[],Vb=null,uC=50,M_=0,jb=null,Gb=!1,Pv=!1,cC=50,Pm=0,Bv=null,A_=vi,Fv=rt,cT=!1;function Uv(){return Ko}function Jo(){return(ni&(lo|zl))!==ka?j():(A_!==vi||(A_=j()),A_)}function Od(t){var a=t.mode;if((a&Mn)===kt)return ln;if((ni&lo)!==ka&&La!==rt)return zr(La);var c=Fr()!==Zi;if(c){if(so.transition!==null){var m=so.transition;m._updatedFibers||(m._updatedFibers=new Set),m._updatedFibers.add(t)}return Fv===Br&&(Fv=$s()),Fv}var v=ms();if(v!==Br)return v;var T=Ng();return T}function hC(t){var a=t.mode;return(a&Mn)===kt?ln:fs()}function Pa(t,a,c,m){OC(),cT&&de("useInsertionEffect must not schedule updates."),Gb&&(Pv=!0),ef(t,c,m),(ni&lo)!==rt&&t===Ko?FC(a):(we&&ig(t,a,c),UC(a),t===Ko&&((ni&lo)===ka&&(T_=Tn(T_,c)),Oa===b_&&Pd(t,La)),Rs(t,m),c===ln&&ni===ka&&(a.mode&Mn)===kt&&!Tu.isBatchingLegacy&&(S_(),o()))}function dC(t,a,c){var m=t.current;m.lanes=a,ef(t,a,c),Rs(t,c)}function fC(t){return(ni&lo)!==ka}function Rs(t,a){var c=t.callbackNode;js(t,a);var m=Pp(t,t===Ko?La:rt);if(m===rt){c!==null&&CT(c),t.callbackNode=null,t.callbackPriority=Br;return}var v=ra(m),T=t.callbackPriority;if(T===v&&!(Tu.current!==null&&c!==Yb)){c==null&&T!==ln&&de("Expected scheduled callback to exist. This error is likely caused by a bug in React. Please file an issue.");return}c!=null&&CT(c);var A;if(v===ln)t.tag===fc?(Tu.isBatchingLegacy!==null&&(Tu.didScheduleLegacyUpdate=!0),i(fT.bind(null,t))):e(fT.bind(null,t)),Tu.current!==null?Tu.current.push(l):Py(function(){(ni&(lo|zl))===ka&&l()}),A=null;else{var k;switch(ag(m)){case Go:k=X;break;case Hs:k=Y;break;case nu:k=G;break;case Xh:k=ee;break;default:k=G;break}A=Kb(k,hT.bind(null,t))}t.callbackPriority=v,t.callbackNode=A}function hT(t,a){if(OE(),A_=vi,Fv=rt,(ni&(lo|zl))!==ka)throw new Error("Should not already be working.");var c=t.callbackNode,m=Th();if(m&&t.callbackNode!==c)return null;var v=Pp(t,t===Ko?La:rt);if(v===rt)return null;var T=!Jd(t,v)&&!eg(t,v)&&!a,A=T?TC(t,v):Vv(t,v);if(A!==xh){if(A===Yf){var k=Qm(t);k!==rt&&(v=k,A=$b(t,k))}if(A===x_){var F=w_;throw Jf(t,rt),Pd(t,v),Rs(t,j()),F}if(A===Pb)Pd(t,v);else{var H=!Jd(t,v),ie=t.current.alternate;if(H&&!mC(ie)){if(A=Vv(t,v),A===Yf){var xe=Qm(t);xe!==rt&&(v=xe,A=$b(t,xe))}if(A===x_){var ye=w_;throw Jf(t,rt),Pd(t,v),Rs(t,j()),ye}}t.finishedWork=ie,t.finishedLanes=v,pC(t,A,v)}}return Rs(t,j()),t.callbackNode===c?hT.bind(null,t):null}function $b(t,a){var c=E_;if(tf(t)){var m=Jf(t,a);m.flags|=xo,Zg(t.containerInfo)}var v=Vv(t,a);if(v!==Yf){var T=As;As=c,T!==null&&dT(T)}return v}function dT(t){As===null?As=t:As.push.apply(As,t)}function pC(t,a,c){switch(a){case xh:case x_:throw new Error("Root did not complete. This is a bug in React.");case Yf:{Qf(t,As,bh);break}case Iv:{if(Pd(t,c),eu(c)&&!MT()){var m=Fb+sT-j();if(m>10){var v=Pp(t,rt);if(v!==rt)break;var T=t.suspendedLanes;if(!qs(T,c)){Jo(),Wu(t,T);break}t.timeoutHandle=ac(Qf.bind(null,t,As,bh),m);break}}Qf(t,As,bh);break}case b_:{if(Pd(t,c),Un(c))break;if(!MT()){var A=O_(t,c),k=A,F=j()-k,H=LC(F)-F;if(H>10){t.timeoutHandle=ac(Qf.bind(null,t,As,bh),H);break}}Qf(t,As,bh);break}case oT:{Qf(t,As,bh);break}default:throw new Error("Unknown root exit status.")}}function mC(t){for(var a=t;;){if(a.flags&Nu){var c=a.updateQueue;if(c!==null){var m=c.stores;if(m!==null)for(var v=0;v<m.length;v++){var T=m[v],A=T.getSnapshot,k=T.value;try{if(!So(A(),k))return!1}catch{return!1}}}}var F=a.child;if(a.subtreeFlags&Nu&&F!==null){F.return=a,a=F;continue}if(a===t)return!0;for(;a.sibling===null;){if(a.return===null||a.return===t)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}return!0}function Pd(t,a){a=Qd(a,Lv),a=Qd(a,T_),tu(t,a)}function fT(t){if(PE(),(ni&(lo|zl))!==ka)throw new Error("Should not already be working.");Th();var a=Pp(t,rt);if(!To(a,ln))return Rs(t,j()),null;var c=Vv(t,a);if(t.tag!==fc&&c===Yf){var m=Qm(t);m!==rt&&(a=m,c=$b(t,m))}if(c===x_){var v=w_;throw Jf(t,rt),Pd(t,a),Rs(t,j()),v}if(c===Pb)throw new Error("Root did not complete. This is a bug in React.");var T=t.current.alternate;return t.finishedWork=T,t.finishedLanes=a,Qf(t,As,bh),Rs(t,j()),null}function gC(t,a){a!==rt&&(Zh(t,Tn(a,ln)),Rs(t,j()),(ni&(lo|zl))===ka&&(S_(),l()))}function qb(t,a){var c=ni;ni|=aT;try{return t(a)}finally{ni=c,ni===ka&&!Tu.isBatchingLegacy&&(S_(),o())}}function _C(t,a,c,m,v){var T=ms(),A=so.transition;try{return so.transition=null,dr(Go),t(a,c,m,v)}finally{dr(T),so.transition=A,ni===ka&&S_()}}function wh(t){Ld!==null&&Ld.tag===fc&&(ni&(lo|zl))===ka&&Th();var a=ni;ni|=aT;var c=so.transition,m=ms();try{return so.transition=null,dr(Go),t?t():void 0}finally{dr(m),so.transition=c,ni=a,(ni&(lo|zl))===ka&&l()}}function pT(){return(ni&(lo|zl))!==ka}function Nv(t,a){Za(Bb,wc,t),wc=Tn(wc,a)}function Hb(t){wc=Bb.current,oa(Bb,t)}function Jf(t,a){t.finishedWork=null,t.finishedLanes=rt;var c=t.timeoutHandle;if(c!==fh&&(t.timeoutHandle=fh,zf(c)),Nr!==null)for(var m=Nr.return;m!==null;){var v=m.alternate;Gw(v,m),m=m.return}Ko=t;var T=ep(t.current,null);return Nr=T,La=wc=a,Oa=xh,w_=null,kv=rt,T_=rt,Lv=rt,E_=null,As=null,cE(),An.discardPendingWarnings(),T}function mT(t,a){do{var c=Nr;try{if(Cd(),q1(),Ci(),Ob.current=null,c===null||c.return===null){Oa=x_,w_=a,Nr=null;return}if(Yr&&c.mode&Ln&&Cv(c,!0),da)if(wt(),a!==null&&typeof a=="object"&&typeof a.then=="function"){var m=a;hi(c,m,La)}else _i(c,a,La);VE(t,c.return,c,a,La),vT(c)}catch(v){a=v,Nr===c&&c!==null?(c=c.return,Nr=c):c=Nr;continue}return}while(!0)}function gT(){var t=Lb.current;return Lb.current=bv,t===null?bv:t}function _T(t){Lb.current=t}function yC(){Fb=j()}function R_(t){kv=Tn(t,kv)}function vC(){Oa===xh&&(Oa=Iv)}function Zb(){(Oa===xh||Oa===Iv||Oa===Yf)&&(Oa=b_),Ko!==null&&(qt(kv)||qt(T_))&&Pd(Ko,La)}function xC(t){Oa!==b_&&(Oa=Yf),E_===null?E_=[t]:E_.push(t)}function bC(){return Oa===xh}function Vv(t,a){var c=ni;ni|=lo;var m=gT();if(Ko!==t||La!==a){if(we){var v=t.memoizedUpdaters;v.size>0&&(D_(t,La),v.clear()),P_(t,a)}bh=rg(),Jf(t,a)}Mi(a);do try{wC();break}catch(T){mT(t,T)}while(!0);if(Cd(),ni=c,_T(m),Nr!==null)throw new Error("Cannot commit an incomplete root. This error is likely caused by a bug in React. Please file an issue.");return Fn(),Ko=null,La=rt,Oa}function wC(){for(;Nr!==null;)yT(Nr)}function TC(t,a){var c=ni;ni|=lo;var m=gT();if(Ko!==t||La!==a){if(we){var v=t.memoizedUpdaters;v.size>0&&(D_(t,La),v.clear()),P_(t,a)}bh=rg(),S_(),Jf(t,a)}Mi(a);do try{EC();break}catch(T){mT(t,T)}while(!0);return Cd(),_T(m),ni=c,Nr!==null?(yi(),xh):(Fn(),Ko=null,La=rt,Oa)}function EC(){for(;Nr!==null&&!D();)yT(Nr)}function yT(t){var a=t.alternate;Yi(t);var c;(t.mode&Ln)!==kt?(lb(t),c=Xb(a,t,wc),Cv(t,!0)):c=Xb(a,t,wc),Ci(),t.memoizedProps=t.pendingProps,c===null?vT(t):Nr=c,Ob.current=null}function vT(t){var a=t;do{var c=a.alternate,m=a.return;if((a.flags&Wl)===Kt){Yi(a);var v=void 0;if((a.mode&Ln)===kt?v=jw(c,a,wc):(lb(a),v=jw(c,a,wc),Cv(a,!1)),Ci(),v!==null){Nr=v;return}}else{var T=vS(c,a);if(T!==null){T.flags&=Wd,Nr=T;return}if((a.mode&Ln)!==kt){Cv(a,!1);for(var A=a.actualDuration,k=a.child;k!==null;)A+=k.actualDuration,k=k.sibling;a.actualDuration=A}if(m!==null)m.flags|=Wl,m.subtreeFlags=Kt,m.deletions=null;else{Oa=Pb,Nr=null;return}}var F=a.sibling;if(F!==null){Nr=F;return}a=m,Nr=a}while(a!==null);Oa===xh&&(Oa=oT)}function Qf(t,a,c){var m=ms(),v=so.transition;try{so.transition=null,dr(Go),SC(t,a,c,m)}finally{so.transition=v,dr(m)}return null}function SC(t,a,c,m){do Th();while(Ld!==null);if(PC(),(ni&(lo|zl))!==ka)throw new Error("Should not already be working.");var v=t.finishedWork,T=t.finishedLanes;if(it(T),v===null)return be(),null;if(T===rt&&de("root.finishedLanes should not be empty during a commit. This is a bug in React."),t.finishedWork=null,t.finishedLanes=rt,v===t.current)throw new Error("Cannot commit the same tree as before. This error is likely caused by a bug in React. Please file an issue.");t.callbackNode=null,t.callbackPriority=Br;var A=Tn(v.lanes,v.childLanes);Vp(t,A),t===Ko&&(Ko=null,Nr=null,La=rt),((v.subtreeFlags&Jl)!==Kt||(v.flags&Jl)!==Kt)&&(Kf||(Kf=!0,Vb=c,Kb(G,function(){return Th(),null})));var k=(v.subtreeFlags&(Nh|Vh|Vu|Jl))!==Kt,F=(v.flags&(Nh|Vh|Vu|Jl))!==Kt;if(k||F){var H=so.transition;so.transition=null;var ie=ms();dr(Go);var xe=ni;ni|=zl,Ob.current=null,ES(t,v),gw(),FS(t,v,T),Fg(t.containerInfo),t.current=v,Va(T),US(v,t,T),Qa(),B(),ni=xe,dr(ie),so.transition=H}else t.current=v,gw();var ye=Kf;if(Kf?(Kf=!1,Ld=t,C_=T):(Pm=0,Bv=null),A=t.pendingLanes,A===rt&&(Om=null),ye||TT(t.current,!1),Ee(v.stateNode,m),we&&t.memoizedUpdaters.clear(),rC(),Rs(t,j()),a!==null)for(var Be=t.onRecoverableError,Ue=0;Ue<a.length;Ue++){var Je=a[Ue],Dt=Je.stack,Qt=Je.digest;Be(Je.value,{componentStack:Dt,digest:Qt})}if(Ov){Ov=!1;var Zt=Ub;throw Ub=null,Zt}return To(C_,ln)&&t.tag!==fc&&Th(),A=t.pendingLanes,To(A,ln)?(LE(),t===jb?M_++:(M_=0,jb=t)):M_=0,l(),be(),null}function Th(){if(Ld!==null){var t=ag(C_),a=Yh(nu,t),c=so.transition,m=ms();try{return so.transition=null,dr(a),MC()}finally{dr(m),so.transition=c}}return!1}function CC(t){Nb.push(t),Kf||(Kf=!0,Kb(G,function(){return Th(),null}))}function MC(){if(Ld===null)return!1;var t=Vb;Vb=null;var a=Ld,c=C_;if(Ld=null,C_=rt,(ni&(lo|zl))!==ka)throw new Error("Cannot flush passive effects while already rendering.");Gb=!0,Pv=!1,Ma(c);var m=ni;ni|=zl,HS(a.current),jS(a,a.current,c,t);{var v=Nb;Nb=[];for(var T=0;T<v.length;T++){var A=v[T];AS(a,A)}}hs(),TT(a.current,!0),ni=m,l(),Pv?a===Bv?Pm++:(Pm=0,Bv=a):Pm=0,Gb=!1,Pv=!1,je(a);{var k=a.current.stateNode;k.effectDuration=0,k.passiveEffectDuration=0}return!0}function xT(t){return Om!==null&&Om.has(t)}function AC(t){Om===null?Om=new Set([t]):Om.add(t)}function RC(t){Ov||(Ov=!0,Ub=t)}var DC=RC;function bT(t,a,c){var m=Xf(c,a),v=yw(t,m,ln),T=Md(t,v,ln),A=Jo();T!==null&&(ef(T,ln,A),Rs(T,A))}function ir(t,a,c){if(bS(c),z_(!1),t.tag===at){bT(t,t,c);return}var m=null;for(m=a;m!==null;){if(m.tag===at){bT(m,t,c);return}else if(m.tag===Ft){var v=m.type,T=m.stateNode;if(typeof v.getDerivedStateFromError=="function"||typeof T.componentDidCatch=="function"&&!xT(T)){var A=Xf(c,t),k=pb(m,A,ln),F=Md(m,k,ln),H=Jo();F!==null&&(ef(F,ln,H),Rs(F,H));return}}m=m.return}de(`Internal React error: Attempted to capture a commit phase error inside a detached tree. This indicates a bug in React. Likely causes include deleting the same fiber more than once, committing an already-finished tree, or an inconsistent return pointer.

Error message:

%s`,c)}function zC(t,a,c){var m=t.pingCache;m!==null&&m.delete(a);var v=Jo();Wu(t,c),NC(t),Ko===t&&qs(La,c)&&(Oa===b_||Oa===Iv&&eu(La)&&j()-Fb<sT?Jf(t,rt):Lv=Tn(Lv,c)),Rs(t,v)}function wT(t,a){a===Br&&(a=hC(t));var c=Jo(),m=Cs(t,a);m!==null&&(ef(m,a,c),Rs(m,c))}function IC(t){var a=t.memoizedState,c=Br;a!==null&&(c=a.retryLane),wT(t,c)}function kC(t,a){var c=Br,m;switch(t.tag){case Ge:m=t.stateNode;var v=t.memoizedState;v!==null&&(c=v.retryLane);break;case Ai:m=t.stateNode;break;default:throw new Error("Pinged unknown suspense boundary type. This is probably a bug in React.")}m!==null&&m.delete(a),wT(t,c)}function LC(t){return t<120?120:t<480?480:t<1080?1080:t<1920?1920:t<3e3?3e3:t<4320?4320:sC(t/1960)*1960}function OC(){if(M_>uC)throw M_=0,jb=null,new Error("Maximum update depth exceeded. This can happen when a component repeatedly calls setState inside componentWillUpdate or componentDidUpdate. React limits the number of nested updates to prevent infinite loops.");Pm>cC&&(Pm=0,Bv=null,de("Maximum update depth exceeded. This can happen when a component calls setState inside useEffect, but useEffect either doesn't have a dependency array, or one of the dependencies changes on every render."))}function PC(){An.flushLegacyContextWarning(),An.flushPendingUnsafeLifecycleWarnings()}function TT(t,a){Yi(t),jv(t,Uo,tC),a&&jv(t,qc,nC),jv(t,Uo,QS),a&&jv(t,qc,eC),Ci()}function jv(t,a,c){for(var m=t,v=null;m!==null;){var T=m.subtreeFlags&a;m!==v&&m.child!==null&&T!==Kt?m=m.child:((m.flags&a)!==Kt&&c(m),m.sibling!==null?m=m.sibling:m=v=m.return)}}var Gv=null;function ET(t){{if((ni&lo)!==ka||!(t.mode&Mn))return;var a=t.tag;if(a!==Hn&&a!==at&&a!==Ft&&a!==Oe&&a!==Rn&&a!==Nn&&a!==xn)return;var c=dn(t)||"ReactComponent";if(Gv!==null){if(Gv.has(c))return;Gv.add(c)}else Gv=new Set([c]);var m=kn;try{Yi(t),de("Can't perform a React state update on a component that hasn't mounted yet. This indicates that you have a side-effect in your render function that asynchronously later calls tries to update the component. Move this work to useEffect instead.")}finally{m?Yi(t):Ci()}}}var Xb;{var BC=null;Xb=function(t,a,c){var m=IT(BC,a);try{return Bw(t,a,c)}catch(T){if(st()||T!==null&&typeof T=="object"&&typeof T.then=="function")throw T;if(Cd(),q1(),Gw(t,a),IT(a,m),a.mode&Ln&&lb(a),Gc(null,Bw,null,t,a,c),bp()){var v=Fu();typeof v=="object"&&v!==null&&v._suppressLogging&&typeof T=="object"&&T!==null&&!T._suppressLogging&&(T._suppressLogging=!0)}throw T}}}var ST=!1,Wb;Wb=new Set;function FC(t){if(Lo&&!zE())switch(t.tag){case Oe:case Rn:case xn:{var a=Nr&&dn(Nr)||"Unknown",c=a;if(!Wb.has(c)){Wb.add(c);var m=dn(t)||"Unknown";de("Cannot update a component (`%s`) while rendering a different component (`%s`). To locate the bad setState() call inside `%s`, follow the stack trace as described in https://reactjs.org/link/setstate-in-render",m,a,a)}break}case Ft:{ST||(de("Cannot update during an existing state transition (such as within `render`). Render methods should be a pure function of props and state."),ST=!0);break}}}function D_(t,a){if(we){var c=t.memoizedUpdaters;c.forEach(function(m){ig(t,m,a)})}}var Yb={};function Kb(t,a){{var c=Tu.current;return c!==null?(c.push(a),Yb):C(t,a)}}function CT(t){if(t!==Yb)return z(t)}function MT(){return Tu.current!==null}function UC(t){{if(t.mode&Mn){if(!rT())return}else if(!oC()||ni!==ka||t.tag!==Oe&&t.tag!==Rn&&t.tag!==xn)return;if(Tu.current===null){var a=kn;try{Yi(t),de(`An update to %s inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act`,dn(t))}finally{a?Yi(t):Ci()}}}}function NC(t){t.tag!==fc&&rT()&&Tu.current===null&&de(`A suspended resource finished loading inside a test, but the event was not wrapped in act(...).

When testing, code that resolves suspended data should be wrapped into act(...):

act(() => {
  /* finish loading suspended data */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act`)}function z_(t){cT=t}var Il=null,Bm=null,VC=function(t){Il=t};function Fm(t){{if(Il===null)return t;var a=Il(t);return a===void 0?t:a.current}}function Jb(t){return Fm(t)}function Qb(t){{if(Il===null)return t;var a=Il(t);if(a===void 0){if(t!=null&&typeof t.render=="function"){var c=Fm(t.render);if(t.render!==c){var m={$$typeof:Te,render:c};return t.displayName!==void 0&&(m.displayName=t.displayName),m}}return t}return a.current}}function AT(t,a){{if(Il===null)return!1;var c=t.elementType,m=a.type,v=!1,T=typeof m=="object"&&m!==null?m.$$typeof:null;switch(t.tag){case Ft:{typeof m=="function"&&(v=!0);break}case Oe:{(typeof m=="function"||T===ot)&&(v=!0);break}case Rn:{(T===Te||T===ot)&&(v=!0);break}case Nn:case xn:{(T===ct||T===ot)&&(v=!0);break}default:return!1}if(v){var A=Il(c);if(A!==void 0&&A===Il(m))return!0}return!1}}function RT(t){{if(Il===null||typeof WeakSet!="function")return;Bm===null&&(Bm=new WeakSet),Bm.add(t)}}var jC=function(t,a){{if(Il===null)return;var c=a.staleFamilies,m=a.updatedFamilies;Th(),wh(function(){e1(t.current,m,c)})}},GC=function(t,a){{if(t.context!==to)return;Th(),wh(function(){I_(a,t,null,null)})}};function e1(t,a,c){{var m=t.alternate,v=t.child,T=t.sibling,A=t.tag,k=t.type,F=null;switch(A){case Oe:case xn:case Ft:F=k;break;case Rn:F=k.render;break}if(Il===null)throw new Error("Expected resolveFamily to be set during hot reload.");var H=!1,ie=!1;if(F!==null){var xe=Il(F);xe!==void 0&&(c.has(xe)?ie=!0:a.has(xe)&&(A===Ft?ie=!0:H=!0))}if(Bm!==null&&(Bm.has(t)||m!==null&&Bm.has(m))&&(ie=!0),ie&&(t._debugNeedsRemount=!0),ie||H){var ye=Cs(t,ln);ye!==null&&Pa(ye,t,ln,vi)}v!==null&&!ie&&e1(v,a,c),T!==null&&e1(T,a,c)}}var $C=function(t,a){{var c=new Set,m=new Set(a.map(function(v){return v.current}));return t1(t.current,m,c),c}};function t1(t,a,c){{var m=t.child,v=t.sibling,T=t.tag,A=t.type,k=null;switch(T){case Oe:case xn:case Ft:k=A;break;case Rn:k=A.render;break}var F=!1;k!==null&&a.has(k)&&(F=!0),F?qC(t,c):m!==null&&t1(m,a,c),v!==null&&t1(v,a,c)}}function qC(t,a){{var c=HC(t,a);if(c)return;for(var m=t;;){switch(m.tag){case bt:a.add(m.stateNode);return;case gt:a.add(m.stateNode.containerInfo);return;case at:a.add(m.stateNode.containerInfo);return}if(m.return===null)throw new Error("Expected to reach root first.");m=m.return}}}function HC(t,a){for(var c=t,m=!1;;){if(c.tag===bt)m=!0,a.add(c.stateNode);else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===t)return m;for(;c.sibling===null;){if(c.return===null||c.return===t)return m;c=c.return}c.sibling.return=c.return,c=c.sibling}return!1}var n1;{n1=!1;try{var DT=Object.preventExtensions({})}catch{n1=!0}}function ZC(t,a,c,m){this.tag=t,this.key=c,this.elementType=null,this.type=null,this.stateNode=null,this.return=null,this.child=null,this.sibling=null,this.index=0,this.ref=null,this.pendingProps=a,this.memoizedProps=null,this.updateQueue=null,this.memoizedState=null,this.dependencies=null,this.mode=m,this.flags=Kt,this.subtreeFlags=Kt,this.deletions=null,this.lanes=rt,this.childLanes=rt,this.alternate=null,this.actualDuration=Number.NaN,this.actualStartTime=Number.NaN,this.selfBaseDuration=Number.NaN,this.treeBaseDuration=Number.NaN,this.actualDuration=0,this.actualStartTime=-1,this.selfBaseDuration=0,this.treeBaseDuration=0,this._debugSource=null,this._debugOwner=null,this._debugNeedsRemount=!1,this._debugHookTypes=null,!n1&&typeof Object.preventExtensions=="function"&&Object.preventExtensions(this)}var Ks=function(t,a,c,m){return new ZC(t,a,c,m)};function i1(t){var a=t.prototype;return!!(a&&a.isReactComponent)}function XC(t){return typeof t=="function"&&!i1(t)&&t.defaultProps===void 0}function WC(t){if(typeof t=="function")return i1(t)?Ft:Oe;if(t!=null){var a=t.$$typeof;if(a===Te)return Rn;if(a===ct)return Nn}return Hn}function ep(t,a){var c=t.alternate;c===null?(c=Ks(t.tag,a,t.key,t.mode),c.elementType=t.elementType,c.type=t.type,c.stateNode=t.stateNode,c._debugSource=t._debugSource,c._debugOwner=t._debugOwner,c._debugHookTypes=t._debugHookTypes,c.alternate=t,t.alternate=c):(c.pendingProps=a,c.type=t.type,c.flags=Kt,c.subtreeFlags=Kt,c.deletions=null,c.actualDuration=0,c.actualStartTime=-1),c.flags=t.flags&No,c.childLanes=t.childLanes,c.lanes=t.lanes,c.child=t.child,c.memoizedProps=t.memoizedProps,c.memoizedState=t.memoizedState,c.updateQueue=t.updateQueue;var m=t.dependencies;switch(c.dependencies=m===null?null:{lanes:m.lanes,firstContext:m.firstContext},c.sibling=t.sibling,c.index=t.index,c.ref=t.ref,c.selfBaseDuration=t.selfBaseDuration,c.treeBaseDuration=t.treeBaseDuration,c._debugNeedsRemount=t._debugNeedsRemount,c.tag){case Hn:case Oe:case xn:c.type=Fm(t.type);break;case Ft:c.type=Jb(t.type);break;case Rn:c.type=Qb(t.type);break}return c}function YC(t,a){t.flags&=No|Rr;var c=t.alternate;if(c===null)t.childLanes=rt,t.lanes=a,t.child=null,t.subtreeFlags=Kt,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null,t.selfBaseDuration=0,t.treeBaseDuration=0;else{t.childLanes=c.childLanes,t.lanes=c.lanes,t.child=c.child,t.subtreeFlags=Kt,t.deletions=null,t.memoizedProps=c.memoizedProps,t.memoizedState=c.memoizedState,t.updateQueue=c.updateQueue,t.type=c.type;var m=c.dependencies;t.dependencies=m===null?null:{lanes:m.lanes,firstContext:m.firstContext},t.selfBaseDuration=c.selfBaseDuration,t.treeBaseDuration=c.treeBaseDuration}return t}function KC(t,a,c){var m;return t===Ed?(m=Mn,a===!0&&(m|=Wn,m|=vr)):m=kt,we&&(m|=Ln),Ks(at,null,null,m)}function r1(t,a,c,m,v,T){var A=Hn,k=t;if(typeof t=="function")i1(t)?(A=Ft,k=Jb(k)):k=Fm(k);else if(typeof t=="string")A=bt;else{e:switch(t){case Z:return Bd(c.children,v,T,a);case se:A=Ea,v|=Wn,(v&Mn)!==kt&&(v|=vr);break;case pe:return JC(c,v,T,a);case We:return QC(c,v,T,a);case qe:return e2(c,v,T,a);case on:return zT(c,v,T,a);case cn:case _t:case Rt:case ai:case Lt:default:{if(typeof t=="object"&&t!==null)switch(t.$$typeof){case ue:A=zn;break e;case _e:A=kr;break e;case Te:A=Rn,k=Qb(k);break e;case ct:A=Nn;break e;case ot:A=Wr,k=null;break e}var F="";{(t===void 0||typeof t=="object"&&t!==null&&Object.keys(t).length===0)&&(F+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var H=m?dn(m):null;H&&(F+=`

Check the render method of \``+H+"`.")}throw new Error("Element type is invalid: expected a string (for built-in components) or a class/function (for composite components) "+("but got: "+(t==null?t:typeof t)+"."+F))}}}var ie=Ks(A,c,a,v);return ie.elementType=t,ie.type=k,ie.lanes=T,ie._debugOwner=m,ie}function a1(t,a,c){var m=null;m=t._owner;var v=t.type,T=t.key,A=t.props,k=r1(v,T,A,m,a,c);return k._debugSource=t._source,k._debugOwner=t._owner,k}function Bd(t,a,c,m){var v=Ks(Ir,t,m,a);return v.lanes=c,v}function JC(t,a,c,m){typeof t.id!="string"&&de('Profiler must specify an "id" of type `string` as a prop. Received the type `%s` instead.',typeof t.id);var v=Ks(Oi,t,m,a|Ln);return v.elementType=pe,v.lanes=c,v.stateNode={effectDuration:0,passiveEffectDuration:0},v}function QC(t,a,c,m){var v=Ks(Ge,t,m,a);return v.elementType=We,v.lanes=c,v}function e2(t,a,c,m){var v=Ks(Ai,t,m,a);return v.elementType=qe,v.lanes=c,v}function zT(t,a,c,m){var v=Ks(_n,t,m,a);v.elementType=on,v.lanes=c;var T={isHidden:!1};return v.stateNode=T,v}function o1(t,a,c){var m=Ks(en,t,null,a);return m.lanes=c,m}function t2(){var t=Ks(bt,null,null,kt);return t.elementType="DELETED",t}function n2(t){var a=Ks(In,null,null,kt);return a.stateNode=t,a}function s1(t,a,c){var m=t.children!==null?t.children:[],v=Ks(gt,m,t.key,a);return v.lanes=c,v.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},v}function IT(t,a){return t===null&&(t=Ks(Hn,null,null,kt)),t.tag=a.tag,t.key=a.key,t.elementType=a.elementType,t.type=a.type,t.stateNode=a.stateNode,t.return=a.return,t.child=a.child,t.sibling=a.sibling,t.index=a.index,t.ref=a.ref,t.pendingProps=a.pendingProps,t.memoizedProps=a.memoizedProps,t.updateQueue=a.updateQueue,t.memoizedState=a.memoizedState,t.dependencies=a.dependencies,t.mode=a.mode,t.flags=a.flags,t.subtreeFlags=a.subtreeFlags,t.deletions=a.deletions,t.lanes=a.lanes,t.childLanes=a.childLanes,t.alternate=a.alternate,t.actualDuration=a.actualDuration,t.actualStartTime=a.actualStartTime,t.selfBaseDuration=a.selfBaseDuration,t.treeBaseDuration=a.treeBaseDuration,t._debugSource=a._debugSource,t._debugOwner=a._debugOwner,t._debugNeedsRemount=a._debugNeedsRemount,t._debugHookTypes=a._debugHookTypes,t}function i2(t,a,c,m,v){this.tag=a,this.containerInfo=t,this.pendingChildren=null,this.current=null,this.pingCache=null,this.finishedWork=null,this.timeoutHandle=fh,this.context=null,this.pendingContext=null,this.callbackNode=null,this.callbackPriority=Br,this.eventTimes=Np(rt),this.expirationTimes=Np(vi),this.pendingLanes=rt,this.suspendedLanes=rt,this.pingedLanes=rt,this.expiredLanes=rt,this.mutableReadLanes=rt,this.finishedLanes=rt,this.entangledLanes=rt,this.entanglements=Np(rt),this.identifierPrefix=m,this.onRecoverableError=v,this.mutableSourceEagerHydrationData=null,this.effectDuration=0,this.passiveEffectDuration=0;{this.memoizedUpdaters=new Set;for(var T=this.pendingUpdatersLaneMap=[],A=0;A<wo;A++)T.push(new Set)}switch(a){case Ed:this._debugRootType=c?"hydrateRoot()":"createRoot()";break;case fc:this._debugRootType=c?"hydrate()":"render()";break}}function kT(t,a,c,m,v,T,A,k,F,H){var ie=new i2(t,a,c,k,F),xe=KC(a,T);ie.current=xe,xe.stateNode=ie;{var ye={element:m,isDehydrated:c,cache:null,transitions:null,pendingSuspenseBoundaries:null};xe.memoizedState=ye}return m0(xe),ie}var l1="18.2.0";function r2(t,a,c){var m=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;return pa(m),{$$typeof:O,key:m==null?null:""+m,children:t,containerInfo:a,implementation:c}}var u1,c1;u1=!1,c1={};function LT(t){if(!t)return to;var a=Xl(t),c=Xy(a);if(a.tag===Ft){var m=a.type;if(Ws(m))return e_(a,m,c)}return c}function a2(t,a){{var c=Xl(t);if(c===void 0){if(typeof t.render=="function")throw new Error("Unable to find node on an unmounted component.");var m=Object.keys(t).join(",");throw new Error("Argument appears to not be a ReactComponent. Keys: "+m)}var v=g(c);if(v===null)return null;if(v.mode&Wn){var T=dn(c)||"Component";if(!c1[T]){c1[T]=!0;var A=kn;try{Yi(v),c.mode&Wn?de("%s is deprecated in StrictMode. %s was passed an instance of %s which is inside StrictMode. Instead, add a ref directly to the element you want to reference. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-find-node",a,a,T):de("%s is deprecated in StrictMode. %s was passed an instance of %s which renders StrictMode children. Instead, add a ref directly to the element you want to reference. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-find-node",a,a,T)}finally{A?Yi(A):Ci()}}}return v.stateNode}}function OT(t,a,c,m,v,T,A,k){var F=!1,H=null;return kT(t,a,F,H,c,m,v,T,A)}function PT(t,a,c,m,v,T,A,k,F,H){var ie=!0,xe=kT(c,m,ie,t,v,T,A,k,F);xe.context=LT(null);var ye=xe.current,Be=Jo(),Ue=Od(ye),Je=yh(Be,Ue);return Je.callback=a??null,Md(ye,Je,Ue),dC(xe,Ue,Be),xe}function I_(t,a,c,m){nt(a,t);var v=a.current,T=Jo(),A=Od(v);hr(A);var k=LT(c);a.context===null?a.context=k:a.pendingContext=k,Lo&&kn!==null&&!u1&&(u1=!0,de(`Render methods should be a pure function of props and state; triggering nested component updates from render is not allowed. If necessary, trigger nested updates in componentDidUpdate.

Check the render method of %s.`,dn(kn)||"Unknown"));var F=yh(T,A);F.payload={element:t},m=m===void 0?null:m,m!==null&&(typeof m!="function"&&de("render(...): Expected the last optional `callback` argument to be a function. Instead received: %s.",m),F.callback=m);var H=Md(v,F,A);return H!==null&&(Pa(H,v,A,T),Qy(H,v,A)),A}function $v(t){var a=t.current;if(!a.child)return null;switch(a.child.tag){case bt:return a.child.stateNode;default:return a.child.stateNode}}function o2(t){switch(t.tag){case at:{var a=t.stateNode;if(tf(a)){var c=Yv(a);gC(a,c)}break}case Ge:{wh(function(){var v=Cs(t,ln);if(v!==null){var T=Jo();Pa(v,t,ln,T)}});var m=ln;h1(t,m);break}}}function BT(t,a){var c=t.memoizedState;c!==null&&c.dehydrated!==null&&(c.retryLane=tg(c.retryLane,a))}function h1(t,a){BT(t,a);var c=t.alternate;c&&BT(c,a)}function s2(t){if(t.tag===Ge){var a=Ql,c=Cs(t,a);if(c!==null){var m=Jo();Pa(c,t,a,m)}h1(t,a)}}function l2(t){if(t.tag===Ge){var a=Od(t),c=Cs(t,a);if(c!==null){var m=Jo();Pa(c,t,a,m)}h1(t,a)}}function FT(t){var a=w(t);return a===null?null:a.stateNode}var UT=function(t){return null};function u2(t){return UT(t)}var NT=function(t){return!1};function c2(t){return NT(t)}var VT=null,jT=null,GT=null,$T=null,qT=null,HT=null,ZT=null,XT=null,WT=null;{var YT=function(t,a,c){var m=a[c],v=It(t)?t.slice():an({},t);return c+1===a.length?(It(v)?v.splice(m,1):delete v[m],v):(v[m]=YT(t[m],a,c+1),v)},KT=function(t,a){return YT(t,a,0)},JT=function(t,a,c,m){var v=a[m],T=It(t)?t.slice():an({},t);if(m+1===a.length){var A=c[m];T[A]=T[v],It(T)?T.splice(v,1):delete T[v]}else T[v]=JT(t[v],a,c,m+1);return T},QT=function(t,a,c){if(a.length!==c.length){Sn("copyWithRename() expects paths of the same length");return}else for(var m=0;m<c.length-1;m++)if(a[m]!==c[m]){Sn("copyWithRename() expects paths to be the same except for the deepest key");return}return JT(t,a,c,0)},eE=function(t,a,c,m){if(c>=a.length)return m;var v=a[c],T=It(t)?t.slice():an({},t);return T[v]=eE(t[v],a,c+1,m),T},tE=function(t,a,c){return eE(t,a,0,c)},d1=function(t,a){for(var c=t.memoizedState;c!==null&&a>0;)c=c.next,a--;return c};VT=function(t,a,c,m){var v=d1(t,a);if(v!==null){var T=tE(v.memoizedState,c,m);v.memoizedState=T,v.baseState=T,t.memoizedProps=an({},t.memoizedProps);var A=Cs(t,ln);A!==null&&Pa(A,t,ln,vi)}},jT=function(t,a,c){var m=d1(t,a);if(m!==null){var v=KT(m.memoizedState,c);m.memoizedState=v,m.baseState=v,t.memoizedProps=an({},t.memoizedProps);var T=Cs(t,ln);T!==null&&Pa(T,t,ln,vi)}},GT=function(t,a,c,m){var v=d1(t,a);if(v!==null){var T=QT(v.memoizedState,c,m);v.memoizedState=T,v.baseState=T,t.memoizedProps=an({},t.memoizedProps);var A=Cs(t,ln);A!==null&&Pa(A,t,ln,vi)}},$T=function(t,a,c){t.pendingProps=tE(t.memoizedProps,a,c),t.alternate&&(t.alternate.pendingProps=t.pendingProps);var m=Cs(t,ln);m!==null&&Pa(m,t,ln,vi)},qT=function(t,a){t.pendingProps=KT(t.memoizedProps,a),t.alternate&&(t.alternate.pendingProps=t.pendingProps);var c=Cs(t,ln);c!==null&&Pa(c,t,ln,vi)},HT=function(t,a,c){t.pendingProps=QT(t.memoizedProps,a,c),t.alternate&&(t.alternate.pendingProps=t.pendingProps);var m=Cs(t,ln);m!==null&&Pa(m,t,ln,vi)},ZT=function(t){var a=Cs(t,ln);a!==null&&Pa(a,t,ln,vi)},XT=function(t){UT=t},WT=function(t){NT=t}}function h2(t){var a=g(t);return a===null?null:a.stateNode}function d2(t){return null}function f2(){return kn}function p2(t){var a=t.findFiberByHostInstance,c=li.ReactCurrentDispatcher;return ve({bundleType:t.bundleType,version:t.version,rendererPackageName:t.rendererPackageName,rendererConfig:t.rendererConfig,overrideHookState:VT,overrideHookStateDeletePath:jT,overrideHookStateRenamePath:GT,overrideProps:$T,overridePropsDeletePath:qT,overridePropsRenamePath:HT,setErrorHandler:XT,setSuspenseHandler:WT,scheduleUpdate:ZT,currentDispatcherRef:c,findHostInstanceByFiber:h2,findFiberByHostInstance:a||d2,findHostInstancesForRefresh:$C,scheduleRefresh:jC,scheduleRoot:GC,setRefreshHandler:VC,getCurrentFiber:f2,reconcilerVersion:l1})}var nE=typeof reportError=="function"?reportError:function(t){console.error(t)};function f1(t){this._internalRoot=t}qv.prototype.render=f1.prototype.render=function(t){var a=this._internalRoot;if(a===null)throw new Error("Cannot update an unmounted root.");{typeof arguments[1]=="function"?de("render(...): does not support the second callback argument. To execute a side effect after rendering, declare it in a component body with useEffect()."):Hv(arguments[1])?de("You passed a container to the second argument of root.render(...). You don't need to pass it again since you already passed it to create the root."):typeof arguments[1]<"u"&&de("You passed a second argument to root.render(...) but it only accepts one argument.");var c=a.containerInfo;if(c.nodeType!==cr){var m=FT(a.current);m&&m.parentNode!==c&&de("render(...): It looks like the React-rendered content of the root container was removed without using React. This is not supported and will cause errors. Instead, call root.unmount() to empty a root's container.")}}I_(t,a,null,null)},qv.prototype.unmount=f1.prototype.unmount=function(){typeof arguments[0]=="function"&&de("unmount(...): does not support a callback argument. To execute a side effect after rendering, declare it in a component body with useEffect().");var t=this._internalRoot;if(t!==null){this._internalRoot=null;var a=t.containerInfo;pT()&&de("Attempted to synchronously unmount a root while React was already rendering. React cannot finish unmounting the root until the current render has completed, which may lead to a race condition."),wh(function(){I_(null,t,null,null)}),fu(a)}};function m2(t,a){if(!Hv(t))throw new Error("createRoot(...): Target container is not a DOM element.");iE(t);var c=!1,m=!1,v="",T=nE;a!=null&&(a.hydrate?Sn("hydrate through createRoot is deprecated. Use ReactDOMClient.hydrateRoot(container, <App />) instead."):typeof a=="object"&&a!==null&&a.$$typeof===K&&de(`You passed a JSX element to createRoot. You probably meant to call root.render instead. Example usage:

  let root = createRoot(domContainer);
  root.render(<App />);`),a.unstable_strictMode===!0&&(c=!0),a.identifierPrefix!==void 0&&(v=a.identifierPrefix),a.onRecoverableError!==void 0&&(T=a.onRecoverableError),a.transitionCallbacks!==void 0&&a.transitionCallbacks);var A=OT(t,Ed,null,c,m,v,T);Zo(A.current,t);var k=t.nodeType===cr?t.parentNode:t;return wf(k),new f1(A)}function qv(t){this._internalRoot=t}function g2(t){t&&af(t)}qv.prototype.unstable_scheduleHydration=g2;function _2(t,a,c){if(!Hv(t))throw new Error("hydrateRoot(...): Target container is not a DOM element.");iE(t),a===void 0&&de("Must provide initial children as second argument to hydrateRoot. Example usage: hydrateRoot(domContainer, <App />)");var m=c??null,v=c!=null&&c.hydratedSources||null,T=!1,A=!1,k="",F=nE;c!=null&&(c.unstable_strictMode===!0&&(T=!0),c.identifierPrefix!==void 0&&(k=c.identifierPrefix),c.onRecoverableError!==void 0&&(F=c.onRecoverableError));var H=PT(a,null,t,Ed,m,T,A,k,F);if(Zo(H.current,t),wf(t),v)for(var ie=0;ie<v.length;ie++){var xe=v[ie];SE(H,xe)}return new qv(H)}function Hv(t){return!!(t&&(t.nodeType===ta||t.nodeType===rs||t.nodeType===Rh||!rr))}function k_(t){return!!(t&&(t.nodeType===ta||t.nodeType===rs||t.nodeType===Rh||t.nodeType===cr&&t.nodeValue===" react-mount-point-unstable "))}function iE(t){t.nodeType===ta&&t.tagName&&t.tagName.toUpperCase()==="BODY"&&de("createRoot(): Creating roots directly with document.body is discouraged, since its children are often manipulated by third-party scripts and browser extensions. This may lead to subtle reconciliation issues. Try using a container element created for your app."),lc(t)&&(t._reactRootContainer?de("You are calling ReactDOMClient.createRoot() on a container that was previously passed to ReactDOM.render(). This is not supported."):de("You are calling ReactDOMClient.createRoot() on a container that has already been passed to createRoot() before. Instead, call root.render() on the existing root instead if you want to update it."))}var y2=li.ReactCurrentOwner,rE;rE=function(t){if(t._reactRootContainer&&t.nodeType!==cr){var a=FT(t._reactRootContainer.current);a&&a.parentNode!==t&&de("render(...): It looks like the React-rendered content of this container was removed without using React. This is not supported and will cause errors. Instead, call ReactDOM.unmountComponentAtNode to empty a container.")}var c=!!t._reactRootContainer,m=p1(t),v=!!(m&&pu(m));v&&!c&&de("render(...): Replacing React-rendered children with a new root component. If you intended to update the children of this node, you should instead have the existing children update their state and render the new components instead of calling ReactDOM.render."),t.nodeType===ta&&t.tagName&&t.tagName.toUpperCase()==="BODY"&&de("render(): Rendering components directly into document.body is discouraged, since its children are often manipulated by third-party scripts and browser extensions. This may lead to subtle reconciliation issues. Try rendering into a container element created for your app.")};function p1(t){return t?t.nodeType===rs?t.documentElement:t.firstChild:null}function aE(){}function v2(t,a,c,m,v){if(v){if(typeof m=="function"){var T=m;m=function(){var ye=$v(A);T.call(ye)}}var A=PT(a,m,t,fc,null,!1,!1,"",aE);t._reactRootContainer=A,Zo(A.current,t);var k=t.nodeType===cr?t.parentNode:t;return wf(k),wh(),A}else{for(var F;F=t.lastChild;)t.removeChild(F);if(typeof m=="function"){var H=m;m=function(){var ye=$v(ie);H.call(ye)}}var ie=OT(t,fc,null,!1,!1,"",aE);t._reactRootContainer=ie,Zo(ie.current,t);var xe=t.nodeType===cr?t.parentNode:t;return wf(xe),wh(function(){I_(a,ie,c,m)}),ie}}function x2(t,a){t!==null&&typeof t!="function"&&de("%s(...): Expected the last optional `callback` argument to be a function. Instead received: %s.",a,t)}function Zv(t,a,c,m,v){rE(c),x2(v===void 0?null:v,"render");var T=c._reactRootContainer,A;if(!T)A=v2(c,a,t,v,m);else{if(A=T,typeof v=="function"){var k=v;v=function(){var F=$v(A);k.call(F)}}I_(a,A,t,v)}return $v(A)}function b2(t){{var a=y2.current;if(a!==null&&a.stateNode!==null){var c=a.stateNode._warnedAboutRefsInRender;c||de("%s is accessing findDOMNode inside its render(). render() should be a pure function of props and state. It should never access something that requires stale data from the previous render, such as refs. Move this logic to componentDidMount and componentDidUpdate instead.",Dn(a.type)||"A component"),a.stateNode._warnedAboutRefsInRender=!0}}return t==null?null:t.nodeType===ta?t:a2(t,"findDOMNode")}function w2(t,a,c){if(de("ReactDOM.hydrate is no longer supported in React 18. Use hydrateRoot instead. Until you switch to the new API, your app will behave as if it's running React 17. Learn more: https://reactjs.org/link/switch-to-createroot"),!k_(a))throw new Error("Target container is not a DOM element.");{var m=lc(a)&&a._reactRootContainer===void 0;m&&de("You are calling ReactDOM.hydrate() on a container that was previously passed to ReactDOMClient.createRoot(). This is not supported. Did you mean to call hydrateRoot(container, element)?")}return Zv(null,t,a,!0,c)}function T2(t,a,c){if(de("ReactDOM.render is no longer supported in React 18. Use createRoot instead. Until you switch to the new API, your app will behave as if it's running React 17. Learn more: https://reactjs.org/link/switch-to-createroot"),!k_(a))throw new Error("Target container is not a DOM element.");{var m=lc(a)&&a._reactRootContainer===void 0;m&&de("You are calling ReactDOM.render() on a container that was previously passed to ReactDOMClient.createRoot(). This is not supported. Did you mean to call root.render(element)?")}return Zv(null,t,a,!1,c)}function E2(t,a,c,m){if(de("ReactDOM.unstable_renderSubtreeIntoContainer() is no longer supported in React 18. Consider using a portal instead. Until you switch to the createRoot API, your app will behave as if it's running React 17. Learn more: https://reactjs.org/link/switch-to-createroot"),!k_(c))throw new Error("Target container is not a DOM element.");if(t==null||!wp(t))throw new Error("parentComponent must be a valid React Component");return Zv(t,a,c,!1,m)}function S2(t){if(!k_(t))throw new Error("unmountComponentAtNode(...): Target container is not a DOM element.");{var a=lc(t)&&t._reactRootContainer===void 0;a&&de("You are calling ReactDOM.unmountComponentAtNode() on a container that was previously passed to ReactDOMClient.createRoot(). This is not supported. Did you mean to call root.unmount()?")}if(t._reactRootContainer){{var c=p1(t),m=c&&!pu(c);m&&de("unmountComponentAtNode(): The node you're attempting to unmount was rendered by another copy of React.")}return wh(function(){Zv(null,null,t,!1,function(){t._reactRootContainer=null,fu(t)})}),!0}else{{var v=p1(t),T=!!(v&&pu(v)),A=t.nodeType===ta&&k_(t.parentNode)&&!!t.parentNode._reactRootContainer;T&&de("unmountComponentAtNode(): The node you're attempting to unmount was rendered by React and is not a top-level container. %s",A?"You may have accidentally passed in a React root node instead of its container.":"Instead, have the parent component update its state and rerender in order to remove this component.")}return!1}}Jv(o2),U_(s2),Zs(l2),Kc(ms),Jc(B_),(typeof Map!="function"||Map.prototype==null||typeof Map.prototype.forEach!="function"||typeof Set!="function"||Set.prototype==null||typeof Set.prototype.clear!="function"||typeof Set.prototype.forEach!="function")&&de("React depends on Map and Set built-in types. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),mp(Dy),qm(qb,_C,wh);function C2(t,a){var c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(!Hv(a))throw new Error("Target container is not a DOM element.");return r2(t,a,null,c)}function M2(t,a,c,m){return E2(t,a,c,m)}var m1={usingClientEntryPoint:!1,Events:[pu,_h,wd,$l,Fc,qb]};function A2(t,a){return m1.usingClientEntryPoint||de('You are importing createRoot from "react-dom" which is not supported. You should instead import it from "react-dom/client".'),m2(t,a)}function R2(t,a,c){return m1.usingClientEntryPoint||de('You are importing hydrateRoot from "react-dom" which is not supported. You should instead import it from "react-dom/client".'),_2(t,a,c)}function D2(t){return pT()&&de("flushSync was called from inside a lifecycle method. React cannot flush when React is already rendering. Consider moving this call to a scheduler task or micro task."),wh(t)}var z2=p2({findFiberByHostInstance:uc,bundleType:1,version:l1,rendererPackageName:"react-dom"});if(!z2&&mi&&window.top===window.self&&(navigator.userAgent.indexOf("Chrome")>-1&&navigator.userAgent.indexOf("Edge")===-1||navigator.userAgent.indexOf("Firefox")>-1)){var oE=window.location.protocol;/^(https?|file):$/.test(oE)&&console.info("%cDownload the React DevTools for a better development experience: https://reactjs.org/link/react-devtools"+(oE==="file:"?`
You might need to use a local HTTP server (instead of file://): https://reactjs.org/link/react-devtools-faq`:""),"font-weight:bold")}Qs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=m1,Qs.createPortal=C2,Qs.createRoot=A2,Qs.findDOMNode=b2,Qs.flushSync=D2,Qs.hydrate=w2,Qs.hydrateRoot=R2,Qs.render=T2,Qs.unmountComponentAtNode=S2,Qs.unstable_batchedUpdates=qb,Qs.unstable_renderSubtreeIntoContainer=M2,Qs.version=l1,typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(new Error)})();(function(At){At.exports=Qs})(N2);var g1=x1;{var Xv=g1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;v1.createRoot=function(At,xt){Xv.usingClientEntryPoint=!0;try{return g1.createRoot(At,xt)}finally{Xv.usingClientEntryPoint=!1}},v1.hydrateRoot=function(At,xt,li){Xv.usingClientEntryPoint=!0;try{return g1.hydrateRoot(At,xt,li)}finally{Xv.usingClientEntryPoint=!1}}}var tp={},j2={get exports(){return tp},set exports(At){tp=At}};(function(At,xt){(function(li,Qi){At.exports=Qi()})(L2,function(){var li,Qi,Ei;function Sn(u,Oe){if(!li)li=Oe;else if(!Qi)Qi=Oe;else{var Ft="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+li+")(sharedChunk); ("+Qi+")(sharedChunk); self.onerror = null;",Hn={};li(Hn),Ei=Oe(Hn),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(Ei.workerUrl=window.URL.createObjectURL(new Blob([Ft],{type:"text/javascript"})))}}Sn(["exports"],function(u){var Oe=typeof self<"u"?self:{},Ft="2.12.0";let Hn;const at={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(Hn==null){const n=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{Hn={}.API_URL_REGEX!=null?new RegExp({}.API_URL_REGEX):n}catch{Hn=n}}return Hn},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},gt={supported:!1,testSupport:function(n){!Ir&&en&&(Ea?kr(n):bt=n)}};let bt,en,Ir=!1,Ea=!1;function kr(n){const e=n.createTexture();n.bindTexture(n.TEXTURE_2D,e);try{if(n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,en),n.isContextLost())return;gt.supported=!0}catch{}n.deleteTexture(e),Ir=!0}Oe.document&&(en=Oe.document.createElement("img"),en.onload=function(){bt&&kr(bt),bt=null,Ea=!0},en.onerror=function(){Ir=!0,bt=null},en.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const zn="01";var Rn=Oi;function Oi(n,e,i,o){this.cx=3*n,this.bx=3*(i-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(o-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=e,this.p2x=i,this.p2y=o}Oi.prototype={sampleCurveX:function(n){return((this.ax*n+this.bx)*n+this.cx)*n},sampleCurveY:function(n){return((this.ay*n+this.by)*n+this.cy)*n},sampleCurveDerivativeX:function(n){return(3*this.ax*n+2*this.bx)*n+this.cx},solveCurveX:function(n,e){if(e===void 0&&(e=1e-6),n<0)return 0;if(n>1)return 1;for(var i=n,o=0;o<8;o++){var l=this.sampleCurveX(i)-n;if(Math.abs(l)<e)return i;var d=this.sampleCurveDerivativeX(i);if(Math.abs(d)<1e-6)break;i-=l/d}var p=0,_=1;for(i=n,o=0;o<20&&(l=this.sampleCurveX(i),!(Math.abs(l-n)<e));o++)n>l?p=i:_=i,i=.5*(_-p)+p;return i},solve:function(n,e){return this.sampleCurveY(this.solveCurveX(n,e))}};var Ge=Nn;function Nn(n,e){this.x=n,this.y=e}Nn.prototype={clone:function(){return new Nn(this.x,this.y)},add:function(n){return this.clone()._add(n)},sub:function(n){return this.clone()._sub(n)},multByPoint:function(n){return this.clone()._multByPoint(n)},divByPoint:function(n){return this.clone()._divByPoint(n)},mult:function(n){return this.clone()._mult(n)},div:function(n){return this.clone()._div(n)},rotate:function(n){return this.clone()._rotate(n)},rotateAround:function(n,e){return this.clone()._rotateAround(n,e)},matMult:function(n){return this.clone()._matMult(n)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(n){return this.x===n.x&&this.y===n.y},dist:function(n){return Math.sqrt(this.distSqr(n))},distSqr:function(n){var e=n.x-this.x,i=n.y-this.y;return e*e+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(n){return Math.atan2(this.y-n.y,this.x-n.x)},angleWith:function(n){return this.angleWithSep(n.x,n.y)},angleWithSep:function(n,e){return Math.atan2(this.x*e-this.y*n,this.x*n+this.y*e)},_matMult:function(n){var e=n[2]*this.x+n[3]*this.y;return this.x=n[0]*this.x+n[1]*this.y,this.y=e,this},_add:function(n){return this.x+=n.x,this.y+=n.y,this},_sub:function(n){return this.x-=n.x,this.y-=n.y,this},_mult:function(n){return this.x*=n,this.y*=n,this},_div:function(n){return this.x/=n,this.y/=n,this},_multByPoint:function(n){return this.x*=n.x,this.y*=n.y,this},_divByPoint:function(n){return this.x/=n.x,this.y/=n.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var n=this.y;return this.y=this.x,this.x=-n,this},_rotate:function(n){var e=Math.cos(n),i=Math.sin(n),o=i*this.x+e*this.y;return this.x=e*this.x-i*this.y,this.y=o,this},_rotateAround:function(n,e){var i=Math.cos(n),o=Math.sin(n),l=e.y+o*(this.x-e.x)+i*(this.y-e.y);return this.x=e.x+i*(this.x-e.x)-o*(this.y-e.y),this.y=l,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Nn.convert=function(n){return n instanceof Nn?n:Array.isArray(n)?new Nn(n[0],n[1]):n};const xn=Math.PI/180,Wr=180/Math.PI;function Wt(n){return n*xn}function In(n){return n*Wr}const Ai=[[0,0],[1,0],[1,1],[0,1]];function ua(n){if(n<=0)return 0;if(n>=1)return 1;const e=n*n,i=e*n;return 4*(n<.5?i:3*(n-e)+i-.75)}function _n(n,e,i,o){const l=new Rn(n,e,i,o);return function(d){return l.solve(d)}}const On=_n(.25,.1,.25,1);function Ut(n,e,i){return Math.min(i,Math.max(e,n))}function Hi(n,e,i){return(i=Ut((i-n)/(e-n),0,1))*i*(3-2*i)}function rn(n,e,i){const o=i-e,l=((n-e)%o+o)%o+e;return l===e?i:l}function Xi(n,e,i){if(!n.length)return i(null,[]);let o=n.length;const l=new Array(n.length);let d=null;n.forEach((p,_)=>{e(p,(x,b)=>{x&&(d=x),l[_]=b,--o==0&&i(d,l)})})}function ca(n){const e=[];for(const i in n)e.push(n[i]);return e}function Kn(n,...e){for(const i of e)for(const o in i)n[o]=i[o];return n}let ha=1;function rr(){return ha++}function ar(){return function n(e){return e?(e^Math.random()*(16>>e/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,n)}()}function or(n){return n<=1?1:Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function da(n){return!!n&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(n)}function Yr(n,e){n.forEach(i=>{e[i]&&(e[i]=e[i].bind(e))})}function er(n,e){return n.indexOf(e,n.length-e.length)!==-1}function Lr(n,e,i){const o={};for(const l in n)o[l]=e.call(i||this,n[l],l,n);return o}function mr(n,e,i){const o={};for(const l in n)e.call(i||this,n[l],l,n)&&(o[l]=n[l]);return o}function Ui(n){return Array.isArray(n)?n.map(Ui):typeof n=="object"&&n?Lr(n,Ui):n}const fa={};function Vn(n){fa[n]||(typeof console<"u"&&console.warn(n),fa[n]=!0)}function mi(n,e,i){return(i.y-n.y)*(e.x-n.x)>(e.y-n.y)*(i.x-n.x)}function Yt(n){let e=0;for(let i,o,l=0,d=n.length,p=d-1;l<d;p=l++)i=n[l],o=n[p],e+=(o.x-i.x)*(i.y+o.y);return e}function Ri(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function sr(n){const e={};if(n.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(i,o,l,d)=>{const p=l||d;return e[o]=!p||p.toLowerCase(),""}),e["max-age"]){const i=parseInt(e["max-age"],10);isNaN(i)?delete e["max-age"]:e["max-age"]=i}return e}let Pi=null;function Vr(n){if(Pi==null){const e=n.navigator?n.navigator.userAgent:null;Pi=!!n.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return Pi}function pa(n){try{const e=Oe[n];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}function gr(n,e){return[n[4*e],n[4*e+1],n[4*e+2],n[4*e+3]]}const Ba="mapbox-tiles";let Ni,lr,Kr=500,Cr=50;function jr(){try{return Oe.caches}catch{}}function Di(){jr()&&!Ni&&(Ni=Oe.caches.open(Ba))}function ma(n){const e=n.indexOf("?");if(e<0)return n;const i=function(l){const d=l.indexOf("?");return d>0?l.slice(d+1).split("&"):[]}(n),o=i.filter(l=>{const d=l.split("=");return d[0]==="language"||d[0]==="worldview"});return o.length?`${n.slice(0,e)}?${o.join("&")}`:n.slice(0,e)}let Fa=1/0;const _r={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(_r);class vt extends Error{constructor(e,i,o){i===401&&gi(o)&&(e+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(e),this.status=i,this.url=o}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Nt=Ri()?()=>self.worker&&self.worker.referrer:()=>(Oe.location.protocol==="blob:"?Oe.parent:Oe).location.href,sn=function(n,e){if(!(/^file:/.test(i=n.url)||/^file:/.test(Nt())&&!/^\w+:/.test(i))){if(Oe.fetch&&Oe.Request&&Oe.AbortController&&Oe.Request.prototype.hasOwnProperty("signal"))return function(o,l){const d=new Oe.AbortController,p=new Oe.Request(o.url,{method:o.method||"GET",body:o.body,credentials:o.credentials,headers:o.headers,referrer:Nt(),signal:d.signal});let _=!1,x=!1;const b=(S=p.url).indexOf("sku=")>0&&gi(S);var S;o.type==="json"&&p.headers.set("Accept","application/json");const M=(I,L,N)=>{if(x)return;if(I&&I.message!=="SecurityError"&&Vn(I),L&&N)return R(L);const $=Date.now();Oe.fetch(p).then(te=>{if(te.ok){const ce=b?te.clone():null;return R(te,ce,$)}return l(new vt(te.statusText,te.status,o.url))}).catch(te=>{te.code!==20&&l(new Error(te.message))})},R=(I,L,N)=>{(o.type==="arrayBuffer"?I.arrayBuffer():o.type==="json"?I.json():I.text()).then($=>{x||(L&&N&&function(te,ce,ne){if(Di(),!Ni)return;const oe={status:ce.status,statusText:ce.statusText,headers:new Oe.Headers};ce.headers.forEach((Ae,Se)=>oe.headers.set(Se,Ae));const me=sr(ce.headers.get("Cache-Control")||"");if(me["no-store"])return;me["max-age"]&&oe.headers.set("Expires",new Date(ne+1e3*me["max-age"]).toUTCString());const he=oe.headers.get("Expires");he&&(new Date(he).getTime()-ne<42e4||function(Ae,Se){if(lr===void 0)try{new Response(new ReadableStream),lr=!0}catch{lr=!1}lr?Se(Ae.body):Ae.blob().then(Se)}(ce,Ae=>{const Se=new Oe.Response(Ae,oe);Di(),Ni&&Ni.then(Fe=>Fe.put(ma(te.url),Se)).catch(Fe=>Vn(Fe.message))}))}(p,L,N),_=!0,l(null,$,I.headers.get("Cache-Control"),I.headers.get("Expires")))}).catch($=>{x||l(new Error($.message))})};return b?function(I,L){if(Di(),!Ni)return L(null);const N=ma(I.url);Ni.then($=>{$.match(N).then(te=>{const ce=function(ne){if(!ne)return!1;const oe=new Date(ne.headers.get("Expires")||0),me=sr(ne.headers.get("Cache-Control")||"");return oe>Date.now()&&!me["no-cache"]}(te);$.delete(N),ce&&$.put(N,te.clone()),L(null,te,ce)}).catch(L)}).catch(L)}(p,M):M(null,null),{cancel:()=>{x=!0,_||d.abort()}}}(n,e);if(Ri()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",n,e,void 0,!0)}var i;return function(o,l){const d=new Oe.XMLHttpRequest;d.open(o.method||"GET",o.url,!0),o.type==="arrayBuffer"&&(d.responseType="arraybuffer");for(const p in o.headers)d.setRequestHeader(p,o.headers[p]);return o.type==="json"&&(d.responseType="text",d.setRequestHeader("Accept","application/json")),d.withCredentials=o.credentials==="include",d.onerror=()=>{l(new Error(d.statusText))},d.onload=()=>{if((d.status>=200&&d.status<300||d.status===0)&&d.response!==null){let p=d.response;if(o.type==="json")try{p=JSON.parse(d.response)}catch(_){return l(_)}l(null,p,d.getResponseHeader("Cache-Control"),d.getResponseHeader("Expires"))}else l(new vt(d.statusText,d.status,o.url))},d.send(o.body),{cancel:()=>d.abort()}}(n,e)},Pn=function(n,e){return sn(Kn(n,{type:"arrayBuffer"}),e)};function Jn(n){const e=Oe.document.createElement("a");return e.href=n,e.protocol===Oe.document.location.protocol&&e.host===Oe.document.location.host}const ur="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Vi,yr;Vi=[],yr=0;const ri=function(n,e){if(gt.supported&&(n.headers||(n.headers={}),n.headers.accept="image/webp,*/*"),yr>=at.MAX_PARALLEL_IMAGE_REQUESTS){const d={requestParameters:n,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return Vi.push(d),d}yr++;let i=!1;const o=()=>{if(!i)for(i=!0,yr--;Vi.length&&yr<at.MAX_PARALLEL_IMAGE_REQUESTS;){const d=Vi.shift(),{requestParameters:p,callback:_,cancelled:x}=d;x||(d.cancel=ri(p,_).cancel)}},l=Pn(n,(d,p,_,x)=>{o(),d?e(d):p&&(Oe.createImageBitmap?function(b,S){const M=new Oe.Blob([new Uint8Array(b)],{type:"image/png"});Oe.createImageBitmap(M).then(R=>{S(null,R)}).catch(R=>{S(new Error(`Could not load image because of ${R.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(p,(b,S)=>e(b,S,_,x)):function(b,S){const M=new Oe.Image,R=Oe.URL;M.onload=()=>{S(null,M),R.revokeObjectURL(M.src),M.onload=null,Oe.requestAnimationFrame(()=>{M.src=ur})},M.onerror=()=>S(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const I=new Oe.Blob([new Uint8Array(b)],{type:"image/png"});M.src=b.byteLength?R.createObjectURL(I):ur}(p,(b,S)=>e(b,S,_,x)))});return{cancel:()=>{l.cancel(),o()}}},Gr="NO_ACCESS_TOKEN";function Zn(n){return n.indexOf("mapbox:")===0}function gi(n){return at.API_URL_REGEX.test(n)}function Wa(n){return at.API_CDN_URL_REGEX.test(n)}function ga(n){return at.API_STYLE_REGEX.test(n)&&!Ya(n)}function Ya(n){return at.API_SPRITE_REGEX.test(n)}const zo=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Sa(n){const e=n.match(zo);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function Ua(n){const e=n.params.length?`?${n.params.join("&")}`:"";return`${n.protocol}://${n.authority}${n.path}${e}`}function Io(n){if(!n)return null;const e=n.split(".");if(!e||e.length!==3)return null;try{return JSON.parse(decodeURIComponent(Oe.atob(e[1]).split("").map(i=>"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class J{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){const i=Io(at.ACCESS_TOKEN);let o="";return o=i&&i.u?Oe.btoa(encodeURIComponent(i.u).replace(/%([0-9A-F]{2})/g,(l,d)=>String.fromCharCode(Number("0x"+d)))):at.ACCESS_TOKEN||"",e?`mapbox.eventData.${e}:${o}`:`mapbox.eventData:${o}`}fetchEventData(){const e=pa("localStorage"),i=this.getStorageKey(),o=this.getStorageKey("uuid");if(e)try{const l=Oe.localStorage.getItem(i);l&&(this.eventData=JSON.parse(l));const d=Oe.localStorage.getItem(o);d&&(this.anonId=d)}catch{Vn("Unable to read from LocalStorage")}}saveEventData(){const e=pa("localStorage"),i=this.getStorageKey(),o=this.getStorageKey("uuid");if(e)try{Oe.localStorage.setItem(o,this.anonId),Object.keys(this.eventData).length>=1&&Oe.localStorage.setItem(i,JSON.stringify(this.eventData))}catch{Vn("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,i,o,l){if(!at.EVENTS_URL)return;const d=Sa(at.EVENTS_URL);d.params.push(`access_token=${l||at.ACCESS_TOKEN||""}`);const p={event:this.type,created:new Date(e).toISOString()},_=i?Kn(p,i):p,x={url:Ua(d),headers:{"Content-Type":"text/plain"},body:JSON.stringify([_])};this.pendingRequest=function(b,S){return sn(Kn(b,{method:"POST"}),S)}(x,b=>{this.pendingRequest=null,o(b),this.saveEventData(),this.processRequests(l)})}queueRequest(e,i){this.queue.push(e),this.processRequests(i)}}const P=new class extends J{constructor(n){super("appUserTurnstile"),this._customAccessToken=n}postTurnstileEvent(n,e){at.EVENTS_URL&&at.ACCESS_TOKEN&&Array.isArray(n)&&n.some(i=>Zn(i)||gi(i))&&this.queueRequest(Date.now(),e)}processRequests(n){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=Io(at.ACCESS_TOKEN),i=e?e.u:at.ACCESS_TOKEN;let o=i!==this.eventData.tokenU;da(this.anonId)||(this.anonId=ar(),o=!0);const l=this.queue.shift();if(this.eventData.lastSuccess){const d=new Date(this.eventData.lastSuccess),p=new Date(l),_=(l-this.eventData.lastSuccess)/864e5;o=o||_>=1||_<-1||d.getDate()!==p.getDate()}else o=!0;o?this.postEvent(l,{sdkIdentifier:"mapbox-gl-js",sdkVersion:Ft,skuId:zn,"enabled.telemetry":!1,userId:this.anonId},d=>{d||(this.eventData.lastSuccess=l,this.eventData.tokenU=i)},n):this.processRequests()}},V=P.postTurnstileEvent.bind(P),K=new class extends J{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(n,e,i,o){this.skuToken=e,this.errorCb=o,at.EVENTS_URL&&(i||at.ACCESS_TOKEN?this.queueRequest({id:n,timestamp:Date.now()},i):this.errorCb(new Error(Gr)))}processRequests(n){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:i}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),da(this.anonId)||(this.anonId=ar()),this.postEvent(i,{sdkIdentifier:"mapbox-gl-js",sdkVersion:Ft,skuId:zn,skuToken:this.skuToken,userId:this.anonId},o=>{o?this.errorCb(o):e&&(this.success[e]=!0)},n))}},O=K.postMapLoadEvent.bind(K),Z=new class extends J{constructor(){super("gljs.performance")}postPerformanceEvent(n,e){at.EVENTS_URL&&(n||at.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:e},n)}processRequests(n){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:e,performanceData:i}=this.queue.shift(),o=function(l){const d=Oe.performance.getEntriesByType("resource"),p=Oe.performance.getEntriesByType("mark"),_=function(R){const I={};if(R){for(const L in R)if(L!=="other")for(const N of R[L]){const $=`${L}ResolveRangeMin`,te=`${L}ResolveRangeMax`,ce=`${L}RequestCount`,ne=`${L}RequestCachedCount`;I[$]=Math.min(I[$]||1/0,N.startTime),I[te]=Math.max(I[te]||-1/0,N.responseEnd);const oe=me=>{I[me]===void 0&&(I[me]=0),++I[me]};N.transferSize!==void 0&&N.transferSize===0&&oe(ne),oe(ce)}}return I}(function(R,I){const L={};if(R)for(const N of R){const $=I(N);L[$]===void 0&&(L[$]=[]),L[$].push(N)}return L}(d,qe)),x=Oe.devicePixelRatio,b=Oe.navigator.connection||Oe.navigator.mozConnection||Oe.navigator.webkitConnection,S={counters:[],metadata:[],attributes:[]},M=(R,I,L)=>{L!=null&&R.push({name:I,value:L.toString()})};for(const R in _)M(S.counters,R,_[R]);if(l.interactionRange[0]!==1/0&&l.interactionRange[1]!==-1/0&&(M(S.counters,"interactionRangeMin",l.interactionRange[0]),M(S.counters,"interactionRangeMax",l.interactionRange[1])),p)for(const R of Object.keys(Te)){const I=Te[R],L=p.find(N=>N.name===I);L&&M(S.counters,I,L.startTime)}return M(S.counters,"visibilityHidden",l.visibilityHidden),M(S.attributes,"style",function(R){if(R)for(const I of R){const L=I.name.split("?")[0];if(ga(L)){const N=L.split("/").slice(-2);if(N.length===2)return`mapbox://styles/${N[0]}/${N[1]}`}}}(d)),M(S.attributes,"terrainEnabled",l.terrainEnabled?"true":"false"),M(S.attributes,"fogEnabled",l.fogEnabled?"true":"false"),M(S.attributes,"projection",l.projection),M(S.attributes,"zoom",l.zoom),M(S.metadata,"devicePixelRatio",x),M(S.metadata,"connectionEffectiveType",b?b.effectiveType:void 0),M(S.metadata,"navigatorUserAgent",Oe.navigator.userAgent),M(S.metadata,"screenWidth",Oe.screen.width),M(S.metadata,"screenHeight",Oe.screen.height),M(S.metadata,"windowWidth",Oe.innerWidth),M(S.metadata,"windowHeight",Oe.innerHeight),M(S.metadata,"mapWidth",l.width/x),M(S.metadata,"mapHeight",l.height/x),M(S.metadata,"webglRenderer",l.renderer),M(S.metadata,"webglVendor",l.vendor),M(S.metadata,"sdkVersion",Ft),M(S.metadata,"sdkIdentifier","mapbox-gl-js"),S}(i);for(const l of o.metadata);for(const l of o.counters);for(const l of o.attributes);this.postEvent(e,o,()=>{},n)}},se=Z.postPerformanceEvent.bind(Z),pe=new class extends J{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(n,e,i,o){if(!at.API_URL||!at.SESSION_PATH)return;const l=Sa(at.API_URL+at.SESSION_PATH);l.params.push(`sku=${e||""}`),l.params.push(`access_token=${o||at.ACCESS_TOKEN||""}`);const d={url:Ua(l),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(p,_){return sn(Kn(p,{method:"GET"}),_)}(d,p=>{this.pendingRequest=null,i(p),this.saveEventData(),this.processRequests(o)})}getSessionAPI(n,e,i,o){this.skuToken=e,this.errorCb=o,at.SESSION_PATH&&at.API_URL&&(i||at.ACCESS_TOKEN?this.queueRequest({id:n,timestamp:Date.now()},i):this.errorCb(new Error(Gr)))}processRequests(n){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:i}=this.queue.shift();e&&this.success[e]||this.getSession(i,this.skuToken,o=>{o?this.errorCb(o):e&&(this.success[e]=!0)},n)}},ue=pe.getSessionAPI.bind(pe),_e=new Set,Te={create:"create",load:"load",fullLoad:"fullLoad"},We={mark(n){Oe.performance.mark(n)},measure(n,e,i){Oe.performance.measure(n,e,i)}};function qe(n){const e=n.name.split("?")[0];return Wa(e)&&e.includes("mapbox-gl.js")?"javascript":Wa(e)&&e.includes("mapbox-gl.css")?"css":function(i){return at.API_FONTS_REGEX.test(i)}(e)?"fontRange":Ya(e)?"sprite":ga(e)?"style":function(i){return at.API_TILEJSON_REGEX.test(i)}(e)?"tilejson":"other"}const ct=Oe.performance;function ot(n){const e=n?n.url.toString():void 0;return ct.getEntriesByName(e)}let _t,Lt,on,cn;const Rt={now:()=>on!==void 0?on:Oe.performance.now(),setNow(n){on=n},restoreNow(){on=void 0},frame(n){const e=Oe.requestAnimationFrame(n);return{cancel:()=>Oe.cancelAnimationFrame(e)}},getImageData(n,e=0){const{width:i,height:o}=n;cn||(cn=Oe.document.createElement("canvas"));const l=cn.getContext("2d",{willReadFrequently:!0});if(!l)throw new Error("failed to create canvas 2d context");return(i>cn.width||o>cn.height)&&(cn.width=i,cn.height=o),l.clearRect(-e,-e,i+2*e,o+2*e),l.drawImage(n,0,0,i,o),l.getImageData(-e,-e,i+2*e,o+2*e)},resolveURL:n=>(_t||(_t=Oe.document.createElement("a")),_t.href=n,_t.href),get devicePixelRatio(){return Oe.devicePixelRatio},get prefersReducedMotion(){return!!Oe.matchMedia&&(Lt==null&&(Lt=Oe.matchMedia("(prefers-reduced-motion: reduce)")),Lt.matches)}};function ai(n,e,i){i[n]&&i[n].indexOf(e)!==-1||(i[n]=i[n]||[],i[n].push(e))}function ui(n,e,i){if(i&&i[n]){const o=i[n].indexOf(e);o!==-1&&i[n].splice(o,1)}}class co{constructor(e,i={}){Kn(this,i),this.type=e}}class _a extends co{constructor(e,i={}){super("error",Kn({error:e},i))}}class an{on(e,i){return this._listeners=this._listeners||{},ai(e,i,this._listeners),this}off(e,i){return ui(e,i,this._listeners),ui(e,i,this._oneTimeListeners),this}once(e,i){return i?(this._oneTimeListeners=this._oneTimeListeners||{},ai(e,i,this._oneTimeListeners),this):new Promise(o=>this.once(e,o))}fire(e,i){typeof e=="string"&&(e=new co(e,i||{}));const o=e.type;if(this.listens(o)){e.target=this;const l=this._listeners&&this._listeners[o]?this._listeners[o].slice():[];for(const _ of l)_.call(this,e);const d=this._oneTimeListeners&&this._oneTimeListeners[o]?this._oneTimeListeners[o].slice():[];for(const _ of d)ui(o,_,this._oneTimeListeners),_.call(this,e);const p=this._eventedParent;p&&(Kn(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),p.fire(e))}else e instanceof _a&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,i){return this._eventedParent=e,this._eventedParentData=i,this}}var Ne=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function ya(n,...e){for(const i of e)for(const o in i)n[o]=i[o];return n}function Wi(n){return n instanceof Number||n instanceof String||n instanceof Boolean?n.valueOf():n}function Ka(n){if(Array.isArray(n))return n.map(Ka);if(n instanceof Object&&!(n instanceof Number||n instanceof String||n instanceof Boolean)){const e={};for(const i in n)e[i]=Ka(n[i]);return e}return Wi(n)}class Ec extends Error{constructor(e,i){super(i),this.message=i,this.key=e}}var Jr=Ec;class el{constructor(e,i=[]){this.parent=e,this.bindings={};for(const[o,l]of i)this.bindings[o]=l}concat(e){return new el(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}var Eu=el;const Or={kind:"null"},ht={kind:"number"},bn={kind:"string"},hn={kind:"boolean"},Qr={kind:"color"},$r={kind:"object"},nn={kind:"value"},ho={kind:"collator"},ko={kind:"formatted"},fo={kind:"resolvedImage"};function Mr(n,e){return{kind:"array",itemType:n,N:e}}function Si(n){if(n.kind==="array"){const e=Si(n.itemType);return typeof n.N=="number"?`array<${e}, ${n.N}>`:n.itemType.kind==="value"?"array":`array<${e}>`}return n.kind}const po=[Or,ht,bn,hn,Qr,ko,$r,Mr(nn),fo];function mo(n,e){if(e.kind==="error")return null;if(n.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!mo(n.itemType,e.itemType))&&(typeof n.N!="number"||n.N===e.N))return null}else{if(n.kind===e.kind)return null;if(n.kind==="value"){for(const i of po)if(!mo(i,e))return null}}return`Expected ${Si(n)} but found ${Si(e)} instead.`}function tl(n,e){return e.some(i=>i.kind===n.kind)}function Ds(n,e){return e.some(i=>i==="null"?n===null:i==="array"?Array.isArray(n):i==="object"?n&&!Array.isArray(n)&&typeof n=="object":i===typeof n)}var ts,Su={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Dn(n){return(n=Math.round(n))<0?0:n>255?255:n}function zs(n){return Dn(n[n.length-1]==="%"?parseFloat(n)/100*255:parseInt(n))}function nl(n){return(e=n[n.length-1]==="%"?parseFloat(n)/100:parseFloat(n))<0?0:e>1?1:e;var e}function dn(n,e,i){return i<0?i+=1:i>1&&(i-=1),6*i<1?n+(e-n)*i*6:2*i<1?e:3*i<2?n+(e-n)*(2/3-i)*6:n}try{ts={}.parseCSSColor=function(n){var e,i=n.replace(/ /g,"").toLowerCase();if(i in Su)return Su[i].slice();if(i[0]==="#")return i.length===4?(e=parseInt(i.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:i.length===7&&(e=parseInt(i.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var o=i.indexOf("("),l=i.indexOf(")");if(o!==-1&&l+1===i.length){var d=i.substr(0,o),p=i.substr(o+1,l-(o+1)).split(","),_=1;switch(d){case"rgba":if(p.length!==4)return null;_=nl(p.pop());case"rgb":return p.length!==3?null:[zs(p[0]),zs(p[1]),zs(p[2]),_];case"hsla":if(p.length!==4)return null;_=nl(p.pop());case"hsl":if(p.length!==3)return null;var x=(parseFloat(p[0])%360+360)%360/360,b=nl(p[1]),S=nl(p[2]),M=S<=.5?S*(b+1):S+b-S*b,R=2*S-M;return[Dn(255*dn(R,M,x+1/3)),Dn(255*dn(R,M,x)),Dn(255*dn(R,M,x-1/3)),_];default:return null}}return null}}catch{}class ea{constructor(e,i,o,l=1){this.r=e,this.g=i,this.b=o,this.a=l}static parse(e){if(!e)return;if(e instanceof ea)return e;if(typeof e!="string")return;const i=ts(e);return i?new ea(i[0]/255*i[3],i[1]/255*i[3],i[2]/255*i[3],i[3]):void 0}toString(){const[e,i,o,l]=this.toArray();return`rgba(${Math.round(e)},${Math.round(i)},${Math.round(o)},${l})`}toArray(){const{r:e,g:i,b:o,a:l}=this;return l===0?[0,0,0,0]:[255*e/l,255*i/l,255*o/l,l]}toArray01(){const{r:e,g:i,b:o,a:l}=this;return l===0?[0,0,0,0]:[e/l,i/l,o/l,l]}toArray01PremultipliedAlpha(){const{r:e,g:i,b:o,a:l}=this;return[e,i,o,l]}}ea.black=new ea(0,0,0,1),ea.white=new ea(1,1,1,1),ea.transparent=new ea(0,0,0,0),ea.red=new ea(1,0,0,1),ea.blue=new ea(0,0,1,1);var kn=ea;class Lo{constructor(e,i,o){this.sensitivity=e?i?"variant":"case":i?"accent":"base",this.locale=o,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,i){return this.collator.compare(e,i)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class ns{constructor(e,i,o,l,d){this.text=e.normalize?e.normalize():e,this.image=i,this.scale=o,this.fontStack=l,this.textColor=d}}class Ar{constructor(e){this.sections=e}static fromString(e){return new Ar([new ns(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof Ar?e:Ar.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}serialize(){const e=["format"];for(const i of this.sections){if(i.image){e.push(["image",i.image.name]);continue}e.push(i.text);const o={};i.fontStack&&(o["text-font"]=["literal",i.fontStack.split(",")]),i.scale&&(o["font-scale"]=i.scale),i.textColor&&(o["text-color"]=["rgba"].concat(i.textColor.toArray())),e.push(o)}return e}}class Ci{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new Ci({name:e,available:!1}):null}serialize(){return["image",this.name]}}function Yi(n,e,i,o){return typeof n=="number"&&n>=0&&n<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof i=="number"&&i>=0&&i<=255?o===void 0||typeof o=="number"&&o>=0&&o<=1?null:`Invalid rgba value [${[n,e,i,o].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof o=="number"?[n,e,i,o]:[n,e,i]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ll(n){if(n===null||typeof n=="string"||typeof n=="boolean"||typeof n=="number"||n instanceof kn||n instanceof Lo||n instanceof Ar||n instanceof Ci)return!0;if(Array.isArray(n)){for(const e of n)if(!Ll(e))return!1;return!0}if(typeof n=="object"){for(const e in n)if(!Ll(n[e]))return!1;return!0}return!1}function oi(n){if(n===null)return Or;if(typeof n=="string")return bn;if(typeof n=="boolean")return hn;if(typeof n=="number")return ht;if(n instanceof kn)return Qr;if(n instanceof Lo)return ho;if(n instanceof Ar)return ko;if(n instanceof Ci)return fo;if(Array.isArray(n)){const e=n.length;let i;for(const o of n){const l=oi(o);if(i){if(i===l)continue;i=nn;break}i=l}return Mr(i||nn,e)}return $r}function qr(n){const e=typeof n;return n===null?"":e==="string"||e==="number"||e==="boolean"?String(n):n instanceof kn||n instanceof Ar||n instanceof Ci?n.toString():JSON.stringify(n)}class go{constructor(e,i){this.type=e,this.value=i}static parse(e,i){if(e.length!==2)return i.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Ll(e[1]))return i.error("invalid value");const o=e[1];let l=oi(o);const d=i.expectedType;return l.kind!=="array"||l.N!==0||!d||d.kind!=="array"||typeof d.N=="number"&&d.N!==0||(l=d),new go(l,o)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof kn?["rgba"].concat(this.value.toArray()):this.value instanceof Ar?this.value.serialize():this.value}}var Ol=go,tr=class{constructor(n){this.name="ExpressionEvaluationError",this.message=n}toJSON(){return this.message}};const _o={string:bn,number:ht,boolean:hn,object:$r};class Cu{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");let o,l=1;const d=e[0];if(d==="array"){let _,x;if(e.length>2){const b=e[1];if(typeof b!="string"||!(b in _o)||b==="object")return i.error('The item type argument of "array" must be one of string, number, boolean',1);_=_o[b],l++}else _=nn;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return i.error('The length argument to "array" must be a positive integer literal',2);x=e[2],l++}o=Mr(_,x)}else o=_o[d];const p=[];for(;l<e.length;l++){const _=i.parse(e[l],l,nn);if(!_)return null;p.push(_)}return new Cu(o,p)}evaluate(e){for(let i=0;i<this.args.length;i++){const o=this.args[i].evaluate(e);if(!mo(this.type,oi(o)))return o;if(i===this.args.length-1)throw new tr(`Expected value to be of type ${Si(this.type)}, but found ${Si(oi(o))} instead.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=this.type,i=[e.kind];if(e.kind==="array"){const o=e.itemType;if(o.kind==="string"||o.kind==="number"||o.kind==="boolean"){i.push(o.kind);const l=e.N;(typeof l=="number"||this.args.length>1)&&i.push(l)}}return i.concat(this.args.map(o=>o.serialize()))}}var va=Cu;class il{constructor(e){this.type=ko,this.sections=e}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");const o=e[1];if(!Array.isArray(o)&&typeof o=="object")return i.error("First argument must be an image or text section.");const l=[];let d=!1;for(let p=1;p<=e.length-1;++p){const _=e[p];if(d&&typeof _=="object"&&!Array.isArray(_)){d=!1;let x=null;if(_["font-scale"]&&(x=i.parse(_["font-scale"],1,ht),!x))return null;let b=null;if(_["text-font"]&&(b=i.parse(_["text-font"],1,Mr(bn)),!b))return null;let S=null;if(_["text-color"]&&(S=i.parse(_["text-color"],1,Qr),!S))return null;const M=l[l.length-1];M.scale=x,M.font=b,M.textColor=S}else{const x=i.parse(e[p],1,nn);if(!x)return null;const b=x.type.kind;if(b!=="string"&&b!=="value"&&b!=="null"&&b!=="resolvedImage")return i.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");d=!0,l.push({content:x,scale:null,font:null,textColor:null})}}return new il(l)}evaluate(e){return new Ar(this.sections.map(i=>{const o=i.content.evaluate(e);return oi(o)===fo?new ns("",o,null,null,null):new ns(qr(o),null,i.scale?i.scale.evaluate(e):null,i.font?i.font.evaluate(e).join(","):null,i.textColor?i.textColor.evaluate(e):null)}))}eachChild(e){for(const i of this.sections)e(i.content),i.scale&&e(i.scale),i.font&&e(i.font),i.textColor&&e(i.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const i of this.sections){e.push(i.content.serialize());const o={};i.scale&&(o["font-scale"]=i.scale.serialize()),i.font&&(o["text-font"]=i.font.serialize()),i.textColor&&(o["text-color"]=i.textColor.serialize()),e.push(o)}return e}}class Mu{constructor(e){this.type=fo,this.input=e}static parse(e,i){if(e.length!==2)return i.error("Expected two arguments.");const o=i.parse(e[1],1,bn);return o?new Mu(o):i.error("No image name provided.")}evaluate(e){const i=this.input.evaluate(e),o=Ci.fromString(i);return o&&e.availableImages&&(o.available=e.availableImages.indexOf(i)>-1),o}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Is={"to-boolean":hn,"to-color":Qr,"to-number":ht,"to-string":bn};class rl{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");const o=e[0];if((o==="to-boolean"||o==="to-string")&&e.length!==2)return i.error("Expected one argument.");const l=Is[o],d=[];for(let p=1;p<e.length;p++){const _=i.parse(e[p],p,nn);if(!_)return null;d.push(_)}return new rl(l,d)}evaluate(e){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(e));if(this.type.kind==="color"){let i,o;for(const l of this.args){if(i=l.evaluate(e),o=null,i instanceof kn)return i;if(typeof i=="string"){const d=e.parseColor(i);if(d)return d}else if(Array.isArray(i)&&(o=i.length<3||i.length>4?`Invalid rbga value ${JSON.stringify(i)}: expected an array containing either three or four numeric values.`:Yi(i[0],i[1],i[2],i[3]),!o))return new kn(i[0]/255,i[1]/255,i[2]/255,i[3])}throw new tr(o||`Could not parse color from value '${typeof i=="string"?i:String(JSON.stringify(i))}'`)}if(this.type.kind==="number"){let i=null;for(const o of this.args){if(i=o.evaluate(e),i===null)return 0;const l=Number(i);if(!isNaN(l))return l}throw new tr(`Could not convert ${JSON.stringify(i)} to number.`)}return this.type.kind==="formatted"?Ar.fromString(qr(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?Ci.fromString(qr(this.args[0].evaluate(e))):qr(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if(this.type.kind==="formatted")return new il([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Mu(this.args[0]).serialize();const e=[`to-${this.type.kind}`];return this.eachChild(i=>{e.push(i.serialize())}),e}}var Na=rl;const ks=["Unknown","Point","LineString","Polygon"];var Sc=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?ks[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const n=this.featureDistanceData.center,e=this.featureDistanceData.scale,{x:i,y:o}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(i*e-n[0])+this.featureDistanceData.bearing[1]*(o*e-n[1])}return 0}parseColor(n){let e=this._parseColorCache[n];return e||(e=this._parseColorCache[n]=kn.parse(n)),e}};class Ls{constructor(e,i,o,l){this.name=e,this.type=i,this._evaluate=o,this.args=l}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,i){const o=e[0],l=Ls.definitions[o];if(!l)return i.error(`Unknown expression "${o}". If you wanted a literal array, use ["literal", [...]].`,0);const d=Array.isArray(l)?l[0]:l.type,p=Array.isArray(l)?[[l[1],l[2]]]:l.overloads,_=p.filter(([b])=>!Array.isArray(b)||b.length===e.length-1);let x=null;for(const[b,S]of _){x=new Fl(i.registry,i.path,null,i.scope);const M=[];let R=!1;for(let I=1;I<e.length;I++){const L=e[I],N=Array.isArray(b)?b[I-1]:b.type,$=x.parse(L,1+M.length,N);if(!$){R=!0;break}M.push($)}if(!R)if(Array.isArray(b)&&b.length!==M.length)x.error(`Expected ${b.length} arguments, but found ${M.length} instead.`);else{for(let I=0;I<M.length;I++){const L=Array.isArray(b)?b[I]:b.type,N=M[I];x.concat(I+1).checkSubtype(L,N.type)}if(x.errors.length===0)return new Ls(o,d,S,M)}}if(_.length===1)i.errors.push(...x.errors);else{const b=(_.length?_:p).map(([M])=>{return R=M,Array.isArray(R)?`(${R.map(Si).join(", ")})`:`(${Si(R.type)}...)`;var R}).join(" | "),S=[];for(let M=1;M<e.length;M++){const R=i.parse(e[M],1+S.length);if(!R)return null;S.push(Si(R.type))}i.error(`Expected arguments of type ${b}, but found (${S.join(", ")}) instead.`)}return null}static register(e,i){Ls.definitions=i;for(const o in i)e[o]=Ls}}var Oo=Ls;class Pl{constructor(e,i,o){this.type=ho,this.locale=o,this.caseSensitive=e,this.diacriticSensitive=i}static parse(e,i){if(e.length!==2)return i.error("Expected one argument.");const o=e[1];if(typeof o!="object"||Array.isArray(o))return i.error("Collator options argument must be an object.");const l=i.parse(o["case-sensitive"]!==void 0&&o["case-sensitive"],1,hn);if(!l)return null;const d=i.parse(o["diacritic-sensitive"]!==void 0&&o["diacritic-sensitive"],1,hn);if(!d)return null;let p=null;return o.locale&&(p=i.parse(o.locale,1,bn),!p)?null:new Pl(l,d,p)}evaluate(e){return new Lo(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}const U=8192;function ge(n,e){n[0]=Math.min(n[0],e[0]),n[1]=Math.min(n[1],e[1]),n[2]=Math.max(n[2],e[0]),n[3]=Math.max(n[3],e[1])}function Pe(n,e){return!(n[0]<=e[0]||n[2]>=e[2]||n[1]<=e[1]||n[3]>=e[3])}function He(n,e){const i=(180+n[0])/360,o=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n[1]*Math.PI/360)))/360,l=Math.pow(2,e.z);return[Math.round(i*l*U),Math.round(o*l*U)]}function dt(n,e,i){const o=n[0]-e[0],l=n[1]-e[1],d=n[0]-i[0],p=n[1]-i[1];return o*p-d*l==0&&o*d<=0&&l*p<=0}function Xt(n,e){let i=!1;for(let p=0,_=e.length;p<_;p++){const x=e[p];for(let b=0,S=x.length;b<S-1;b++){if(dt(n,x[b],x[b+1]))return!1;(l=x[b])[1]>(o=n)[1]!=(d=x[b+1])[1]>o[1]&&o[0]<(d[0]-l[0])*(o[1]-l[1])/(d[1]-l[1])+l[0]&&(i=!i)}}var o,l,d;return i}function Ot(n,e){for(let i=0;i<e.length;i++)if(Xt(n,e[i]))return!0;return!1}function tn(n,e,i,o){const l=o[0]-i[0],d=o[1]-i[1],p=(n[0]-i[0])*d-l*(n[1]-i[1]),_=(e[0]-i[0])*d-l*(e[1]-i[1]);return p>0&&_<0||p<0&&_>0}function Cn(n,e,i){for(const b of i)for(let S=0;S<b.length-1;++S)if((_=[(p=b[S+1])[0]-(d=b[S])[0],p[1]-d[1]])[0]*(x=[(l=e)[0]-(o=n)[0],l[1]-o[1]])[1]-_[1]*x[0]!=0&&tn(o,l,d,p)&&tn(d,p,o,l))return!0;var o,l,d,p,_,x;return!1}function si(n,e){for(let i=0;i<n.length;++i)if(!Xt(n[i],e))return!1;for(let i=0;i<n.length-1;++i)if(Cn(n[i],n[i+1],e))return!1;return!0}function zi(n,e){for(let i=0;i<e.length;i++)if(si(n,e[i]))return!0;return!1}function ci(n,e,i){const o=[];for(let l=0;l<n.length;l++){const d=[];for(let p=0;p<n[l].length;p++){const _=He(n[l][p],i);ge(e,_),d.push(_)}o.push(d)}return o}function Bi(n,e,i){const o=[];for(let l=0;l<n.length;l++){const d=ci(n[l],e,i);o.push(d)}return o}function Ii(n,e,i,o){if(n[0]<i[0]||n[0]>i[2]){const l=.5*o;let d=n[0]-i[0]>l?-o:i[0]-n[0]>l?o:0;d===0&&(d=n[0]-i[2]>l?-o:i[2]-n[0]>l?o:0),n[0]+=d}ge(e,n)}function It(n,e,i,o){const l=Math.pow(2,o.z)*U,d=[o.x*U,o.y*U],p=[];if(!n)return p;for(const _ of n)for(const x of _){const b=[x.x+d[0],x.y+d[1]];Ii(b,e,i,l),p.push(b)}return p}function Os(n,e,i,o){const l=Math.pow(2,o.z)*U,d=[o.x*U,o.y*U],p=[];if(!n)return p;for(const x of n){const b=[];for(const S of x){const M=[S.x+d[0],S.y+d[1]];ge(e,M),b.push(M)}p.push(b)}if(e[2]-e[0]<=l/2){(_=e)[0]=_[1]=1/0,_[2]=_[3]=-1/0;for(const x of p)for(const b of x)Ii(b,e,i,l)}var _;return p}class is{constructor(e,i){this.type=hn,this.geojson=e,this.geometries=i}static parse(e,i){if(e.length!==2)return i.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Ll(e[1])){const o=e[1];if(o.type==="FeatureCollection")for(let l=0;l<o.features.length;++l){const d=o.features[l].geometry.type;if(d==="Polygon"||d==="MultiPolygon")return new is(o,o.features[l].geometry)}else if(o.type==="Feature"){const l=o.geometry.type;if(l==="Polygon"||l==="MultiPolygon")return new is(o,o.geometry)}else if(o.type==="Polygon"||o.type==="MultiPolygon")return new is(o,o)}return i.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(i,o){const l=[1/0,1/0,-1/0,-1/0],d=[1/0,1/0,-1/0,-1/0],p=i.canonicalID();if(!p)return!1;if(o.type==="Polygon"){const _=ci(o.coordinates,d,p),x=It(i.geometry(),l,d,p);if(!Pe(l,d))return!1;for(const b of x)if(!Xt(b,_))return!1}if(o.type==="MultiPolygon"){const _=Bi(o.coordinates,d,p),x=It(i.geometry(),l,d,p);if(!Pe(l,d))return!1;for(const b of x)if(!Ot(b,_))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(i,o){const l=[1/0,1/0,-1/0,-1/0],d=[1/0,1/0,-1/0,-1/0],p=i.canonicalID();if(!p)return!1;if(o.type==="Polygon"){const _=ci(o.coordinates,d,p),x=Os(i.geometry(),l,d,p);if(!Pe(l,d))return!1;for(const b of x)if(!si(b,_))return!1}if(o.type==="MultiPolygon"){const _=Bi(o.coordinates,d,p),x=Os(i.geometry(),l,d,p);if(!Pe(l,d))return!1;for(const b of x)if(!zi(b,_))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Bl=is;function al(n){if(n instanceof Oo&&(n.name==="get"&&n.args.length===1||n.name==="feature-state"||n.name==="has"&&n.args.length===1||n.name==="properties"||n.name==="geometry-type"||n.name==="id"||/^filter-/.test(n.name))||n instanceof Bl)return!1;let e=!0;return n.eachChild(i=>{e&&!al(i)&&(e=!1)}),e}function yo(n){if(n instanceof Oo&&n.name==="feature-state")return!1;let e=!0;return n.eachChild(i=>{e&&!yo(i)&&(e=!1)}),e}function Ps(n,e){if(n instanceof Oo&&e.indexOf(n.name)>=0)return!1;let i=!0;return n.eachChild(o=>{i&&!Ps(o,e)&&(i=!1)}),i}class ol{constructor(e,i){this.type=i.type,this.name=e,this.boundExpression=i}static parse(e,i){if(e.length!==2||typeof e[1]!="string")return i.error("'var' expression requires exactly one string literal argument.");const o=e[1];return i.scope.has(o)?new ol(o,i.scope.get(o)):i.error(`Unknown variable "${o}". Make sure "${o}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var Cc=ol;class Sh{constructor(e,i=[],o,l=new Eu,d=[]){this.registry=e,this.path=i,this.key=i.map(p=>`[${p}]`).join(""),this.scope=l,this.errors=d,this.expectedType=o}parse(e,i,o,l,d={}){return i?this.concat(i,o,l)._parse(e,d):this._parse(e,d)}_parse(e,i){function o(l,d,p){return p==="assert"?new va(d,[l]):p==="coerce"?new Na(d,[l]):l}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const l=e[0];if(typeof l!="string")return this.error(`Expression name must be a string, but found ${typeof l} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const d=this.registry[l];if(d){let p=d.parse(e,this);if(!p)return null;if(this.expectedType){const _=this.expectedType,x=p.type;if(_.kind!=="string"&&_.kind!=="number"&&_.kind!=="boolean"&&_.kind!=="object"&&_.kind!=="array"||x.kind!=="value")if(_.kind!=="color"&&_.kind!=="formatted"&&_.kind!=="resolvedImage"||x.kind!=="value"&&x.kind!=="string"){if(this.checkSubtype(_,x))return null}else p=o(p,_,i.typeAnnotation||"coerce");else p=o(p,_,i.typeAnnotation||"assert")}if(!(p instanceof Ol)&&p.type.kind!=="resolvedImage"&&Ul(p)){const _=new Sc;try{p=new Ol(p.type,p.evaluate(_))}catch(x){return this.error(x.message),null}}return p}return this.error(`Unknown expression "${l}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,i,o){const l=typeof e=="number"?this.path.concat(e):this.path,d=o?this.scope.concat(o):this.scope;return new Sh(this.registry,l,i||null,d,this.errors)}error(e,...i){const o=`${this.key}${i.map(l=>`[${l}]`).join("")}`;this.errors.push(new Jr(o,e))}checkSubtype(e,i){const o=mo(e,i);return o&&this.error(o),o}}var Fl=Sh;function Ul(n){if(n instanceof Cc)return Ul(n.boundExpression);if(n instanceof Oo&&n.name==="error"||n instanceof Pl||n instanceof Bl)return!1;const e=n instanceof Na||n instanceof va;let i=!0;return n.eachChild(o=>{i=e?i&&Ul(o):i&&o instanceof Ol}),!!i&&al(n)&&Ps(n,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Au(n,e){const i=n.length-1;let o,l,d=0,p=i,_=0;for(;d<=p;)if(_=Math.floor((d+p)/2),o=n[_],l=n[_+1],o<=e){if(_===i||e<l)return _;d=_+1}else{if(!(o>e))throw new tr("Input is not a number.");p=_-1}return 0}class Ru{constructor(e,i,o){this.type=e,this.input=i,this.labels=[],this.outputs=[];for(const[l,d]of o)this.labels.push(l),this.outputs.push(d)}static parse(e,i){if(e.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return i.error("Expected an even number of arguments.");const o=i.parse(e[1],1,ht);if(!o)return null;const l=[];let d=null;i.expectedType&&i.expectedType.kind!=="value"&&(d=i.expectedType);for(let p=1;p<e.length;p+=2){const _=p===1?-1/0:e[p],x=e[p+1],b=p,S=p+1;if(typeof _!="number")return i.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',b);if(l.length&&l[l.length-1][0]>=_)return i.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',b);const M=i.parse(x,S,d);if(!M)return null;d=d||M.type,l.push([_,M])}return new Ru(d,o,l)}evaluate(e){const i=this.labels,o=this.outputs;if(i.length===1)return o[0].evaluate(e);const l=this.input.evaluate(e);if(l<=i[0])return o[0].evaluate(e);const d=i.length;return l>=i[d-1]?o[d-1].evaluate(e):o[Au(i,l)].evaluate(e)}eachChild(e){e(this.input);for(const i of this.outputs)e(i)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){const e=["step",this.input.serialize()];for(let i=0;i<this.labels.length;i++)i>0&&e.push(this.labels[i]),e.push(this.outputs[i].serialize());return e}}var Mc=Ru;function Bn(n,e,i){return n*(1-i)+e*i}var Ch=Object.freeze({__proto__:null,number:Bn,color:function(n,e,i){return new kn(Bn(n.r,e.r,i),Bn(n.g,e.g,i),Bn(n.b,e.b,i),Bn(n.a,e.a,i))},array:function(n,e,i){return n.map((o,l)=>Bn(o,e[l],i))}});const Po=.95047,np=1.08883,Ac=4/29,Du=6/29,Mh=3*Du*Du,ip=Math.PI/180,Ah=180/Math.PI;function Rc(n){return n>.008856451679035631?Math.pow(n,1/3):n/Mh+Ac}function ta(n){return n>Du?n*n*n:Mh*(n-Ac)}function Bo(n){return 255*(n<=.0031308?12.92*n:1.055*Math.pow(n,1/2.4)-.055)}function cr(n){return(n/=255)<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function rs(n){const e=cr(n.r),i=cr(n.g),o=cr(n.b),l=Rc((.4124564*e+.3575761*i+.1804375*o)/Po),d=Rc((.2126729*e+.7151522*i+.072175*o)/1);return{l:116*d-16,a:500*(l-d),b:200*(d-Rc((.0193339*e+.119192*i+.9503041*o)/np)),alpha:n.a}}function Rh(n){let e=(n.l+16)/116,i=isNaN(n.a)?e:e+n.a/500,o=isNaN(n.b)?e:e-n.b/200;return e=1*ta(e),i=Po*ta(i),o=np*ta(o),new kn(Bo(3.2404542*i-1.5371385*e-.4985314*o),Bo(-.969266*i+1.8760108*e+.041556*o),Bo(.0556434*i-.2040259*e+1.0572252*o),n.alpha)}function Dh(n,e,i){const o=e-n;return n+i*(o>180||o<-180?o-360*Math.round(o/360):o)}const Dc={forward:rs,reverse:Rh,interpolate:function(n,e,i){return{l:Bn(n.l,e.l,i),a:Bn(n.a,e.a,i),b:Bn(n.b,e.b,i),alpha:Bn(n.alpha,e.alpha,i)}}},as={forward:function(n){const{l:e,a:i,b:o}=rs(n),l=Math.atan2(o,i)*Ah;return{h:l<0?l+360:l,c:Math.sqrt(i*i+o*o),l:e,alpha:n.a}},reverse:function(n){const e=n.h*ip,i=n.c;return Rh({l:n.l,a:Math.cos(e)*i,b:Math.sin(e)*i,alpha:n.alpha})},interpolate:function(n,e,i){return{h:Dh(n.h,e.h,i),c:Bn(n.c,e.c,i),l:Bn(n.l,e.l,i),alpha:Bn(n.alpha,e.alpha,i)}}};var rp=Object.freeze({__proto__:null,lab:Dc,hcl:as});class zh{constructor(e,i,o,l,d){this.type=e,this.operator=i,this.interpolation=o,this.input=l,this.labels=[],this.outputs=[];for(const[p,_]of d)this.labels.push(p),this.outputs.push(_)}static interpolationFactor(e,i,o,l){let d=0;if(e.name==="exponential")d=zc(i,e.base,o,l);else if(e.name==="linear")d=zc(i,1,o,l);else if(e.name==="cubic-bezier"){const p=e.controlPoints;d=new Rn(p[0],p[1],p[2],p[3]).solve(zc(i,1,o,l))}return d}static parse(e,i){let[o,l,d,...p]=e;if(!Array.isArray(l)||l.length===0)return i.error("Expected an interpolation type expression.",1);if(l[0]==="linear")l={name:"linear"};else if(l[0]==="exponential"){const b=l[1];if(typeof b!="number")return i.error("Exponential interpolation requires a numeric base.",1,1);l={name:"exponential",base:b}}else{if(l[0]!=="cubic-bezier")return i.error(`Unknown interpolation type ${String(l[0])}`,1,0);{const b=l.slice(1);if(b.length!==4||b.some(S=>typeof S!="number"||S<0||S>1))return i.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);l={name:"cubic-bezier",controlPoints:b}}}if(e.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return i.error("Expected an even number of arguments.");if(d=i.parse(d,2,ht),!d)return null;const _=[];let x=null;o==="interpolate-hcl"||o==="interpolate-lab"?x=Qr:i.expectedType&&i.expectedType.kind!=="value"&&(x=i.expectedType);for(let b=0;b<p.length;b+=2){const S=p[b],M=p[b+1],R=b+3,I=b+4;if(typeof S!="number")return i.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',R);if(_.length&&_[_.length-1][0]>=S)return i.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',R);const L=i.parse(M,I,x);if(!L)return null;x=x||L.type,_.push([S,L])}return x.kind==="number"||x.kind==="color"||x.kind==="array"&&x.itemType.kind==="number"&&typeof x.N=="number"?new zh(x,o,l,d,_):i.error(`Type ${Si(x)} is not interpolatable.`)}evaluate(e){const i=this.labels,o=this.outputs;if(i.length===1)return o[0].evaluate(e);const l=this.input.evaluate(e);if(l<=i[0])return o[0].evaluate(e);const d=i.length;if(l>=i[d-1])return o[d-1].evaluate(e);const p=Au(i,l),_=zh.interpolationFactor(this.interpolation,l,i[p],i[p+1]),x=o[p].evaluate(e),b=o[p+1].evaluate(e);return this.operator==="interpolate"?Ch[this.type.kind.toLowerCase()](x,b,_):this.operator==="interpolate-hcl"?as.reverse(as.interpolate(as.forward(x),as.forward(b),_)):Dc.reverse(Dc.interpolate(Dc.forward(x),Dc.forward(b),_))}eachChild(e){e(this.input);for(const i of this.outputs)e(i)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const i=[this.operator,e,this.input.serialize()];for(let o=0;o<this.labels.length;o++)i.push(this.labels[o],this.outputs[o].serialize());return i}}function zc(n,e,i,o){const l=o-i,d=n-i;return l===0?0:e===1?d/l:(Math.pow(e,d)-1)/(Math.pow(e,l)-1)}var os=zh;class Ih{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expectected at least one argument.");let o=null;const l=i.expectedType;l&&l.kind!=="value"&&(o=l);const d=[];for(const _ of e.slice(1)){const x=i.parse(_,1+d.length,o,void 0,{typeAnnotation:"omit"});if(!x)return null;o=o||x.type,d.push(x)}const p=l&&d.some(_=>mo(l,_.type));return new Ih(p?nn:o,d)}evaluate(e){let i,o=null,l=0;for(const d of this.args){if(l++,o=d.evaluate(e),o&&o instanceof Ci&&!o.available&&(i||(i=o),o=null,l===this.args.length))return i;if(o!==null)break}return o}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=["coalesce"];return this.eachChild(i=>{e.push(i.serialize())}),e}}var Ud=Ih;class Ic{constructor(e,i){this.type=i.type,this.bindings=[].concat(e),this.result=i}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const i of this.bindings)e(i[1]);e(this.result)}static parse(e,i){if(e.length<4)return i.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const o=[];for(let d=1;d<e.length-1;d+=2){const p=e[d];if(typeof p!="string")return i.error(`Expected string, but found ${typeof p} instead.`,d);if(/[^a-zA-Z0-9_]/.test(p))return i.error("Variable names must contain only alphanumeric characters or '_'.",d);const _=i.parse(e[d+1],d+1);if(!_)return null;o.push([p,_])}const l=i.parse(e[e.length-1],e.length-1,i.expectedType,o);return l?new Ic(o,l):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[i,o]of this.bindings)e.push(i,o.serialize());return e.push(this.result.serialize()),e}}var ap=Ic;class Nd{constructor(e,i,o){this.type=e,this.index=i,this.input=o}static parse(e,i){if(e.length!==3)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const o=i.parse(e[1],1,ht),l=i.parse(e[2],2,Mr(i.expectedType||nn));return o&&l?new Nd(l.type.itemType,o,l):null}evaluate(e){const i=this.index.evaluate(e),o=this.input.evaluate(e);if(i<0)throw new tr(`Array index out of bounds: ${i} < 0.`);if(i>=o.length)throw new tr(`Array index out of bounds: ${i} > ${o.length-1}.`);if(i!==Math.floor(i))throw new tr(`Array index must be an integer, but found ${i} instead.`);return o[i]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var op=Nd;class kc{constructor(e,i){this.type=hn,this.needle=e,this.haystack=i}static parse(e,i){if(e.length!==3)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const o=i.parse(e[1],1,nn),l=i.parse(e[2],2,nn);return o&&l?tl(o.type,[hn,bn,ht,Or,nn])?new kc(o,l):i.error(`Expected first argument to be of type boolean, string, number or null, but found ${Si(o.type)} instead`):null}evaluate(e){const i=this.needle.evaluate(e),o=this.haystack.evaluate(e);if(o==null)return!1;if(!Ds(i,["boolean","string","number","null"]))throw new tr(`Expected first argument to be of type boolean, string, number or null, but found ${Si(oi(i))} instead.`);if(!Ds(o,["string","array"]))throw new tr(`Expected second argument to be of type array or string, but found ${Si(oi(o))} instead.`);return o.indexOf(i)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Nl=kc;class zu{constructor(e,i,o){this.type=ht,this.needle=e,this.haystack=i,this.fromIndex=o}static parse(e,i){if(e.length<=2||e.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const o=i.parse(e[1],1,nn),l=i.parse(e[2],2,nn);if(!o||!l)return null;if(!tl(o.type,[hn,bn,ht,Or,nn]))return i.error(`Expected first argument to be of type boolean, string, number or null, but found ${Si(o.type)} instead`);if(e.length===4){const d=i.parse(e[3],3,ht);return d?new zu(o,l,d):null}return new zu(o,l)}evaluate(e){const i=this.needle.evaluate(e),o=this.haystack.evaluate(e);if(!Ds(i,["boolean","string","number","null"]))throw new tr(`Expected first argument to be of type boolean, string, number or null, but found ${Si(oi(i))} instead.`);if(!Ds(o,["string","array"]))throw new tr(`Expected second argument to be of type array or string, but found ${Si(oi(o))} instead.`);if(this.fromIndex){const l=this.fromIndex.evaluate(e);return o.indexOf(i,l)}return o.indexOf(i)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var sp=zu;class kh{constructor(e,i,o,l,d,p){this.inputType=e,this.type=i,this.input=o,this.cases=l,this.outputs=d,this.otherwise=p}static parse(e,i){if(e.length<5)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return i.error("Expected an even number of arguments.");let o,l;i.expectedType&&i.expectedType.kind!=="value"&&(l=i.expectedType);const d={},p=[];for(let b=2;b<e.length-1;b+=2){let S=e[b];const M=e[b+1];Array.isArray(S)||(S=[S]);const R=i.concat(b);if(S.length===0)return R.error("Expected at least one branch label.");for(const L of S){if(typeof L!="number"&&typeof L!="string")return R.error("Branch labels must be numbers or strings.");if(typeof L=="number"&&Math.abs(L)>Number.MAX_SAFE_INTEGER)return R.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof L=="number"&&Math.floor(L)!==L)return R.error("Numeric branch labels must be integer values.");if(o){if(R.checkSubtype(o,oi(L)))return null}else o=oi(L);if(d[String(L)]!==void 0)return R.error("Branch labels must be unique.");d[String(L)]=p.length}const I=i.parse(M,b,l);if(!I)return null;l=l||I.type,p.push(I)}const _=i.parse(e[1],1,nn);if(!_)return null;const x=i.parse(e[e.length-1],e.length-1,l);return x?_.type.kind!=="value"&&i.concat(1).checkSubtype(o,_.type)?null:new kh(o,l,_,d,p,x):null}evaluate(e){const i=this.input.evaluate(e);return(oi(i)===this.inputType&&this.outputs[this.cases[i]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],i=Object.keys(this.cases).sort(),o=[],l={};for(const p of i){const _=l[this.cases[p]];_===void 0?(l[this.cases[p]]=o.length,o.push([this.cases[p],[p]])):o[_][1].push(p)}const d=p=>this.inputType.kind==="number"?Number(p):p;for(const[p,_]of o)e.push(_.length===1?d(_[0]):_.map(d)),e.push(this.outputs[p].serialize());return e.push(this.otherwise.serialize()),e}}var Nm=kh;class Iu{constructor(e,i,o){this.type=e,this.branches=i,this.otherwise=o}static parse(e,i){if(e.length<4)return i.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return i.error("Expected an odd number of arguments.");let o;i.expectedType&&i.expectedType.kind!=="value"&&(o=i.expectedType);const l=[];for(let p=1;p<e.length-1;p+=2){const _=i.parse(e[p],p,hn);if(!_)return null;const x=i.parse(e[p+1],p+1,o);if(!x)return null;l.push([_,x]),o=o||x.type}const d=i.parse(e[e.length-1],e.length-1,o);return d?new Iu(o,l,d):null}evaluate(e){for(const[i,o]of this.branches)if(i.evaluate(e))return o.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[i,o]of this.branches)e(i),e(o);e(this.otherwise)}outputDefined(){return this.branches.every(([e,i])=>i.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild(i=>{e.push(i.serialize())}),e}}var lp=Iu;class Lc{constructor(e,i,o,l){this.type=e,this.input=i,this.beginIndex=o,this.endIndex=l}static parse(e,i){if(e.length<=2||e.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const o=i.parse(e[1],1,nn),l=i.parse(e[2],2,ht);if(!o||!l)return null;if(!tl(o.type,[Mr(nn),bn,nn]))return i.error(`Expected first argument to be of type array or string, but found ${Si(o.type)} instead`);if(e.length===4){const d=i.parse(e[3],3,ht);return d?new Lc(o.type,o,l,d):null}return new Lc(o.type,o,l)}evaluate(e){const i=this.input.evaluate(e),o=this.beginIndex.evaluate(e);if(!Ds(i,["string","array"]))throw new tr(`Expected first argument to be of type array or string, but found ${Si(oi(i))} instead.`);if(this.endIndex){const l=this.endIndex.evaluate(e);return i.slice(o,l)}return i.slice(o)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var Vm=Lc;function up(n,e){return n==="=="||n==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function cp(n,e,i,o){return o.compare(e,i)===0}function Vl(n,e,i){const o=n!=="=="&&n!=="!=";return class lE{constructor(d,p,_){this.type=hn,this.lhs=d,this.rhs=p,this.collator=_,this.hasUntypedArgument=d.type.kind==="value"||p.type.kind==="value"}static parse(d,p){if(d.length!==3&&d.length!==4)return p.error("Expected two or three arguments.");const _=d[0];let x=p.parse(d[1],1,nn);if(!x)return null;if(!up(_,x.type))return p.concat(1).error(`"${_}" comparisons are not supported for type '${Si(x.type)}'.`);let b=p.parse(d[2],2,nn);if(!b)return null;if(!up(_,b.type))return p.concat(2).error(`"${_}" comparisons are not supported for type '${Si(b.type)}'.`);if(x.type.kind!==b.type.kind&&x.type.kind!=="value"&&b.type.kind!=="value")return p.error(`Cannot compare types '${Si(x.type)}' and '${Si(b.type)}'.`);o&&(x.type.kind==="value"&&b.type.kind!=="value"?x=new va(b.type,[x]):x.type.kind!=="value"&&b.type.kind==="value"&&(b=new va(x.type,[b])));let S=null;if(d.length===4){if(x.type.kind!=="string"&&b.type.kind!=="string"&&x.type.kind!=="value"&&b.type.kind!=="value")return p.error("Cannot use collator to compare non-string types.");if(S=p.parse(d[3],3,ho),!S)return null}return new lE(x,b,S)}evaluate(d){const p=this.lhs.evaluate(d),_=this.rhs.evaluate(d);if(o&&this.hasUntypedArgument){const x=oi(p),b=oi(_);if(x.kind!==b.kind||x.kind!=="string"&&x.kind!=="number")throw new tr(`Expected arguments for "${n}" to be (string, string) or (number, number), but found (${x.kind}, ${b.kind}) instead.`)}if(this.collator&&!o&&this.hasUntypedArgument){const x=oi(p),b=oi(_);if(x.kind!=="string"||b.kind!=="string")return e(d,p,_)}return this.collator?i(d,p,_,this.collator.evaluate(d)):e(d,p,_)}eachChild(d){d(this.lhs),d(this.rhs),this.collator&&d(this.collator)}outputDefined(){return!0}serialize(){const d=[n];return this.eachChild(p=>{d.push(p.serialize())}),d}}}const Vd=Vl("==",function(n,e,i){return e===i},cp),hp=Vl("!=",function(n,e,i){return e!==i},function(n,e,i,o){return!cp(0,e,i,o)}),Lh=Vl("<",function(n,e,i){return e<i},function(n,e,i,o){return o.compare(e,i)<0}),jm=Vl(">",function(n,e,i){return e>i},function(n,e,i,o){return o.compare(e,i)>0}),Gm=Vl("<=",function(n,e,i){return e<=i},function(n,e,i,o){return o.compare(e,i)<=0}),$m=Vl(">=",function(n,e,i){return e>=i},function(n,e,i,o){return o.compare(e,i)>=0});class jd{constructor(e,i,o,l,d,p){this.type=bn,this.number=e,this.locale=i,this.currency=o,this.unit=l,this.minFractionDigits=d,this.maxFractionDigits=p}static parse(e,i){if(e.length!==3)return i.error("Expected two arguments.");const o=i.parse(e[1],1,ht);if(!o)return null;const l=e[2];if(typeof l!="object"||Array.isArray(l))return i.error("NumberFormat options argument must be an object.");let d=null;if(l.locale&&(d=i.parse(l.locale,1,bn),!d))return null;let p=null;if(l.currency&&(p=i.parse(l.currency,1,bn),!p))return null;let _=null;if(l.unit&&(_=i.parse(l.unit,1,bn),!_))return null;let x=null;if(l["min-fraction-digits"]&&(x=i.parse(l["min-fraction-digits"],1,ht),!x))return null;let b=null;return l["max-fraction-digits"]&&(b=i.parse(l["max-fraction-digits"],1,ht),!b)?null:new jd(o,d,p,_,x,b)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(e):void 0,unit:this.unit?this.unit.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.unit&&e(this.unit),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.unit&&(e.unit=this.unit.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class Oc{constructor(e){this.type=ht,this.input=e}static parse(e,i){if(e.length!==2)return i.error(`Expected 1 argument, but found ${e.length-1} instead.`);const o=i.parse(e[1],1);return o?o.type.kind!=="array"&&o.type.kind!=="string"&&o.type.kind!=="value"?i.error(`Expected argument of type string or array, but found ${Si(o.type)} instead.`):new Oc(o):null}evaluate(e){const i=this.input.evaluate(e);if(typeof i=="string"||Array.isArray(i))return i.length;throw new tr(`Expected value to be of type string or array, but found ${Si(oi(i))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild(i=>{e.push(i.serialize())}),e}}const sl={"==":Vd,"!=":hp,">":jm,"<":Lh,">=":$m,"<=":Gm,array:va,at:op,boolean:va,case:lp,coalesce:Ud,collator:Pl,format:il,image:Mu,in:Nl,"index-of":sp,interpolate:os,"interpolate-hcl":os,"interpolate-lab":os,length:Oc,let:ap,literal:Ol,match:Nm,number:va,"number-format":jd,object:va,slice:Vm,step:Mc,string:va,"to-boolean":Na,"to-color":Na,"to-number":Na,"to-string":Na,var:Cc,within:Bl};function Pc(n,[e,i,o,l]){e=e.evaluate(n),i=i.evaluate(n),o=o.evaluate(n);const d=l?l.evaluate(n):1,p=Yi(e,i,o,d);if(p)throw new tr(p);return new kn(e/255*d,i/255*d,o/255*d,d)}function Oh(n,e){return n in e}function Bs(n,e){const i=e[n];return i===void 0?null:i}function ss(n){return{type:n}}Oo.register(sl,{error:[{kind:"error"},[bn],(n,[e])=>{throw new tr(e.evaluate(n))}],typeof:[bn,[nn],(n,[e])=>Si(oi(e.evaluate(n)))],"to-rgba":[Mr(ht,4),[Qr],(n,[e])=>e.evaluate(n).toArray()],rgb:[Qr,[ht,ht,ht],Pc],rgba:[Qr,[ht,ht,ht,ht],Pc],has:{type:hn,overloads:[[[bn],(n,[e])=>Oh(e.evaluate(n),n.properties())],[[bn,$r],(n,[e,i])=>Oh(e.evaluate(n),i.evaluate(n))]]},get:{type:nn,overloads:[[[bn],(n,[e])=>Bs(e.evaluate(n),n.properties())],[[bn,$r],(n,[e,i])=>Bs(e.evaluate(n),i.evaluate(n))]]},"feature-state":[nn,[bn],(n,[e])=>Bs(e.evaluate(n),n.featureState||{})],properties:[$r,[],n=>n.properties()],"geometry-type":[bn,[],n=>n.geometryType()],id:[nn,[],n=>n.id()],zoom:[ht,[],n=>n.globals.zoom],pitch:[ht,[],n=>n.globals.pitch||0],"distance-from-center":[ht,[],n=>n.distanceFromCenter()],"heatmap-density":[ht,[],n=>n.globals.heatmapDensity||0],"line-progress":[ht,[],n=>n.globals.lineProgress||0],"sky-radial-progress":[ht,[],n=>n.globals.skyRadialProgress||0],accumulated:[nn,[],n=>n.globals.accumulated===void 0?null:n.globals.accumulated],"+":[ht,ss(ht),(n,e)=>{let i=0;for(const o of e)i+=o.evaluate(n);return i}],"*":[ht,ss(ht),(n,e)=>{let i=1;for(const o of e)i*=o.evaluate(n);return i}],"-":{type:ht,overloads:[[[ht,ht],(n,[e,i])=>e.evaluate(n)-i.evaluate(n)],[[ht],(n,[e])=>-e.evaluate(n)]]},"/":[ht,[ht,ht],(n,[e,i])=>e.evaluate(n)/i.evaluate(n)],"%":[ht,[ht,ht],(n,[e,i])=>e.evaluate(n)%i.evaluate(n)],ln2:[ht,[],()=>Math.LN2],pi:[ht,[],()=>Math.PI],e:[ht,[],()=>Math.E],"^":[ht,[ht,ht],(n,[e,i])=>Math.pow(e.evaluate(n),i.evaluate(n))],sqrt:[ht,[ht],(n,[e])=>Math.sqrt(e.evaluate(n))],log10:[ht,[ht],(n,[e])=>Math.log(e.evaluate(n))/Math.LN10],ln:[ht,[ht],(n,[e])=>Math.log(e.evaluate(n))],log2:[ht,[ht],(n,[e])=>Math.log(e.evaluate(n))/Math.LN2],sin:[ht,[ht],(n,[e])=>Math.sin(e.evaluate(n))],cos:[ht,[ht],(n,[e])=>Math.cos(e.evaluate(n))],tan:[ht,[ht],(n,[e])=>Math.tan(e.evaluate(n))],asin:[ht,[ht],(n,[e])=>Math.asin(e.evaluate(n))],acos:[ht,[ht],(n,[e])=>Math.acos(e.evaluate(n))],atan:[ht,[ht],(n,[e])=>Math.atan(e.evaluate(n))],min:[ht,ss(ht),(n,e)=>Math.min(...e.map(i=>i.evaluate(n)))],max:[ht,ss(ht),(n,e)=>Math.max(...e.map(i=>i.evaluate(n)))],abs:[ht,[ht],(n,[e])=>Math.abs(e.evaluate(n))],round:[ht,[ht],(n,[e])=>{const i=e.evaluate(n);return i<0?-Math.round(-i):Math.round(i)}],floor:[ht,[ht],(n,[e])=>Math.floor(e.evaluate(n))],ceil:[ht,[ht],(n,[e])=>Math.ceil(e.evaluate(n))],"filter-==":[hn,[bn,nn],(n,[e,i])=>n.properties()[e.value]===i.value],"filter-id-==":[hn,[nn],(n,[e])=>n.id()===e.value],"filter-type-==":[hn,[bn],(n,[e])=>n.geometryType()===e.value],"filter-<":[hn,[bn,nn],(n,[e,i])=>{const o=n.properties()[e.value],l=i.value;return typeof o==typeof l&&o<l}],"filter-id-<":[hn,[nn],(n,[e])=>{const i=n.id(),o=e.value;return typeof i==typeof o&&i<o}],"filter->":[hn,[bn,nn],(n,[e,i])=>{const o=n.properties()[e.value],l=i.value;return typeof o==typeof l&&o>l}],"filter-id->":[hn,[nn],(n,[e])=>{const i=n.id(),o=e.value;return typeof i==typeof o&&i>o}],"filter-<=":[hn,[bn,nn],(n,[e,i])=>{const o=n.properties()[e.value],l=i.value;return typeof o==typeof l&&o<=l}],"filter-id-<=":[hn,[nn],(n,[e])=>{const i=n.id(),o=e.value;return typeof i==typeof o&&i<=o}],"filter->=":[hn,[bn,nn],(n,[e,i])=>{const o=n.properties()[e.value],l=i.value;return typeof o==typeof l&&o>=l}],"filter-id->=":[hn,[nn],(n,[e])=>{const i=n.id(),o=e.value;return typeof i==typeof o&&i>=o}],"filter-has":[hn,[nn],(n,[e])=>e.value in n.properties()],"filter-has-id":[hn,[],n=>n.id()!==null&&n.id()!==void 0],"filter-type-in":[hn,[Mr(bn)],(n,[e])=>e.value.indexOf(n.geometryType())>=0],"filter-id-in":[hn,[Mr(nn)],(n,[e])=>e.value.indexOf(n.id())>=0],"filter-in-small":[hn,[bn,Mr(nn)],(n,[e,i])=>i.value.indexOf(n.properties()[e.value])>=0],"filter-in-large":[hn,[bn,Mr(nn)],(n,[e,i])=>function(o,l,d,p){for(;d<=p;){const _=d+p>>1;if(l[_]===o)return!0;l[_]>o?p=_-1:d=_+1}return!1}(n.properties()[e.value],i.value,0,i.value.length-1)],all:{type:hn,overloads:[[[hn,hn],(n,[e,i])=>e.evaluate(n)&&i.evaluate(n)],[ss(hn),(n,e)=>{for(const i of e)if(!i.evaluate(n))return!1;return!0}]]},any:{type:hn,overloads:[[[hn,hn],(n,[e,i])=>e.evaluate(n)||i.evaluate(n)],[ss(hn),(n,e)=>{for(const i of e)if(i.evaluate(n))return!0;return!1}]]},"!":[hn,[hn],(n,[e])=>!e.evaluate(n)],"is-supported-script":[hn,[bn],(n,[e])=>{const i=n.globals&&n.globals.isSupportedScript;return!i||i(e.evaluate(n))}],upcase:[bn,[bn],(n,[e])=>e.evaluate(n).toUpperCase()],downcase:[bn,[bn],(n,[e])=>e.evaluate(n).toLowerCase()],concat:[bn,ss(nn),(n,e)=>e.map(i=>qr(i.evaluate(n))).join("")],"resolved-locale":[bn,[ho],(n,[e])=>e.evaluate(n).resolvedLocale()]});var Bc=sl;function dp(n){return{result:"success",value:n}}function Ja(n){return{result:"error",value:n}}function jl(n){return n["property-type"]==="data-driven"}function ll(n){return!!n.expression&&n.expression.parameters.indexOf("zoom")>-1}function Gd(n){return!!n.expression&&n.expression.interpolated}function Xn(n){return n instanceof Number?"number":n instanceof String?"string":n instanceof Boolean?"boolean":Array.isArray(n)?"array":n===null?"null":typeof n}function Pr(n){return typeof n=="object"&&n!==null&&!Array.isArray(n)}function fp(n){return n}function Ph(n,e){const i=e.type==="color",o=n.stops&&typeof n.stops[0][0]=="object",l=o||!(o||n.property!==void 0),d=n.type||(Gd(e)?"exponential":"interval");if(i&&((n=ya({},n)).stops&&(n.stops=n.stops.map(b=>[b[0],kn.parse(b[1])])),n.default=kn.parse(n.default?n.default:e.default)),n.colorSpace&&n.colorSpace!=="rgb"&&!rp[n.colorSpace])throw new Error(`Unknown color space: ${n.colorSpace}`);let p,_,x;if(d==="exponential")p=qd;else if(d==="interval")p=pp;else if(d==="categorical"){p=$d,_=Object.create(null);for(const b of n.stops)_[b[0]]=b[1];x=typeof n.stops[0][0]}else{if(d!=="identity")throw new Error(`Unknown function type "${d}"`);p=Bh}if(o){const b={},S=[];for(let I=0;I<n.stops.length;I++){const L=n.stops[I],N=L[0].zoom;b[N]===void 0&&(b[N]={zoom:N,type:n.type,property:n.property,default:n.default,stops:[]},S.push(N)),b[N].stops.push([L[0].value,L[1]])}const M=[];for(const I of S)M.push([b[I].zoom,Ph(b[I],e)]);const R={name:"linear"};return{kind:"composite",interpolationType:R,interpolationFactor:os.interpolationFactor.bind(void 0,R),zoomStops:M.map(I=>I[0]),evaluate:({zoom:I},L)=>qd({stops:M,base:n.base},e,I).evaluate(I,L)}}if(l){const b=d==="exponential"?{name:"exponential",base:n.base!==void 0?n.base:1}:null;return{kind:"camera",interpolationType:b,interpolationFactor:os.interpolationFactor.bind(void 0,b),zoomStops:n.stops.map(S=>S[0]),evaluate:({zoom:S})=>p(n,e,S,_,x)}}return{kind:"source",evaluate(b,S){const M=S&&S.properties?S.properties[n.property]:void 0;return M===void 0?ku(n.default,e.default):p(n,e,M,_,x)}}}function ku(n,e,i){return n!==void 0?n:e!==void 0?e:i!==void 0?i:void 0}function $d(n,e,i,o,l){return ku(typeof i===l?o[i]:void 0,n.default,e.default)}function pp(n,e,i){if(Xn(i)!=="number")return ku(n.default,e.default);const o=n.stops.length;if(o===1||i<=n.stops[0][0])return n.stops[0][1];if(i>=n.stops[o-1][0])return n.stops[o-1][1];const l=Au(n.stops.map(d=>d[0]),i);return n.stops[l][1]}function qd(n,e,i){const o=n.base!==void 0?n.base:1;if(Xn(i)!=="number")return ku(n.default,e.default);const l=n.stops.length;if(l===1||i<=n.stops[0][0])return n.stops[0][1];if(i>=n.stops[l-1][0])return n.stops[l-1][1];const d=Au(n.stops.map(S=>S[0]),i),p=function(S,M,R,I){const L=I-R,N=S-R;return L===0?0:M===1?N/L:(Math.pow(M,N)-1)/(Math.pow(M,L)-1)}(i,o,n.stops[d][0],n.stops[d+1][0]),_=n.stops[d][1],x=n.stops[d+1][1];let b=Ch[e.type]||fp;if(n.colorSpace&&n.colorSpace!=="rgb"){const S=rp[n.colorSpace];b=(M,R)=>S.reverse(S.interpolate(S.forward(M),S.forward(R),p))}return typeof _.evaluate=="function"?{evaluate(...S){const M=_.evaluate.apply(void 0,S),R=x.evaluate.apply(void 0,S);if(M!==void 0&&R!==void 0)return b(M,R,p)}}:b(_,x,p)}function Bh(n,e,i){return e.type==="color"?i=kn.parse(i):e.type==="formatted"?i=Ar.fromString(i.toString()):e.type==="resolvedImage"?i=Ci.fromString(i.toString()):Xn(i)===e.type||e.type==="enum"&&e.values[i]||(i=void 0),ku(i,n.default,e.default)}class Lu{constructor(e,i){this.expression=e,this._warningHistory={},this._evaluator=new Sc,this._defaultValue=i?function(o){return o.type==="color"&&(Pr(o.default)||Array.isArray(o.default))?new kn(0,0,0,0):o.type==="color"?kn.parse(o.default)||null:o.default===void 0?null:o.default}(i):null,this._enumValues=i&&i.type==="enum"?i.values:null}evaluateWithoutErrorHandling(e,i,o,l,d,p,_,x){return this._evaluator.globals=e,this._evaluator.feature=i,this._evaluator.featureState=o,this._evaluator.canonical=l||null,this._evaluator.availableImages=d||null,this._evaluator.formattedSection=p,this._evaluator.featureTileCoord=_||null,this._evaluator.featureDistanceData=x||null,this.expression.evaluate(this._evaluator)}evaluate(e,i,o,l,d,p,_,x){this._evaluator.globals=e,this._evaluator.feature=i||null,this._evaluator.featureState=o||null,this._evaluator.canonical=l||null,this._evaluator.availableImages=d||null,this._evaluator.formattedSection=p||null,this._evaluator.featureTileCoord=_||null,this._evaluator.featureDistanceData=x||null;try{const b=this.expression.evaluate(this._evaluator);if(b==null||typeof b=="number"&&b!=b)return this._defaultValue;if(this._enumValues&&!(b in this._enumValues))throw new tr(`Expected value to be one of ${Object.keys(this._enumValues).map(S=>JSON.stringify(S)).join(", ")}, but found ${JSON.stringify(b)} instead.`);return b}catch(b){return this._warningHistory[b.message]||(this._warningHistory[b.message]=!0,typeof console<"u"&&console.warn(b.message)),this._defaultValue}}}function Fs(n){return Array.isArray(n)&&n.length>0&&typeof n[0]=="string"&&n[0]in Bc}function ul(n,e){const i=new Fl(Bc,[],e?function(l){const d={color:Qr,string:bn,number:ht,enum:bn,boolean:hn,formatted:ko,resolvedImage:fo};return l.type==="array"?Mr(d[l.value]||nn,l.length):d[l.type]}(e):void 0),o=i.parse(n,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return o?dp(new Lu(o,e)):Ja(i.errors)}class vo{constructor(e,i){this.kind=e,this._styleExpression=i,this.isStateDependent=e!=="constant"&&!yo(i.expression)}evaluateWithoutErrorHandling(e,i,o,l,d,p){return this._styleExpression.evaluateWithoutErrorHandling(e,i,o,l,d,p)}evaluate(e,i,o,l,d,p){return this._styleExpression.evaluate(e,i,o,l,d,p)}}class Fh{constructor(e,i,o,l){this.kind=e,this.zoomStops=o,this._styleExpression=i,this.isStateDependent=e!=="camera"&&!yo(i.expression),this.interpolationType=l}evaluateWithoutErrorHandling(e,i,o,l,d,p){return this._styleExpression.evaluateWithoutErrorHandling(e,i,o,l,d,p)}evaluate(e,i,o,l,d,p){return this._styleExpression.evaluate(e,i,o,l,d,p)}interpolationFactor(e,i,o){return this.interpolationType?os.interpolationFactor(this.interpolationType,e,i,o):0}}function Hd(n,e){if((n=ul(n,e)).result==="error")return n;const i=n.value.expression,o=al(i);if(!o&&!jl(e))return Ja([new Jr("","data expressions not supported")]);const l=Ps(i,["zoom","pitch","distance-from-center"]);if(!l&&!ll(e))return Ja([new Jr("","zoom expressions not supported")]);const d=Gl(i);return d||l?d instanceof Jr?Ja([d]):d instanceof os&&!Gd(e)?Ja([new Jr("",'"interpolate" expressions cannot be used with this property')]):dp(d?new Fh(o?"camera":"composite",n.value,d.labels,d instanceof os?d.interpolation:void 0):new vo(o?"constant":"source",n.value)):Ja([new Jr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Ou{constructor(e,i){this._parameters=e,this._specification=i,ya(this,Ph(this._parameters,this._specification))}static deserialize(e){return new Ou(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function Gl(n){let e=null;if(n instanceof ap)e=Gl(n.result);else if(n instanceof Ud){for(const i of n.args)if(e=Gl(i),e)break}else(n instanceof Mc||n instanceof os)&&n.input instanceof Oo&&n.input.name==="zoom"&&(e=n);return e instanceof Jr||n.eachChild(i=>{const o=Gl(i);o instanceof Jr?e=o:!e&&o?e=new Jr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&o&&e!==o&&(e=new Jr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}class mt{constructor(e,i,o,l){this.message=(e?`${e}: `:"")+o,l&&(this.identifier=l),i!=null&&i.__line__&&(this.line=i.__line__)}}function na(n){const e=n.key,i=n.value,o=n.valueSpec||{},l=n.objectElementValidators||{},d=n.style,p=n.styleSpec;let _=[];const x=Xn(i);if(x!=="object")return[new mt(e,i,`object expected, ${x} found`)];for(const b in i){const S=b.split(".")[0],M=o[S]||o["*"];let R;l[S]?R=l[S]:o[S]?R=ba:l["*"]?R=l["*"]:o["*"]&&(R=ba),R?_=_.concat(R({key:(e&&`${e}.`)+b,value:i[b],valueSpec:M,style:d,styleSpec:p,object:i,objectKey:b},i)):_.push(new mt(e,i[b],`unknown property "${b}"`))}for(const b in o)l[b]||o[b].required&&o[b].default===void 0&&i[b]===void 0&&_.push(new mt(e,i,`missing required property "${b}"`));return _}function ls(n){const e=n.value,i=n.valueSpec,o=n.style,l=n.styleSpec,d=n.key,p=n.arrayElementValidator||ba;if(Xn(e)!=="array")return[new mt(d,e,`array expected, ${Xn(e)} found`)];if(i.length&&e.length!==i.length)return[new mt(d,e,`array length ${i.length} expected, length ${e.length} found`)];if(i["min-length"]&&e.length<i["min-length"])return[new mt(d,e,`array length at least ${i["min-length"]} expected, length ${e.length} found`)];let _={type:i.value,values:i.values,minimum:i.minimum,maximum:i.maximum,function:void 0};l.$version<7&&(_.function=i.function),Xn(i.value)==="object"&&(_=i.value);let x=[];for(let b=0;b<e.length;b++)x=x.concat(p({array:e,arrayIndex:b,value:e[b],valueSpec:_,style:o,styleSpec:l,key:`${d}[${b}]`}));return x}function Zd(n){const e=n.key,i=n.value,o=n.valueSpec;let l=Xn(i);if(l==="number"&&i!=i&&(l="NaN"),l!=="number")return[new mt(e,i,`number expected, ${l} found`)];if("minimum"in o){let d=o.minimum;if(Xn(o.minimum)==="array"&&(d=o.minimum[n.arrayIndex]),i<d)return[new mt(e,i,`${i} is less than the minimum value ${d}`)]}if("maximum"in o){let d=o.maximum;if(Xn(o.maximum)==="array"&&(d=o.maximum[n.arrayIndex]),i>d)return[new mt(e,i,`${i} is greater than the maximum value ${d}`)]}return[]}function mp(n){const e=n.valueSpec,i=Wi(n.value.type);let o,l,d,p={};const _=i!=="categorical"&&n.value.property===void 0,x=!_,b=Xn(n.value.stops)==="array"&&Xn(n.value.stops[0])==="array"&&Xn(n.value.stops[0][0])==="object",S=na({key:n.key,value:n.value,valueSpec:n.styleSpec.function,style:n.style,styleSpec:n.styleSpec,objectElementValidators:{stops:function(I){if(i==="identity")return[new mt(I.key,I.value,'identity function may not have a "stops" property')];let L=[];const N=I.value;return L=L.concat(ls({key:I.key,value:N,valueSpec:I.valueSpec,style:I.style,styleSpec:I.styleSpec,arrayElementValidator:M})),Xn(N)==="array"&&N.length===0&&L.push(new mt(I.key,N,"array must have at least one stop")),L},default:function(I){return ba({key:I.key,value:I.value,valueSpec:e,style:I.style,styleSpec:I.styleSpec})}}});return i==="identity"&&_&&S.push(new mt(n.key,n.value,'missing required property "property"')),i==="identity"||n.value.stops||S.push(new mt(n.key,n.value,'missing required property "stops"')),i==="exponential"&&n.valueSpec.expression&&!Gd(n.valueSpec)&&S.push(new mt(n.key,n.value,"exponential functions not supported")),n.styleSpec.$version>=8&&(x&&!jl(n.valueSpec)?S.push(new mt(n.key,n.value,"property functions not supported")):_&&!ll(n.valueSpec)&&S.push(new mt(n.key,n.value,"zoom functions not supported"))),i!=="categorical"&&!b||n.value.property!==void 0||S.push(new mt(n.key,n.value,'"property" property is required')),S;function M(I){let L=[];const N=I.value,$=I.key;if(Xn(N)!=="array")return[new mt($,N,`array expected, ${Xn(N)} found`)];if(N.length!==2)return[new mt($,N,`array length 2 expected, length ${N.length} found`)];if(b){if(Xn(N[0])!=="object")return[new mt($,N,`object expected, ${Xn(N[0])} found`)];if(N[0].zoom===void 0)return[new mt($,N,"object stop key must have zoom")];if(N[0].value===void 0)return[new mt($,N,"object stop key must have value")];const te=Wi(N[0].zoom);if(typeof te!="number")return[new mt($,N[0].zoom,"stop zoom values must be numbers")];if(d&&d>te)return[new mt($,N[0].zoom,"stop zoom values must appear in ascending order")];te!==d&&(d=te,l=void 0,p={}),L=L.concat(na({key:`${$}[0]`,value:N[0],valueSpec:{zoom:{}},style:I.style,styleSpec:I.styleSpec,objectElementValidators:{zoom:Zd,value:R}}))}else L=L.concat(R({key:`${$}[0]`,value:N[0],valueSpec:{},style:I.style,styleSpec:I.styleSpec},N));return Fs(Ka(N[1]))?L.concat([new mt(`${$}[1]`,N[1],"expressions are not allowed in function stops.")]):L.concat(ba({key:`${$}[1]`,value:N[1],valueSpec:e,style:I.style,styleSpec:I.styleSpec}))}function R(I,L){const N=Xn(I.value),$=Wi(I.value),te=I.value!==null?I.value:L;if(o){if(N!==o)return[new mt(I.key,te,`${N} stop domain type must match previous stop domain type ${o}`)]}else o=N;if(N!=="number"&&N!=="string"&&N!=="boolean"&&typeof $!="number"&&typeof $!="string"&&typeof $!="boolean")return[new mt(I.key,te,"stop domain value must be a number, string, or boolean")];if(N!=="number"&&i!=="categorical"){let ce=`number expected, ${N} found`;return jl(e)&&i===void 0&&(ce+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new mt(I.key,te,ce)]}return i!=="categorical"||N!=="number"||typeof $=="number"&&isFinite($)&&Math.floor($)===$?i!=="categorical"&&N==="number"&&typeof $=="number"&&typeof l=="number"&&l!==void 0&&$<l?[new mt(I.key,te,"stop domain values must appear in ascending order")]:(l=$,i==="categorical"&&$ in p?[new mt(I.key,te,"stop domain values must be unique")]:(p[$]=!0,[])):[new mt(I.key,te,`integer expected, found ${String($)}`)]}}function $l(n){const e=(n.expressionContext==="property"?Hd:ul)(Ka(n.value),n.valueSpec);if(e.result==="error")return e.value.map(o=>new mt(`${n.key}${o.key}`,n.value,o.message));const i=e.value.expression||e.value._styleExpression.expression;if(n.expressionContext==="property"&&n.propertyKey==="text-font"&&!i.outputDefined())return[new mt(n.key,n.value,`Invalid data expression for "${n.propertyKey}". Output values must be contained as literals within the expression.`)];if(n.expressionContext==="property"&&n.propertyType==="layout"&&!yo(i))return[new mt(n.key,n.value,'"feature-state" data expressions are not supported with layout properties.')];if(n.expressionContext==="filter")return gp(i,n);if(n.expressionContext&&n.expressionContext.indexOf("cluster")===0){if(!Ps(i,["zoom","feature-state"]))return[new mt(n.key,n.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(n.expressionContext==="cluster-initial"&&!al(i))return[new mt(n.key,n.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function gp(n,e){const i=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(e.valueSpec&&e.valueSpec.expression)for(const l of e.valueSpec.expression.parameters)i.delete(l);if(i.size===0)return[];const o=[];return n instanceof Oo&&i.has(n.name)?[new mt(e.key,e.value,`["${n.name}"] expression is not supported in a filter for a ${e.object.type} layer with id: ${e.object.id}`)]:(n.eachChild(l=>{o.push(...gp(l,e))}),o)}function Fc(n){const e=n.key,i=n.value,o=n.valueSpec,l=[];return Array.isArray(o.values)?o.values.indexOf(Wi(i))===-1&&l.push(new mt(e,i,`expected one of [${o.values.join(", ")}], ${JSON.stringify(i)} found`)):Object.keys(o.values).indexOf(Wi(i))===-1&&l.push(new mt(e,i,`expected one of [${Object.keys(o.values).join(", ")}], ${JSON.stringify(i)} found`)),l}function ql(n){if(n===!0||n===!1)return!0;if(!Array.isArray(n)||n.length===0)return!1;switch(n[0]){case"has":return n.length>=2&&n[1]!=="$id"&&n[1]!=="$type";case"in":return n.length>=3&&(typeof n[1]!="string"||Array.isArray(n[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return n.length!==3||Array.isArray(n[1])||Array.isArray(n[2]);case"any":case"all":for(const e of n.slice(1))if(!ql(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}function cl(n,e="fill"){if(n==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};ql(n)||(n=us(n));const i=n;let o=!0;try{o=function(b){if(!Hl(b))return b;let S=Ka(b);return Uc(S),S=xa(S),S}(i)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(i,null,2)}
        `)}const l=Ne[`filter_${e}`],d=ul(o,l);let p=null;if(d.result==="error")throw new Error(d.value.map(b=>`${b.key}: ${b.message}`).join(", "));p=(b,S,M)=>d.value.evaluate(b,S,{},M);let _=null,x=null;if(o!==i){const b=ul(i,l);if(b.result==="error")throw new Error(b.value.map(S=>`${S.key}: ${S.message}`).join(", "));_=(S,M,R,I,L)=>b.value.evaluate(S,M,{},R,void 0,void 0,I,L),x=!al(b.value.expression)}return{filter:p,dynamicFilter:_||void 0,needGeometry:_p(o),needFeature:!!x}}function xa(n){if(!Array.isArray(n))return n;const e=function(i){if(qm.has(i[0])){for(let o=1;o<i.length;o++)if(Hl(i[o]))return!0}return i}(n);return e===!0?e:e.map(i=>xa(i))}function Uc(n){let e=!1;const i=[];if(n[0]==="case"){for(let o=1;o<n.length-1;o+=2)e=e||Hl(n[o]),i.push(n[o+1]);i.push(n[n.length-1])}else if(n[0]==="match"){e=e||Hl(n[1]);for(let o=2;o<n.length-1;o+=2)i.push(n[o+1]);i.push(n[n.length-1])}else if(n[0]==="step"){e=e||Hl(n[1]);for(let o=1;o<n.length-1;o+=2)i.push(n[o+1])}e&&(n.length=0,n.push("any",...i));for(let o=1;o<n.length;o++)Uc(n[o])}function Hl(n){if(!Array.isArray(n))return!1;if((e=n[0])==="pitch"||e==="distance-from-center")return!0;var e;for(let i=1;i<n.length;i++)if(Hl(n[i]))return!0;return!1}const qm=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Hm(n,e){return n<e?-1:n>e?1:0}function _p(n){if(!Array.isArray(n))return!1;if(n[0]==="within")return!0;for(let e=1;e<n.length;e++)if(_p(n[e]))return!0;return!1}function us(n){if(!n)return!0;const e=n[0];return n.length<=1?e!=="any":e==="=="?Nc(n[1],n[2],"=="):e==="!="?Vc(Nc(n[1],n[2],"==")):e==="<"||e===">"||e==="<="||e===">="?Nc(n[1],n[2],e):e==="any"?(i=n.slice(1),["any"].concat(i.map(us))):e==="all"?["all"].concat(n.slice(1).map(us)):e==="none"?["all"].concat(n.slice(1).map(us).map(Vc)):e==="in"?hl(n[1],n.slice(2)):e==="!in"?Vc(hl(n[1],n.slice(2))):e==="has"?Xd(n[1]):e==="!has"?Vc(Xd(n[1])):e!=="within"||n;var i}function Nc(n,e,i){switch(n){case"$type":return[`filter-type-${i}`,e];case"$id":return[`filter-id-${i}`,e];default:return[`filter-${i}`,n,e]}}function hl(n,e){if(e.length===0)return!1;switch(n){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(i=>typeof i!=typeof e[0])?["filter-in-large",n,["literal",e.sort(Hm)]]:["filter-in-small",n,["literal",e]]}}function Xd(n){switch(n){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",n]}}function Vc(n){return["!",n]}function Zl(n){return ql(Ka(n.value))?$l(ya({},n,{expressionContext:"filter",valueSpec:n.styleSpec[`filter_${n.layerType||"fill"}`]})):yp(n)}function yp(n){const e=n.value,i=n.key;if(Xn(e)!=="array")return[new mt(i,e,`array expected, ${Xn(e)} found`)];const o=n.styleSpec;let l,d=[];if(e.length<1)return[new mt(i,e,"filter array must have at least 1 element")];switch(d=d.concat(Fc({key:`${i}[0]`,value:e[0],valueSpec:o.filter_operator,style:n.style,styleSpec:n.styleSpec})),Wi(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&Wi(e[1])==="$type"&&d.push(new mt(i,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&d.push(new mt(i,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(l=Xn(e[1]),l!=="string"&&d.push(new mt(`${i}[1]`,e[1],`string expected, ${l} found`)));for(let p=2;p<e.length;p++)l=Xn(e[p]),Wi(e[1])==="$type"?d=d.concat(Fc({key:`${i}[${p}]`,value:e[p],valueSpec:o.geometry_type,style:n.style,styleSpec:n.styleSpec})):l!=="string"&&l!=="number"&&l!=="boolean"&&d.push(new mt(`${i}[${p}]`,e[p],`string, number, or boolean expected, ${l} found`));break;case"any":case"all":case"none":for(let p=1;p<e.length;p++)d=d.concat(yp({key:`${i}[${p}]`,value:e[p],style:n.style,styleSpec:n.styleSpec}));break;case"has":case"!has":l=Xn(e[1]),e.length!==2?d.push(new mt(i,e,`filter array for "${e[0]}" operator must have 2 elements`)):l!=="string"&&d.push(new mt(`${i}[1]`,e[1],`string expected, ${l} found`));break;case"within":l=Xn(e[1]),e.length!==2?d.push(new mt(i,e,`filter array for "${e[0]}" operator must have 2 elements`)):l!=="object"&&d.push(new mt(`${i}[1]`,e[1],`object expected, ${l} found`))}return d}function dl(n,e){const i=n.key,o=n.style,l=n.styleSpec,d=n.value,p=n.objectKey,_=l[`${e}_${n.layerType}`];if(!_)return[];const x=p.match(/^(.*)-transition$/);if(e==="paint"&&x&&_[x[1]]&&_[x[1]].transition)return ba({key:i,value:d,valueSpec:l.transition,style:o,styleSpec:l});const b=n.valueSpec||_[p];if(!b)return[new mt(i,d,`unknown property "${p}"`)];let S;if(Xn(d)==="string"&&jl(b)&&!b.tokens&&(S=/^{([^}]+)}$/.exec(d)))return[new mt(i,d,`"${p}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(S[1])} }\`.`)];const M=[];return n.layerType==="symbol"&&(p==="text-field"&&o&&!o.glyphs&&M.push(new mt(i,d,'use of "text-field" requires a style "glyphs" property')),p==="text-font"&&Pr(Ka(d))&&Wi(d.type)==="identity"&&M.push(new mt(i,d,'"text-font" does not support identity functions'))),M.concat(ba({key:n.key,value:d,valueSpec:b,style:o,styleSpec:l,expressionContext:"property",propertyType:e,propertyKey:p}))}function Pu(n){return dl(n,"paint")}function jc(n){return dl(n,"layout")}function Bu(n){let e=[];const i=n.value,o=n.key,l=n.style,d=n.styleSpec;i.type||i.ref||e.push(new mt(o,i,'either "type" or "ref" is required'));let p=Wi(i.type);const _=Wi(i.ref);if(i.id){const x=Wi(i.id);for(let b=0;b<n.arrayIndex;b++){const S=l.layers[b];Wi(S.id)===x&&e.push(new mt(o,i.id,`duplicate layer id "${i.id}", previously used at line ${S.id.__line__}`))}}if("ref"in i){let x;["type","source","source-layer","filter","layout"].forEach(b=>{b in i&&e.push(new mt(o,i[b],`"${b}" is prohibited for ref layers`))}),l.layers.forEach(b=>{Wi(b.id)===_&&(x=b)}),x?x.ref?e.push(new mt(o,i.ref,"ref cannot reference another ref layer")):p=Wi(x.type):typeof _=="string"&&e.push(new mt(o,i.ref,`ref layer "${_}" not found`))}else if(p!=="background"&&p!=="sky")if(i.source){const x=l.sources&&l.sources[i.source],b=x&&Wi(x.type);x?b==="vector"&&p==="raster"?e.push(new mt(o,i.source,`layer "${i.id}" requires a raster source`)):b==="raster"&&p!=="raster"?e.push(new mt(o,i.source,`layer "${i.id}" requires a vector source`)):b!=="vector"||i["source-layer"]?b==="raster-dem"&&p!=="hillshade"?e.push(new mt(o,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):p!=="line"||!i.paint||!i.paint["line-gradient"]&&!i.paint["line-trim-offset"]||b==="geojson"&&x.lineMetrics||e.push(new mt(o,i,`layer "${i.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new mt(o,i,`layer "${i.id}" must specify a "source-layer"`)):e.push(new mt(o,i.source,`source "${i.source}" not found`))}else e.push(new mt(o,i,'missing required property "source"'));return e=e.concat(na({key:o,value:i,valueSpec:d.layer,style:n.style,styleSpec:n.styleSpec,objectElementValidators:{"*":()=>[],type:()=>ba({key:`${o}.type`,value:i.type,valueSpec:d.layer.type,style:n.style,styleSpec:n.styleSpec,object:i,objectKey:"type"}),filter:x=>Zl(ya({layerType:p},x)),layout:x=>na({layer:i,key:x.key,value:x.value,valueSpec:{},style:x.style,styleSpec:x.styleSpec,objectElementValidators:{"*":b=>jc(ya({layerType:p},b))}}),paint:x=>na({layer:i,key:x.key,value:x.value,valueSpec:{},style:x.style,styleSpec:x.styleSpec,objectElementValidators:{"*":b=>Pu(ya({layerType:p},b))}})}})),e}function Us(n){const e=n.value,i=n.key,o=Xn(e);return o!=="string"?[new mt(i,e,`string expected, ${o} found`)]:[]}const Gc={promoteId:function({key:n,value:e}){if(Xn(e)==="string")return Us({key:n,value:e});{const i=[];for(const o in e)i.push(...Us({key:`${n}.${o}`,value:e[o]}));return i}}};function vp(n){const e=n.value,i=n.key,o=n.styleSpec,l=n.style;if(!e.type)return[new mt(i,e,'"type" is required')];const d=Wi(e.type);let p;switch(d){case"vector":case"raster":case"raster-dem":return p=na({key:i,value:e,valueSpec:o[`source_${d.replace("-","_")}`],style:n.style,styleSpec:o,objectElementValidators:Gc}),p;case"geojson":if(p=na({key:i,value:e,valueSpec:o.source_geojson,style:l,styleSpec:o,objectElementValidators:Gc}),e.cluster)for(const _ in e.clusterProperties){const[x,b]=e.clusterProperties[_],S=typeof x=="string"?[x,["accumulated"],["get",_]]:x;p.push(...$l({key:`${i}.${_}.map`,value:b,expressionContext:"cluster-map"})),p.push(...$l({key:`${i}.${_}.reduce`,value:S,expressionContext:"cluster-reduce"}))}return p;case"video":return na({key:i,value:e,valueSpec:o.source_video,style:l,styleSpec:o});case"image":return na({key:i,value:e,valueSpec:o.source_image,style:l,styleSpec:o});case"canvas":return[new mt(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Fc({key:`${i}.type`,value:e.type,valueSpec:{values:xp(o)},style:l,styleSpec:o})}}function xp(n){return n.source.reduce((e,i)=>{const o=n[i];return o.type.type==="enum"&&(e=e.concat(Object.keys(o.type.values))),e},[])}function bp(n){const e=n.value,i=n.styleSpec,o=i.light,l=n.style;let d=[];const p=Xn(e);if(e===void 0)return d;if(p!=="object")return d=d.concat([new mt("light",e,`object expected, ${p} found`)]),d;for(const _ in e){const x=_.match(/^(.*)-transition$/);d=d.concat(x&&o[x[1]]&&o[x[1]].transition?ba({key:_,value:e[_],valueSpec:i.transition,style:l,styleSpec:i}):o[_]?ba({key:_,value:e[_],valueSpec:o[_],style:l,styleSpec:i}):[new mt(_,e[_],`unknown property "${_}"`)])}return d}function Fu(n){const e=n.value,i=n.key,o=n.style,l=n.styleSpec,d=l.terrain;let p=[];const _=Xn(e);if(e===void 0)return p;if(_!=="object")return p=p.concat([new mt("terrain",e,`object expected, ${_} found`)]),p;for(const x in e){const b=x.match(/^(.*)-transition$/);p=p.concat(b&&d[b[1]]&&d[b[1]].transition?ba({key:x,value:e[x],valueSpec:l.transition,style:o,styleSpec:l}):d[x]?ba({key:x,value:e[x],valueSpec:d[x],style:o,styleSpec:l}):[new mt(x,e[x],`unknown property "${x}"`)])}if(e.source){const x=o.sources&&o.sources[e.source],b=x&&Wi(x.type);x?b!=="raster-dem"&&p.push(new mt(i,e.source,`terrain cannot be used with a source of type ${String(b)}, it only be used with a "raster-dem" source type`)):p.push(new mt(i,e.source,`source "${e.source}" not found`))}else p.push(new mt(i,e,'terrain is missing required property "source"'));return p}function Xl(n){const e=n.value,i=n.style,o=n.styleSpec,l=o.fog;let d=[];const p=Xn(e);if(e===void 0)return d;if(p!=="object")return d=d.concat([new mt("fog",e,`object expected, ${p} found`)]),d;for(const _ in e){const x=_.match(/^(.*)-transition$/);d=d.concat(x&&l[x[1]]&&l[x[1]].transition?ba({key:_,value:e[_],valueSpec:o.transition,style:i,styleSpec:o}):l[_]?ba({key:_,value:e[_],valueSpec:l[_],style:i,styleSpec:o}):[new mt(_,e[_],`unknown property "${_}"`)])}return d}const wp={"*":()=>[],array:ls,boolean:function(n){const e=n.value,i=n.key,o=Xn(e);return o!=="boolean"?[new mt(i,e,`boolean expected, ${o} found`)]:[]},number:Zd,color:function(n){const e=n.key,i=n.value,o=Xn(i);return o!=="string"?[new mt(e,i,`color expected, ${o} found`)]:ts(i)===null?[new mt(e,i,`color expected, "${i}" found`)]:[]},enum:Fc,filter:Zl,function:mp,layer:Bu,object:na,source:vp,light:bp,terrain:Fu,fog:Xl,string:Us,formatted:function(n){return Us(n).length===0?[]:$l(n)},resolvedImage:function(n){return Us(n).length===0?[]:$l(n)},projection:function(n){const e=n.value,i=n.styleSpec,o=i.projection,l=n.style;let d=[];const p=Xn(e);if(p==="object")for(const _ in e)d=d.concat(ba({key:_,value:e[_],valueSpec:o[_],style:l,styleSpec:i}));else p!=="string"&&(d=d.concat([new mt("projection",e,`object or string expected, ${p} found`)]));return d}};function ba(n){const e=n.value,i=n.valueSpec,o=n.styleSpec;return i.expression&&Pr(Wi(e))?mp(n):i.expression&&Fs(Ka(e))?$l(n):i.type&&wp[i.type]?wp[i.type](n):na(ya({},n,{valueSpec:i.type?o[i.type]:i}))}function Kt(n){const e=n.value,i=n.key,o=Us(n);return o.length||(e.indexOf("{fontstack}")===-1&&o.push(new mt(i,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&o.push(new mt(i,e,'"glyphs" url must include a "{range}" token'))),o}function fl(n,e=Ne){return Ca(ba({key:"",value:n,valueSpec:e.$root,styleSpec:e,style:n,objectElementValidators:{glyphs:Kt,"*":()=>[]}}))}const Rr=n=>Ca(Pu(n)),jn=n=>Ca(jc(n));function Ca(n){return n.slice().sort((e,i)=>e.line&&i.line?e.line-i.line:0)}function Uu(n,e){let i=!1;if(e&&e.length)for(const o of e)n.fire(new _a(new Error(o.message))),i=!0;return i}var pl=wn;function wn(n,e,i){var o=this.cells=[];if(n instanceof ArrayBuffer){this.arrayBuffer=n;var l=new Int32Array(this.arrayBuffer);n=l[0],this.d=(e=l[1])+2*(i=l[2]);for(var d=0;d<this.d*this.d;d++){var p=l[3+d],_=l[3+d+1];o.push(p===_?null:l.subarray(p,_))}var x=l[3+o.length+1];this.keys=l.subarray(l[3+o.length],x),this.bboxes=l.subarray(x),this.insert=this._insertReadonly}else{this.d=e+2*i;for(var b=0;b<this.d*this.d;b++)o.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=n,this.padding=i,this.scale=e/n,this.uid=0;var S=i/e*n;this.min=-S,this.max=n+S}wn.prototype.insert=function(n,e,i,o,l){this._forEachCell(e,i,o,l,this._insertCell,this.uid++),this.keys.push(n),this.bboxes.push(e),this.bboxes.push(i),this.bboxes.push(o),this.bboxes.push(l)},wn.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},wn.prototype._insertCell=function(n,e,i,o,l,d){this.cells[l].push(d)},wn.prototype.query=function(n,e,i,o,l){var d=this.min,p=this.max;if(n<=d&&e<=d&&p<=i&&p<=o&&!l)return Array.prototype.slice.call(this.keys);var _=[];return this._forEachCell(n,e,i,o,this._queryCell,_,{},l),_},wn.prototype._queryCell=function(n,e,i,o,l,d,p,_){var x=this.cells[l];if(x!==null)for(var b=this.keys,S=this.bboxes,M=0;M<x.length;M++){var R=x[M];if(p[R]===void 0){var I=4*R;(_?_(S[I+0],S[I+1],S[I+2],S[I+3]):n<=S[I+2]&&e<=S[I+3]&&i>=S[I+0]&&o>=S[I+1])?(p[R]=!0,d.push(b[R])):p[R]=!1}}},wn.prototype._forEachCell=function(n,e,i,o,l,d,p,_){for(var x=this._convertToCellCoord(n),b=this._convertToCellCoord(e),S=this._convertToCellCoord(i),M=this._convertToCellCoord(o),R=x;R<=S;R++)for(var I=b;I<=M;I++){var L=this.d*I+R;if((!_||_(this._convertFromCellCoord(R),this._convertFromCellCoord(I),this._convertFromCellCoord(R+1),this._convertFromCellCoord(I+1)))&&l.call(this,n,e,i,o,L,d,p,_))return}},wn.prototype._convertFromCellCoord=function(n){return(n-this.padding)/this.scale},wn.prototype._convertToCellCoord=function(n){return Math.max(0,Math.min(this.d-1,Math.floor(n*this.scale)+this.padding))},wn.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var n=this.cells,e=3+this.cells.length+1+1,i=0,o=0;o<this.cells.length;o++)i+=this.cells[o].length;var l=new Int32Array(e+i+this.keys.length+this.bboxes.length);l[0]=this.extent,l[1]=this.n,l[2]=this.padding;for(var d=e,p=0;p<n.length;p++){var _=n[p];l[3+p]=d,l.set(_,d),d+=_.length}return l[3+n.length]=d,l.set(this.keys,d),l[3+n.length+1]=d+=this.keys.length,l.set(this.bboxes,d),d+=this.bboxes.length,l.buffer};const xo={};function ft(n,e,i={}){Object.defineProperty(n,"_classRegistryKey",{value:e,writeable:!1}),xo[e]={klass:n,omit:i.omit||[]}}ft(Object,"Object"),pl.serialize=function(n,e){const i=n.toArrayBuffer();return e&&e.push(i),{buffer:i}},pl.deserialize=function(n){return new pl(n.buffer)},Object.defineProperty(pl,"name",{value:"Grid"}),ft(pl,"Grid"),ft(kn,"Color"),ft(Error,"Error"),ft(vt,"AJAXError"),ft(Ci,"ResolvedImage"),ft(Ou,"StylePropertyFunction"),ft(Lu,"StyleExpression",{omit:["_evaluator"]}),ft(Fh,"ZoomDependentExpression"),ft(vo,"ZoomConstantExpression"),ft(Oo,"CompoundExpression",{omit:["_evaluate"]});for(const n in Bc)xo[Bc[n]._classRegistryKey]||ft(Bc[n],`Expression${n}`);function ml(n){return n&&typeof ArrayBuffer<"u"&&(n instanceof ArrayBuffer||n.constructor&&n.constructor.name==="ArrayBuffer")}function bo(n){return Oe.ImageBitmap&&n instanceof Oe.ImageBitmap}function wa(n,e){if(n==null||typeof n=="boolean"||typeof n=="number"||typeof n=="string"||n instanceof Boolean||n instanceof Number||n instanceof String||n instanceof Date||n instanceof RegExp)return n;if(ml(n)||bo(n))return e&&e.push(n),n;if(ArrayBuffer.isView(n)){const i=n;return e&&e.push(i.buffer),i}if(n instanceof Oe.ImageData)return e&&e.push(n.data.buffer),n;if(Array.isArray(n)){const i=[];for(const o of n)i.push(wa(o,e));return i}if(typeof n=="object"){const i=n.constructor,o=i._classRegistryKey;if(!o)throw new Error(`can't serialize object of unregistered class ${o}`);const l=i.serialize?i.serialize(n,e):{};if(!i.serialize){for(const d in n)n.hasOwnProperty(d)&&(xo[o].omit.indexOf(d)>=0||(l[d]=wa(n[d],e)));n instanceof Error&&(l.message=n.message)}if(l.$name)throw new Error("$name property is reserved for worker serialization logic.");return o!=="Object"&&(l.$name=o),l}throw new Error("can't serialize object of type "+typeof n)}function Fo(n){if(n==null||typeof n=="boolean"||typeof n=="number"||typeof n=="string"||n instanceof Boolean||n instanceof Number||n instanceof String||n instanceof Date||n instanceof RegExp||ml(n)||bo(n)||ArrayBuffer.isView(n)||n instanceof Oe.ImageData)return n;if(Array.isArray(n))return n.map(Fo);if(typeof n=="object"){const e=n.$name||"Object",{klass:i}=xo[e];if(!i)throw new Error(`can't deserialize unregistered class ${e}`);if(i.deserialize)return i.deserialize(n);const o=Object.create(i.prototype);for(const l of Object.keys(n))l!=="$name"&&(o[l]=Fo(n[l]));return o}throw new Error("can't deserialize object of type "+typeof n)}const Nu=n=>n>=1536&&n<=1791,Tp=n=>n>=1872&&n<=1919,Wd=n=>n>=2208&&n<=2303,Wl=n=>n>=11904&&n<=12031,ia=n=>n>=12032&&n<=12255,$c=n=>n>=12272&&n<=12287,Yl=n=>n>=12288&&n<=12351,Kl=n=>n>=12352&&n<=12447,cs=n=>n>=12448&&n<=12543,Uh=n=>n>=12544&&n<=12591,Uo=n=>n>=12704&&n<=12735,qc=n=>n>=12736&&n<=12783,Nh=n=>n>=12784&&n<=12799,Vh=n=>n>=12800&&n<=13055,Vu=n=>n>=13056&&n<=13311,Jl=n=>n>=13312&&n<=19903,No=n=>n>=19968&&n<=40959,Ep=n=>n>=40960&&n<=42127,gl=n=>n>=42128&&n<=42191,jh=n=>n>=44032&&n<=55215,ju=n=>n>=63744&&n<=64255,h=n=>n>=64336&&n<=65023,r=n=>n>=65040&&n<=65055,s=n=>n>=65072&&n<=65103,f=n=>n>=65104&&n<=65135,g=n=>n>=65136&&n<=65279,y=n=>n>=65280&&n<=65519;function w(n){for(const e of n)if(z(e.charCodeAt(0)))return!0;return!1}function E(n){for(const e of n)if(!C(e.charCodeAt(0)))return!1;return!0}function C(n){return!(Nu(n)||Tp(n)||Wd(n)||h(n)||g(n))}function z(n){return!(n!==746&&n!==747&&(n<4352||!(Uo(n)||Uh(n)||s(n)&&!(n>=65097&&n<=65103)||ju(n)||Vu(n)||Wl(n)||qc(n)||!(!Yl(n)||n>=12296&&n<=12305||n>=12308&&n<=12319||n===12336)||Jl(n)||No(n)||Vh(n)||(e=>e>=12592&&e<=12687)(n)||(e=>e>=43360&&e<=43391)(n)||(e=>e>=55216&&e<=55295)(n)||(e=>e>=4352&&e<=4607)(n)||jh(n)||Kl(n)||$c(n)||(e=>e>=12688&&e<=12703)(n)||ia(n)||Nh(n)||cs(n)&&n!==12540||!(!y(n)||n===65288||n===65289||n===65293||n>=65306&&n<=65310||n===65339||n===65341||n===65343||n>=65371&&n<=65503||n===65507||n>=65512&&n<=65519)||!(!f(n)||n>=65112&&n<=65118||n>=65123&&n<=65126)||(e=>e>=5120&&e<=5759)(n)||(e=>e>=6320&&e<=6399)(n)||r(n)||(e=>e>=19904&&e<=19967)(n)||Ep(n)||gl(n))))}function D(n){return!(z(n)||function(e){return!!((i=>i>=128&&i<=255)(e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||(i=>i>=8192&&i<=8303)(e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||(i=>i>=8448&&i<=8527)(e)||(i=>i>=8528&&i<=8591)(e)||(i=>i>=8960&&i<=9215)(e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||(i=>i>=9216&&i<=9279)(e)&&e!==9251||(i=>i>=9280&&i<=9311)(e)||(i=>i>=9312&&i<=9471)(e)||(i=>i>=9632&&i<=9727)(e)||(i=>i>=9728&&i<=9983)(e)&&!(e>=9754&&e<=9759)||(i=>i>=11008&&i<=11263)(e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||Yl(e)||cs(e)||(i=>i>=57344&&i<=63743)(e)||s(e)||f(e)||y(e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(n))}function B(n){return n>=1424&&n<=2303||h(n)||g(n)}function j(n,e){return!(!e&&B(n)||n>=2304&&n<=3583||n>=3840&&n<=4255||(i=>i>=6016&&i<=6143)(n))}function W(n){for(const e of n)if(B(e.charCodeAt(0)))return!0;return!1}const X="deferred",Y="loading",G="loaded";let q=null,ee="unavailable",Q=null;const ae=function(n){n&&typeof n=="string"&&n.indexOf("NetworkError")>-1&&(ee="error"),q&&q(n)};function fe(){le.fire(new co("pluginStateChange",{pluginStatus:ee,pluginURL:Q}))}const le=new an,re=function(){return ee},Ce=function(){if(ee!==X||!Q)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");ee=Y,fe(),Q&&Pn({url:Q},n=>{n?ae(n):(ee=G,fe())})},we={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>ee===G||we.applyArabicShaping!=null,isLoading:()=>ee===Y,setState(n){ee=n.pluginStatus,Q=n.pluginURL},isParsed:()=>we.applyArabicShaping!=null&&we.processBidirectionalText!=null&&we.processStyledBidirectionalText!=null,getPluginURL:()=>Q};class ve{constructor(e,i){this.zoom=e,i?(this.now=i.now,this.fadeDuration=i.fadeDuration,this.transition=i.transition,this.pitch=i.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(e){return function(i,o){for(const l of i)if(!j(l.charCodeAt(0),o))return!1;return!0}(e,we.isLoaded())}}class nt{constructor(e,i){this.property=e,this.value=i,this.expression=function(o,l){if(Pr(o))return new Ou(o,l);if(Fs(o)){const d=Hd(o,l);if(d.result==="error")throw new Error(d.value.map(p=>`${p.key}: ${p.message}`).join(", "));return d.value}{let d=o;return typeof o=="string"&&l.type==="color"&&(d=kn.parse(o)),{kind:"constant",evaluate:()=>d}}}(i===void 0?e.specification.default:i,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,i,o){return this.property.possiblyEvaluate(this,e,i,o)}}class Ee{constructor(e){this.property=e,this.value=new nt(e,void 0)}transitioned(e,i){return new De(this.property,this.value,i,Kn({},e.transition,this.transition),e.now)}untransitioned(){return new De(this.property,this.value,null,{},0)}}class je{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return Ui(this._values[e].value.value)}setValue(e,i){this._values.hasOwnProperty(e)||(this._values[e]=new Ee(this._values[e].property)),this._values[e].value=new nt(this._values[e].property,i===null?void 0:Ui(i))}getTransition(e){return Ui(this._values[e].transition)}setTransition(e,i){this._values.hasOwnProperty(e)||(this._values[e]=new Ee(this._values[e].property)),this._values[e].transition=Ui(i)||void 0}serialize(){const e={};for(const i of Object.keys(this._values)){const o=this.getValue(i);o!==void 0&&(e[i]=o);const l=this.getTransition(i);l!==void 0&&(e[`${i}-transition`]=l)}return e}transitioned(e,i){const o=new Ze(this._properties);for(const l of Object.keys(this._values))o._values[l]=this._values[l].transitioned(e,i._values[l]);return o}untransitioned(){const e=new Ze(this._properties);for(const i of Object.keys(this._values))e._values[i]=this._values[i].untransitioned();return e}}class De{constructor(e,i,o,l,d){const p=l.delay||0,_=l.duration||0;d=d||0,this.property=e,this.value=i,this.begin=d+p,this.end=this.begin+_,e.specification.transition&&(l.delay||l.duration)&&(this.prior=o)}possiblyEvaluate(e,i,o){const l=e.now||0,d=this.value.possiblyEvaluate(e,i,o),p=this.prior;if(p){if(l>this.end)return this.prior=null,d;if(this.value.isDataDriven())return this.prior=null,d;if(l<this.begin)return p.possiblyEvaluate(e,i,o);{const _=(l-this.begin)/(this.end-this.begin);return this.property.interpolate(p.possiblyEvaluate(e,i,o),d,ua(_))}}return d}}class Ze{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,i,o){const l=new it(this._properties);for(const d of Object.keys(this._values))l._values[d]=this._values[d].possiblyEvaluate(e,i,o);return l}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class Le{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return Ui(this._values[e].value)}setValue(e,i){this._values[e]=new nt(this._values[e].property,i===null?void 0:Ui(i))}serialize(){const e={};for(const i of Object.keys(this._values)){const o=this.getValue(i);o!==void 0&&(e[i]=o)}return e}possiblyEvaluate(e,i,o){const l=new it(this._properties);for(const d of Object.keys(this._values))l._values[d]=this._values[d].possiblyEvaluate(e,i,o);return l}}class Ye{constructor(e,i,o){this.property=e,this.value=i,this.parameters=o}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,i,o,l){return this.property.evaluate(this.value,this.parameters,e,i,o,l)}}class it{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class be{constructor(e){this.specification=e}possiblyEvaluate(e,i){return e.expression.evaluate(i)}interpolate(e,i,o){const l=Ch[this.specification.type];return l?l(e,i,o):e}}class Re{constructor(e,i){this.specification=e,this.overrides=i}possiblyEvaluate(e,i,o,l){return new Ye(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(i,null,{},o,l)}:e.expression,i)}interpolate(e,i,o){if(e.value.kind!=="constant"||i.value.kind!=="constant")return e;if(e.value.value===void 0||i.value.value===void 0)return new Ye(this,{kind:"constant",value:void 0},e.parameters);const l=Ch[this.specification.type];return l?new Ye(this,{kind:"constant",value:l(e.value.value,i.value.value,o)},e.parameters):e}evaluate(e,i,o,l,d,p){return e.kind==="constant"?e.value:e.evaluate(i,o,l,d,p)}}class wt{constructor(e){this.specification=e}possiblyEvaluate(e,i,o,l){return!!e.expression.evaluate(i,null,{},o,l)}interpolate(){return!1}}class Pt{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const i=new ve(0,{});for(const o in e){const l=e[o];l.specification.overridable&&this.overridableProperties.push(o);const d=this.defaultPropertyValues[o]=new nt(l,void 0),p=this.defaultTransitionablePropertyValues[o]=new Ee(l);this.defaultTransitioningPropertyValues[o]=p.untransitioned(),this.defaultPossiblyEvaluatedValues[o]=d.possiblyEvaluate(i)}}}function St(n,e){return 256*(n=Ut(Math.floor(n),0,255))+Ut(Math.floor(e),0,255)}ft(Re,"DataDrivenProperty"),ft(be,"DataConstantProperty"),ft(wt,"ColorRampProperty");const Ht={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class fn{constructor(e,i){this._structArray=e,this._pos1=i*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Bt{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,i){return e._trim(),i&&(e.isTransferred=!0,i.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const i=Object.create(this.prototype);return i.arrayBuffer=e.arrayBuffer,i.length=e.length,i.capacity=e.arrayBuffer.byteLength/i.bytesPerElement,i._refreshViews(),i}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const i=this.uint8;this._refreshViews(),i&&this.uint8.set(i)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function yt(n,e=1){let i=0,o=0;return{members:n.map(l=>{const d=Ht[l.type].BYTES_PER_ELEMENT,p=i=ei(i,Math.max(e,d)),_=l.components||1;return o=Math.max(o,d),i+=d*_,{name:l.name,type:l.type,components:_,offset:p}}),size:ei(i,Math.max(o,e)),alignment:e}}function ei(n,e){return Math.ceil(n/e)*e}class Gn extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i){const o=this.length;return this.resize(o+1),this.emplace(o,e,i)}emplace(e,i,o){const l=2*e;return this.int16[l+0]=i,this.int16[l+1]=o,e}}Gn.prototype.bytesPerElement=4,ft(Gn,"StructArrayLayout2i4");class _i extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,o){const l=this.length;return this.resize(l+1),this.emplace(l,e,i,o)}emplace(e,i,o,l){const d=3*e;return this.int16[d+0]=i,this.int16[d+1]=o,this.int16[d+2]=l,e}}_i.prototype.bytesPerElement=6,ft(_i,"StructArrayLayout3i6");class hi extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,o,l){const d=this.length;return this.resize(d+1),this.emplace(d,e,i,o,l)}emplace(e,i,o,l,d){const p=4*e;return this.int16[p+0]=i,this.int16[p+1]=o,this.int16[p+2]=l,this.int16[p+3]=d,e}}hi.prototype.bytesPerElement=8,ft(hi,"StructArrayLayout4i8");class Va extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,o,l,d,p,_){const x=this.length;return this.resize(x+1),this.emplace(x,e,i,o,l,d,p,_)}emplace(e,i,o,l,d,p,_,x){const b=6*e,S=12*e,M=3*e;return this.int16[b+0]=i,this.int16[b+1]=o,this.uint8[S+4]=l,this.uint8[S+5]=d,this.uint8[S+6]=p,this.uint8[S+7]=_,this.float32[M+2]=x,e}}Va.prototype.bytesPerElement=12,ft(Va,"StructArrayLayout2i4ub1f12");class Qa extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,o,l){const d=this.length;return this.resize(d+1),this.emplace(d,e,i,o,l)}emplace(e,i,o,l,d){const p=4*e;return this.float32[p+0]=i,this.float32[p+1]=o,this.float32[p+2]=l,this.float32[p+3]=d,e}}Qa.prototype.bytesPerElement=16,ft(Qa,"StructArrayLayout4f16");class Ma extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,o,l,d){const p=this.length;return this.resize(p+1),this.emplace(p,e,i,o,l,d)}emplace(e,i,o,l,d,p){const _=6*e,x=3*e;return this.uint16[_+0]=i,this.uint16[_+1]=o,this.uint16[_+2]=l,this.uint16[_+3]=d,this.float32[x+2]=p,e}}Ma.prototype.bytesPerElement=12,ft(Ma,"StructArrayLayout4ui1f12");class hs extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,o,l){const d=this.length;return this.resize(d+1),this.emplace(d,e,i,o,l)}emplace(e,i,o,l,d){const p=4*e;return this.uint16[p+0]=i,this.uint16[p+1]=o,this.uint16[p+2]=l,this.uint16[p+3]=d,e}}hs.prototype.bytesPerElement=8,ft(hs,"StructArrayLayout4ui8");class Mi extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,o,l,d,p){const _=this.length;return this.resize(_+1),this.emplace(_,e,i,o,l,d,p)}emplace(e,i,o,l,d,p,_){const x=6*e;return this.int16[x+0]=i,this.int16[x+1]=o,this.int16[x+2]=l,this.int16[x+3]=d,this.int16[x+4]=p,this.int16[x+5]=_,e}}Mi.prototype.bytesPerElement=12,ft(Mi,"StructArrayLayout6i12");class yi extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,o,l,d,p,_,x,b,S,M,R){const I=this.length;return this.resize(I+1),this.emplace(I,e,i,o,l,d,p,_,x,b,S,M,R)}emplace(e,i,o,l,d,p,_,x,b,S,M,R,I){const L=12*e;return this.int16[L+0]=i,this.int16[L+1]=o,this.int16[L+2]=l,this.int16[L+3]=d,this.uint16[L+4]=p,this.uint16[L+5]=_,this.uint16[L+6]=x,this.uint16[L+7]=b,this.int16[L+8]=S,this.int16[L+9]=M,this.int16[L+10]=R,this.int16[L+11]=I,e}}yi.prototype.bytesPerElement=24,ft(yi,"StructArrayLayout4i4ui4i24");class Fn extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,o,l,d,p){const _=this.length;return this.resize(_+1),this.emplace(_,e,i,o,l,d,p)}emplace(e,i,o,l,d,p,_){const x=10*e,b=5*e;return this.int16[x+0]=i,this.int16[x+1]=o,this.int16[x+2]=l,this.float32[b+2]=d,this.float32[b+3]=p,this.float32[b+4]=_,e}}Fn.prototype.bytesPerElement=20,ft(Fn,"StructArrayLayout3i3f20");class hr extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint32[1*e+0]=i,e}}hr.prototype.bytesPerElement=4,ft(hr,"StructArrayLayout1ul4");class Ta extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,o,l,d,p,_,x,b,S,M,R,I){const L=this.length;return this.resize(L+1),this.emplace(L,e,i,o,l,d,p,_,x,b,S,M,R,I)}emplace(e,i,o,l,d,p,_,x,b,S,M,R,I,L){const N=20*e,$=10*e;return this.int16[N+0]=i,this.int16[N+1]=o,this.int16[N+2]=l,this.int16[N+3]=d,this.int16[N+4]=p,this.float32[$+3]=_,this.float32[$+4]=x,this.float32[$+5]=b,this.float32[$+6]=S,this.int16[N+14]=M,this.uint32[$+8]=R,this.uint16[N+18]=I,this.uint16[N+19]=L,e}}Ta.prototype.bytesPerElement=40,ft(Ta,"StructArrayLayout5i4f1i1ul2ui40");class di extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,o,l,d,p,_){const x=this.length;return this.resize(x+1),this.emplace(x,e,i,o,l,d,p,_)}emplace(e,i,o,l,d,p,_,x){const b=8*e;return this.int16[b+0]=i,this.int16[b+1]=o,this.int16[b+2]=l,this.int16[b+4]=d,this.int16[b+5]=p,this.int16[b+6]=_,this.int16[b+7]=x,e}}di.prototype.bytesPerElement=16,ft(di,"StructArrayLayout3i2i2i16");class kt extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,o,l,d){const p=this.length;return this.resize(p+1),this.emplace(p,e,i,o,l,d)}emplace(e,i,o,l,d,p){const _=4*e,x=8*e;return this.float32[_+0]=i,this.float32[_+1]=o,this.float32[_+2]=l,this.int16[x+6]=d,this.int16[x+7]=p,e}}kt.prototype.bytesPerElement=16,ft(kt,"StructArrayLayout2f1f2i16");class Mn extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,o,l){const d=this.length;return this.resize(d+1),this.emplace(d,e,i,o,l)}emplace(e,i,o,l,d){const p=12*e,_=3*e;return this.uint8[p+0]=i,this.uint8[p+1]=o,this.float32[_+1]=l,this.float32[_+2]=d,e}}Mn.prototype.bytesPerElement=12,ft(Mn,"StructArrayLayout2ub2f12");class Ln extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,o){const l=this.length;return this.resize(l+1),this.emplace(l,e,i,o)}emplace(e,i,o,l){const d=3*e;return this.float32[d+0]=i,this.float32[d+1]=o,this.float32[d+2]=l,e}}Ln.prototype.bytesPerElement=12,ft(Ln,"StructArrayLayout3f12");class Wn extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,o){const l=this.length;return this.resize(l+1),this.emplace(l,e,i,o)}emplace(e,i,o,l){const d=3*e;return this.uint16[d+0]=i,this.uint16[d+1]=o,this.uint16[d+2]=l,e}}Wn.prototype.bytesPerElement=6,ft(Wn,"StructArrayLayout3ui6");class vr extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,i,o,l,d,p,_,x,b,S,M,R,I,L,N,$,te,ce,ne,oe,me){const he=this.length;return this.resize(he+1),this.emplace(he,e,i,o,l,d,p,_,x,b,S,M,R,I,L,N,$,te,ce,ne,oe,me)}emplace(e,i,o,l,d,p,_,x,b,S,M,R,I,L,N,$,te,ce,ne,oe,me,he){const Ae=30*e,Se=15*e,Fe=60*e;return this.int16[Ae+0]=i,this.int16[Ae+1]=o,this.int16[Ae+2]=l,this.float32[Se+2]=d,this.float32[Se+3]=p,this.uint16[Ae+8]=_,this.uint16[Ae+9]=x,this.uint32[Se+5]=b,this.uint32[Se+6]=S,this.uint32[Se+7]=M,this.uint16[Ae+16]=R,this.uint16[Ae+17]=I,this.uint16[Ae+18]=L,this.float32[Se+10]=N,this.float32[Se+11]=$,this.uint8[Fe+48]=te,this.uint8[Fe+49]=ce,this.uint8[Fe+50]=ne,this.uint32[Se+13]=oe,this.int16[Ae+28]=me,this.uint8[Fe+58]=he,e}}vr.prototype.bytesPerElement=60,ft(vr,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Vo extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,i,o,l,d,p,_,x,b,S,M,R,I,L,N,$,te,ce,ne,oe,me,he,Ae,Se,Fe,Xe,Me,Ve,$e,Ke){const tt=this.length;return this.resize(tt+1),this.emplace(tt,e,i,o,l,d,p,_,x,b,S,M,R,I,L,N,$,te,ce,ne,oe,me,he,Ae,Se,Fe,Xe,Me,Ve,$e,Ke)}emplace(e,i,o,l,d,p,_,x,b,S,M,R,I,L,N,$,te,ce,ne,oe,me,he,Ae,Se,Fe,Xe,Me,Ve,$e,Ke,tt){const ke=38*e,st=19*e;return this.int16[ke+0]=i,this.int16[ke+1]=o,this.int16[ke+2]=l,this.float32[st+2]=d,this.float32[st+3]=p,this.int16[ke+8]=_,this.int16[ke+9]=x,this.int16[ke+10]=b,this.int16[ke+11]=S,this.int16[ke+12]=M,this.int16[ke+13]=R,this.uint16[ke+14]=I,this.uint16[ke+15]=L,this.uint16[ke+16]=N,this.uint16[ke+17]=$,this.uint16[ke+18]=te,this.uint16[ke+19]=ce,this.uint16[ke+20]=ne,this.uint16[ke+21]=oe,this.uint16[ke+22]=me,this.uint16[ke+23]=he,this.uint16[ke+24]=Ae,this.uint16[ke+25]=Se,this.uint16[ke+26]=Fe,this.uint16[ke+27]=Xe,this.uint16[ke+28]=Me,this.uint32[st+15]=Ve,this.float32[st+16]=$e,this.float32[st+17]=Ke,this.float32[st+18]=tt,e}}Vo.prototype.bytesPerElement=76,ft(Vo,"StructArrayLayout3i2f6i15ui1ul3f76");class ds extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.float32[1*e+0]=i,e}}ds.prototype.bytesPerElement=4,ft(ds,"StructArrayLayout1f4");class Hc extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,o,l,d){const p=this.length;return this.resize(p+1),this.emplace(p,e,i,o,l,d)}emplace(e,i,o,l,d,p){const _=5*e;return this.float32[_+0]=i,this.float32[_+1]=o,this.float32[_+2]=l,this.float32[_+3]=d,this.float32[_+4]=p,e}}Hc.prototype.bytesPerElement=20,ft(Hc,"StructArrayLayout5f20");class Gu extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,o,l){const d=this.length;return this.resize(d+1),this.emplace(d,e,i,o,l)}emplace(e,i,o,l,d){const p=6*e;return this.uint32[3*e+0]=i,this.uint16[p+2]=o,this.uint16[p+3]=l,this.uint16[p+4]=d,e}}Gu.prototype.bytesPerElement=12,ft(Gu,"StructArrayLayout1ul3ui12");class wo extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i){const o=this.length;return this.resize(o+1),this.emplace(o,e,i)}emplace(e,i,o){const l=2*e;return this.uint16[l+0]=i,this.uint16[l+1]=o,e}}wo.prototype.bytesPerElement=4,ft(wo,"StructArrayLayout2ui4");class rt extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint16[1*e+0]=i,e}}rt.prototype.bytesPerElement=2,ft(rt,"StructArrayLayout1ui2");class Br extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i){const o=this.length;return this.resize(o+1),this.emplace(o,e,i)}emplace(e,i,o){const l=2*e;return this.float32[l+0]=i,this.float32[l+1]=o,e}}Br.prototype.bytesPerElement=8,ft(Br,"StructArrayLayout2f8");class ln extends fn{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}ln.prototype.size=40;class $u extends Ta{get(e){return new ln(this,e)}}ft($u,"CollisionBoxArray");class _l extends fn{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}_l.prototype.size=60;class qu extends vr{get(e){return new _l(this,e)}}ft(qu,"PlacedSymbolArray");class Ns extends fn{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(e){this._structArray.uint32[this._pos4+15]=e}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Ns.prototype.size=76;class Gh extends Vo{get(e){return new Ns(this,e)}}ft(Gh,"SymbolInstanceArray");class Zc extends ds{getoffsetX(e){return this.float32[1*e+0]}}ft(Zc,"GlyphOffsetArray");class $h extends Gn{getx(e){return this.int16[2*e+0]}gety(e){return this.int16[2*e+1]}}ft($h,"SymbolLineVertexArray");class Sp extends fn{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Sp.prototype.size=12;class Cp extends Gu{get(e){return new Sp(this,e)}}ft(Cp,"FeatureIndexArray");class Mp extends wo{geta_centroid_pos0(e){return this.uint16[2*e+0]}geta_centroid_pos1(e){return this.uint16[2*e+1]}}ft(Mp,"FillExtrusionCentroidArray");const Zm=yt([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Xm=yt([{name:"a_dash",components:4,type:"Uint16"}]);var Hu={exports:{}},Ap={exports:{}};Ap.exports=function(n,e){var i,o,l,d,p,_,x,b;for(o=n.length-(i=3&n.length),l=e,p=3432918353,_=461845907,b=0;b<o;)x=255&n.charCodeAt(b)|(255&n.charCodeAt(++b))<<8|(255&n.charCodeAt(++b))<<16|(255&n.charCodeAt(++b))<<24,++b,l=27492+(65535&(d=5*(65535&(l=(l^=x=(65535&(x=(x=(65535&x)*p+(((x>>>16)*p&65535)<<16)&4294967295)<<15|x>>>17))*_+(((x>>>16)*_&65535)<<16)&4294967295)<<13|l>>>19))+((5*(l>>>16)&65535)<<16)&4294967295))+((58964+(d>>>16)&65535)<<16);switch(x=0,i){case 3:x^=(255&n.charCodeAt(b+2))<<16;case 2:x^=(255&n.charCodeAt(b+1))<<8;case 1:l^=x=(65535&(x=(x=(65535&(x^=255&n.charCodeAt(b)))*p+(((x>>>16)*p&65535)<<16)&4294967295)<<15|x>>>17))*_+(((x>>>16)*_&65535)<<16)&4294967295}return l^=n.length,l=2246822507*(65535&(l^=l>>>16))+((2246822507*(l>>>16)&65535)<<16)&4294967295,l=3266489909*(65535&(l^=l>>>13))+((3266489909*(l>>>16)&65535)<<16)&4294967295,(l^=l>>>16)>>>0};var Rp={exports:{}};Rp.exports=function(n,e){for(var i,o=n.length,l=e^o,d=0;o>=4;)i=1540483477*(65535&(i=255&n.charCodeAt(d)|(255&n.charCodeAt(++d))<<8|(255&n.charCodeAt(++d))<<16|(255&n.charCodeAt(++d))<<24))+((1540483477*(i>>>16)&65535)<<16),l=1540483477*(65535&l)+((1540483477*(l>>>16)&65535)<<16)^(i=1540483477*(65535&(i^=i>>>24))+((1540483477*(i>>>16)&65535)<<16)),o-=4,++d;switch(o){case 3:l^=(255&n.charCodeAt(d+2))<<16;case 2:l^=(255&n.charCodeAt(d+1))<<8;case 1:l=1540483477*(65535&(l^=255&n.charCodeAt(d)))+((1540483477*(l>>>16)&65535)<<16)}return l=1540483477*(65535&(l^=l>>>13))+((1540483477*(l>>>16)&65535)<<16),(l^=l>>>15)>>>0};var Dp=Ap.exports,Wm=Rp.exports;Hu.exports=Dp,Hu.exports.murmur3=Dp,Hu.exports.murmur2=Wm;class qh{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,i,o,l){this.ids.push(zp(e)),this.positions.push(i,o,l)}getPositions(e){const i=zp(e);let o=0,l=this.ids.length-1;for(;o<l;){const p=o+l>>1;this.ids[p]>=i?l=p:o=p+1}const d=[];for(;this.ids[o]===i;)d.push({index:this.positions[3*o],start:this.positions[3*o+1],end:this.positions[3*o+2]}),o++;return d}static serialize(e,i){const o=new Float64Array(e.ids),l=new Uint32Array(e.positions);return Yd(o,l,0,o.length-1),i&&i.push(o.buffer,l.buffer),{ids:o,positions:l}}static deserialize(e){const i=new qh;return i.ids=e.ids,i.positions=e.positions,i.indexed=!0,i}}function zp(n){const e=+n;return!isNaN(e)&&Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?e:Hu.exports(String(n))}function Yd(n,e,i,o){for(;i<o;){const l=n[i+o>>1];let d=i-1,p=o+1;for(;;){do d++;while(n[d]<l);do p--;while(n[p]>l);if(d>=p)break;Hh(n,d,p),Hh(e,3*d,3*p),Hh(e,3*d+1,3*p+1),Hh(e,3*d+2,3*p+2)}p-i<o-p?(Yd(n,e,i,p),i=p+1):(Yd(n,e,p+1,o),o=p)}}function Hh(n,e,i){const o=n[e];n[e]=n[i],n[i]=o}ft(qh,"FeaturePositionMap");class Vs{constructor(e){this.gl=e.gl,this.initialized=!1}fetchUniformLocation(e,i){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(e,i),this.initialized=!0),!!this.location}}class Xc extends Vs{constructor(e){super(e),this.current=0}set(e,i,o){this.fetchUniformLocation(e,i)&&this.current!==o&&(this.current=o,this.gl.uniform1f(this.location,o))}}class Wc extends Vs{constructor(e){super(e),this.current=[0,0,0,0]}set(e,i,o){this.fetchUniformLocation(e,i)&&(o[0]===this.current[0]&&o[1]===this.current[1]&&o[2]===this.current[2]&&o[3]===this.current[3]||(this.current=o,this.gl.uniform4f(this.location,o[0],o[1],o[2],o[3])))}}class Ip extends Vs{constructor(e){super(e),this.current=kn.transparent}set(e,i,o){this.fetchUniformLocation(e,i)&&(o.r===this.current.r&&o.g===this.current.g&&o.b===this.current.b&&o.a===this.current.a||(this.current=o,this.gl.uniform4f(this.location,o.r,o.g,o.b,o.a)))}}const Ym=new Float32Array(16),Km=new Float32Array(9),Jm=new Float32Array(4);function kp(n){return[St(255*n.r,255*n.g),St(255*n.b,255*n.a)]}class Ql{constructor(e,i,o){this.value=e,this.uniformNames=i.map(l=>`u_${l}`),this.type=o}setUniform(e,i,o,l,d){i.set(e,d,l.constantOr(this.value))}getBinding(e,i){return this.type==="color"?new Ip(e):new Xc(e)}}class Yc{constructor(e,i){this.uniformNames=i.map(o=>`u_${o}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(e){this.pixelRatio=e.pixelRatio||1,this.pattern=e.tl.concat(e.br)}setUniform(e,i,o,l,d){const p=d==="u_pattern"||d==="u_dash"?this.pattern:d==="u_pixel_ratio"?this.pixelRatio:null;p&&i.set(e,d,p)}getBinding(e,i){return i==="u_pattern"||i==="u_dash"?new Wc(e):new Xc(e)}}class jo{constructor(e,i,o,l){this.expression=e,this.type=o,this.maxValue=0,this.paintVertexAttributes=i.map(d=>({name:`a_${d}`,type:"Float32",components:o==="color"?2:1,offset:0})),this.paintVertexArray=new l}populatePaintArray(e,i,o,l,d,p){const _=this.paintVertexArray.length,x=this.expression.evaluate(new ve(0),i,{},d,l,p);this.paintVertexArray.resize(e),this._setPaintValue(_,e,x)}updatePaintArray(e,i,o,l,d){const p=this.expression.evaluate({zoom:0},o,l,void 0,d);this._setPaintValue(e,i,p)}_setPaintValue(e,i,o){if(this.type==="color"){const l=kp(o);for(let d=e;d<i;d++)this.paintVertexArray.emplace(d,l[0],l[1])}else{for(let l=e;l<i;l++)this.paintVertexArray.emplace(l,o);this.maxValue=Math.max(this.maxValue,Math.abs(o))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Aa{constructor(e,i,o,l,d,p){this.expression=e,this.uniformNames=i.map(_=>`u_${_}_t`),this.type=o,this.useIntegerZoom=l,this.zoom=d,this.maxValue=0,this.paintVertexAttributes=i.map(_=>({name:`a_${_}`,type:"Float32",components:o==="color"?4:2,offset:0})),this.paintVertexArray=new p}populatePaintArray(e,i,o,l,d,p){const _=this.expression.evaluate(new ve(this.zoom),i,{},d,l,p),x=this.expression.evaluate(new ve(this.zoom+1),i,{},d,l,p),b=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(b,e,_,x)}updatePaintArray(e,i,o,l,d){const p=this.expression.evaluate({zoom:this.zoom},o,l,void 0,d),_=this.expression.evaluate({zoom:this.zoom+1},o,l,void 0,d);this._setPaintValue(e,i,p,_)}_setPaintValue(e,i,o,l){if(this.type==="color"){const d=kp(o),p=kp(l);for(let _=e;_<i;_++)this.paintVertexArray.emplace(_,d[0],d[1],p[0],p[1])}else{for(let d=e;d<i;d++)this.paintVertexArray.emplace(d,o,l);this.maxValue=Math.max(this.maxValue,Math.abs(o),Math.abs(l))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,i,o,l,d){const p=this.useIntegerZoom?Math.floor(o.zoom):o.zoom,_=Ut(this.expression.interpolationFactor(p,this.zoom,this.zoom+1),0,1);i.set(e,d,_)}getBinding(e,i){return new Xc(e)}}class Hr{constructor(e,i,o,l,d){this.expression=e,this.layerId=d,this.paintVertexAttributes=(o==="array"?Xm:Zm).members;for(let p=0;p<i.length;++p);this.paintVertexArray=new l}populatePaintArray(e,i,o){const l=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValues(l,e,i.patterns&&i.patterns[this.layerId],o)}updatePaintArray(e,i,o,l,d,p){this._setPaintValues(e,i,o.patterns&&o.patterns[this.layerId],p)}_setPaintValues(e,i,o,l){if(!l||!o)return;const d=l[o];if(!d)return;const{tl:p,br:_,pixelRatio:x}=d;for(let b=e;b<i;b++)this.paintVertexArray.emplace(b,p[0],p[1],_[0],_[1],x)}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Zu{constructor(e,i,o=()=>!0){this.binders={},this._buffers=[];const l=[];for(const d in e.paint._values){if(!o(d))continue;const p=e.paint.get(d);if(!(p instanceof Ye&&jl(p.property.specification)))continue;const _=Op(d,e.type),x=p.value,b=p.property.specification.type,S=p.property.useIntegerZoom,M=d==="line-dasharray"||d.endsWith("pattern"),R=d==="line-dasharray"&&e.layout.get("line-cap").value.kind!=="constant";if(x.kind!=="constant"||R)if(x.kind==="source"||R||M){const I=O_(d,b,"source");this.binders[d]=M?new Hr(x,_,b,I,e.id):new jo(x,_,b,I),l.push(`/a_${d}`)}else{const I=O_(d,b,"composite");this.binders[d]=new Aa(x,_,b,S,i,I),l.push(`/z_${d}`)}else this.binders[d]=M?new Yc(x.value,_):new Ql(x.value,_,b),l.push(`/u_${d}`)}this.cacheKey=l.sort().join("")}getMaxValue(e){const i=this.binders[e];return i instanceof jo||i instanceof Aa?i.maxValue:0}populatePaintArrays(e,i,o,l,d,p){for(const _ in this.binders){const x=this.binders[_];(x instanceof jo||x instanceof Aa||x instanceof Hr)&&x.populatePaintArray(e,i,o,l,d,p)}}setConstantPatternPositions(e){for(const i in this.binders){const o=this.binders[i];o instanceof Yc&&o.setConstantPatternPositions(e)}}updatePaintArrays(e,i,o,l,d,p){let _=!1;for(const x in e){const b=i.getPositions(x);for(const S of b){const M=o.feature(S.index);for(const R in this.binders){const I=this.binders[R];if((I instanceof jo||I instanceof Aa||I instanceof Hr)&&I.expression.isStateDependent===!0){const L=l.paint.get(R);I.expression=L.value,I.updatePaintArray(S.start,S.end,M,e[x],d,p),_=!0}}}}return _}defines(){const e=[];for(const i in this.binders){const o=this.binders[i];(o instanceof Ql||o instanceof Yc)&&e.push(...o.uniformNames.map(l=>`#define HAS_UNIFORM_${l}`))}return e}getBinderAttributes(){const e=[];for(const i in this.binders){const o=this.binders[i];if(o instanceof jo||o instanceof Aa||o instanceof Hr)for(let l=0;l<o.paintVertexAttributes.length;l++)e.push(o.paintVertexAttributes[l].name)}return e}getBinderUniforms(){const e=[];for(const i in this.binders){const o=this.binders[i];if(o instanceof Ql||o instanceof Yc||o instanceof Aa)for(const l of o.uniformNames)e.push(l)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e){const i=[];for(const o in this.binders){const l=this.binders[o];if(l instanceof Ql||l instanceof Yc||l instanceof Aa)for(const d of l.uniformNames)i.push({name:d,property:o,binding:l.getBinding(e,d)})}return i}setUniforms(e,i,o,l,d){for(const{name:p,property:_,binding:x}of o)this.binders[_].setUniform(e,x,d,l.get(_),p)}updatePaintBuffers(){this._buffers=[];for(const e in this.binders){const i=this.binders[e];(i instanceof jo||i instanceof Aa||i instanceof Hr)&&i.paintVertexBuffer&&this._buffers.push(i.paintVertexBuffer)}}upload(e){for(const i in this.binders){const o=this.binders[i];(o instanceof jo||o instanceof Aa||o instanceof Hr)&&o.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const i=this.binders[e];(i instanceof jo||i instanceof Aa||i instanceof Hr)&&i.destroy()}}}class vi{constructor(e,i,o=()=>!0){this.programConfigurations={};for(const l of e)this.programConfigurations[l.id]=new Zu(l,i,o);this.needsUpload=!1,this._featureMap=new qh,this._bufferOffset=0}populatePaintArrays(e,i,o,l,d,p,_){for(const x in this.programConfigurations)this.programConfigurations[x].populatePaintArrays(e,i,l,d,p,_);i.id!==void 0&&this._featureMap.add(i.id,o,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,i,o,l,d){for(const p of o)this.needsUpload=this.programConfigurations[p.id].updatePaintArrays(e,this._featureMap,i,p,l,d)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const i in this.programConfigurations)this.programConfigurations[i].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const Lp={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function Op(n,e){return Lp[n]||[n.replace(`${e}-`,"").replace(/-/g,"_")]}const Kd={"line-pattern":{source:Ma,composite:Ma},"fill-pattern":{source:Ma,composite:Ma},"fill-extrusion-pattern":{source:Ma,composite:Ma},"line-dasharray":{source:hs,composite:hs}},Pp={color:{source:Br,composite:Qa},number:{source:ds,composite:Br}};function O_(n,e,i){const o=Kd[n];return o&&o[i]||Pp[e][i]}ft(Ql,"ConstantBinder"),ft(Yc,"PatternConstantBinder"),ft(jo,"SourceExpressionBinder"),ft(Hr,"PatternCompositeBinder"),ft(Aa,"CompositeExpressionBinder"),ft(Zu,"ProgramConfiguration",{omit:["_buffers"]}),ft(vi,"ProgramConfigurationSet");const Bp="-transition";class js extends an{constructor(e,i){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&e.type!=="sky"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),i.layout&&(this._unevaluatedLayout=new Le(i.layout)),i.paint)){this._transitionablePaint=new je(i.paint);for(const o in e.paint)this.setPaintProperty(o,e.paint[o],{validate:!1});for(const o in e.layout)this.setLayoutProperty(o,e.layout[o],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new it(i.paint)}}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,i,o={}){i!=null&&this._validate(jn,`layers.${this.id}.layout.${e}`,e,i,o)||(e!=="visibility"?this._unevaluatedLayout.setValue(e,i):this.visibility=i)}getPaintProperty(e){return er(e,Bp)?this._transitionablePaint.getTransition(e.slice(0,-Bp.length)):this._transitionablePaint.getValue(e)}setPaintProperty(e,i,o={}){if(i!=null&&this._validate(Rr,`layers.${this.id}.paint.${e}`,e,i,o))return!1;if(er(e,Bp))return this._transitionablePaint.setTransition(e.slice(0,-Bp.length),i||void 0),!1;{const l=this._transitionablePaint._values[e],d=l.value.isDataDriven(),p=l.value;this._transitionablePaint.setValue(e,i),this._handleSpecialPaintPropertyUpdate(e);const _=this._transitionablePaint._values[e].value,x=_.isDataDriven(),b=er(e,"pattern")||e==="line-dasharray";return x||d||b||this._handleOverridablePaintPropertyUpdate(e,p,_)}}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getProgramConfiguration(e){return null}_handleOverridablePaintPropertyUpdate(e,i,o){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,i){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,i)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,i)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),mr(e,(i,o)=>!(i===void 0||o==="layout"&&!Object.keys(i).length||o==="paint"&&!Object.keys(i).length))}_validate(e,i,o,l,d={}){return(!d||d.validate!==!1)&&Uu(this,e.call(fl,{key:i,layerType:this.type,objectKey:o,value:l,styleSpec:Ne,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const i=this.paint.get(e);if(i instanceof Ye&&jl(i.property.specification)&&(i.value.kind==="source"||i.value.kind==="composite")&&i.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=cl(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const Yv=yt([{name:"a_pos",components:2,type:"Int16"}],4),Qm=yt([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Dr{constructor(e=[]){this.segments=e}prepareSegment(e,i,o,l){let d=this.segments[this.segments.length-1];return e>Dr.MAX_VERTEX_ARRAY_LENGTH&&Vn(`Max vertices per segment is ${Dr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!d||d.vertexLength+e>Dr.MAX_VERTEX_ARRAY_LENGTH||d.sortKey!==l)&&(d={vertexOffset:i.length,primitiveOffset:o.length,vertexLength:0,primitiveLength:0},l!==void 0&&(d.sortKey=l),this.segments.push(d)),d}get(){return this.segments}destroy(){for(const e of this.segments)for(const i in e.vaos)e.vaos[i].destroy()}static simpleSegment(e,i,o,l){return new Dr([{vertexOffset:e,primitiveOffset:i,vertexLength:o,primitiveLength:l,vaos:{},sortKey:0}])}}Dr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,ft(Dr,"SegmentVector");var qt=8192;class eu{constructor(e,i){e&&(i?this.setSouthWest(e).setNorthEast(i):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof Un?new Un(e.lng,e.lat):Un.convert(e),this}setSouthWest(e){return this._sw=e instanceof Un?new Un(e.lng,e.lat):Un.convert(e),this}extend(e){const i=this._sw,o=this._ne;let l,d;if(e instanceof Un)l=e,d=e;else{if(!(e instanceof eu))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(eu.convert(e)):this.extend(Un.convert(e)):typeof e=="object"&&e!==null&&e.hasOwnProperty("lat")&&e.hasOwnProperty("lon")?this.extend(Un.convert(e)):this;if(l=e._sw,d=e._ne,!l||!d)return this}return i||o?(i.lng=Math.min(l.lng,i.lng),i.lat=Math.min(l.lat,i.lat),o.lng=Math.max(d.lng,o.lng),o.lat=Math.max(d.lat,o.lat)):(this._sw=new Un(l.lng,l.lat),this._ne=new Un(d.lng,d.lat)),this}getCenter(){return new Un((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Un(this.getWest(),this.getNorth())}getSouthEast(){return new Un(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:i,lat:o}=Un.convert(e);let l=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(l=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=o&&o<=this._ne.lat&&l}static convert(e){return!e||e instanceof eu?e:new eu(e)}}const Fp=63710088e-1;class Un{constructor(e,i){if(isNaN(e)||isNaN(i))throw new Error(`Invalid LngLat object: (${e}, ${i})`);if(this.lng=+e,this.lat=+i,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Un(rn(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const i=Math.PI/180,o=this.lat*i,l=e.lat*i,d=Math.sin(o)*Math.sin(l)+Math.cos(o)*Math.cos(l)*Math.cos((e.lng-this.lng)*i);return Fp*Math.acos(Math.min(d,1))}toBounds(e=0){const i=360*e/40075017,o=i/Math.cos(Math.PI/180*this.lat);return new eu(new Un(this.lng-o,this.lat-i),new Un(this.lng+o,this.lat+i))}static convert(e){if(e instanceof Un)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new Un(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new Un(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Jd=2*Math.PI*Fp;function eg(n){return Jd*Math.cos(n*Math.PI/180)}function Gs(n){return(180+n)/360}function $s(n){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n*Math.PI/360)))/360}function fs(n,e){return n/eg(e)}function ra(n){return 360*n-180}function zr(n){return 360/Math.PI*Math.atan(Math.exp((180-360*n)*Math.PI/180))-90}function Xu(n,e){return n*eg(zr(e))}const ps=85.051129;function To(n){return 1/Math.cos(n*Math.PI/180)}class qs{constructor(e,i,o=0){this.x=+e,this.y=+i,this.z=+o}static fromLngLat(e,i=0){const o=Un.convert(e);return new qs(Gs(o.lng),$s(o.lat),fs(i,o.lat))}toLngLat(){return new Un(ra(this.x),zr(this.y))}toAltitude(){return Xu(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Jd*To(zr(this.y))}}function Tn(n,e,i,o,l,d,p,_,x){const b=(e+o)/2,S=(i+l)/2,M=new Ge(b,S);_(M),function(R,I,L,N,$,te){const ce=L-$,ne=N-te;return Math.abs((N-I)*ce-(L-R)*ne)/Math.hypot(ce,ne)}(M.x,M.y,d.x,d.y,p.x,p.y)>=x?(Tn(n,e,i,b,S,d,M,_,x),Tn(n,b,S,o,l,M,p,_,x)):n.push(p)}function Qd(n,e,i){let o=n[0],l=o.x,d=o.y;e(o);const p=[o];for(let _=1;_<n.length;_++){const x=n[_],{x:b,y:S}=x;e(x),Tn(p,l,d,b,S,o,x,e,i),l=b,d=S,o=x}return p}function Up(n,e,i,o){if(o(e,i)){const l=e.add(i)._mult(.5);Up(n,e,l,o),Up(n,l,i,o)}else n.push(i)}function w1(n,e){let i=n[0];const o=[i];for(let l=1;l<n.length;l++){const d=n[l];Up(o,i,d,e),i=d}return o}const tg=Math.pow(2,14)-1,Np=-tg-1;function ef(n,e){const i=Math.round(n.x*e),o=Math.round(n.y*e);return n.x=Ut(i,Np,tg),n.y=Ut(o,Np,tg),(i<n.x||i>n.x+1||o<n.y||o>n.y+1)&&Vn("Geometry exceeds allowed extent, reduce your vector tile buffer size"),n}function tu(n,e,i){const o=n.loadGeometry(),l=n.extent,d=qt/l;if(e&&i&&i.projection.isReprojectedInTileSpace){const p=1<<e.z,{scale:_,x,y:b,projection:S}=i,M=R=>{const I=ra((e.x+R.x/l)/p),L=zr((e.y+R.y/l)/p),N=S.project(I,L);R.x=(N.x*_-x)*l,R.y=(N.y*_-b)*l};for(let R=0;R<o.length;R++)if(n.type!==1)o[R]=Qd(o[R],M,1);else{const I=[];for(const L of o[R])L.x<0||L.x>=l||L.y<0||L.y>=l||(M(L),I.push(L));o[R]=I}}for(const p of o)for(const _ of p)ef(_,d);return o}function Wu(n,e){return{type:n.type,id:n.id,properties:n.properties,geometry:e?tu(n):[]}}function Vp(n,e,i,o,l){n.emplaceBack(2*e+(o+1)/2,2*i+(l+1)/2)}function Zh(n,e,i){n.emplaceBack(e.x,e.y,e.z,i[0]*16384,i[1]*16384,i[2]*16384)}class ng{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new Gn,this.indexArray=new Wn,this.segments=new Dr,this.programConfigurations=new vi(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(e,i,o,l){const d=this.layers[0],p=[];let _=null;d.type==="circle"&&(_=d.layout.get("circle-sort-key"));for(const{feature:b,id:S,index:M,sourceLayerIndex:R}of e){const I=this.layers[0]._featureFilter.needGeometry,L=Wu(b,I);if(!this.layers[0]._featureFilter.filter(new ve(this.zoom),L,o))continue;const N=_?_.evaluate(L,{},o):void 0,$={id:S,properties:b.properties,type:b.type,sourceLayerIndex:R,index:M,geometry:I?L.geometry:tu(b,o,l),patterns:{},sortKey:N};p.push($)}_&&p.sort((b,S)=>b.sortKey-S.sortKey);let x=null;l.projection.name==="globe"&&(this.globeExtVertexArray=new Mi,x=l.projection);for(const b of p){const{geometry:S,index:M,sourceLayerIndex:R}=b,I=e[M].feature;this.addFeature(b,S,M,i.availableImages,o,x),i.featureIndex.insert(I,S,M,R,this.index)}}update(e,i,o,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,o,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Yv.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,Qm.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(e,i,o,l,d,p){for(const _ of i)for(const x of _){const b=x.x,S=x.y;if(b<0||b>=qt||S<0||S>=qt)continue;if(p){const I=p.projectTilePoint(b,S,d),L=p.upVector(d,b,S),N=this.globeExtVertexArray;Zh(N,I,L),Zh(N,I,L),Zh(N,I,L),Zh(N,I,L)}const M=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),R=M.vertexLength;Vp(this.layoutVertexArray,b,S,-1,-1),Vp(this.layoutVertexArray,b,S,1,-1),Vp(this.layoutVertexArray,b,S,1,1),Vp(this.layoutVertexArray,b,S,-1,1),this.indexArray.emplaceBack(R,R+1,R+2),this.indexArray.emplaceBack(R,R+2,R+3),M.vertexLength+=4,M.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,o,{},l,d)}}function ig(n,e){for(let i=0;i<n.length;i++)if(dr(e,n[i]))return!0;for(let i=0;i<e.length;i++)if(dr(n,e[i]))return!0;return!!Hs(n,e)}function P_(n,e,i){return!!dr(n,e)||!!Xh(e,n,i)}function rg(n,e){if(n.length===1)return ms(e,n[0]);for(let i=0;i<e.length;i++){const o=e[i];for(let l=0;l<o.length;l++)if(dr(n,o[l]))return!0}for(let i=0;i<n.length;i++)if(ms(e,n[i]))return!0;for(let i=0;i<e.length;i++)if(Hs(n,e[i]))return!0;return!1}function Go(n,e,i){if(n.length>1){if(Hs(n,e))return!0;for(let o=0;o<e.length;o++)if(Xh(e[o],n,i))return!0}for(let o=0;o<n.length;o++)if(Xh(n[o],e,i))return!0;return!1}function Hs(n,e){if(n.length===0||e.length===0)return!1;for(let i=0;i<n.length-1;i++){const o=n[i],l=n[i+1];for(let d=0;d<e.length-1;d++)if(nu(o,l,e[d],e[d+1]))return!0}return!1}function nu(n,e,i,o){return mi(n,i,o)!==mi(e,i,o)&&mi(n,e,i)!==mi(n,e,o)}function Xh(n,e,i){const o=i*i;if(e.length===1)return n.distSqr(e[0])<o;for(let l=1;l<e.length;l++)if(Wh(n,e[l-1],e[l])<o)return!0;return!1}function Wh(n,e,i){const o=e.distSqr(i);if(o===0)return n.distSqr(e);const l=((n.x-e.x)*(i.x-e.x)+(n.y-e.y)*(i.y-e.y))/o;return n.distSqr(l<0?e:l>1?i:i.sub(e)._mult(l)._add(e))}function ms(n,e){let i,o,l,d=!1;for(let p=0;p<n.length;p++){i=n[p];for(let _=0,x=i.length-1;_<i.length;x=_++)o=i[_],l=i[x],o.y>e.y!=l.y>e.y&&e.x<(l.x-o.x)*(e.y-o.y)/(l.y-o.y)+o.x&&(d=!d)}return d}function dr(n,e){let i=!1;for(let o=0,l=n.length-1;o<n.length;l=o++){const d=n[o],p=n[l];d.y>e.y!=p.y>e.y&&e.x<(p.x-d.x)*(e.y-d.y)/(p.y-d.y)+d.x&&(i=!i)}return i}function B_(n,e,i,o,l){for(const p of n)if(e<=p.x&&i<=p.y&&o>=p.x&&l>=p.y)return!0;const d=[new Ge(e,i),new Ge(e,l),new Ge(o,l),new Ge(o,i)];if(n.length>2){for(const p of d)if(dr(n,p))return!0}for(let p=0;p<n.length-1;p++)if(Kv(n[p],n[p+1],d))return!0;return!1}function Kv(n,e,i){const o=i[0],l=i[2];if(n.x<o.x&&e.x<o.x||n.x>l.x&&e.x>l.x||n.y<o.y&&e.y<o.y||n.y>l.y&&e.y>l.y)return!1;const d=mi(n,e,i[0]);return d!==mi(n,e,i[1])||d!==mi(n,e,i[2])||d!==mi(n,e,i[3])}function Yh(n,e,i){const o=e.paint.get(n).value;return o.kind==="constant"?o.value:i.programConfigurations.get(e.id).getMaxValue(n)}function Kh(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function ag(n,e,i,o,l){if(!e[0]&&!e[1])return n;const d=Ge.convert(e)._mult(l);i==="viewport"&&d._rotate(-o);const p=[];for(let _=0;_<n.length;_++)p.push(n[_].sub(d));return p}function tf(n,e,i,o){const l=Ge.convert(n)._mult(o);return e==="viewport"&&l._rotate(-i),l}ft(ng,"CircleBucket",{omit:["layers"]});const F_=new Pt({"circle-sort-key":new Re(Ne.layout_circle["circle-sort-key"])});var Jv={paint:new Pt({"circle-radius":new Re(Ne.paint_circle["circle-radius"]),"circle-color":new Re(Ne.paint_circle["circle-color"]),"circle-blur":new Re(Ne.paint_circle["circle-blur"]),"circle-opacity":new Re(Ne.paint_circle["circle-opacity"]),"circle-translate":new be(Ne.paint_circle["circle-translate"]),"circle-translate-anchor":new be(Ne.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new be(Ne.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new be(Ne.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Re(Ne.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Re(Ne.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Re(Ne.paint_circle["circle-stroke-opacity"])}),layout:F_},jp=1e-6,ja=typeof Float32Array<"u"?Float32Array:Array;function U_(){var n=new ja(9);return ja!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1,n}function og(n,e,i){var o=e[0],l=e[1],d=e[2],p=e[3],_=e[4],x=e[5],b=e[6],S=e[7],M=e[8],R=i[0],I=i[1],L=i[2],N=i[3],$=i[4],te=i[5],ce=i[6],ne=i[7],oe=i[8];return n[0]=R*o+I*p+L*b,n[1]=R*l+I*_+L*S,n[2]=R*d+I*x+L*M,n[3]=N*o+$*p+te*b,n[4]=N*l+$*_+te*S,n[5]=N*d+$*x+te*M,n[6]=ce*o+ne*p+oe*b,n[7]=ce*l+ne*_+oe*S,n[8]=ce*d+ne*x+oe*M,n}function Zs(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Gp(n,e){var i=e[0],o=e[1],l=e[2],d=e[3],p=e[4],_=e[5],x=e[6],b=e[7],S=e[8],M=e[9],R=e[10],I=e[11],L=e[12],N=e[13],$=e[14],te=e[15],ce=i*_-o*p,ne=i*x-l*p,oe=i*b-d*p,me=o*x-l*_,he=o*b-d*_,Ae=l*b-d*x,Se=S*N-M*L,Fe=S*$-R*L,Xe=S*te-I*L,Me=M*$-R*N,Ve=M*te-I*N,$e=R*te-I*$,Ke=ce*$e-ne*Ve+oe*Me+me*Xe-he*Fe+Ae*Se;return Ke?(n[0]=(_*$e-x*Ve+b*Me)*(Ke=1/Ke),n[1]=(l*Ve-o*$e-d*Me)*Ke,n[2]=(N*Ae-$*he+te*me)*Ke,n[3]=(R*he-M*Ae-I*me)*Ke,n[4]=(x*Xe-p*$e-b*Fe)*Ke,n[5]=(i*$e-l*Xe+d*Fe)*Ke,n[6]=($*oe-L*Ae-te*ne)*Ke,n[7]=(S*Ae-R*oe+I*ne)*Ke,n[8]=(p*Ve-_*Xe+b*Se)*Ke,n[9]=(o*Xe-i*Ve-d*Se)*Ke,n[10]=(L*he-N*oe+te*ce)*Ke,n[11]=(M*oe-S*he-I*ce)*Ke,n[12]=(_*Fe-p*Me-x*Se)*Ke,n[13]=(i*Me-o*Fe+l*Se)*Ke,n[14]=(N*ne-L*me-$*ce)*Ke,n[15]=(S*me-M*ne+R*ce)*Ke,n):null}function Kc(n,e,i){var o=e[0],l=e[1],d=e[2],p=e[3],_=e[4],x=e[5],b=e[6],S=e[7],M=e[8],R=e[9],I=e[10],L=e[11],N=e[12],$=e[13],te=e[14],ce=e[15],ne=i[0],oe=i[1],me=i[2],he=i[3];return n[0]=ne*o+oe*_+me*M+he*N,n[1]=ne*l+oe*x+me*R+he*$,n[2]=ne*d+oe*b+me*I+he*te,n[3]=ne*p+oe*S+me*L+he*ce,n[4]=(ne=i[4])*o+(oe=i[5])*_+(me=i[6])*M+(he=i[7])*N,n[5]=ne*l+oe*x+me*R+he*$,n[6]=ne*d+oe*b+me*I+he*te,n[7]=ne*p+oe*S+me*L+he*ce,n[8]=(ne=i[8])*o+(oe=i[9])*_+(me=i[10])*M+(he=i[11])*N,n[9]=ne*l+oe*x+me*R+he*$,n[10]=ne*d+oe*b+me*I+he*te,n[11]=ne*p+oe*S+me*L+he*ce,n[12]=(ne=i[12])*o+(oe=i[13])*_+(me=i[14])*M+(he=i[15])*N,n[13]=ne*l+oe*x+me*R+he*$,n[14]=ne*d+oe*b+me*I+he*te,n[15]=ne*p+oe*S+me*L+he*ce,n}function Jh(n,e,i){var o,l,d,p,_,x,b,S,M,R,I,L,N=i[0],$=i[1],te=i[2];return e===n?(n[12]=e[0]*N+e[4]*$+e[8]*te+e[12],n[13]=e[1]*N+e[5]*$+e[9]*te+e[13],n[14]=e[2]*N+e[6]*$+e[10]*te+e[14],n[15]=e[3]*N+e[7]*$+e[11]*te+e[15]):(l=e[1],d=e[2],p=e[3],_=e[4],x=e[5],b=e[6],S=e[7],M=e[8],R=e[9],I=e[10],L=e[11],n[0]=o=e[0],n[1]=l,n[2]=d,n[3]=p,n[4]=_,n[5]=x,n[6]=b,n[7]=S,n[8]=M,n[9]=R,n[10]=I,n[11]=L,n[12]=o*N+_*$+M*te+e[12],n[13]=l*N+x*$+R*te+e[13],n[14]=d*N+b*$+I*te+e[14],n[15]=p*N+S*$+L*te+e[15]),n}function Jc(n,e,i){var o=i[0],l=i[1],d=i[2];return n[0]=e[0]*o,n[1]=e[1]*o,n[2]=e[2]*o,n[3]=e[3]*o,n[4]=e[4]*l,n[5]=e[5]*l,n[6]=e[6]*l,n[7]=e[7]*l,n[8]=e[8]*d,n[9]=e[9]*d,n[10]=e[10]*d,n[11]=e[11]*d,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n}function nf(n,e,i){var o=Math.sin(i),l=Math.cos(i),d=e[4],p=e[5],_=e[6],x=e[7],b=e[8],S=e[9],M=e[10],R=e[11];return e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[4]=d*l+b*o,n[5]=p*l+S*o,n[6]=_*l+M*o,n[7]=x*l+R*o,n[8]=b*l-d*o,n[9]=S*l-p*o,n[10]=M*l-_*o,n[11]=R*l-x*o,n}function Qc(n,e,i){var o=Math.sin(i),l=Math.cos(i),d=e[0],p=e[1],_=e[2],x=e[3],b=e[8],S=e[9],M=e[10],R=e[11];return e!==n&&(n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=d*l-b*o,n[1]=p*l-S*o,n[2]=_*l-M*o,n[3]=x*l-R*o,n[8]=d*o+b*l,n[9]=p*o+S*l,n[10]=_*o+M*l,n[11]=x*o+R*l,n}function iu(n,e){return n[0]=e[0],n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=e[1],n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=e[2],n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function ru(n,e,i){var o,l,d,p=i[0],_=i[1],x=i[2],b=Math.hypot(p,_,x);return b<jp?null:(p*=b=1/b,_*=b,x*=b,o=Math.sin(e),l=Math.cos(e),n[0]=p*p*(d=1-l)+l,n[1]=_*p*d+x*o,n[2]=x*p*d-_*o,n[3]=0,n[4]=p*_*d-x*o,n[5]=_*_*d+l,n[6]=x*_*d+p*o,n[7]=0,n[8]=p*x*d+_*o,n[9]=_*x*d-p*o,n[10]=x*x*d+l,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n)}Math.hypot||(Math.hypot=function(){for(var n=0,e=arguments.length;e--;)n+=arguments[e]*arguments[e];return Math.sqrt(n)});var Yu=Kc;function eh(){var n=new ja(3);return ja!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function Qh(n){var e=new ja(3);return e[0]=n[0],e[1]=n[1],e[2]=n[2],e}function gs(n){return Math.hypot(n[0],n[1],n[2])}function ed(n,e,i){var o=new ja(3);return o[0]=n,o[1]=e,o[2]=i,o}function au(n,e,i){return n[0]=e[0]+i[0],n[1]=e[1]+i[1],n[2]=e[2]+i[2],n}function sg(n,e,i){return n[0]=e[0]-i[0],n[1]=e[1]-i[1],n[2]=e[2]-i[2],n}function lg(n,e,i){return n[0]=e[0]*i[0],n[1]=e[1]*i[1],n[2]=e[2]*i[2],n}function ou(n,e,i){return n[0]=Math.min(e[0],i[0]),n[1]=Math.min(e[1],i[1]),n[2]=Math.min(e[2],i[2]),n}function rf(n,e,i){return n[0]=Math.max(e[0],i[0]),n[1]=Math.max(e[1],i[1]),n[2]=Math.max(e[2],i[2]),n}function Eo(n,e,i){return n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n}function af(n,e,i,o){return n[0]=e[0]+i[0]*o,n[1]=e[1]+i[1]*o,n[2]=e[2]+i[2]*o,n}function aa(n,e){var i=e[0],o=e[1],l=e[2],d=i*i+o*o+l*l;return d>0&&(d=1/Math.sqrt(d)),n[0]=e[0]*d,n[1]=e[1]*d,n[2]=e[2]*d,n}function $o(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]}function ug(n,e,i){var o=e[0],l=e[1],d=e[2],p=i[0],_=i[1],x=i[2];return n[0]=l*x-d*_,n[1]=d*p-o*x,n[2]=o*_-l*p,n}function ji(n,e,i){var o=e[0],l=e[1],d=e[2],p=i[3]*o+i[7]*l+i[11]*d+i[15];return n[0]=(i[0]*o+i[4]*l+i[8]*d+i[12])/(p=p||1),n[1]=(i[1]*o+i[5]*l+i[9]*d+i[13])/p,n[2]=(i[2]*o+i[6]*l+i[10]*d+i[14])/p,n}function td(n,e,i){var o=i[0],l=i[1],d=i[2],p=e[0],_=e[1],x=e[2],b=l*x-d*_,S=d*p-o*x,M=o*_-l*p,R=l*M-d*S,I=d*b-o*M,L=o*S-l*b,N=2*i[3];return S*=N,M*=N,I*=2,L*=2,n[0]=p+(b*=N)+(R*=2),n[1]=_+S+I,n[2]=x+M+L,n}var yl,qo=sg,N_=lg,Qv=gs;function V_(n,e,i){return n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n[3]=e[3]*i,n}function j_(n,e){var i=e[0],o=e[1],l=e[2],d=e[3],p=i*i+o*o+l*l+d*d;return p>0&&(p=1/Math.sqrt(p)),n[0]=i*p,n[1]=o*p,n[2]=l*p,n[3]=d*p,n}function th(n,e,i){var o=e[0],l=e[1],d=e[2],p=e[3];return n[0]=i[0]*o+i[4]*l+i[8]*d+i[12]*p,n[1]=i[1]*o+i[5]*l+i[9]*d+i[13]*p,n[2]=i[2]*o+i[6]*l+i[10]*d+i[14]*p,n[3]=i[3]*o+i[7]*l+i[11]*d+i[15]*p,n}function $p(){var n=new ja(4);return ja!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n[3]=1,n}function G_(n){return n[0]=0,n[1]=0,n[2]=0,n[3]=1,n}function of(n,e,i){i*=.5;var o=e[0],l=e[1],d=e[2],p=e[3],_=Math.sin(i),x=Math.cos(i);return n[0]=o*x+p*_,n[1]=l*x+d*_,n[2]=d*x-l*_,n[3]=p*x-o*_,n}function qp(n,e,i){i*=.5;var o=e[0],l=e[1],d=e[2],p=e[3],_=Math.sin(i),x=Math.cos(i);return n[0]=o*x-d*_,n[1]=l*x+p*_,n[2]=d*x+o*_,n[3]=p*x-l*_,n}eh(),yl=new ja(4),ja!=Float32Array&&(yl[0]=0,yl[1]=0,yl[2]=0,yl[3]=0);var $_=j_;eh(),ed(1,0,0),ed(0,1,0),$p(),$p(),U_();class cg{constructor(e,i){this.pos=e,this.dir=i}intersectsPlane(e,i,o){const l=$o(i,this.dir);if(Math.abs(l)<1e-6)return!1;const d=((e[0]-this.pos[0])*i[0]+(e[1]-this.pos[1])*i[1]+(e[2]-this.pos[2])*i[2])/l;return o[0]=this.pos[0]+this.dir[0]*d,o[1]=this.pos[1]+this.dir[1]*d,o[2]=this.pos[2]+this.dir[2]*d,!0}closestPointOnSphere(e,i,o){if(function(I,L){var N=I[0],$=I[1],te=I[2],ce=L[0],ne=L[1],oe=L[2];return Math.abs(N-ce)<=jp*Math.max(1,Math.abs(N),Math.abs(ce))&&Math.abs($-ne)<=jp*Math.max(1,Math.abs($),Math.abs(ne))&&Math.abs(te-oe)<=jp*Math.max(1,Math.abs(te),Math.abs(oe))}(this.pos,e)||i===0)return o[0]=o[1]=o[2]=0,!1;const[l,d,p]=this.dir,_=this.pos[0]-e[0],x=this.pos[1]-e[1],b=this.pos[2]-e[2],S=l*l+d*d+p*p,M=2*(_*l+x*d+b*p),R=M*M-4*S*(_*_+x*x+b*b-i*i);if(R<0){const I=Math.max(-M/2,0),L=_+l*I,N=x+d*I,$=b+p*I,te=Math.hypot(L,N,$);return o[0]=L*i/te,o[1]=N*i/te,o[2]=$*i/te,!1}{const I=(-M-Math.sqrt(R))/(2*S);if(I<0){const L=Math.hypot(_,x,b);return o[0]=_*i/L,o[1]=x*i/L,o[2]=b*i/L,!1}return o[0]=_+l*I,o[1]=x+d*I,o[2]=b+p*I,!0}}}class hg{constructor(e,i,o,l,d){this.TL=e,this.TR=i,this.BR=o,this.BL=l,this.horizon=d}static fromInvProjectionMatrix(e,i,o){const l=[-1,1,1],d=[1,1,1],p=[1,-1,1],_=[-1,-1,1],x=ji(l,l,e),b=ji(d,d,e),S=ji(p,p,e),M=ji(_,_,e);return new hg(x,b,S,M,i/o)}}class dg{constructor(e,i){this.points=e,this.planes=i}static fromInvProjectionMatrix(e,i,o,l){const d=Math.pow(2,o),p=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(x=>{const b=th([],x,e),S=1/b[3]/i*d;return function(M,R,I){return M[0]=R[0]*I[0],M[1]=R[1]*I[1],M[2]=R[2]*I[2],M[3]=R[3]*I[3],M}(b,b,[S,S,l?1/b[3]:S,S])}),_=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(x=>{const b=aa([],ug([],qo([],p[x[0]],p[x[1]]),qo([],p[x[2]],p[x[1]]))),S=-$o(b,p[x[1]]);return b.concat(S)});return new dg(p,_)}}class Ga{static fromPoints(e){const i=[1/0,1/0,1/0],o=[-1/0,-1/0,-1/0];for(const l of e)ou(i,i,l),rf(o,o,l);return new Ga(i,o)}static applyTransform(e,i){const o=e.getCorners();for(let l=0;l<o.length;++l)ji(o[l],o[l],i);return Ga.fromPoints(o)}constructor(e,i){this.min=e,this.max=i,this.center=Eo([],au([],this.min,this.max),.5)}quadrant(e){const i=[e%2==0,e<2],o=Qh(this.min),l=Qh(this.max);for(let d=0;d<i.length;d++)o[d]=i[d]?this.min[d]:this.center[d],l[d]=i[d]?this.center[d]:this.max[d];return l[2]=this.max[2],new Ga(o,l)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,i=this.max;return[[e[0],e[1],e[2]],[i[0],e[1],e[2]],[i[0],i[1],e[2]],[e[0],i[1],e[2]],[e[0],e[1],i[2]],[i[0],e[1],i[2]],[i[0],i[1],i[2]],[e[0],i[1],i[2]]]}intersects(e){const i=this.getCorners();let o=!0;for(let l=0;l<e.planes.length;l++){const d=e.planes[l];let p=0;for(let _=0;_<i.length;_++)p+=$o(d,i[_])+d[3]>=0;if(p===0)return 0;p!==i.length&&(o=!1)}if(o)return 2;for(let l=0;l<3;l++){let d=Number.MAX_VALUE,p=-Number.MAX_VALUE;for(let _=0;_<e.points.length;_++){const x=e.points[_][l]-this.min[l];d=Math.min(d,x),p=Math.max(p,x)}if(p<0||d>this.max[l]-this.min[l])return 0}return 1}}function nd(n,e,i,o,l,d,p,_,x){if(d&&n.queryGeometry.isAboveHorizon)return!1;d&&(x*=n.pixelToTileUnitsFactor);const b=n.tileID.canonical,S=i.projection.upVectorScale(b,i.center.lat,i.worldSize).metersToTile;for(const M of e)for(const R of M){const I=R.add(_),L=l&&i.elevation?i.elevation.exaggeration()*l.getElevationAt(I.x,I.y,!0):0,N=i.projection.projectTilePoint(I.x,I.y,b);if(L>0){const ne=i.projection.upVector(b,I.x,I.y);N.x+=ne[0]*S*L,N.y+=ne[1]*S*L,N.z+=ne[2]*S*L}const $=d?I:fg(N.x,N.y,N.z,o),te=d?n.tilespaceRays.map(ne=>tx(ne,L)):n.queryGeometry.screenGeometry,ce=th([],[N.x,N.y,N.z,1],o);if(!p&&d?x*=ce[3]/i.cameraToCenterDistance:p&&!d&&(x*=i.cameraToCenterDistance/ce[3]),d){const ne=zr((R.y/qt+b.y)/(1<<b.z));x/=i.projection.pixelsPerMeter(ne,1)/fs(1,ne)}if(P_(te,$,x))return!0}return!1}function fg(n,e,i,o){const l=th([],[n,e,i,1],o);return new Ge(l[0]/l[3],l[1]/l[3])}const id=ed(0,0,0),ex=ed(0,0,1);function tx(n,e){const i=eh();return id[2]=e,n.intersectsPlane(id,ex,i),new Ge(i[0],i[1])}class pg extends ng{}function mg(n,{width:e,height:i},o,l){if(l){if(l instanceof Uint8ClampedArray)l=new Uint8Array(l.buffer);else if(l.length!==e*i*o)throw new RangeError("mismatched image size")}else l=new Uint8Array(e*i*o);return n.width=e,n.height=i,n.data=l,n}function sf(n,e,i){const{width:o,height:l}=e;o===n.width&&l===n.height||(rd(n,e,{x:0,y:0},{x:0,y:0},{width:Math.min(n.width,o),height:Math.min(n.height,l)},i),n.width=o,n.height=l,n.data=e.data)}function rd(n,e,i,o,l,d){if(l.width===0||l.height===0)return e;if(l.width>n.width||l.height>n.height||i.x>n.width-l.width||i.y>n.height-l.height)throw new RangeError("out of range source coordinates for image copy");if(l.width>e.width||l.height>e.height||o.x>e.width-l.width||o.y>e.height-l.height)throw new RangeError("out of range destination coordinates for image copy");const p=n.data,_=e.data;for(let x=0;x<l.height;x++){const b=((i.y+x)*n.width+i.x)*d,S=((o.y+x)*e.width+o.x)*d;for(let M=0;M<l.width*d;M++)_[S+M]=p[b+M]}return e}ft(pg,"HeatmapBucket",{omit:["layers"]});class vl{constructor(e,i){mg(this,e,1,i)}resize(e){sf(this,new vl(e),1)}clone(){return new vl({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,i,o,l,d){rd(e,i,o,l,d,1)}}class Ki{constructor(e,i){mg(this,e,4,i)}resize(e){sf(this,new Ki(e),4)}replace(e,i){i?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Ki({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,i,o,l,d){rd(e,i,o,l,d,4)}}ft(vl,"AlphaImage"),ft(Ki,"RGBAImage");var ad={paint:new Pt({"heatmap-radius":new Re(Ne.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Re(Ne.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new be(Ne.paint_heatmap["heatmap-intensity"]),"heatmap-color":new wt(Ne.paint_heatmap["heatmap-color"]),"heatmap-opacity":new be(Ne.paint_heatmap["heatmap-opacity"])})};function lf(n){const e={},i=n.resolution||256,o=n.clips?n.clips.length:1,l=n.image||new Ki({width:i,height:o}),d=(p,_,x)=>{e[n.evaluationKey]=x;const b=n.expression.evaluate(e);l.data[p+_+0]=Math.floor(255*b.r/b.a),l.data[p+_+1]=Math.floor(255*b.g/b.a),l.data[p+_+2]=Math.floor(255*b.b/b.a),l.data[p+_+3]=Math.floor(255*b.a)};if(n.clips)for(let p=0,_=0;p<o;++p,_+=4*i)for(let x=0,b=0;x<i;x++,b+=4){const S=x/(i-1),{start:M,end:R}=n.clips[p];d(_,b,M*(1-S)+R*S)}else for(let p=0,_=0;p<i;p++,_+=4)d(0,_,p/(i-1));return l}var uf={paint:new Pt({"hillshade-illumination-direction":new be(Ne.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new be(Ne.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new be(Ne.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new be(Ne.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new be(Ne.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new be(Ne.paint_hillshade["hillshade-accent-color"])})};const nx=yt([{name:"a_pos",components:2,type:"Int16"}],4),{members:gg}=nx;var nh={exports:{}};function Ku(n,e,i){i=i||2;var o,l,d,p,_,x,b,S=e&&e.length,M=S?e[0]*i:n.length,R=q_(n,0,M,i,!0),I=[];if(!R||R.next===R.prev)return I;if(S&&(R=function(N,$,te,ce){var ne,oe,me,he=[];for(ne=0,oe=$.length;ne<oe;ne++)(me=q_(N,$[ne]*ce,ne<oe-1?$[ne+1]*ce:N.length,ce,!1))===me.next&&(me.steiner=!0),he.push(ux(me));for(he.sort(ox),ne=0;ne<he.length;ne++)te=sx(he[ne],te);return te}(n,e,R,i)),n.length>80*i){o=d=n[0],l=p=n[1];for(var L=i;L<M;L+=i)(_=n[L])<o&&(o=_),(x=n[L+1])<l&&(l=x),_>d&&(d=_),x>p&&(p=x);b=(b=Math.max(d-o,p-l))!==0?32767/b:0}return od(R,I,i,o,l,b,0),I}function q_(n,e,i,o,l){var d,p;if(l===vg(n,e,i,o)>0)for(d=e;d<i;d+=o)p=X_(d,n[d],n[d+1],p);else for(d=i-o;d>=e;d-=o)p=X_(d,n[d],n[d+1],p);return p&&Hp(p,p.next)&&(cf(p),p=p.next),p}function xl(n,e){if(!n)return n;e||(e=n);var i,o=n;do if(i=!1,o.steiner||!Hp(o,o.next)&&xr(o.prev,o,o.next)!==0)o=o.next;else{if(cf(o),(o=e=o.prev)===o.next)break;i=!0}while(i||o!==e);return e}function od(n,e,i,o,l,d,p){if(n){!p&&d&&function(S,M,R,I){var L=S;do L.z===0&&(L.z=yg(L.x,L.y,M,R,I)),L.prevZ=L.prev,L.nextZ=L.next,L=L.next;while(L!==S);L.prevZ.nextZ=null,L.prevZ=null,function(N){var $,te,ce,ne,oe,me,he,Ae,Se=1;do{for(te=N,N=null,oe=null,me=0;te;){for(me++,ce=te,he=0,$=0;$<Se&&(he++,ce=ce.nextZ);$++);for(Ae=Se;he>0||Ae>0&&ce;)he!==0&&(Ae===0||!ce||te.z<=ce.z)?(ne=te,te=te.nextZ,he--):(ne=ce,ce=ce.nextZ,Ae--),oe?oe.nextZ=ne:N=ne,ne.prevZ=oe,oe=ne;te=ce}oe.nextZ=null,Se*=2}while(me>1)}(L)}(n,o,l,d);for(var _,x,b=n;n.prev!==n.next;)if(_=n.prev,x=n.next,d?rx(n,o,l,d):ix(n))e.push(_.i/i|0),e.push(n.i/i|0),e.push(x.i/i|0),cf(n),n=x.next,b=x.next;else if((n=x)===b){p?p===1?od(n=ax(xl(n),e,i),e,i,o,l,d,2):p===2&&_g(n,e,i,o,l,d):od(xl(n),e,i,o,l,d,1);break}}}function ix(n){var e=n.prev,i=n,o=n.next;if(xr(e,i,o)>=0)return!1;for(var l=e.x,d=i.x,p=o.x,_=e.y,x=i.y,b=o.y,S=l<d?l<p?l:p:d<p?d:p,M=_<x?_<b?_:b:x<b?x:b,R=l>d?l>p?l:p:d>p?d:p,I=_>x?_>b?_:b:x>b?x:b,L=o.next;L!==e;){if(L.x>=S&&L.x<=R&&L.y>=M&&L.y<=I&&ih(l,_,d,x,p,b,L.x,L.y)&&xr(L.prev,L,L.next)>=0)return!1;L=L.next}return!0}function rx(n,e,i,o){var l=n.prev,d=n,p=n.next;if(xr(l,d,p)>=0)return!1;for(var _=l.x,x=d.x,b=p.x,S=l.y,M=d.y,R=p.y,I=_<x?_<b?_:b:x<b?x:b,L=S<M?S<R?S:R:M<R?M:R,N=_>x?_>b?_:b:x>b?x:b,$=S>M?S>R?S:R:M>R?M:R,te=yg(I,L,e,i,o),ce=yg(N,$,e,i,o),ne=n.prevZ,oe=n.nextZ;ne&&ne.z>=te&&oe&&oe.z<=ce;){if(ne.x>=I&&ne.x<=N&&ne.y>=L&&ne.y<=$&&ne!==l&&ne!==p&&ih(_,S,x,M,b,R,ne.x,ne.y)&&xr(ne.prev,ne,ne.next)>=0||(ne=ne.prevZ,oe.x>=I&&oe.x<=N&&oe.y>=L&&oe.y<=$&&oe!==l&&oe!==p&&ih(_,S,x,M,b,R,oe.x,oe.y)&&xr(oe.prev,oe,oe.next)>=0))return!1;oe=oe.nextZ}for(;ne&&ne.z>=te;){if(ne.x>=I&&ne.x<=N&&ne.y>=L&&ne.y<=$&&ne!==l&&ne!==p&&ih(_,S,x,M,b,R,ne.x,ne.y)&&xr(ne.prev,ne,ne.next)>=0)return!1;ne=ne.prevZ}for(;oe&&oe.z<=ce;){if(oe.x>=I&&oe.x<=N&&oe.y>=L&&oe.y<=$&&oe!==l&&oe!==p&&ih(_,S,x,M,b,R,oe.x,oe.y)&&xr(oe.prev,oe,oe.next)>=0)return!1;oe=oe.nextZ}return!0}function ax(n,e,i){var o=n;do{var l=o.prev,d=o.next.next;!Hp(l,d)&&H_(l,o,o.next,d)&&rh(l,d)&&rh(d,l)&&(e.push(l.i/i|0),e.push(o.i/i|0),e.push(d.i/i|0),cf(o),cf(o.next),o=n=d),o=o.next}while(o!==n);return xl(o)}function _g(n,e,i,o,l,d){var p=n;do{for(var _=p.next.next;_!==p.prev;){if(p.i!==_.i&&cx(p,_)){var x=Z_(p,_);return p=xl(p,p.next),x=xl(x,x.next),od(p,e,i,o,l,d,0),void od(x,e,i,o,l,d,0)}_=_.next}p=p.next}while(p!==n)}function ox(n,e){return n.x-e.x}function sx(n,e){var i=function(l,d){var p,_=d,x=l.x,b=l.y,S=-1/0;do{if(b<=_.y&&b>=_.next.y&&_.next.y!==_.y){var M=_.x+(b-_.y)*(_.next.x-_.x)/(_.next.y-_.y);if(M<=x&&M>S&&(S=M,p=_.x<_.next.x?_:_.next,M===x))return p}_=_.next}while(_!==d);if(!p)return null;var R,I=p,L=p.x,N=p.y,$=1/0;_=p;do x>=_.x&&_.x>=L&&x!==_.x&&ih(b<N?x:S,b,L,N,b<N?S:x,b,_.x,_.y)&&(R=Math.abs(b-_.y)/(x-_.x),rh(_,l)&&(R<$||R===$&&(_.x>p.x||_.x===p.x&&lx(p,_)))&&(p=_,$=R)),_=_.next;while(_!==I);return p}(n,e);if(!i)return e;var o=Z_(i,n);return xl(o,o.next),xl(i,i.next)}function lx(n,e){return xr(n.prev,n,e.prev)<0&&xr(e.next,n,n.next)<0}function yg(n,e,i,o,l){return(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-i)*l|0)|n<<8))|n<<4))|n<<2))|n<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-o)*l|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function ux(n){var e=n,i=n;do(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next;while(e!==n);return i}function ih(n,e,i,o,l,d,p,_){return(l-p)*(e-_)>=(n-p)*(d-_)&&(n-p)*(o-_)>=(i-p)*(e-_)&&(i-p)*(d-_)>=(l-p)*(o-_)}function cx(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!function(i,o){var l=i;do{if(l.i!==i.i&&l.next.i!==i.i&&l.i!==o.i&&l.next.i!==o.i&&H_(l,l.next,i,o))return!0;l=l.next}while(l!==i);return!1}(n,e)&&(rh(n,e)&&rh(e,n)&&function(i,o){var l=i,d=!1,p=(i.x+o.x)/2,_=(i.y+o.y)/2;do l.y>_!=l.next.y>_&&l.next.y!==l.y&&p<(l.next.x-l.x)*(_-l.y)/(l.next.y-l.y)+l.x&&(d=!d),l=l.next;while(l!==i);return d}(n,e)&&(xr(n.prev,n,e.prev)||xr(n,e.prev,e))||Hp(n,e)&&xr(n.prev,n,n.next)>0&&xr(e.prev,e,e.next)>0)}function xr(n,e,i){return(e.y-n.y)*(i.x-e.x)-(e.x-n.x)*(i.y-e.y)}function Hp(n,e){return n.x===e.x&&n.y===e.y}function H_(n,e,i,o){var l=Xp(xr(n,e,i)),d=Xp(xr(n,e,o)),p=Xp(xr(i,o,n)),_=Xp(xr(i,o,e));return l!==d&&p!==_||!(l!==0||!Zp(n,i,e))||!(d!==0||!Zp(n,o,e))||!(p!==0||!Zp(i,n,o))||!(_!==0||!Zp(i,e,o))}function Zp(n,e,i){return e.x<=Math.max(n.x,i.x)&&e.x>=Math.min(n.x,i.x)&&e.y<=Math.max(n.y,i.y)&&e.y>=Math.min(n.y,i.y)}function Xp(n){return n>0?1:n<0?-1:0}function rh(n,e){return xr(n.prev,n,n.next)<0?xr(n,e,n.next)>=0&&xr(n,n.prev,e)>=0:xr(n,e,n.prev)<0||xr(n,n.next,e)<0}function Z_(n,e){var i=new Wp(n.i,n.x,n.y),o=new Wp(e.i,e.x,e.y),l=n.next,d=e.prev;return n.next=e,e.prev=n,i.next=l,l.prev=i,o.next=i,i.prev=o,d.next=o,o.prev=d,o}function X_(n,e,i,o){var l=new Wp(n,e,i);return o?(l.next=o.next,l.prev=o,o.next.prev=l,o.next=l):(l.prev=l,l.next=l),l}function cf(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function Wp(n,e,i){this.i=n,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function vg(n,e,i,o){for(var l=0,d=e,p=i-o;d<i;d+=o)l+=(n[p]-n[d])*(n[d+1]+n[p+1]),p=d;return l}function hx(n,e,i,o,l){W_(n,e,i||0,o||n.length-1,l||dx)}function W_(n,e,i,o,l){for(;o>i;){if(o-i>600){var d=o-i+1,p=e-i+1,_=Math.log(d),x=.5*Math.exp(2*_/3),b=.5*Math.sqrt(_*x*(d-x)/d)*(p-d/2<0?-1:1);W_(n,e,Math.max(i,Math.floor(e-p*x/d+b)),Math.min(o,Math.floor(e+(d-p)*x/d+b)),l)}var S=n[e],M=i,R=o;for(hf(n,i,e),l(n[o],S)>0&&hf(n,i,o);M<R;){for(hf(n,M,R),M++,R--;l(n[M],S)<0;)M++;for(;l(n[R],S)>0;)R--}l(n[i],S)===0?hf(n,i,R):hf(n,++R,o),R<=e&&(i=R+1),e<=R&&(o=R-1)}}function hf(n,e,i){var o=n[e];n[e]=n[i],n[i]=o}function dx(n,e){return n<e?-1:n>e?1:0}function xg(n,e){const i=n.length;if(i<=1)return[n];const o=[];let l,d;for(let p=0;p<i;p++){const _=Yt(n[p]);_!==0&&(n[p].area=Math.abs(_),d===void 0&&(d=_<0),d===_<0?(l&&o.push(l),l=[n[p]]):l.push(n[p]))}if(l&&o.push(l),e>1)for(let p=0;p<o.length;p++)o[p].length<=e||(hx(o[p],e,1,o[p].length-1,fx),o[p]=o[p].slice(0,e));return o}function fx(n,e){return e.area-n.area}function Yp(n,e,i){const o=i.patternDependencies;let l=!1;for(const d of e){const p=d.paint.get(`${n}-pattern`);p.isConstant()||(l=!0);const _=p.constantOr(null);_&&(l=!0,o[_]=!0)}return l}function df(n,e,i,o,l){const d=l.patternDependencies;for(const p of e){const _=p.paint.get(`${n}-pattern`).value;if(_.kind!=="constant"){let x=_.evaluate({zoom:o},i,{},l.availableImages);x=x&&x.name?x.name:x,d[x]=!0,i.patterns[p.id]=x}}return i}nh.exports=Ku,nh.exports.default=Ku,Ku.deviation=function(n,e,i,o){var l=e&&e.length,d=Math.abs(vg(n,0,l?e[0]*i:n.length,i));if(l)for(var p=0,_=e.length;p<_;p++)d-=Math.abs(vg(n,e[p]*i,p<_-1?e[p+1]*i:n.length,i));var x=0;for(p=0;p<o.length;p+=3){var b=o[p]*i,S=o[p+1]*i,M=o[p+2]*i;x+=Math.abs((n[b]-n[M])*(n[S+1]-n[b+1])-(n[b]-n[S])*(n[M+1]-n[b+1]))}return d===0&&x===0?0:Math.abs((x-d)/d)},Ku.flatten=function(n){for(var e=n[0][0].length,i={vertices:[],holes:[],dimensions:e},o=0,l=0;l<n.length;l++){for(var d=0;d<n[l].length;d++)for(var p=0;p<e;p++)i.vertices.push(n[l][d][p]);l>0&&i.holes.push(o+=n[l-1].length)}return i};class Ju{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Gn,this.indexArray=new Wn,this.indexArray2=new wo,this.programConfigurations=new vi(e.layers,e.zoom),this.segments=new Dr,this.segments2=new Dr,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.projection=e.projection}populate(e,i,o,l){this.hasPattern=Yp("fill",this.layers,i);const d=this.layers[0].layout.get("fill-sort-key"),p=[];for(const{feature:_,id:x,index:b,sourceLayerIndex:S}of e){const M=this.layers[0]._featureFilter.needGeometry,R=Wu(_,M);if(!this.layers[0]._featureFilter.filter(new ve(this.zoom),R,o))continue;const I=d?d.evaluate(R,{},o,i.availableImages):void 0,L={id:x,properties:_.properties,type:_.type,sourceLayerIndex:S,index:b,geometry:M?R.geometry:tu(_,o,l),patterns:{},sortKey:I};p.push(L)}d&&p.sort((_,x)=>_.sortKey-x.sortKey);for(const _ of p){const{geometry:x,index:b,sourceLayerIndex:S}=_;if(this.hasPattern){const M=df("fill",this.layers,_,this.zoom,i);this.patternFeatures.push(M)}else this.addFeature(_,x,b,o,{},i.availableImages);i.featureIndex.insert(e[b].feature,x,b,S,this.index)}}update(e,i,o,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,o,l)}addFeatures(e,i,o,l,d){for(const p of this.patternFeatures)this.addFeature(p,p.geometry,p.index,i,o,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,gg),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,i,o,l,d,p=[]){for(const _ of xg(i,500)){let x=0;for(const L of _)x+=L.length;const b=this.segments.prepareSegment(x,this.layoutVertexArray,this.indexArray),S=b.vertexLength,M=[],R=[];for(const L of _){if(L.length===0)continue;L!==_[0]&&R.push(M.length/2);const N=this.segments2.prepareSegment(L.length,this.layoutVertexArray,this.indexArray2),$=N.vertexLength;this.layoutVertexArray.emplaceBack(L[0].x,L[0].y),this.indexArray2.emplaceBack($+L.length-1,$),M.push(L[0].x),M.push(L[0].y);for(let te=1;te<L.length;te++)this.layoutVertexArray.emplaceBack(L[te].x,L[te].y),this.indexArray2.emplaceBack($+te-1,$+te),M.push(L[te].x),M.push(L[te].y);N.vertexLength+=L.length,N.primitiveLength+=L.length}const I=nh.exports(M,R);for(let L=0;L<I.length;L+=3)this.indexArray.emplaceBack(S+I[L],S+I[L+1],S+I[L+2]);b.vertexLength+=x,b.primitiveLength+=I.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,o,d,p,l)}}ft(Ju,"FillBucket",{omit:["layers","patternFeatures"]});const px=new Pt({"fill-sort-key":new Re(Ne.layout_fill["fill-sort-key"])});var Y_={paint:new Pt({"fill-antialias":new be(Ne.paint_fill["fill-antialias"]),"fill-opacity":new Re(Ne.paint_fill["fill-opacity"]),"fill-color":new Re(Ne.paint_fill["fill-color"]),"fill-outline-color":new Re(Ne.paint_fill["fill-outline-color"]),"fill-translate":new be(Ne.paint_fill["fill-translate"]),"fill-translate-anchor":new be(Ne.paint_fill["fill-translate-anchor"]),"fill-pattern":new Re(Ne.paint_fill["fill-pattern"])}),layout:px};const K_=yt([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),J_=yt([{name:"a_centroid_pos",components:2,type:"Uint16"}]),mx=yt([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:Q_}=K_;var Kp={},gx=Ge,ey=ah;function ah(n,e,i,o,l){this.properties={},this.extent=i,this.type=0,this._pbf=n,this._geometry=-1,this._keys=o,this._values=l,n.readFields(ty,this,e)}function ty(n,e,i){n==1?e.id=i.readVarint():n==2?function(o,l){for(var d=o.readVarint()+o.pos;o.pos<d;){var p=l._keys[o.readVarint()],_=l._values[o.readVarint()];l.properties[p]=_}}(i,e):n==3?e.type=i.readVarint():n==4&&(e._geometry=i.pos)}function ny(n){for(var e,i,o=0,l=0,d=n.length,p=d-1;l<d;p=l++)o+=((i=n[p]).x-(e=n[l]).x)*(e.y+i.y);return o}ah.types=["Unknown","Point","LineString","Polygon"],ah.prototype.loadGeometry=function(){var n=this._pbf;n.pos=this._geometry;for(var e,i=n.readVarint()+n.pos,o=1,l=0,d=0,p=0,_=[];n.pos<i;){if(l<=0){var x=n.readVarint();o=7&x,l=x>>3}if(l--,o===1||o===2)d+=n.readSVarint(),p+=n.readSVarint(),o===1&&(e&&_.push(e),e=[]),e.push(new gx(d,p));else{if(o!==7)throw new Error("unknown command "+o);e&&e.push(e[0].clone())}}return e&&_.push(e),_},ah.prototype.bbox=function(){var n=this._pbf;n.pos=this._geometry;for(var e=n.readVarint()+n.pos,i=1,o=0,l=0,d=0,p=1/0,_=-1/0,x=1/0,b=-1/0;n.pos<e;){if(o<=0){var S=n.readVarint();i=7&S,o=S>>3}if(o--,i===1||i===2)(l+=n.readSVarint())<p&&(p=l),l>_&&(_=l),(d+=n.readSVarint())<x&&(x=d),d>b&&(b=d);else if(i!==7)throw new Error("unknown command "+i)}return[p,x,_,b]},ah.prototype.toGeoJSON=function(n,e,i){var o,l,d=this.extent*Math.pow(2,i),p=this.extent*n,_=this.extent*e,x=this.loadGeometry(),b=ah.types[this.type];function S(I){for(var L=0;L<I.length;L++){var N=I[L];I[L]=[360*(N.x+p)/d-180,360/Math.PI*Math.atan(Math.exp((180-360*(N.y+_)/d)*Math.PI/180))-90]}}switch(this.type){case 1:var M=[];for(o=0;o<x.length;o++)M[o]=x[o][0];S(x=M);break;case 2:for(o=0;o<x.length;o++)S(x[o]);break;case 3:for(x=function(I){var L=I.length;if(L<=1)return[I];for(var N,$,te=[],ce=0;ce<L;ce++){var ne=ny(I[ce]);ne!==0&&($===void 0&&($=ne<0),$===ne<0?(N&&te.push(N),N=[I[ce]]):N.push(I[ce]))}return N&&te.push(N),te}(x),o=0;o<x.length;o++)for(l=0;l<x[o].length;l++)S(x[o][l])}x.length===1?x=x[0]:b="Multi"+b;var R={type:"Feature",geometry:{type:b,coordinates:x},properties:this.properties};return"id"in this&&(R.id=this.id),R};var sd=ey,iy=ry;function ry(n,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=n,this._keys=[],this._values=[],this._features=[],n.readFields(_x,this,e),this.length=this._features.length}function _x(n,e,i){n===15?e.version=i.readVarint():n===1?e.name=i.readString():n===5?e.extent=i.readVarint():n===2?e._features.push(i.pos):n===3?e._keys.push(i.readString()):n===4&&e._values.push(function(o){for(var l=null,d=o.readVarint()+o.pos;o.pos<d;){var p=o.readVarint()>>3;l=p===1?o.readString():p===2?o.readFloat():p===3?o.readDouble():p===4?o.readVarint64():p===5?o.readVarint():p===6?o.readSVarint():p===7?o.readBoolean():null}return l}(i))}ry.prototype.feature=function(n){if(n<0||n>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[n];var e=this._pbf.readVarint()+this._pbf.pos;return new sd(this._pbf,e,this.extent,this._keys,this._values)};var yx=iy;function vx(n,e,i){if(n===3){var o=new yx(i,i.readVarint()+i.pos);o.length&&(e[o.name]=o)}}var bg=Kp.VectorTile=function(n,e){this.layers=n.readFields(vx,{},e)},ff=Kp.VectorTileFeature=ey;function Jp(n,e,i,o){const l=[],d=o===0?(p,_,x,b,S,M)=>{p.push(new Ge(M,x+(M-_)/(b-_)*(S-x)))}:(p,_,x,b,S,M)=>{p.push(new Ge(_+(M-x)/(S-x)*(b-_),M))};for(const p of n){const _=[];for(const x of p){if(x.length<=2)continue;const b=[];for(let R=0;R<x.length-1;R++){const I=x[R].x,L=x[R].y,N=x[R+1].x,$=x[R+1].y,te=o===0?I:L,ce=o===0?N:$;te<e?ce>e&&d(b,I,L,N,$,e):te>i?ce<i&&d(b,I,L,N,$,i):b.push(x[R]),ce<e&&te>=e&&d(b,I,L,N,$,e),ce>i&&te<=i&&d(b,I,L,N,$,i)}let S=x[x.length-1];const M=o===0?S.x:S.y;M>=e&&M<=i&&b.push(S),b.length&&(S=b[b.length-1],b[0].x===S.x&&b[0].y===S.y||b.push(b[0]),_.push(b))}_.length&&l.push(_)}return l}Kp.VectorTileLayer=iy;const xx=ff.types,ay=Math.pow(2,13);function su(n,e,i,o,l,d,p,_){n.emplaceBack((e<<1)+p,(i<<1)+d,(Math.floor(o*ay)<<1)+l,Math.round(_))}function lu(n,e,i){n.emplaceBack(e.x,e.y,e.z,i[0]*16384,i[1]*16384,i[2]*16384)}class oy{constructor(){this.acc=new Ge(0,0),this.polyCount=[]}startRing(e){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new Ge(e.x,e.y),this.max=new Ge(e.x,e.y))}append(e,i){this.currentPolyCount.edges++,this.acc._add(e);const o=this.min,l=this.max;e.x<o.x?o.x=e.x:e.x>l.x&&(l.x=e.x),e.y<o.y?o.y=e.y:e.y>l.y&&(l.y=e.y),((e.x===0||e.x===qt)&&e.x===i.x)!=((e.y===0||e.y===qt)&&e.y===i.y)&&this.processBorderOverlap(e,i),i.x<0!=e.x<0&&this.addBorderIntersection(0,Bn(i.y,e.y,(0-i.x)/(e.x-i.x))),i.x>qt!=e.x>qt&&this.addBorderIntersection(1,Bn(i.y,e.y,(qt-i.x)/(e.x-i.x))),i.y<0!=e.y<0&&this.addBorderIntersection(2,Bn(i.x,e.x,(0-i.y)/(e.y-i.y))),i.y>qt!=e.y>qt&&this.addBorderIntersection(3,Bn(i.x,e.x,(qt-i.y)/(e.y-i.y)))}addBorderIntersection(e,i){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const o=this.borders[e];i<o[0]&&(o[0]=i),i>o[1]&&(o[1]=i)}processBorderOverlap(e,i){if(e.x===i.x){if(e.y===i.y)return;const o=e.x===0?0:1;this.addBorderIntersection(o,i.y),this.addBorderIntersection(o,e.y)}else{const o=e.y===0?2:3;this.addBorderIntersection(o,i.x),this.addBorderIntersection(o,e.x)}}centroid(){const e=this.polyCount.reduce((i,o)=>i+o.edges,0);return e!==0?this.acc.div(e)._round():new Ge(0,0)}span(){return new Ge(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((e,i)=>e+ +(i[0]!==Number.MAX_VALUE),0)}}class pf{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=e.projection,this.layoutVertexArray=new hi,this.centroidVertexArray=new Mp,this.indexArray=new Wn,this.programConfigurations=new vi(e.layers,e.zoom),this.segments=new Dr,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.enableTerrain=e.enableTerrain}populate(e,i,o,l){this.features=[],this.hasPattern=Yp("fill-extrusion",this.layers,i),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(d){const p=Math.exp(Math.PI*(1-d.y/(1<<d.z)*2));return 80150034*p/(p*p+1)/qt/(1<<d.z)}(o),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:d,id:p,index:_,sourceLayerIndex:x}of e){const b=this.layers[0]._featureFilter.needGeometry,S=Wu(d,b);if(!this.layers[0]._featureFilter.filter(new ve(this.zoom),S,o))continue;const M={id:p,sourceLayerIndex:x,index:_,geometry:b?S.geometry:tu(d,o,l),properties:d.properties,type:d.type,patterns:{}},R=this.layoutVertexArray.length;this.hasPattern?this.features.push(df("fill-extrusion",this.layers,M,this.zoom,i)):this.addFeature(M,M.geometry,_,o,{},i.availableImages,l),i.featureIndex.insert(d,M.geometry,_,x,this.index,R)}this.sortBorders()}addFeatures(e,i,o,l,d){for(const p of this.features){const{geometry:_}=p;this.addFeature(p,_,p.index,i,o,l,d)}this.sortBorders()}update(e,i,o,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,o,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Q_),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,mx.members,!0))),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,J_.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,i,o,l,d,p,_){const x=[new Ge(0,0),new Ge(qt,qt)],b=_.projection,S=b.name==="globe",M=this.enableTerrain&&!S?new oy:null,R=xx[e.type]==="Polygon";S&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Mi);const I=xg(i,500);for(let te=I.length-1;te>=0;te--){const ce=I[te];(ce.length===0||(L=ce[0]).every(ne=>ne.x<=0)||L.every(ne=>ne.x>=qt)||L.every(ne=>ne.y<=0)||L.every(ne=>ne.y>=qt))&&I.splice(te,1)}var L;let N;if(S)N=cy(I,x,l);else{N=[];for(const te of I)N.push({polygon:te,bounds:x})}const $=R?this.edgeRadius:0;for(const{polygon:te,bounds:ce}of N){let ne=0,oe=0;for(const he of te)R&&!he[0].equals(he[he.length-1])&&he.push(he[0]),oe+=R?he.length-1:he.length;const me=this.segments.prepareSegment((R?5:4)*oe,this.layoutVertexArray,this.indexArray);if(R){const he=[],Ae=[];ne=me.vertexLength;for(const Fe of te){let Xe,Me;Fe.length&&Fe!==te[0]&&Ae.push(he.length/2),Xe=Fe[1].sub(Fe[0])._perp()._unit();for(let Ve=1;Ve<Fe.length;Ve++){const $e=Fe[Ve],Ke=Fe[Ve===Fe.length-1?1:Ve+1];let{x:tt,y:ke}=$e;if($){Me=Ke.sub($e)._perp()._unit();const st=Xe.add(Me)._unit(),jt=$*Math.min(4,1/(Xe.x*st.x+Xe.y*st.y));tt+=jt*st.x,ke+=jt*st.y,Xe=Me}su(this.layoutVertexArray,tt,ke,0,0,1,1,0),me.vertexLength++,he.push($e.x,$e.y),S&&lu(this.layoutVertexExtArray,b.projectTilePoint(tt,ke,l),b.upVector(l,tt,ke))}}const Se=nh.exports(he,Ae);for(let Fe=0;Fe<Se.length;Fe+=3)this.indexArray.emplaceBack(ne+Se[Fe],ne+Se[Fe+2],ne+Se[Fe+1]),me.primitiveLength++}for(const he of te){M&&he.length&&M.startRing(he[0]);let Ae,Se,Fe,Xe=he.length>4&&uy(he[he.length-2],he[0],he[1]),Me=$?Qp(he[he.length-2],he[0],he[1],$):0;Se=he[1].sub(he[0])._perp()._unit();let Ve=!0;for(let $e=1,Ke=0;$e<he.length;$e++){let tt=he[$e-1],ke=he[$e];const st=he[$e===he.length-1?1:$e+1];if(M&&R&&M.currentPolyCount.top++,wg(ke,tt,ce)){$&&(Se=st.sub(ke)._perp()._unit(),Ve=!Ve);continue}M&&M.append(ke,tt);const jt=ke.sub(tt)._perp(),pt=jt.x/(Math.abs(jt.x)+Math.abs(jt.y)),Et=jt.y>0?1:0,lt=tt.dist(ke);if(Ke+lt>32768&&(Ke=0),$){Fe=st.sub(ke)._perp()._unit();let pn=ly(tt,ke,st,sy(Se,Fe),$);isNaN(pn)&&(pn=0);const $t=ke.sub(tt)._unit();tt=tt.add($t.mult(Me))._round(),ke=ke.add($t.mult(-pn))._round(),Me=pn,Se=Fe}const Gt=me.vertexLength,yn=he.length>4&&uy(tt,ke,st);let mn=Tg(Ke,Xe,Ve);if(su(this.layoutVertexArray,tt.x,tt.y,pt,Et,0,0,mn),su(this.layoutVertexArray,tt.x,tt.y,pt,Et,0,1,mn),Ke+=lt,mn=Tg(Ke,yn,!Ve),Xe=yn,su(this.layoutVertexArray,ke.x,ke.y,pt,Et,0,0,mn),su(this.layoutVertexArray,ke.x,ke.y,pt,Et,0,1,mn),me.vertexLength+=4,this.indexArray.emplaceBack(Gt+0,Gt+1,Gt+2),this.indexArray.emplaceBack(Gt+1,Gt+3,Gt+2),me.primitiveLength+=2,$){const pn=ne+($e===1?he.length-2:$e-2),$t=$e===1?ne:pn+1;if(this.indexArray.emplaceBack(Gt+1,pn,Gt+3),this.indexArray.emplaceBack(pn,$t,Gt+3),me.primitiveLength+=2,Ae===void 0&&(Ae=Gt),!wg(st,he[$e],ce)){const Qn=$e===he.length-1?Ae:me.vertexLength;this.indexArray.emplaceBack(Gt+2,Gt+3,Qn),this.indexArray.emplaceBack(Gt+3,Qn+1,Qn),this.indexArray.emplaceBack(Gt+3,$t,Qn+1),me.primitiveLength+=3}Ve=!Ve}if(S){const pn=this.layoutVertexExtArray,$t=b.projectTilePoint(tt.x,tt.y,l),Qn=b.projectTilePoint(ke.x,ke.y,l),Jt=b.upVector(l,tt.x,tt.y),En=b.upVector(l,ke.x,ke.y);lu(pn,$t,Jt),lu(pn,$t,Jt),lu(pn,Qn,En),lu(pn,Qn,En)}}R&&(ne+=he.length-1)}}if(M&&M.polyCount.length>0){if(M.borders){M.vertexArrayOffset=this.centroidVertexArray.length;const te=M.borders,ce=this.featuresOnBorder.push(M)-1;for(let ne=0;ne<4;ne++)te[ne][0]!==Number.MAX_VALUE&&this.borders[ne].push(ce)}this.encodeCentroid(M.borders?void 0:M.centroid(),M)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,o,d,p,l)}sortBorders(){for(let e=0;e<4;e++)this.borders[e].sort((i,o)=>this.featuresOnBorder[i].borders[e][0]-this.featuresOnBorder[o].borders[e][0])}encodeCentroid(e,i,o=!0){let l,d;if(e)if(e.y!==0){const _=i.span()._mult(this.tileToMeter);l=(Math.max(e.x,1)<<3)+Math.min(7,Math.round(_.x/10)),d=(Math.max(e.y,1)<<3)+Math.min(7,Math.round(_.y/10))}else l=Math.ceil(7*(e.x+450)),d=0;else l=0,d=+o;let p=o?this.centroidVertexArray.length:i.vertexArrayOffset;for(const _ of i.polyCount){o&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*_.edges+_.top);for(let x=0;x<_.top;x++)this.centroidVertexArray.emplace(p++,l,d);for(let x=0;x<2*_.edges;x++)this.centroidVertexArray.emplace(p++,0,d),this.centroidVertexArray.emplace(p++,l,d)}}}function sy(n,e){const i=n.add(e)._unit();return n.x*i.x+n.y*i.y}function Qp(n,e,i,o){const l=e.sub(n)._perp()._unit(),d=i.sub(e)._perp()._unit();return ly(n,e,i,sy(l,d),o)}function ly(n,e,i,o,l){const d=Math.sqrt(1-o*o);return Math.min(n.dist(e)/3,e.dist(i)/3,l*d/o)}function wg(n,e,i){return n.x<i[0].x&&e.x<i[0].x||n.x>i[1].x&&e.x>i[1].x||n.y<i[0].y&&e.y<i[0].y||n.y>i[1].y&&e.y>i[1].y}function uy(n,e,i){if(n.x<0||n.x>=qt||e.x<0||e.x>=qt||i.x<0||i.x>=qt)return!1;const o=i.sub(e),l=o.perp(),d=n.sub(e);return(o.x*d.x+o.y*d.y)/Math.sqrt((o.x*o.x+o.y*o.y)*(d.x*d.x+d.y*d.y))>-.866&&l.x*d.x+l.y*d.y<0}function Tg(n,e,i){const o=e?2|n:-3&n;return i?1|o:-2&o}function Eg(){const n=Math.PI/32,e=Math.tan(n),i=Fp;return i*Math.sqrt(1+2*e*e)-i}function cy(n,e,i){const o=1<<i.z,l=ra(i.x/o),d=ra((i.x+1)/o),p=zr(i.y/o),_=zr((i.y+1)/o);return function(x,b,S,M,R=0,I){const L=[];if(!x.length||!S||!M)return L;const N=(he,Ae)=>{for(const Se of he)L.push({polygon:Se,bounds:Ae})},$=Math.ceil(Math.log2(S)),te=Math.ceil(Math.log2(M)),ce=$-te,ne=[];for(let he=0;he<Math.abs(ce);he++)ne.push(ce>0?0:1);for(let he=0;he<Math.min($,te);he++)ne.push(0),ne.push(1);let oe=x;if(oe=Jp(oe,b[0].y-R,b[1].y+R,1),oe=Jp(oe,b[0].x-R,b[1].x+R,0),!oe.length)return L;const me=[];for(ne.length?me.push({polygons:oe,bounds:b,depth:0}):N(oe,b);me.length;){const he=me.pop(),Ae=he.depth,Se=ne[Ae],Fe=he.bounds[0],Xe=he.bounds[1],Me=Se===0?Fe.x:Fe.y,Ve=Se===0?Xe.x:Xe.y,$e=I?I(Se,Me,Ve):.5*(Me+Ve),Ke=Jp(he.polygons,Me-R,$e+R,Se),tt=Jp(he.polygons,$e-R,Ve+R,Se);if(Ke.length){const ke=[Fe,new Ge(Se===0?$e:Xe.x,Se===1?$e:Xe.y)];ne.length>Ae+1?me.push({polygons:Ke,bounds:ke,depth:Ae+1}):N(Ke,ke)}if(tt.length){const ke=[new Ge(Se===0?$e:Fe.x,Se===1?$e:Fe.y),Xe];ne.length>Ae+1?me.push({polygons:tt,bounds:ke,depth:Ae+1}):N(tt,ke)}}return L}(n,e,Math.ceil((d-l)/11.25),Math.ceil((p-_)/11.25),1,(x,b,S)=>{if(x===0)return .5*(b+S);{const M=zr((i.y+b/qt)/o);return($s(.5*(zr((i.y+S/qt)/o)+M))*o-i.y)*qt}})}ft(pf,"FillExtrusionBucket",{omit:["layers","features"]}),ft(oy,"PartMetadata");const bx=new Pt({"fill-extrusion-edge-radius":new be(Ne["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var wx={paint:new Pt({"fill-extrusion-opacity":new be(Ne["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Re(Ne["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new be(Ne["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new be(Ne["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Re(Ne["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Re(Ne["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Re(Ne["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new be(Ne["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new be(Ne["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new be(Ne["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"])}),layout:bx};function hy(n,e,i){var o=2*Math.PI*6378137/256/Math.pow(2,i);return[n*o-2*Math.PI*6378137/2,e*o-2*Math.PI*6378137/2]}class em{constructor(e,i,o){this.z=e,this.x=i,this.y=o,this.key=mf(0,e,e,i,o)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,i){const o=function(d,p,_){var x=hy(256*d,256*(p=Math.pow(2,_)-p-1),_),b=hy(256*(d+1),256*(p+1),_);return x[0]+","+x[1]+","+b[0]+","+b[1]}(this.x,this.y,this.z),l=function(d,p,_){let x,b="";for(let S=d;S>0;S--)x=1<<S-1,b+=(p&x?1:0)+(_&x?2:0);return b}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(i==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",l).replace("{bbox-epsg-3857}",o)}toString(){return`${this.z}/${this.x}/${this.y}`}}class dy{constructor(e,i){this.wrap=e,this.canonical=i,this.key=mf(e,i.z,i.z,i.x,i.y)}}class $a{constructor(e,i,o,l,d){this.overscaledZ=e,this.wrap=i,this.canonical=new em(o,+l,+d),this.key=i===0&&e===o?this.canonical.key:mf(i,e,o,l,d)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const i=this.canonical.z-e;return e>this.canonical.z?new $a(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new $a(e,this.wrap,e,this.canonical.x>>i,this.canonical.y>>i)}calculateScaledKey(e,i=!0){if(this.overscaledZ===e&&i)return this.key;if(e>this.canonical.z)return mf(this.wrap*+i,e,this.canonical.z,this.canonical.x,this.canonical.y);{const o=this.canonical.z-e;return mf(this.wrap*+i,e,e,this.canonical.x>>o,this.canonical.y>>o)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const i=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>i&&e.canonical.y===this.canonical.y>>i}children(e){if(this.overscaledZ>=e)return[new $a(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const i=this.canonical.z+1,o=2*this.canonical.x,l=2*this.canonical.y;return[new $a(i,this.wrap,i,o,l),new $a(i,this.wrap,i,o+1,l),new $a(i,this.wrap,i,o,l+1),new $a(i,this.wrap,i,o+1,l+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new $a(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new $a(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new dy(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function mf(n,e,i,o,l){const d=1<<Math.min(i,22);let p=d*(l%d)+o%d;return n&&i<22&&(p+=d*d*((n<0?-2*n-1:2*n)%(1<<2*(22-i)))),16*(32*p+i)+(e-i)}ft(em,"CanonicalTileID"),ft($a,"OverscaledTileID",{omit:["projMatrix"]});class ld extends Ge{constructor(e,i,o){super(e,i),this.z=o}}function gf(n,e){return n.x*e.x+n.y*e.y}function So(n,e){if(n.length===1){let i=0;const o=e[i++];let l;for(;!l||o.equals(l);)if(l=e[i++],!l)return 1/0;for(;i<e.length;i++){const d=e[i],p=n[0],_=l.sub(o),x=d.sub(o),b=p.sub(o),S=gf(_,_),M=gf(_,x),R=gf(x,x),I=gf(b,_),L=gf(b,x),N=S*R-M*M,$=(R*I-M*L)/N,te=(S*L-M*I)/N,ce=o.z*(1-$-te)+l.z*$+d.z*te;if(isFinite(ce))return ce}return 1/0}{let i=1/0;for(const o of e)i=Math.min(i,o.z);return i}}function ud(n,e,i,o,l,d,p,_){const x=p*l.getElevationAt(n,e,!0,!0),b=d[0]!==0,S=b?d[1]===0?p*(d[0]/7-450):p*function(M,R,I){const L=Math.floor(R[0]/8),N=Math.floor(R[1]/8),$=10*(R[0]-8*L),te=10*(R[1]-8*N),ce=M.getElevationAt(L,N,!0,!0),ne=M.getMeterToDEM(I),oe=Math.floor(.5*($*ne-1)),me=Math.floor(.5*(te*ne-1)),he=M.tileCoordToPixel(L,N),Ae=2*oe+1,Se=2*me+1,Fe=function(tt,ke,st,jt,pt){return[tt.getElevationAtPixel(ke,st,!0),tt.getElevationAtPixel(ke+pt,st,!0),tt.getElevationAtPixel(ke,st+pt,!0),tt.getElevationAtPixel(ke+jt,st+pt,!0)]}(M,he.x-oe,he.y-me,Ae,Se),Xe=Math.abs(Fe[0]-Fe[1]),Me=Math.abs(Fe[2]-Fe[3]),Ve=Math.abs(Fe[0]-Fe[2])+Math.abs(Fe[1]-Fe[3]),$e=Math.min(.25,.5*ne*(Xe+Me)/Ae),Ke=Math.min(.25,.5*ne*Ve/Se);return ce+Math.max($e*$,Ke*te)}(l,d,_):x;return{base:x+(i===0)?-1:i,top:b?Math.max(S+o,x+i+2):x+o}}const fy=yt([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:Tx}=fy,py=yt([{name:"a_packed",components:4,type:"Float32"}]),{members:Ex}=py,Sx=ff.types,Cx=Math.cos(Math.PI/180*37.5);class _f{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(i=>{this.gradients[i.id]={}}),this.layoutVertexArray=new Va,this.layoutVertexArray2=new Qa,this.indexArray=new Wn,this.programConfigurations=new vi(e.layers,e.zoom),this.segments=new Dr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(e,i,o,l){this.hasPattern=Yp("line",this.layers,i);const d=this.layers[0].layout.get("line-sort-key"),p=[];for(const{feature:S,id:M,index:R,sourceLayerIndex:I}of e){const L=this.layers[0]._featureFilter.needGeometry,N=Wu(S,L);if(!this.layers[0]._featureFilter.filter(new ve(this.zoom),N,o))continue;const $=d?d.evaluate(N,{},o):void 0,te={id:M,properties:S.properties,type:S.type,sourceLayerIndex:I,index:R,geometry:L?N.geometry:tu(S,o,l),patterns:{},sortKey:$};p.push(te)}d&&p.sort((S,M)=>S.sortKey-M.sortKey);const{lineAtlas:_,featureIndex:x}=i,b=this.addConstantDashes(_);for(const S of p){const{geometry:M,index:R,sourceLayerIndex:I}=S;if(b&&this.addFeatureDashes(S,_),this.hasPattern){const L=df("line",this.layers,S,this.zoom,i);this.patternFeatures.push(L)}else this.addFeature(S,M,R,o,_.positions,i.availableImages);x.insert(e[R].feature,M,R,I,this.index)}}addConstantDashes(e){let i=!1;for(const o of this.layers){const l=o.paint.get("line-dasharray").value,d=o.layout.get("line-cap").value;if(l.kind!=="constant"||d.kind!=="constant")i=!0;else{const p=d.value,_=l.value;if(!_)continue;e.addDash(_,p)}}return i}addFeatureDashes(e,i){const o=this.zoom;for(const l of this.layers){const d=l.paint.get("line-dasharray").value,p=l.layout.get("line-cap").value;if(d.kind==="constant"&&p.kind==="constant")continue;let _,x;if(d.kind==="constant"){if(_=d.value,!_)continue}else _=d.evaluate({zoom:o},e);x=p.kind==="constant"?p.value:p.evaluate({zoom:o},e),i.addDash(_,x),e.patterns[l.id]=i.getKey(_,x)}}update(e,i,o,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,o,l)}addFeatures(e,i,o,l,d){for(const p of this.patternFeatures)this.addFeature(p,p.geometry,p.index,i,o,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Ex)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Tx),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,i,o,l,d,p){const _=this.layers[0].layout,x=_.get("line-join").evaluate(e,{}),b=_.get("line-cap").evaluate(e,{}),S=_.get("line-miter-limit"),M=_.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const R of i)this.addLine(R,e,x,b,S,M);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,o,d,p,l)}addLine(e,i,o,l,d,p){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let te=0;te<e.length-1;te++)this.totalDistance+=e[te].dist(e[te+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const _=Sx[i.type]==="Polygon";let x=e.length;for(;x>=2&&e[x-1].equals(e[x-2]);)x--;let b=0;for(;b<x-1&&e[b].equals(e[b+1]);)b++;if(x<(_?3:2))return;o==="bevel"&&(d=1.05);const S=this.overscaling<=16?122880/(512*this.overscaling):0,M=this.segments.prepareSegment(10*x,this.layoutVertexArray,this.indexArray);let R,I,L,N,$;this.e1=this.e2=-1,_&&(R=e[x-2],$=e[b].sub(R)._unit()._perp());for(let te=b;te<x;te++){if(L=te===x-1?_?e[b+1]:void 0:e[te+1],L&&e[te].equals(L))continue;$&&(N=$),R&&(I=R),R=e[te],$=L?L.sub(R)._unit()._perp():N,N=N||$;let ce=N.add($);ce.x===0&&ce.y===0||ce._unit();const ne=N.x*$.x+N.y*$.y,oe=ce.x*$.x+ce.y*$.y,me=oe!==0?1/oe:1/0,he=2*Math.sqrt(2-2*oe),Ae=oe<Cx&&I&&L,Se=N.x*$.y-N.y*$.x>0;if(Ae&&te>b){const Me=R.dist(I);if(Me>2*S){const Ve=R.sub(R.sub(I)._mult(S/Me)._round());this.updateDistance(I,Ve),this.addCurrentVertex(Ve,N,0,0,M),I=Ve}}const Fe=I&&L;let Xe=Fe?o:_?"butt":l;if(Fe&&Xe==="round"&&(me<p?Xe="miter":me<=2&&(Xe="fakeround")),Xe==="miter"&&me>d&&(Xe="bevel"),Xe==="bevel"&&(me>2&&(Xe="flipbevel"),me<d&&(Xe="miter")),I&&this.updateDistance(I,R),Xe==="miter")ce._mult(me),this.addCurrentVertex(R,ce,0,0,M);else if(Xe==="flipbevel"){if(me>100)ce=$.mult(-1);else{const Me=me*N.add($).mag()/N.sub($).mag();ce._perp()._mult(Me*(Se?-1:1))}this.addCurrentVertex(R,ce,0,0,M),this.addCurrentVertex(R,ce.mult(-1),0,0,M)}else if(Xe==="bevel"||Xe==="fakeround"){const Me=-Math.sqrt(me*me-1),Ve=Se?Me:0,$e=Se?0:Me;if(I&&this.addCurrentVertex(R,N,Ve,$e,M),Xe==="fakeround"){const Ke=Math.round(180*he/Math.PI/20);for(let tt=1;tt<Ke;tt++){let ke=tt/Ke;if(ke!==.5){const jt=ke-.5;ke+=ke*jt*(ke-1)*((1.0904+ne*(ne*(3.55645-1.43519*ne)-3.2452))*jt*jt+(.848013+ne*(.215638*ne-1.06021)))}const st=$.sub(N)._mult(ke)._add(N)._unit()._mult(Se?-1:1);this.addHalfVertex(R,st.x,st.y,!1,Se,0,M)}}L&&this.addCurrentVertex(R,$,-Ve,-$e,M)}else if(Xe==="butt")this.addCurrentVertex(R,ce,0,0,M);else if(Xe==="square"){const Me=I?1:-1;I||this.addCurrentVertex(R,ce,Me,Me,M),this.addCurrentVertex(R,ce,0,0,M),I&&this.addCurrentVertex(R,ce,Me,Me,M)}else Xe==="round"&&(I&&(this.addCurrentVertex(R,N,0,0,M),this.addCurrentVertex(R,N,1,1,M,!0)),L&&(this.addCurrentVertex(R,$,-1,-1,M,!0),this.addCurrentVertex(R,$,0,0,M)));if(Ae&&te<x-1){const Me=R.dist(L);if(Me>2*S){const Ve=R.add(L.sub(R)._mult(S/Me)._round());this.updateDistance(R,Ve),this.addCurrentVertex(Ve,$,0,0,M),R=Ve}}}}addCurrentVertex(e,i,o,l,d,p=!1){const _=i.y*l-i.x,x=-i.y-i.x*l;this.addHalfVertex(e,i.x+i.y*o,i.y-i.x*o,p,!1,o,d),this.addHalfVertex(e,_,x,p,!0,-l,d)}addHalfVertex({x:e,y:i},o,l,d,p,_,x){this.layoutVertexArray.emplaceBack((e<<1)+(d?1:0),(i<<1)+(p?1:0),Math.round(63*o)+128,Math.round(63*l)+128,1+(_===0?0:_<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const b=x.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,b),x.primitiveLength++),p?this.e2=b:this.e1=b}updateScaledDistance(){if(this.lineClips){const e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,i){this.distance+=e.dist(i),this.updateScaledDistance()}}ft(_f,"LineBucket",{omit:["layers","patternFeatures"]});const my=new Pt({"line-cap":new Re(Ne.layout_line["line-cap"]),"line-join":new Re(Ne.layout_line["line-join"]),"line-miter-limit":new be(Ne.layout_line["line-miter-limit"]),"line-round-limit":new be(Ne.layout_line["line-round-limit"]),"line-sort-key":new Re(Ne.layout_line["line-sort-key"])});var gy={paint:new Pt({"line-opacity":new Re(Ne.paint_line["line-opacity"]),"line-color":new Re(Ne.paint_line["line-color"]),"line-translate":new be(Ne.paint_line["line-translate"]),"line-translate-anchor":new be(Ne.paint_line["line-translate-anchor"]),"line-width":new Re(Ne.paint_line["line-width"]),"line-gap-width":new Re(Ne.paint_line["line-gap-width"]),"line-offset":new Re(Ne.paint_line["line-offset"]),"line-blur":new Re(Ne.paint_line["line-blur"]),"line-dasharray":new Re(Ne.paint_line["line-dasharray"]),"line-pattern":new Re(Ne.paint_line["line-pattern"]),"line-gradient":new wt(Ne.paint_line["line-gradient"]),"line-trim-offset":new be(Ne.paint_line["line-trim-offset"])}),layout:my};const _y=new class extends Re{possiblyEvaluate(n,e){return e=new ve(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,transition:e.transition}),super.possiblyEvaluate(n,e)}evaluate(n,e,i,o){return e=Kn({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(n,e,i,o)}}(gy.paint.properties["line-width"].specification);function Sg(n,e){return e>0?e+2*n:n}_y.useIntegerZoom=!0;const Cg=yt([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Mx=yt([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),Ax=yt([{name:"a_projected_pos",components:4,type:"Float32"}],4);yt([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Rx=yt([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),Dx=yt([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);yt([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const yy=yt([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),zx=yt([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);yt([{name:"triangle",components:3,type:"Uint16"}]),yt([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),yt([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),yt([{type:"Float32",name:"offsetX"}]),yt([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var br=24;const _s=128;function oh(n,e){const{expression:i}=e;if(i.kind==="constant")return{kind:"constant",layoutSize:i.evaluate(new ve(n+1))};if(i.kind==="source")return{kind:"source"};{const{zoomStops:o,interpolationType:l}=i;let d=0;for(;d<o.length&&o[d]<=n;)d++;d=Math.max(0,d-1);let p=d;for(;p<o.length&&o[p]<n+1;)p++;p=Math.min(o.length-1,p);const _=o[d],x=o[p];return i.kind==="composite"?{kind:"composite",minZoom:_,maxZoom:x,interpolationType:l}:{kind:"camera",minZoom:_,maxZoom:x,minSize:i.evaluate(new ve(_)),maxSize:i.evaluate(new ve(x)),interpolationType:l}}}function cd(n,{uSize:e,uSizeT:i},{lowerSize:o,upperSize:l}){return n.kind==="source"?o/_s:n.kind==="composite"?Bn(o/_s,l/_s,i):e}function hd(n,e){let i=0,o=0;if(n.kind==="constant")o=n.layoutSize;else if(n.kind!=="source"){const{interpolationType:l,minZoom:d,maxZoom:p}=n,_=l?Ut(os.interpolationFactor(l,e,d,p),0,1):0;n.kind==="camera"?o=Bn(n.minSize,n.maxSize,_):i=_}return{uSizeT:i,uSize:o}}var Ix=Object.freeze({__proto__:null,getSizeData:oh,evaluateSizeForFeature:cd,evaluateSizeForZoom:hd,SIZE_PACK_FACTOR:_s});function vy(n,e,i){return n.sections.forEach(o=>{o.text=function(l,d,p){const _=d.layout.get("text-transform").evaluate(p,{});return _==="uppercase"?l=l.toLocaleUpperCase():_==="lowercase"&&(l=l.toLocaleLowerCase()),we.applyArabicShaping&&(l=we.applyArabicShaping(l)),l}(o.text,e,i)}),n}const yf={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};function tm(n){return n==="︶"||n==="﹈"||n==="︸"||n==="﹄"||n==="﹂"||n==="︾"||n==="︼"||n==="︺"||n==="︘"||n==="﹀"||n==="︐"||n==="︓"||n==="︔"||n==="｀"||n==="￣"||n==="︑"||n==="︒"}function dd(n){return n==="︵"||n==="﹇"||n==="︷"||n==="﹃"||n==="﹁"||n==="︽"||n==="︻"||n==="︹"||n==="︗"||n==="︿"}var sh=xi,Mg=function(n,e,i,o,l){var d,p,_=8*l-o-1,x=(1<<_)-1,b=x>>1,S=-7,M=i?l-1:0,R=i?-1:1,I=n[e+M];for(M+=R,d=I&(1<<-S)-1,I>>=-S,S+=_;S>0;d=256*d+n[e+M],M+=R,S-=8);for(p=d&(1<<-S)-1,d>>=-S,S+=o;S>0;p=256*p+n[e+M],M+=R,S-=8);if(d===0)d=1-b;else{if(d===x)return p?NaN:1/0*(I?-1:1);p+=Math.pow(2,o),d-=b}return(I?-1:1)*p*Math.pow(2,d-o)},vf=function(n,e,i,o,l,d){var p,_,x,b=8*d-l-1,S=(1<<b)-1,M=S>>1,R=l===23?Math.pow(2,-24)-Math.pow(2,-77):0,I=o?0:d-1,L=o?1:-1,N=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(_=isNaN(e)?1:0,p=S):(p=Math.floor(Math.log(e)/Math.LN2),e*(x=Math.pow(2,-p))<1&&(p--,x*=2),(e+=p+M>=1?R/x:R*Math.pow(2,1-M))*x>=2&&(p++,x/=2),p+M>=S?(_=0,p=S):p+M>=1?(_=(e*x-1)*Math.pow(2,l),p+=M):(_=e*Math.pow(2,M-1)*Math.pow(2,l),p=0));l>=8;n[i+I]=255&_,I+=L,_/=256,l-=8);for(p=p<<l|_,b+=l;b>0;n[i+I]=255&p,I+=L,p/=256,b-=8);n[i+I-L]|=128*N};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function xi(n){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(n)?n:new Uint8Array(n||0),this.pos=0,this.type=0,this.length=this.buf.length}xi.Varint=0,xi.Fixed64=1,xi.Bytes=2,xi.Fixed32=5;var nm=4294967296,Ag=1/nm,Rg=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function bl(n){return n.type===xi.Bytes?n.readVarint()+n.pos:n.pos+1}function lh(n,e,i){return i?4294967296*e+(n>>>0):4294967296*(e>>>0)+(n>>>0)}function uu(n,e,i){var o=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));i.realloc(o);for(var l=i.pos-1;l>=n;l--)i.buf[l+o]=i.buf[l]}function kx(n,e){for(var i=0;i<n.length;i++)e.writeVarint(n[i])}function Lx(n,e){for(var i=0;i<n.length;i++)e.writeSVarint(n[i])}function Ox(n,e){for(var i=0;i<n.length;i++)e.writeFloat(n[i])}function xf(n,e){for(var i=0;i<n.length;i++)e.writeDouble(n[i])}function Dg(n,e){for(var i=0;i<n.length;i++)e.writeBoolean(n[i])}function xy(n,e){for(var i=0;i<n.length;i++)e.writeFixed32(n[i])}function Px(n,e){for(var i=0;i<n.length;i++)e.writeSFixed32(n[i])}function by(n,e){for(var i=0;i<n.length;i++)e.writeFixed64(n[i])}function Bx(n,e){for(var i=0;i<n.length;i++)e.writeSFixed64(n[i])}function Gi(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16)+16777216*n[e+3]}function Qu(n,e,i){n[i]=e,n[i+1]=e>>>8,n[i+2]=e>>>16,n[i+3]=e>>>24}function bf(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16)+(n[e+3]<<24)}function wf(n,e,i){e.glyphs=[],n===1&&i.readMessage(wy,e)}function wy(n,e,i){if(n===3){const{id:o,bitmap:l,width:d,height:p,left:_,top:x,advance:b}=i.readMessage(Ty,{});e.glyphs.push({id:o,bitmap:new vl({width:d+6,height:p+6},l),metrics:{width:d,height:p,left:_,top:x,advance:b}})}else n===4?e.ascender=i.readSVarint():n===5&&(e.descender=i.readSVarint())}function Ty(n,e,i){n===1?e.id=i.readVarint():n===2?e.bitmap=i.readBytes():n===3?e.width=i.readVarint():n===4?e.height=i.readVarint():n===5?e.left=i.readSVarint():n===6?e.top=i.readSVarint():n===7&&(e.advance=i.readVarint())}function Tf(n){let e=0,i=0;for(const p of n)e+=p.w*p.h,i=Math.max(i,p.w);n.sort((p,_)=>_.h-p.h);const o=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),i),h:1/0}];let l=0,d=0;for(const p of n)for(let _=o.length-1;_>=0;_--){const x=o[_];if(!(p.w>x.w||p.h>x.h)){if(p.x=x.x,p.y=x.y,d=Math.max(d,p.y+p.h),l=Math.max(l,p.x+p.w),p.w===x.w&&p.h===x.h){const b=o.pop();_<o.length&&(o[_]=b)}else p.h===x.h?(x.x+=p.w,x.w-=p.w):p.w===x.w?(x.y+=p.h,x.h-=p.h):(o.push({x:x.x+p.w,y:x.y,w:x.w-p.w,h:p.h}),x.y+=p.h,x.h-=p.h);break}}return{w:l,h:d,fill:e/(l*d)||0}}xi.prototype={destroy:function(){this.buf=null},readFields:function(n,e,i){for(i=i||this.length;this.pos<i;){var o=this.readVarint(),l=o>>3,d=this.pos;this.type=7&o,n(l,e,this),this.pos===d&&this.skip(o)}return e},readMessage:function(n,e){return this.readFields(n,e,this.readVarint()+this.pos)},readFixed32:function(){var n=Gi(this.buf,this.pos);return this.pos+=4,n},readSFixed32:function(){var n=bf(this.buf,this.pos);return this.pos+=4,n},readFixed64:function(){var n=Gi(this.buf,this.pos)+Gi(this.buf,this.pos+4)*nm;return this.pos+=8,n},readSFixed64:function(){var n=Gi(this.buf,this.pos)+bf(this.buf,this.pos+4)*nm;return this.pos+=8,n},readFloat:function(){var n=Mg(this.buf,this.pos,!0,23,4);return this.pos+=4,n},readDouble:function(){var n=Mg(this.buf,this.pos,!0,52,8);return this.pos+=8,n},readVarint:function(n){var e,i,o=this.buf;return e=127&(i=o[this.pos++]),i<128?e:(e|=(127&(i=o[this.pos++]))<<7,i<128?e:(e|=(127&(i=o[this.pos++]))<<14,i<128?e:(e|=(127&(i=o[this.pos++]))<<21,i<128?e:function(l,d,p){var _,x,b=p.buf;if(_=(112&(x=b[p.pos++]))>>4,x<128||(_|=(127&(x=b[p.pos++]))<<3,x<128)||(_|=(127&(x=b[p.pos++]))<<10,x<128)||(_|=(127&(x=b[p.pos++]))<<17,x<128)||(_|=(127&(x=b[p.pos++]))<<24,x<128)||(_|=(1&(x=b[p.pos++]))<<31,x<128))return lh(l,_,d);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(i=o[this.pos]))<<28,n,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var n=this.readVarint();return n%2==1?(n+1)/-2:n/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var n=this.readVarint()+this.pos,e=this.pos;return this.pos=n,n-e>=12&&Rg?function(i,o,l){return Rg.decode(i.subarray(o,l))}(this.buf,e,n):function(i,o,l){for(var d="",p=o;p<l;){var _,x,b,S=i[p],M=null,R=S>239?4:S>223?3:S>191?2:1;if(p+R>l)break;R===1?S<128&&(M=S):R===2?(192&(_=i[p+1]))==128&&(M=(31&S)<<6|63&_)<=127&&(M=null):R===3?(x=i[p+2],(192&(_=i[p+1]))==128&&(192&x)==128&&((M=(15&S)<<12|(63&_)<<6|63&x)<=2047||M>=55296&&M<=57343)&&(M=null)):R===4&&(x=i[p+2],b=i[p+3],(192&(_=i[p+1]))==128&&(192&x)==128&&(192&b)==128&&((M=(15&S)<<18|(63&_)<<12|(63&x)<<6|63&b)<=65535||M>=1114112)&&(M=null)),M===null?(M=65533,R=1):M>65535&&(M-=65536,d+=String.fromCharCode(M>>>10&1023|55296),M=56320|1023&M),d+=String.fromCharCode(M),p+=R}return d}(this.buf,e,n)},readBytes:function(){var n=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,n);return this.pos=n,e},readPackedVarint:function(n,e){if(this.type!==xi.Bytes)return n.push(this.readVarint(e));var i=bl(this);for(n=n||[];this.pos<i;)n.push(this.readVarint(e));return n},readPackedSVarint:function(n){if(this.type!==xi.Bytes)return n.push(this.readSVarint());var e=bl(this);for(n=n||[];this.pos<e;)n.push(this.readSVarint());return n},readPackedBoolean:function(n){if(this.type!==xi.Bytes)return n.push(this.readBoolean());var e=bl(this);for(n=n||[];this.pos<e;)n.push(this.readBoolean());return n},readPackedFloat:function(n){if(this.type!==xi.Bytes)return n.push(this.readFloat());var e=bl(this);for(n=n||[];this.pos<e;)n.push(this.readFloat());return n},readPackedDouble:function(n){if(this.type!==xi.Bytes)return n.push(this.readDouble());var e=bl(this);for(n=n||[];this.pos<e;)n.push(this.readDouble());return n},readPackedFixed32:function(n){if(this.type!==xi.Bytes)return n.push(this.readFixed32());var e=bl(this);for(n=n||[];this.pos<e;)n.push(this.readFixed32());return n},readPackedSFixed32:function(n){if(this.type!==xi.Bytes)return n.push(this.readSFixed32());var e=bl(this);for(n=n||[];this.pos<e;)n.push(this.readSFixed32());return n},readPackedFixed64:function(n){if(this.type!==xi.Bytes)return n.push(this.readFixed64());var e=bl(this);for(n=n||[];this.pos<e;)n.push(this.readFixed64());return n},readPackedSFixed64:function(n){if(this.type!==xi.Bytes)return n.push(this.readSFixed64());var e=bl(this);for(n=n||[];this.pos<e;)n.push(this.readSFixed64());return n},skip:function(n){var e=7&n;if(e===xi.Varint)for(;this.buf[this.pos++]>127;);else if(e===xi.Bytes)this.pos=this.readVarint()+this.pos;else if(e===xi.Fixed32)this.pos+=4;else{if(e!==xi.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(n,e){this.writeVarint(n<<3|e)},realloc:function(n){for(var e=this.length||16;e<this.pos+n;)e*=2;if(e!==this.length){var i=new Uint8Array(e);i.set(this.buf),this.buf=i,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(n){this.realloc(4),Qu(this.buf,n,this.pos),this.pos+=4},writeSFixed32:function(n){this.realloc(4),Qu(this.buf,n,this.pos),this.pos+=4},writeFixed64:function(n){this.realloc(8),Qu(this.buf,-1&n,this.pos),Qu(this.buf,Math.floor(n*Ag),this.pos+4),this.pos+=8},writeSFixed64:function(n){this.realloc(8),Qu(this.buf,-1&n,this.pos),Qu(this.buf,Math.floor(n*Ag),this.pos+4),this.pos+=8},writeVarint:function(n){(n=+n||0)>268435455||n<0?function(e,i){var o,l;if(e>=0?(o=e%4294967296|0,l=e/4294967296|0):(l=~(-e/4294967296),4294967295^(o=~(-e%4294967296))?o=o+1|0:(o=0,l=l+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),function(d,p,_){_.buf[_.pos++]=127&d|128,d>>>=7,_.buf[_.pos++]=127&d|128,d>>>=7,_.buf[_.pos++]=127&d|128,d>>>=7,_.buf[_.pos++]=127&d|128,_.buf[_.pos]=127&(d>>>=7)}(o,0,i),function(d,p){var _=(7&d)<<4;p.buf[p.pos++]|=_|((d>>>=3)?128:0),d&&(p.buf[p.pos++]=127&d|((d>>>=7)?128:0),d&&(p.buf[p.pos++]=127&d|((d>>>=7)?128:0),d&&(p.buf[p.pos++]=127&d|((d>>>=7)?128:0),d&&(p.buf[p.pos++]=127&d|((d>>>=7)?128:0),d&&(p.buf[p.pos++]=127&d)))))}(l,i)}(n,this):(this.realloc(4),this.buf[this.pos++]=127&n|(n>127?128:0),n<=127||(this.buf[this.pos++]=127&(n>>>=7)|(n>127?128:0),n<=127||(this.buf[this.pos++]=127&(n>>>=7)|(n>127?128:0),n<=127||(this.buf[this.pos++]=n>>>7&127))))},writeSVarint:function(n){this.writeVarint(n<0?2*-n-1:2*n)},writeBoolean:function(n){this.writeVarint(Boolean(n))},writeString:function(n){n=String(n),this.realloc(4*n.length),this.pos++;var e=this.pos;this.pos=function(o,l,d){for(var p,_,x=0;x<l.length;x++){if((p=l.charCodeAt(x))>55295&&p<57344){if(!_){p>56319||x+1===l.length?(o[d++]=239,o[d++]=191,o[d++]=189):_=p;continue}if(p<56320){o[d++]=239,o[d++]=191,o[d++]=189,_=p;continue}p=_-55296<<10|p-56320|65536,_=null}else _&&(o[d++]=239,o[d++]=191,o[d++]=189,_=null);p<128?o[d++]=p:(p<2048?o[d++]=p>>6|192:(p<65536?o[d++]=p>>12|224:(o[d++]=p>>18|240,o[d++]=p>>12&63|128),o[d++]=p>>6&63|128),o[d++]=63&p|128)}return d}(this.buf,n,this.pos);var i=this.pos-e;i>=128&&uu(e,i,this),this.pos=e-1,this.writeVarint(i),this.pos+=i},writeFloat:function(n){this.realloc(4),vf(this.buf,n,this.pos,!0,23,4),this.pos+=4},writeDouble:function(n){this.realloc(8),vf(this.buf,n,this.pos,!0,52,8),this.pos+=8},writeBytes:function(n){var e=n.length;this.writeVarint(e),this.realloc(e);for(var i=0;i<e;i++)this.buf[this.pos++]=n[i]},writeRawMessage:function(n,e){this.pos++;var i=this.pos;n(e,this);var o=this.pos-i;o>=128&&uu(i,o,this),this.pos=i-1,this.writeVarint(o),this.pos+=o},writeMessage:function(n,e,i){this.writeTag(n,xi.Bytes),this.writeRawMessage(e,i)},writePackedVarint:function(n,e){e.length&&this.writeMessage(n,kx,e)},writePackedSVarint:function(n,e){e.length&&this.writeMessage(n,Lx,e)},writePackedBoolean:function(n,e){e.length&&this.writeMessage(n,Dg,e)},writePackedFloat:function(n,e){e.length&&this.writeMessage(n,Ox,e)},writePackedDouble:function(n,e){e.length&&this.writeMessage(n,xf,e)},writePackedFixed32:function(n,e){e.length&&this.writeMessage(n,xy,e)},writePackedSFixed32:function(n,e){e.length&&this.writeMessage(n,Px,e)},writePackedFixed64:function(n,e){e.length&&this.writeMessage(n,by,e)},writePackedSFixed64:function(n,e){e.length&&this.writeMessage(n,Bx,e)},writeBytesField:function(n,e){this.writeTag(n,xi.Bytes),this.writeBytes(e)},writeFixed32Field:function(n,e){this.writeTag(n,xi.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(n,e){this.writeTag(n,xi.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(n,e){this.writeTag(n,xi.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(n,e){this.writeTag(n,xi.Fixed64),this.writeSFixed64(e)},writeVarintField:function(n,e){this.writeTag(n,xi.Varint),this.writeVarint(e)},writeSVarintField:function(n,e){this.writeTag(n,xi.Varint),this.writeSVarint(e)},writeStringField:function(n,e){this.writeTag(n,xi.Bytes),this.writeString(e)},writeFloatField:function(n,e){this.writeTag(n,xi.Fixed32),this.writeFloat(e)},writeDoubleField:function(n,e){this.writeTag(n,xi.Fixed64),this.writeDouble(e)},writeBooleanField:function(n,e){this.writeVarintField(n,Boolean(e))}};class uh{constructor(e,{pixelRatio:i,version:o,stretchX:l,stretchY:d,content:p}){this.paddedRect=e,this.pixelRatio=i,this.stretchX=l,this.stretchY=d,this.content=p,this.version=o}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Ey{constructor(e,i){const o={},l={};this.haveRenderCallbacks=[];const d=[];this.addImages(e,o,d),this.addImages(i,l,d);const{w:p,h:_}=Tf(d),x=new Ki({width:p||1,height:_||1});for(const b in e){const S=e[b],M=o[b].paddedRect;Ki.copy(S.data,x,{x:0,y:0},{x:M.x+1,y:M.y+1},S.data)}for(const b in i){const S=i[b],M=l[b].paddedRect,R=M.x+1,I=M.y+1,L=S.data.width,N=S.data.height;Ki.copy(S.data,x,{x:0,y:0},{x:R,y:I},S.data),Ki.copy(S.data,x,{x:0,y:N-1},{x:R,y:I-1},{width:L,height:1}),Ki.copy(S.data,x,{x:0,y:0},{x:R,y:I+N},{width:L,height:1}),Ki.copy(S.data,x,{x:L-1,y:0},{x:R-1,y:I},{width:1,height:N}),Ki.copy(S.data,x,{x:0,y:0},{x:R+L,y:I},{width:1,height:N})}this.image=x,this.iconPositions=o,this.patternPositions=l}addImages(e,i,o){for(const l in e){const d=e[l],p={x:0,y:0,w:d.data.width+2,h:d.data.height+2};o.push(p),i[l]=new uh(p,d),d.hasRenderCallback&&this.haveRenderCallbacks.push(l)}}patchUpdatedImages(e,i){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(o=>e.hasImage(o)),e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const o in e.updatedImages)this.patchUpdatedImage(this.iconPositions[o],e.getImage(o),i),this.patchUpdatedImage(this.patternPositions[o],e.getImage(o),i)}patchUpdatedImage(e,i,o){if(!e||!i||e.version===i.version)return;e.version=i.version;const[l,d]=e.tl;o.update(i.data,void 0,{x:l,y:d})}}ft(uh,"ImagePosition"),ft(Ey,"ImageAtlas");const qa={horizontal:1,vertical:2,horizontalOnly:3};class wl{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,i){const o=new wl;return o.scale=e||1,o.fontStack=i,o}static forImage(e){const i=new wl;return i.imageName=e,i}}class fd{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,i){const o=new fd;for(let l=0;l<e.sections.length;l++){const d=e.sections[l];d.image?o.addImageSection(d):o.addTextSection(d,i)}return o}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(e){this.text=function(i,o){let l="";for(let d=0;d<i.length;d++){const p=i.charCodeAt(d+1)||null,_=i.charCodeAt(d-1)||null;l+=!o&&(p&&D(p)&&!yf[i[d+1]]||_&&D(_)&&!yf[i[d-1]])||!yf[i[d]]?i[d]:yf[i[d]]}return l}(this.text,e)}trim(){let e=0;for(let o=0;o<this.text.length&&rm[this.text.charCodeAt(o)];o++)e++;let i=this.text.length;for(let o=this.text.length-1;o>=0&&o>=e&&rm[this.text.charCodeAt(o)];o--)i--;this.text=this.text.substring(e,i),this.sectionIndex=this.sectionIndex.slice(e,i)}substring(e,i){const o=new fd;return o.text=this.text.substring(e,i),o.sectionIndex=this.sectionIndex.slice(e,i),o.sections=this.sections,o}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,i)=>Math.max(e,this.sections[i].scale),0)}addTextSection(e,i){this.text+=e.text,this.sections.push(wl.forText(e.scale,e.fontStack||i));const o=this.sections.length-1;for(let l=0;l<e.text.length;++l)this.sectionIndex.push(o)}addImageSection(e){const i=e.image?e.image.name:"";if(i.length===0)return void Vn("Can't add FormattedSection with an empty image.");const o=this.getNextImageSectionCharCode();o?(this.text+=String.fromCharCode(o),this.sections.push(wl.forImage(i)),this.sectionIndex.push(this.sections.length-1)):Vn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function im(n,e,i,o,l,d,p,_,x,b,S,M,R,I,L){const N=fd.fromFeature(n,l);M===qa.vertical&&N.verticalizePunctuation(R);let $=[];const te=function(he,Ae,Se,Fe,Xe,Me){if(!he)return[];const Ve=[],$e=function(st,jt,pt,Et,lt,Gt){let yn=0;for(let mn=0;mn<st.length();mn++){const pn=st.getSection(mn);yn+=eo(st.getCharCode(mn),pn,Et,lt,jt,Gt)}return yn/Math.max(1,Math.ceil(yn/pt))}(he,Ae,Se,Fe,Xe,Me),Ke=he.text.indexOf("​")>=0;let tt=0;for(let st=0;st<he.length();st++){const jt=he.getSection(st),pt=he.getCharCode(st);if(rm[pt]||(tt+=eo(pt,jt,Fe,Xe,Ae,Me)),st<he.length()-1){const Et=!((ke=pt)<11904||!(Uo(ke)||Uh(ke)||s(ke)||ju(ke)||Vu(ke)||Wl(ke)||qc(ke)||Yl(ke)||Jl(ke)||No(ke)||Vh(ke)||y(ke)||Kl(ke)||$c(ke)||ia(ke)||Nh(ke)||cs(ke)||r(ke)||gl(ke)||Ep(ke)));(Fx[pt]||Et||jt.imageName)&&Ve.push(cu(st+1,tt,$e,Ve,am(pt,he.getCharCode(st+1),Et&&Ke),!1))}}var ke;return zg(cu(he.length(),tt,$e,Ve,0,!0))}(N,b,d,e,o,I),{processBidirectionalText:ce,processStyledBidirectionalText:ne}=we;if(ce&&N.sections.length===1){const he=ce(N.toString(),te);for(const Ae of he){const Se=new fd;Se.text=Ae,Se.sections=N.sections;for(let Fe=0;Fe<Ae.length;Fe++)Se.sectionIndex.push(0);$.push(Se)}}else if(ne){const he=ne(N.text,N.sectionIndex,te);for(const Ae of he){const Se=new fd;Se.text=Ae[0],Se.sectionIndex=Ae[1],Se.sections=N.sections,$.push(Se)}}else $=function(he,Ae){const Se=[],Fe=he.text;let Xe=0;for(const Me of Ae)Se.push(he.substring(Xe,Me)),Xe=Me;return Xe<Fe.length&&Se.push(he.substring(Xe,Fe.length)),Se}(N,te);const oe=[],me={positionedLines:oe,text:N.toString(),top:S[1],bottom:S[1],left:S[0],right:S[0],writingMode:M,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(he,Ae,Se,Fe,Xe,Me,Ve,$e,Ke,tt,ke,st){let jt=0,pt=0,Et=0;const lt=$e==="right"?1:$e==="left"?0:.5;let Gt=!1;for(const Jt of Xe){const En=Jt.getSections();for(const fi of En){if(fi.imageName)continue;const ki=Ae[fi.fontStack];if(ki&&(Gt=ki.ascender!==void 0&&ki.descender!==void 0,!Gt))break}if(!Gt)break}let yn=0;for(const Jt of Xe){Jt.trim();const En=Jt.getMaxScale(),fi=(En-1)*br,ki={positionedGlyphs:[],lineOffset:0};he.positionedLines[yn]=ki;const bi=ki.positionedGlyphs;let pi=0;if(!Jt.length()){pt+=Me,++yn;continue}let Fi=0,Ji=0;for(let ti=0;ti<Jt.length();ti++){const $n=Jt.getSection(ti),nr=Jt.getSectionIndex(ti),qn=Jt.getCharCode(ti);let Zi=$n.scale,Fr=null,An=null,pr=null,wr=br,Tr=0;const Er=!(Ke===qa.horizontal||!ke&&!z(qn)||ke&&(rm[qn]||(mn=qn,Nu(mn)||Tp(mn)||Wd(mn)||h(mn)||g(mn))));if($n.imageName){const Zr=Fe[$n.imageName];if(!Zr)continue;pr=$n.imageName,he.iconsInText=he.iconsInText||!0,An=Zr.paddedRect;const Sr=Zr.displaySize;Zi=Zi*br/st,Fr={width:Sr[0],height:Sr[1],left:1,top:-3,advance:Er?Sr[1]:Sr[0],localGlyph:!1},Tr=Gt?-Fr.height*Zi:En*br-17-Sr[1]*Zi,wr=Fr.advance;const Xo=(Er?Sr[0]:Sr[1])*Zi-br*En;Xo>0&&Xo>pi&&(pi=Xo)}else{const Zr=Se[$n.fontStack];if(!Zr)continue;Zr[qn]&&(An=Zr[qn]);const Sr=Ae[$n.fontStack];if(!Sr)continue;const Xo=Sr.glyphs[qn];if(!Xo)continue;if(Fr=Xo.metrics,wr=qn!==8203?br:0,Gt){const Ml=Sr.ascender!==void 0?Math.abs(Sr.ascender):0,Ys=Sr.descender!==void 0?Math.abs(Sr.descender):0,pc=(Ml+Ys)*Zi;Fi<pc&&(Fi=pc,Ji=(Ml-Ys)/2*Zi),Tr=-Ml*Zi}else Tr=(En-Zi)*br-17}Er?(he.verticalizable=!0,bi.push({glyph:qn,imageName:pr,x:jt,y:pt+Tr,vertical:Er,scale:Zi,localGlyph:Fr.localGlyph,fontStack:$n.fontStack,sectionIndex:nr,metrics:Fr,rect:An}),jt+=wr*Zi+tt):(bi.push({glyph:qn,imageName:pr,x:jt,y:pt+Tr,vertical:Er,scale:Zi,localGlyph:Fr.localGlyph,fontStack:$n.fontStack,sectionIndex:nr,metrics:Fr,rect:An}),jt+=Fr.advance*Zi+tt)}bi.length!==0&&(Et=Math.max(jt-tt,Et),Gt?ec(bi,lt,pi,Ji,Me*En/2):ec(bi,lt,pi,0,Me/2)),jt=0;const fr=Me*En+pi;ki.lineOffset=Math.max(pi,fi),pt+=fr,++yn}var mn;const pn=pt,{horizontalAlign:$t,verticalAlign:Qn}=hu(Ve);(function(Jt,En,fi,ki,bi,pi){const Fi=(En-fi)*bi,Ji=-pi*ki;for(const fr of Jt)for(const ti of fr.positionedGlyphs)ti.x+=Fi,ti.y+=Ji})(he.positionedLines,lt,$t,Qn,Et,pn),he.top+=-Qn*pn,he.bottom=he.top+pn,he.left+=-$t*Et,he.right=he.left+Et,he.hasBaseline=Gt}(me,e,i,o,$,p,_,x,M,b,R,L),!function(he){for(const Ae of he)if(Ae.positionedGlyphs.length!==0)return!1;return!0}(oe)&&me}const rm={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Fx={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function eo(n,e,i,o,l,d){if(e.imageName){const p=o[e.imageName];return p?p.displaySize[0]*e.scale*br/d+l:0}{const p=i[e.fontStack],_=p&&p.glyphs[n];return _?_.metrics.advance*e.scale+l:0}}function pd(n,e,i,o){const l=Math.pow(n-e,2);return o?n<e?l/2:2*l:l+Math.abs(i)*i}function am(n,e,i){let o=0;return n===10&&(o-=1e4),i&&(o+=150),n!==40&&n!==65288||(o+=50),e!==41&&e!==65289||(o+=50),o}function cu(n,e,i,o,l,d){let p=null,_=pd(e,i,l,d);for(const x of o){const b=pd(e-x.x,i,l,d)+x.badness;b<=_&&(p=x,_=b)}return{index:n,x:e,priorBreak:p,badness:_}}function zg(n){return n?zg(n.priorBreak).concat(n.index):[]}function hu(n){let e=.5,i=.5;switch(n){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(n){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:e,verticalAlign:i}}function ec(n,e,i,o,l){if(!(e||i||o||l))return;const d=n.length-1,p=n[d],_=(p.x+p.metrics.advance*p.scale)*e;for(let x=0;x<=d;x++)n[x].x-=_,n[x].y+=i+o+l}function om(n,e,i){const{horizontalAlign:o,verticalAlign:l}=hu(i),d=e[0]-n.displaySize[0]*o,p=e[1]-n.displaySize[1]*l;return{image:n,top:p,bottom:p+n.displaySize[1],left:d,right:d+n.displaySize[0]}}function sm(n,e,i,o,l,d){const p=n.image;let _;if(p.content){const $=p.content,te=p.pixelRatio||1;_=[$[0]/te,$[1]/te,p.displaySize[0]-$[2]/te,p.displaySize[1]-$[3]/te]}const x=e.left*d,b=e.right*d;let S,M,R,I;i==="width"||i==="both"?(I=l[0]+x-o[3],M=l[0]+b+o[1]):(I=l[0]+(x+b-p.displaySize[0])/2,M=I+p.displaySize[0]);const L=e.top*d,N=e.bottom*d;return i==="height"||i==="both"?(S=l[1]+L-o[0],R=l[1]+N+o[2]):(S=l[1]+(L+N-p.displaySize[1])/2,R=S+p.displaySize[1]),{image:p,top:S,right:M,bottom:R,left:I,collisionPadding:_}}class ys extends Ge{constructor(e,i,o,l,d){super(e,i),this.angle=l,this.z=o,d!==void 0&&(this.segment=d)}clone(){return new ys(this.x,this.y,this.z,this.angle,this.segment)}}function md(n,e,i,o,l){if(e.segment===void 0)return!0;let d=e,p=e.segment+1,_=0;for(;_>-i/2;){if(p--,p<0)return!1;_-=n[p].dist(d),d=n[p]}_+=n[p].dist(n[p+1]),p++;const x=[];let b=0;for(;_<i/2;){const S=n[p],M=n[p+1];if(!M)return!1;let R=n[p-1].angleTo(S)-S.angleTo(M);for(R=Math.abs((R+3*Math.PI)%(2*Math.PI)-Math.PI),x.push({distance:_,angleDelta:R}),b+=R;_-x[0].distance>o;)b-=x.shift().angleDelta;if(b>l)return!1;p++,_+=S.dist(M)}return!0}function Ig(n){let e=0;for(let i=0;i<n.length-1;i++)e+=n[i].dist(n[i+1]);return e}function Ef(n,e,i){return n?.6*e*i:0}function kg(n,e){return Math.max(n?n.right-n.left:0,e?e.right-e.left:0)}function Sy(n,e,i,o,l,d){const p=Ef(i,l,d),_=kg(i,o)*d;let x=0;const b=Ig(n)/2;for(let S=0;S<n.length-1;S++){const M=n[S],R=n[S+1],I=M.dist(R);if(x+I>b){const L=(b-x)/I,N=Bn(M.x,R.x,L),$=Bn(M.y,R.y,L),te=new ys(N,$,0,R.angleTo(M),S);return!p||md(n,te,_,p,e)?te:void 0}x+=I}}function Ux(n,e,i,o,l,d,p,_,x){const b=Ef(o,d,p),S=kg(o,l),M=S*p,R=n[0].x===0||n[0].x===x||n[0].y===0||n[0].y===x;return e-M<e/4&&(e=M+e/4),Cy(n,R?e/2*_%e:(S/2+2*d)*p*_%e,e,b,i,M,R,!1,x)}function Cy(n,e,i,o,l,d,p,_,x){const b=d/2,S=Ig(n);let M=0,R=e-i,I=[];for(let L=0;L<n.length-1;L++){const N=n[L],$=n[L+1],te=N.dist($),ce=$.angleTo(N);for(;R+i<M+te;){R+=i;const ne=(R-M)/te,oe=Bn(N.x,$.x,ne),me=Bn(N.y,$.y,ne);if(oe>=0&&oe<x&&me>=0&&me<x&&R-b>=0&&R+b<=S){const he=new ys(oe,me,0,ce,L);he._round(),o&&!md(n,he,d,o,l)||I.push(he)}}M+=te}return _||I.length||p||(I=Cy(n,M/2,i,o,l,d,p,!0,x)),I}function Sf(n,e,i,o,l){const d=[];for(let p=0;p<n.length;p++){const _=n[p];let x;for(let b=0;b<_.length-1;b++){let S=_[b],M=_[b+1];S.x<e&&M.x<e||(S.x<e?S=new Ge(e,S.y+(e-S.x)/(M.x-S.x)*(M.y-S.y))._round():M.x<e&&(M=new Ge(e,S.y+(e-S.x)/(M.x-S.x)*(M.y-S.y))._round()),S.y<i&&M.y<i||(S.y<i?S=new Ge(S.x+(i-S.y)/(M.y-S.y)*(M.x-S.x),i)._round():M.y<i&&(M=new Ge(S.x+(i-S.y)/(M.y-S.y)*(M.x-S.x),i)._round()),S.x>=o&&M.x>=o||(S.x>=o?S=new Ge(o,S.y+(o-S.x)/(M.x-S.x)*(M.y-S.y))._round():M.x>=o&&(M=new Ge(o,S.y+(o-S.x)/(M.x-S.x)*(M.y-S.y))._round()),S.y>=l&&M.y>=l||(S.y>=l?S=new Ge(S.x+(l-S.y)/(M.y-S.y)*(M.x-S.x),l)._round():M.y>=l&&(M=new Ge(S.x+(l-S.y)/(M.y-S.y)*(M.x-S.x),l)._round()),x&&S.equals(x[x.length-1])||(x=[S],d.push(x)),x.push(M)))))}}return d}ft(ys,"Anchor");const tc=1e20;function Lg(n,e,i,o,l,d,p,_,x){for(let b=e;b<e+o;b++)My(n,i*d+b,d,l,p,_,x);for(let b=i;b<i+l;b++)My(n,b*d+e,1,o,p,_,x)}function My(n,e,i,o,l,d,p){d[0]=0,p[0]=-tc,p[1]=tc,l[0]=n[e];for(let _=1,x=0,b=0;_<o;_++){l[_]=n[e+_*i];const S=_*_;do{const M=d[x];b=(l[_]-l[M]+S-M*M)/(_-M)/2}while(b<=p[x]&&--x>-1);x++,d[x]=_,p[x]=b,p[x+1]=tc}for(let _=0,x=0;_<o;_++){for(;p[x+1]<_;)x++;const b=d[x],S=_-b;n[e+_*i]=l[b]+S*S}}const gd={none:0,ideographs:1,all:2};class _d{constructor(e,i,o){this.requestManager=e,this.localGlyphMode=i,this.localFontFamily=o,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e){this.url=e}getGlyphs(e,i){const o=[];for(const l in e)for(const d of e[l])o.push({stack:l,id:d});Xi(o,({stack:l,id:d},p)=>{let _=this.entries[l];_||(_=this.entries[l]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let x=_.glyphs[d];if(x!==void 0)return void p(null,{stack:l,id:d,glyph:x});if(x=this._tinySDF(_,l,d),x)return _.glyphs[d]=x,void p(null,{stack:l,id:d,glyph:x});const b=Math.floor(d/256);if(256*b>65535)return void p(new Error("glyphs > 65535 not supported"));if(_.ranges[b])return void p(null,{stack:l,id:d,glyph:x});let S=_.requests[b];S||(S=_.requests[b]=[],_d.loadGlyphRange(l,b,this.url,this.requestManager,(M,R)=>{if(R){_.ascender=R.ascender,_.descender=R.descender;for(const I in R.glyphs)this._doesCharSupportLocalGlyph(+I)||(_.glyphs[+I]=R.glyphs[+I]);_.ranges[b]=!0}for(const I of S)I(M,R);delete _.requests[b]})),S.push((M,R)=>{M?p(M):R&&p(null,{stack:l,id:d,glyph:R.glyphs[d]||null})})},(l,d)=>{if(l)i(l);else if(d){const p={};for(const{stack:_,id:x,glyph:b}of d)p[_]===void 0&&(p[_]={}),p[_].glyphs===void 0&&(p[_].glyphs={}),p[_].glyphs[x]=b&&{id:b.id,bitmap:b.bitmap.clone(),metrics:b.metrics},p[_].ascender=this.entries[_].ascender,p[_].descender=this.entries[_].descender;i(null,p)}})}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==gd.none&&(this.localGlyphMode===gd.all?!!this.localFontFamily:!!this.localFontFamily&&(No(e)||jh(e)||Kl(e)||cs(e)||Yl(e)))}_tinySDF(e,i,o){const l=this.localFontFamily;if(!l||!this._doesCharSupportLocalGlyph(o))return;let d=e.tinySDF;if(!d){let N="400";/bold/i.test(i)?N="900":/medium/i.test(i)?N="500":/light/i.test(i)&&(N="200"),d=e.tinySDF=new _d.TinySDF({fontFamily:l,fontWeight:N,fontSize:48,buffer:6,radius:16}),d.fontWeight=N}if(this.localGlyphs[d.fontWeight][o])return this.localGlyphs[d.fontWeight][o];const p=String.fromCharCode(o),{data:_,width:x,height:b,glyphWidth:S,glyphHeight:M,glyphLeft:R,glyphTop:I,glyphAdvance:L}=d.draw(p);return this.localGlyphs[d.fontWeight][o]={id:o,bitmap:new vl({width:x,height:b},_),metrics:{width:S/2,height:M/2,left:R/2,top:I/2-27,advance:L/2,localGlyph:!0}}}}function Ay(n,e,i,o){const l=[],d=n.image,p=d.pixelRatio,_=d.paddedRect.w-2,x=d.paddedRect.h-2,b=n.right-n.left,S=n.bottom-n.top,M=d.stretchX||[[0,_]],R=d.stretchY||[[0,x]],I=(Me,Ve)=>Me+Ve[1]-Ve[0],L=M.reduce(I,0),N=R.reduce(I,0),$=_-L,te=x-N;let ce=0,ne=L,oe=0,me=N,he=0,Ae=$,Se=0,Fe=te;if(d.content&&o){const Me=d.content;ce=lm(M,0,Me[0]),oe=lm(R,0,Me[1]),ne=lm(M,Me[0],Me[2]),me=lm(R,Me[1],Me[3]),he=Me[0]-ce,Se=Me[1]-oe,Ae=Me[2]-Me[0]-ne,Fe=Me[3]-Me[1]-me}const Xe=(Me,Ve,$e,Ke)=>{const tt=um(Me.stretch-ce,ne,b,n.left),ke=cm(Me.fixed-he,Ae,Me.stretch,L),st=um(Ve.stretch-oe,me,S,n.top),jt=cm(Ve.fixed-Se,Fe,Ve.stretch,N),pt=um($e.stretch-ce,ne,b,n.left),Et=cm($e.fixed-he,Ae,$e.stretch,L),lt=um(Ke.stretch-oe,me,S,n.top),Gt=cm(Ke.fixed-Se,Fe,Ke.stretch,N),yn=new Ge(tt,st),mn=new Ge(pt,st),pn=new Ge(pt,lt),$t=new Ge(tt,lt),Qn=new Ge(ke/p,jt/p),Jt=new Ge(Et/p,Gt/p),En=e*Math.PI/180;if(En){const bi=Math.sin(En),pi=Math.cos(En),Fi=[pi,-bi,bi,pi];yn._matMult(Fi),mn._matMult(Fi),$t._matMult(Fi),pn._matMult(Fi)}const fi=Me.stretch+Me.fixed,ki=Ve.stretch+Ve.fixed;return{tl:yn,tr:mn,bl:$t,br:pn,tex:{x:d.paddedRect.x+1+fi,y:d.paddedRect.y+1+ki,w:$e.stretch+$e.fixed-fi,h:Ke.stretch+Ke.fixed-ki},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Qn,pixelOffsetBR:Jt,minFontScaleX:Ae/p/b,minFontScaleY:Fe/p/S,isSDF:i}};if(o&&(d.stretchX||d.stretchY)){const Me=Ry(M,$,L),Ve=Ry(R,te,N);for(let $e=0;$e<Me.length-1;$e++){const Ke=Me[$e],tt=Me[$e+1];for(let ke=0;ke<Ve.length-1;ke++)l.push(Xe(Ke,Ve[ke],tt,Ve[ke+1]))}}else l.push(Xe({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:_+1},{fixed:0,stretch:x+1}));return l}function lm(n,e,i){let o=0;for(const l of n)o+=Math.max(e,Math.min(i,l[1]))-Math.max(e,Math.min(i,l[0]));return o}function Ry(n,e,i){const o=[{fixed:-1,stretch:0}];for(const[l,d]of n){const p=o[o.length-1];o.push({fixed:l-p.stretch,stretch:p.stretch}),o.push({fixed:l-p.stretch,stretch:p.stretch+(d-l)})}return o.push({fixed:e+1,stretch:i}),o}function um(n,e,i,o){return n/e*i+o}function cm(n,e,i,o){return n-e*i/o}function Nx(n,e,i,o){const l=e+n.positionedLines[o].lineOffset;return o===0?i+l/2:i+(l+(e+n.positionedLines[o-1].lineOffset))/2}_d.loadGlyphRange=function(n,e,i,o,l){const d=256*e,p=d+255,_=o.transformRequest(o.normalizeGlyphsURL(i).replace("{fontstack}",n).replace("{range}",`${d}-${p}`),_r.Glyphs);Pn(_,(x,b)=>{if(x)l(x);else if(b){const S={},M=function(R){return new sh(R).readFields(wf,{})}(b);for(const R of M.glyphs)S[R.id]=R;l(null,{glyphs:S,ascender:M.ascender,descender:M.descender})}})},_d.TinySDF=class{constructor({fontSize:n=24,buffer:e=3,radius:i=8,cutoff:o=.25,fontFamily:l="sans-serif",fontWeight:d="normal",fontStyle:p="normal"}={}){this.buffer=e,this.cutoff=o,this.radius=i;const _=this.size=n+4*e,x=this._createCanvas(_),b=this.ctx=x.getContext("2d",{willReadFrequently:!0});b.font=`${p} ${d} ${n}px ${l}`,b.textBaseline="alphabetic",b.textAlign="left",b.fillStyle="black",this.gridOuter=new Float64Array(_*_),this.gridInner=new Float64Array(_*_),this.f=new Float64Array(_),this.z=new Float64Array(_+1),this.v=new Uint16Array(_)}_createCanvas(n){const e=document.createElement("canvas");return e.width=e.height=n,e}draw(n){const{width:e,actualBoundingBoxAscent:i,actualBoundingBoxDescent:o,actualBoundingBoxLeft:l,actualBoundingBoxRight:d}=this.ctx.measureText(n),p=Math.ceil(i),_=Math.min(this.size-this.buffer,Math.ceil(d-l)),x=Math.min(this.size-this.buffer,p+Math.ceil(o)),b=_+2*this.buffer,S=x+2*this.buffer,M=Math.max(b*S,0),R=new Uint8ClampedArray(M),I={data:R,width:b,height:S,glyphWidth:_,glyphHeight:x,glyphTop:p,glyphLeft:0,glyphAdvance:e};if(_===0||x===0)return I;const{ctx:L,buffer:N,gridInner:$,gridOuter:te}=this;L.clearRect(N,N,_,x),L.fillText(n,N,N+p);const ce=L.getImageData(N,N,_,x);te.fill(tc,0,M),$.fill(0,0,M);for(let ne=0;ne<x;ne++)for(let oe=0;oe<_;oe++){const me=ce.data[4*(ne*_+oe)+3]/255;if(me===0)continue;const he=(ne+N)*b+oe+N;if(me===1)te[he]=0,$[he]=tc;else{const Ae=.5-me;te[he]=Ae>0?Ae*Ae:0,$[he]=Ae<0?Ae*Ae:0}}Lg(te,0,0,b,S,b,this.f,this.v,this.z),Lg($,N,N,_,x,b,this.f,this.v,this.z);for(let ne=0;ne<M;ne++){const oe=Math.sqrt(te[ne])-Math.sqrt($[ne]);R[ne]=Math.round(255-255*(oe/this.radius+this.cutoff))}return I}};class Vx{constructor(e=[],i=jx){if(this.data=e,this.length=this.data.length,this.compare=i,this.length>0)for(let o=(this.length>>1)-1;o>=0;o--)this._down(o)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],i=this.data.pop();return this.length--,this.length>0&&(this.data[0]=i,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:i,compare:o}=this,l=i[e];for(;e>0;){const d=e-1>>1,p=i[d];if(o(l,p)>=0)break;i[e]=p,e=d}i[e]=l}_down(e){const{data:i,compare:o}=this,l=this.length>>1,d=i[e];for(;e<l;){let p=1+(e<<1),_=i[p];const x=p+1;if(x<this.length&&o(i[x],_)<0&&(p=x,_=i[x]),o(_,d)>=0)break;i[e]=_,e=p}i[e]=d}}function jx(n,e){return n<e?-1:n>e?1:0}function Gx(n,e=1,i=!1){let o=1/0,l=1/0,d=-1/0,p=-1/0;const _=n[0];for(let I=0;I<_.length;I++){const L=_[I];(!I||L.x<o)&&(o=L.x),(!I||L.y<l)&&(l=L.y),(!I||L.x>d)&&(d=L.x),(!I||L.y>p)&&(p=L.y)}const x=Math.min(d-o,p-l);let b=x/2;const S=new Vx([],Og);if(x===0)return new Ge(o,l);for(let I=o;I<d;I+=x)for(let L=l;L<p;L+=x)S.push(new nc(I+b,L+b,b,n));let M=function(I){let L=0,N=0,$=0;const te=I[0];for(let ce=0,ne=te.length,oe=ne-1;ce<ne;oe=ce++){const me=te[ce],he=te[oe],Ae=me.x*he.y-he.x*me.y;N+=(me.x+he.x)*Ae,$+=(me.y+he.y)*Ae,L+=3*Ae}return new nc(N/L,$/L,0,I)}(n),R=S.length;for(;S.length;){const I=S.pop();(I.d>M.d||!M.d)&&(M=I,i&&console.log("found best %d after %d probes",Math.round(1e4*I.d)/1e4,R)),I.max-M.d<=e||(b=I.h/2,S.push(new nc(I.p.x-b,I.p.y-b,b,n)),S.push(new nc(I.p.x+b,I.p.y-b,b,n)),S.push(new nc(I.p.x-b,I.p.y+b,b,n)),S.push(new nc(I.p.x+b,I.p.y+b,b,n)),R+=4)}return i&&(console.log(`num probes: ${R}`),console.log(`best distance: ${M.d}`)),M.p}function Og(n,e){return e.max-n.max}function nc(n,e,i,o){this.p=new Ge(n,e),this.h=i,this.d=function(l,d){let p=!1,_=1/0;for(let x=0;x<d.length;x++){const b=d[x];for(let S=0,M=b.length,R=M-1;S<M;R=S++){const I=b[S],L=b[R];I.y>l.y!=L.y>l.y&&l.x<(L.x-I.x)*(l.y-I.y)/(L.y-I.y)+I.x&&(p=!p),_=Math.min(_,Wh(l,I,L))}}return(p?1:-1)*Math.sqrt(_)}(this.p,o),this.max=this.d+this.h*Math.SQRT2}const Cf=Number.POSITIVE_INFINITY,Pg=Math.sqrt(2);function Dy(n,[e,i]){let o=0,l=0;if(i===Cf){e<0&&(e=0);const d=e/Pg;switch(n){case"top-right":case"top-left":l=d-7;break;case"bottom-right":case"bottom-left":l=7-d;break;case"bottom":l=7-e;break;case"top":l=e-7}switch(n){case"top-right":case"bottom-right":o=-d;break;case"top-left":case"bottom-left":o=d;break;case"left":o=e;break;case"right":o=-e}}else{switch(e=Math.abs(e),i=Math.abs(i),n){case"top-right":case"top-left":case"top":l=i-7;break;case"bottom-right":case"bottom-left":case"bottom":l=7-i}switch(n){case"top-right":case"bottom-right":case"right":o=-e;break;case"top-left":case"bottom-left":case"left":o=e}}return[o,l]}function Mf(n,e,i,o,l,d,p,_,x,b){n.createArrays(),n.tilePixelRatio=qt/(512*n.overscaling),n.compareText={},n.iconsNeedLinear=!1;const S=n.layers[0].layout,M=n.layers[0]._unevaluatedLayout._values,R={};if(n.textSizeData.kind==="composite"){const{minZoom:N,maxZoom:$}=n.textSizeData;R.compositeTextSizes=[M["text-size"].possiblyEvaluate(new ve(N),_),M["text-size"].possiblyEvaluate(new ve($),_)]}if(n.iconSizeData.kind==="composite"){const{minZoom:N,maxZoom:$}=n.iconSizeData;R.compositeIconSizes=[M["icon-size"].possiblyEvaluate(new ve(N),_),M["icon-size"].possiblyEvaluate(new ve($),_)]}R.layoutTextSize=M["text-size"].possiblyEvaluate(new ve(x+1),_),R.layoutIconSize=M["icon-size"].possiblyEvaluate(new ve(x+1),_),R.textMaxSize=M["text-size"].possiblyEvaluate(new ve(18),_);const I=S.get("text-rotation-alignment")==="map"&&S.get("symbol-placement")!=="point",L=S.get("text-size");for(const N of n.features){const $=S.get("text-font").evaluate(N,{},_).join(","),te=L.evaluate(N,{},_),ce=R.layoutTextSize.evaluate(N,{},_),ne=(R.layoutIconSize.evaluate(N,{},_),{horizontal:{},vertical:void 0}),oe=N.text;let me,he=[0,0];if(oe){const Fe=oe.toString(),Xe=S.get("text-letter-spacing").evaluate(N,{},_)*br,Me=S.get("text-line-height").evaluate(N,{},_)*br,Ve=E(Fe)?Xe:0,$e=S.get("text-anchor").evaluate(N,{},_),Ke=S.get("text-variable-anchor");if(!Ke){const pt=S.get("text-radial-offset").evaluate(N,{},_);he=pt?Dy($e,[pt*br,Cf]):S.get("text-offset").evaluate(N,{},_).map(Et=>Et*br)}let tt=I?"center":S.get("text-justify").evaluate(N,{},_);const ke=S.get("symbol-placement")==="point",st=ke?S.get("text-max-width").evaluate(N,{},_)*br:1/0,jt=pt=>{n.allowVerticalPlacement&&w(Fe)&&(ne.vertical=im(oe,e,i,l,$,st,Me,$e,pt,Ve,he,qa.vertical,!0,ce,te))};if(!I&&Ke){const pt=tt==="auto"?Ke.map(lt=>ch(lt)):[tt];let Et=!1;for(let lt=0;lt<pt.length;lt++){const Gt=pt[lt];if(!ne.horizontal[Gt])if(Et)ne.horizontal[Gt]=ne.horizontal[0];else{const yn=im(oe,e,i,l,$,st,Me,"center",Gt,Ve,he,qa.horizontal,!1,ce,te);yn&&(ne.horizontal[Gt]=yn,Et=yn.positionedLines.length===1)}}jt("left")}else{if(tt==="auto"&&(tt=ch($e)),ke||S.get("text-writing-mode").indexOf("horizontal")>=0||!w(Fe)){const pt=im(oe,e,i,l,$,st,Me,$e,tt,Ve,he,qa.horizontal,!1,ce,te);pt&&(ne.horizontal[tt]=pt)}jt(ke?"left":tt)}}let Ae=!1;if(N.icon&&N.icon.name){const Fe=o[N.icon.name];Fe&&(me=om(l[N.icon.name],S.get("icon-offset").evaluate(N,{},_),S.get("icon-anchor").evaluate(N,{},_)),Ae=Fe.sdf,n.sdfIcons===void 0?n.sdfIcons=Fe.sdf:n.sdfIcons!==Fe.sdf&&Vn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Fe.pixelRatio!==n.pixelRatio||S.get("icon-rotate").constantOr(1)!==0)&&(n.iconsNeedLinear=!0))}const Se=Iy(ne.horizontal)||ne.vertical;n.iconsInText||(n.iconsInText=!!Se&&Se.iconsInText),(Se||me)&&$x(n,N,ne,me,o,R,ce,0,he,Ae,p,_,b)}d&&n.generateCollisionDebugBuffers(x,n.collisionBoxArray)}function ch(n){switch(n){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function $x(n,e,i,o,l,d,p,_,x,b,S,M,R){let I=d.textMaxSize.evaluate(e,{},M);I===void 0&&(I=p);const L=n.layers[0].layout,N=L.get("icon-offset").evaluate(e,{},M),$=Iy(i.horizontal)||i.vertical,te=R.name==="globe",ce=p/24,ne=n.tilePixelRatio*I/24,oe=(Ve=n.overscaling,n.zoom>18&&Ve>2&&(Ve>>=1),Math.max(qt/(512*Ve),1)*L.get("symbol-spacing")),me=L.get("text-padding")*n.tilePixelRatio,he=L.get("icon-padding")*n.tilePixelRatio,Ae=Wt(L.get("text-max-angle")),Se=L.get("text-rotation-alignment")==="map"&&L.get("symbol-placement")!=="point",Fe=L.get("icon-rotation-alignment")==="map"&&L.get("symbol-placement")!=="point",Xe=L.get("symbol-placement"),Me=oe/2;var Ve;const $e=L.get("icon-text-fit");let Ke;o&&$e!=="none"&&(n.allowVerticalPlacement&&i.vertical&&(Ke=sm(o,i.vertical,$e,L.get("icon-text-fit-padding"),N,ce)),$&&(o=sm(o,$,$e,L.get("icon-text-fit-padding"),N,ce)));const tt=(ke,st,jt)=>{if(st.x<0||st.x>=qt||st.y<0||st.y>=qt)return;let pt=null;if(te){const{x:Et,y:lt,z:Gt}=R.projectTilePoint(st.x,st.y,jt);pt={anchor:new ys(Et,lt,Gt,0,void 0),up:R.upVector(jt,st.x,st.y)}}(function(Et,lt,Gt,yn,mn,pn,$t,Qn,Jt,En,fi,ki,bi,pi,Fi,Ji,fr,ti,$n,nr,qn,Zi,Fr,An,pr){const wr=Et.addToLineVertexArray(lt,yn);let Tr,Er,Zr,Sr,Xo,Ml,Ys,pc=0,n_=0,Ss=0,vm=0,qf=-1,Sd=-1;const no={};let xm=Hu.exports("");const Al=Gt?Gt.anchor:lt;let Cd=0,bm=0;if(Jt._unevaluatedLayout.getValue("text-radial-offset")===void 0?[Cd,bm]=Jt.layout.get("text-offset").evaluate(qn,{},pr).map(Xa=>Xa*br):(Cd=Jt.layout.get("text-radial-offset").evaluate(qn,{},pr)*br,bm=Cf),Et.allowVerticalPlacement&&mn.vertical){const Xa=mn.vertical;if(Fi)Ml=Bg(Xa),Qn&&(Ys=Bg(Qn));else{const Mo=Jt.layout.get("text-rotate").evaluate(qn,{},pr)+90;Zr=Af(En,Al,lt,fi,ki,bi,Xa,pi,Mo,Ji),Qn&&(Sr=Af(En,Al,lt,fi,ki,bi,Qn,ti,Mo))}}if(pn){const Xa=Jt.layout.get("icon-rotate").evaluate(qn,{},pr),Mo=Jt.layout.get("icon-text-fit")!=="none",Hf=Ay(pn,Xa,Fr,Mo),mc=Qn?Ay(Qn,Xa,Fr,Mo):void 0;Er=Af(En,Al,lt,fi,ki,bi,pn,ti,Xa),pc=4*Hf.length;const Ur=Et.iconSizeData;let Wo=null;Ur.kind==="source"?(Wo=[_s*Jt.layout.get("icon-size").evaluate(qn,{},pr)],Wo[0]>du&&Vn(`${Et.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):Ur.kind==="composite"&&(Wo=[_s*Zi.compositeIconSizes[0].evaluate(qn,{},pr),_s*Zi.compositeIconSizes[1].evaluate(qn,{},pr)],(Wo[0]>du||Wo[1]>du)&&Vn(`${Et.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Et.addSymbols(Et.icon,Hf,Wo,nr,$n,qn,!1,Gt,lt,wr.lineStartIndex,wr.lineLength,-1,An,pr),qf=Et.icon.placedSymbolArray.length-1,mc&&(n_=4*mc.length,Et.addSymbols(Et.icon,mc,Wo,nr,$n,qn,qa.vertical,Gt,lt,wr.lineStartIndex,wr.lineLength,-1,An,pr),Sd=Et.icon.placedSymbolArray.length-1)}for(const Xa in mn.horizontal){const Mo=mn.horizontal[Xa];Tr||(xm=Hu.exports(Mo.text),Fi?Xo=Bg(Mo):Tr=Af(En,Al,lt,fi,ki,bi,Mo,pi,Jt.layout.get("text-rotate").evaluate(qn,{},pr),Ji));const Hf=Mo.positionedLines.length===1;if(Ss+=zy(Et,Gt,lt,Mo,$t,Jt,Fi,qn,Ji,wr,mn.vertical?qa.horizontal:qa.horizontalOnly,Hf?Object.keys(mn.horizontal):[Xa],no,qf,Zi,An,pr),Hf)break}mn.vertical&&(vm+=zy(Et,Gt,lt,mn.vertical,$t,Jt,Fi,qn,Ji,wr,qa.vertical,["vertical"],no,Sd,Zi,An,pr));let gu=-1;const wm=(Xa,Mo)=>Xa?Math.max(Xa,Mo):Mo;gu=wm(Xo,gu),gu=wm(Ml,gu),gu=wm(Ys,gu);const i_=gu>-1?1:0;Et.glyphOffsetArray.length>=sc.MAX_GLYPHS&&Vn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),qn.sortKey!==void 0&&Et.addToSortKeyRanges(Et.symbolInstances.length,qn.sortKey),Et.symbolInstances.emplaceBack(Al.x,Al.y,Al.z,lt.x,lt.y,no.right>=0?no.right:-1,no.center>=0?no.center:-1,no.left>=0?no.left:-1,no.vertical>=0?no.vertical:-1,qf,Sd,xm,Tr!==void 0?Tr:Et.collisionBoxArray.length,Tr!==void 0?Tr+1:Et.collisionBoxArray.length,Zr!==void 0?Zr:Et.collisionBoxArray.length,Zr!==void 0?Zr+1:Et.collisionBoxArray.length,Er!==void 0?Er:Et.collisionBoxArray.length,Er!==void 0?Er+1:Et.collisionBoxArray.length,Sr||Et.collisionBoxArray.length,Sr?Sr+1:Et.collisionBoxArray.length,fi,Ss,vm,pc,n_,i_,0,Cd,bm,gu)})(n,st,pt,ke,i,o,l,Ke,n.layers[0],n.collisionBoxArray,e.index,e.sourceLayerIndex,n.index,me,Se,x,0,he,Fe,N,e,d,b,S,M)};if(Xe==="line")for(const ke of Sf(e.geometry,0,0,qt,qt)){const st=Ux(ke,oe,Ae,i.vertical||$,o,24,ne,n.overscaling,qt);for(const jt of st){const pt=$;pt&&qx(n,pt.text,Me,jt)||tt(ke,jt,M)}}else if(Xe==="line-center"){for(const ke of e.geometry)if(ke.length>1){const st=Sy(ke,Ae,i.vertical||$,o,24,ne);st&&tt(ke,st,M)}}else if(e.type==="Polygon")for(const ke of xg(e.geometry,0)){const st=Gx(ke,16);tt(ke[0],new ys(st.x,st.y,0,0,void 0),M)}else if(e.type==="LineString")for(const ke of e.geometry)tt(ke,new ys(ke[0].x,ke[0].y,0,0,void 0),M);else if(e.type==="Point")for(const ke of e.geometry)for(const st of ke)tt([st],new ys(st.x,st.y,0,0,void 0),M)}const du=32640;function zy(n,e,i,o,l,d,p,_,x,b,S,M,R,I,L,N,$){const te=function(oe,me,he,Ae,Se,Fe,Xe,Me){const Ve=[];if(me.positionedLines.length===0)return Ve;const $e=Ae.layout.get("text-rotate").evaluate(Fe,{})*Math.PI/180,Ke=function(pt){const Et=pt[0],lt=pt[1],Gt=Et*lt;return Gt>0?[Et,-lt]:Gt<0?[-Et,lt]:Et===0?[lt,Et]:[lt,-Et]}(he);let tt=Math.abs(me.top-me.bottom);for(const pt of me.positionedLines)tt-=pt.lineOffset;const ke=me.positionedLines.length,st=tt/ke;let jt=me.top-he[1];for(let pt=0;pt<ke;++pt){const Et=me.positionedLines[pt];jt=Nx(me,st,jt,pt);for(const lt of Et.positionedGlyphs){if(!lt.rect)continue;const Gt=lt.rect||{};let yn=4,mn=!0,pn=1,$t=0;if(lt.imageName){const An=Xe[lt.imageName];if(!An)continue;if(An.sdf){Vn("SDF images are not supported in formatted text and will be ignored.");continue}mn=!1,pn=An.pixelRatio,yn=1/pn}const Qn=(Se||Me)&&lt.vertical,Jt=lt.metrics.advance*lt.scale/2,En=lt.metrics,fi=lt.rect;if(fi===null)continue;Me&&me.verticalizable&&($t=lt.imageName?Jt-lt.metrics.width*lt.scale/2:0);const ki=Se?[lt.x+Jt,lt.y]:[0,0];let bi=[0,0],pi=[0,0],Fi=!1;Se||(Qn?(pi=[lt.x+Jt+Ke[0],lt.y+Ke[1]-$t],Fi=!0):bi=[lt.x+Jt+he[0],lt.y+he[1]-$t]);const Ji=fi.w*lt.scale/(pn*(lt.localGlyph?2:1)),fr=fi.h*lt.scale/(pn*(lt.localGlyph?2:1));let ti,$n,nr,qn;if(Qn){const An=lt.y-jt,pr=new Ge(-Jt,Jt-An),wr=-Math.PI/2,Tr=new Ge(...pi);ti=new Ge(-Jt+bi[0],bi[1]),ti._rotateAround(wr,pr)._add(Tr),ti.x+=-An+Jt,ti.y-=(En.left-yn)*lt.scale;const Er=lt.imageName?En.advance*lt.scale:br*lt.scale,Zr=String.fromCharCode(lt.glyph);tm(Zr)?ti.x+=(1-yn)*lt.scale:dd(Zr)?ti.x+=Er-En.height*lt.scale+(-yn-1)*lt.scale:ti.x+=lt.imageName||En.width+2*yn===fi.w&&En.height+2*yn===fi.h?(Er-fr)/2:(Er-(En.height+2*yn)*lt.scale)/2,$n=new Ge(ti.x,ti.y-Ji),nr=new Ge(ti.x+fr,ti.y),qn=new Ge(ti.x+fr,ti.y-Ji)}else{const An=(En.left-yn)*lt.scale-Jt+bi[0],pr=(-En.top-yn)*lt.scale+bi[1],wr=An+Ji,Tr=pr+fr;ti=new Ge(An,pr),$n=new Ge(wr,pr),nr=new Ge(An,Tr),qn=new Ge(wr,Tr)}if($e){let An;An=Se?new Ge(0,0):Fi?new Ge(Ke[0],Ke[1]):new Ge(he[0],he[1]),ti._rotateAround($e,An),$n._rotateAround($e,An),nr._rotateAround($e,An),qn._rotateAround($e,An)}const Zi=new Ge(0,0),Fr=new Ge(0,0);Ve.push({tl:ti,tr:$n,bl:nr,br:qn,tex:Gt,writingMode:me.writingMode,glyphOffset:ki,sectionIndex:lt.sectionIndex,isSDF:mn,pixelOffsetTL:Zi,pixelOffsetBR:Fr,minFontScaleX:0,minFontScaleY:0})}}return Ve}(0,o,x,d,p,_,l,n.allowVerticalPlacement),ce=n.textSizeData;let ne=null;ce.kind==="source"?(ne=[_s*d.layout.get("text-size").evaluate(_,{},$)],ne[0]>du&&Vn(`${n.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):ce.kind==="composite"&&(ne=[_s*L.compositeTextSizes[0].evaluate(_,{},$),_s*L.compositeTextSizes[1].evaluate(_,{},$)],(ne[0]>du||ne[1]>du)&&Vn(`${n.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),n.addSymbols(n.text,te,ne,x,p,_,S,e,i,b.lineStartIndex,b.lineLength,I,N,$);for(const oe of M)R[oe]=n.text.placedSymbolArray.length-1;return 4*te.length}function Iy(n){for(const e in n)return n[e];return null}function Af(n,e,i,o,l,d,p,_,x,b){let S=p.top,M=p.bottom,R=p.left,I=p.right;const L=p.collisionPadding;if(L&&(R-=L[0],S-=L[1],I+=L[2],M+=L[3]),x){const N=new Ge(R,S),$=new Ge(I,S),te=new Ge(R,M),ce=new Ge(I,M),ne=Wt(x);let oe=new Ge(0,0);b&&(oe=new Ge(b[0],b[1])),N._rotateAround(ne,oe),$._rotateAround(ne,oe),te._rotateAround(ne,oe),ce._rotateAround(ne,oe),R=Math.min(N.x,$.x,te.x,ce.x),I=Math.max(N.x,$.x,te.x,ce.x),S=Math.min(N.y,$.y,te.y,ce.y),M=Math.max(N.y,$.y,te.y,ce.y)}return n.emplaceBack(e.x,e.y,e.z,i.x,i.y,R,S,I,M,_,o,l,d),n.length-1}function Bg(n){n.collisionPadding&&(n.top-=n.collisionPadding[1],n.bottom+=n.collisionPadding[3]);const e=n.bottom-n.top;return e>0?Math.max(10,e):null}function qx(n,e,i,o){const l=n.compareText;if(e in l){const d=l[e];for(let p=d.length-1;p>=0;p--)if(o.dist(d[p])<i)return!0}else l[e]=[];return l[e].push(o),!1}const ky=yt([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:Rf}=ky,Df=yt([{name:"a_pos_3",components:3,type:"Int16"}]);var ic=yt([{name:"a_pos",type:"Int16",components:2}]);const Ho=qt/Math.PI/2,hh=2*fs(1,0)*Ho*Math.PI,yd=64,rc=[yd,32,16],Co=-Ho,vs=Ho,Hx=[new Ga([Co,Co,Co],[vs,vs,vs]),new Ga([Co,Co,Co],[0,0,vs]),new Ga([0,Co,Co],[vs,0,vs]),new Ga([Co,0,Co],[0,vs,vs]),new Ga([0,0,Co],[vs,vs,vs])];function Zx(n,e,i,o=!0){const l=Eo([],n._camera.position,n.worldSize),d=[e,i,1,1];th(d,d,n.pixelMatrixInverse),V_(d,d,1/d[3]);const p=aa([],qo([],d,l)),_=n.globeMatrix,x=[_[12],_[13],_[14]],b=qo([],x,l),S=gs(b),M=aa([],b),R=n.worldSize/(2*Math.PI),I=$o(M,p),L=Math.asin(R/S);if(L<Math.acos(I)){if(!o)return null;const Xe=[],Me=[];Eo(Xe,p,S/I),aa(Me,qo(Me,Xe,b)),aa(p,au(p,b,Eo(p,Me,Math.tan(L)*S)))}const N=[];new cg(l,p).closestPointOnSphere(x,R,N);const $=aa([],gr(_,0)),te=aa([],gr(_,1)),ce=aa([],gr(_,2)),ne=$o($,N),oe=$o(te,N),me=$o(ce,N),he=In(Math.asin(-oe/R));let Ae=In(Math.atan2(ne,me));Ae=n.center.lng+function(Xe,Me){const Ve=(Me-Xe+180)%360-180;return Ve<-180?Ve+360:Ve}(n.center.lng,Ae);const Se=Gs(Ae),Fe=Ut($s(he),0,1);return new qs(Se,Fe)}class Xx{constructor(e,i,o){this.a=qo([],e,o),this.b=qo([],i,o),this.center=o;const l=aa([],this.a),d=aa([],this.b);this.angle=Math.acos($o(l,d))}}function Fg(n,e){if(n.angle===0)return null;let i;return i=n.a[e]===0?1/n.angle*.5*Math.PI:1/n.angle*Math.atan(n.b[e]/n.a[e]/Math.sin(n.angle)-1/Math.tan(n.angle)),i<0||i>1?null:function(o,l,d,p){const _=Math.sin(d);return o*(Math.sin((1-p)*d)/_)+l*(Math.sin(p*d)/_)}(n.a[e],n.b[e],n.angle,Ut(i,0,1))+n.center[e]}function Tl(n){if(n.z<=1)return Hx[n.z+2*n.y+n.x];const e=Ng(hm(n));return Ga.fromPoints(e)}function dh(n,e,i){return Eo(n,n,1-i),af(n,n,e,i)}function Ly(n,e){const i=ph(e.zoom);if(i===0)return Tl(n);const o=hm(n),l=Ng(o),d=Gs(o.getWest())*e.worldSize,p=Gs(o.getEast())*e.worldSize,_=$s(o.getNorth())*e.worldSize,x=$s(o.getSouth())*e.worldSize,b=[d,_,0],S=[p,_,0],M=[d,x,0],R=[p,x,0],I=Gp([],e.globeMatrix);return ji(b,b,I),ji(S,S,I),ji(M,M,I),ji(R,R,I),l[0]=dh(l[0],M,i),l[1]=dh(l[1],R,i),l[2]=dh(l[2],S,i),l[3]=dh(l[3],b,i),Ga.fromPoints(l)}function Oy(n,e,i){for(const o of n)ji(o,o,e),Eo(o,o,i)}function Ug(n,e,i){const o=e/n.worldSize,l=n.globeMatrix;if(i.z<=1){const Se=Tl(i).getCorners();return Oy(Se,l,o),Ga.fromPoints(Se)}const d=hm(i),p=Ng(d);Oy(p,l,o);const _=Number.MAX_VALUE,x=[-_,-_,-_],b=[_,_,_];if(d.contains(n.center)){for(const Xe of p)ou(b,b,Xe),rf(x,x,Xe);x[2]=0;const Se=n.point,Fe=[Se.x*o,Se.y*o,0];return ou(b,b,Fe),rf(x,x,Fe),new Ga(b,x)}const S=[l[12]*o,l[13]*o,l[14]*o],M=d.getCenter(),R=Ut(n.center.lat,-85.051129,ps),I=Ut(M.lat,-85.051129,ps),L=Gs(n.center.lng),N=$s(R);let $=L-Gs(M.lng);const te=N-$s(I);$>.5?$-=1:$<-.5&&($+=1);let ce=0;Math.abs($)>Math.abs(te)?ce=$>=0?1:3:(ce=te>=0?0:2,af(S,S,[l[4]*o,l[5]*o,l[6]*o],-Math.sin(Wt(te>=0?d.getSouth():d.getNorth()))*Ho));const ne=p[ce],oe=p[(ce+1)%4],me=new Xx(ne,oe,S),he=[Fg(me,0)||ne[0],Fg(me,1)||ne[1],Fg(me,2)||ne[2]],Ae=ph(n.zoom);if(Ae>0){const Se=function({x:Xe,y:Me,z:Ve},$e,Ke,tt,ke){const st=1/(1<<Ve);let jt=Xe*st,pt=jt+st,Et=Me*st,lt=Et+st,Gt=0;const yn=(jt+pt)/2-tt;return yn>.5?Gt=-1:yn<-.5&&(Gt=1),jt=((jt+Gt)*$e-(tt*=$e))*Ke+tt,pt=((pt+Gt)*$e-tt)*Ke+tt,Et=(Et*$e-(ke*=$e))*Ke+ke,lt=(lt*$e-ke)*Ke+ke,[[jt,lt,0],[pt,lt,0],[pt,Et,0],[jt,Et,0]]}(i,e,n._pixelsPerMercatorPixel,L,N);for(let Xe=0;Xe<p.length;Xe++)dh(p[Xe],Se[Xe],Ae);const Fe=au([],Se[ce],Se[(ce+1)%4]);Eo(Fe,Fe,.5),dh(he,Fe,Ae)}for(const Se of p)ou(b,b,Se),rf(x,x,Se);return b[2]=Math.min(ne[2],oe[2]),ou(b,b,he),rf(x,x,he),new Ga(b,x)}function hm({x:n,y:e,z:i}){const o=1/(1<<i),l=new Un(ra(n*o),zr((e+1)*o)),d=new Un(ra((n+1)*o),zr(e*o));return new eu(l,d)}function Ng(n){const e=Wt(n.getNorth()),i=Wt(n.getSouth()),o=Math.cos(e),l=Math.cos(i),d=Math.sin(e),p=Math.sin(i),_=n.getWest(),x=n.getEast();return[ac(l,p,_),ac(l,p,x),ac(o,d,x),ac(o,d,_)]}function ac(n,e,i,o=Ho){return i=Wt(i),[n*Math.sin(i)*o,-e*o,n*Math.cos(i)*o]}function zf(n,e,i){return ac(Math.cos(Wt(n)),Math.sin(Wt(n)),e,i)}function fh(n,e,i,o){const l=1<<i.z,d=(n/qt+i.x)/l;return zf(zr((e/qt+i.y)/l),ra(d),o)}function If({min:n,max:e}){return 16383/Math.max(e[0]-n[0],e[1]-n[1],e[2]-n[2])}const Py=new Float64Array(16);function kf(n){const e=If(n),i=iu(Py,[e,e,e]);return Jh(i,i,((o=[])[0]=-(l=n.min)[0],o[1]=-l[1],o[2]=-l[2],o));var o,l}function Vg(n){const e=(o=n.min,(i=Py)[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=o[0],i[13]=o[1],i[14]=o[2],i[15]=1,i);var i,o;const l=1/If(n);return Jc(e,e,[l,l,l])}function By(n,e,i,o,l){const d=function(x){const b=qt/(2*Math.PI);return x/(2*Math.PI)/b}(i),p=[n,e,-i/(2*Math.PI)],_=Zs(new Float64Array(16));return Jh(_,_,p),Jc(_,_,[d,d,d]),nf(_,_,Wt(-l)),Qc(_,_,Wt(-o)),_}function ph(n){return Hi(5,6,n)}function Fy(n,e){const i=zf(e.lat,e.lng),o=function(L){const N=zf(L._center.lat,L._center.lng);let $=ug([],ed(0,1,0),N);const te=ru([],-L.angle,N);$=ji($,$,te),ru(te,-L._pitch,$);const ce=aa([],N);return Eo(ce,ce,L.cameraToCenterDistance/L.pixelsPerMeter*hh),ji(ce,ce,te),au([],N,ce)}(n);return p=(l=sg([],o,i))[0],_=l[1],x=l[2],b=(d=i)[0],S=d[1],M=d[2],I=(R=Math.sqrt(p*p+_*_+x*x)*Math.sqrt(b*b+S*S+M*M))&&$o(l,d)/R,Math.acos(Math.min(Math.max(I,-1),1));var l,d,p,_,x,b,S,M,R,I}function jg(n,e){return Fy(n,e)>Math.PI/2*1.01}const Uy=Wt(85),Wx=Math.cos(Uy),Yx=Math.sin(Uy);function Ny(n,e){const i=n.fovAboveCenter,o=n.elevation?n.elevation.getMinElevationBelowMSL()*e:0,l=(n._camera.position[2]*n.worldSize-o)/Math.cos(n._pitch),d=Math.sin(i)*l/Math.sin(Math.max(Math.PI/2-n._pitch-i,.01)),p=Math.sin(n._pitch)*d+l;return Math.min(1.01*p,l*(1/n._horizonShift))}function mh(n,e){if(!e.isReprojectedInTileSpace)return{scale:1<<n.z,x:n.x,y:n.y,x2:n.x+1,y2:n.y+1,projection:e};const i=Math.pow(2,-n.z),o=n.x*i,l=(n.x+1)*i,d=n.y*i,p=(n.y+1)*i,_=ra(o),x=ra(l),b=zr(d),S=zr(p),M=e.project(_,b),R=e.project(x,b),I=e.project(x,S),L=e.project(_,S);let N=Math.min(M.x,R.x,I.x,L.x),$=Math.min(M.y,R.y,I.y,L.y),te=Math.max(M.x,R.x,I.x,L.x),ce=Math.max(M.y,R.y,I.y,L.y);const ne=i/16;function oe(he,Ae,Se,Fe,Xe,Me){const Ve=(Se+Xe)/2,$e=(Fe+Me)/2,Ke=e.project(ra(Ve),zr($e)),tt=Math.max(0,N-Ke.x,$-Ke.y,Ke.x-te,Ke.y-ce);N=Math.min(N,Ke.x),te=Math.max(te,Ke.x),$=Math.min($,Ke.y),ce=Math.max(ce,Ke.y),tt>ne&&(oe(he,Ke,Se,Fe,Ve,$e),oe(Ke,Ae,Ve,$e,Xe,Me))}oe(M,R,o,d,l,d),oe(R,I,l,d,l,p),oe(I,L,l,p,o,p),oe(L,M,o,p,o,d),N-=ne,$-=ne,te+=ne,ce+=ne;const me=1/Math.max(te-N,ce-$);return{scale:me,x:N*me,y:$*me,x2:te*me,y2:ce*me,projection:e}}const Gg=Zs(new Float32Array(16));class oc{constructor(e){this.spec=e,this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,i){return{x:0,y:0,z:0}}unproject(e,i){return new Un(0,0)}projectTilePoint(e,i,o){return{x:e,y:i,z:0}}locationPoint(e,i,o=!0){return e._coordinatePoint(e.locationCoordinate(i),o)}pixelsPerMeter(e,i){return fs(1,e)*i}pixelSpaceConversion(e,i,o){return 1}farthestPixelDistance(e){return Ny(e,e.pixelsPerMeter)}pointCoordinate(e,i,o,l){const d=e.horizonLineFromTop(!1),p=new Ge(i,Math.max(d,o));return e.rayIntersectionCoordinate(e.pointRayIntersection(p,l))}pointCoordinate3D(e,i,o){const l=new Ge(i,o);if(e.elevation)return e.elevation.pointCoordinate(l);{const d=this.pointCoordinate(e,l.x,l.y,0);return[d.x,d.y,d.z]}}isPointAboveHorizon(e,i){if(e.elevation)return!this.pointCoordinate3D(e,i.x,i.y);const o=e.horizonLineFromTop();return i.y<o}createInversionMatrix(e,i){return Gg}createTileMatrix(e,i,o){let l,d,p;const _=o.canonical,x=Zs(new Float64Array(16));if(this.isReprojectedInTileSpace){const b=mh(_,this);l=1,d=b.x+o.wrap*b.scale,p=b.y,Jc(x,x,[l/b.scale,l/b.scale,e.pixelsPerMeter/i])}else l=i/e.zoomScale(_.z),d=(_.x+Math.pow(2,_.z)*o.wrap)*l,p=_.y*l;return Jh(x,x,[d,p,0]),Jc(x,x,[l/qt,l/qt,1]),x}upVector(e,i,o){return[0,0,1]}upVectorScale(e,i,o){return{metersToTile:1}}}class Kx extends oc{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];const[i,o]=this.parallels=e.parallels||[29.5,45.5],l=Math.sin(Wt(i));this.n=(l+Math.sin(Wt(o)))/2,this.c=1+l*(2*this.n-l),this.r0=Math.sqrt(this.c)/this.n}project(e,i){const{n:o,c:l,r0:d}=this,p=Wt(e-this.center[0]),_=Wt(i),x=Math.sqrt(l-2*o*Math.sin(_))/o;return{x:x*Math.sin(p*o),y:x*Math.cos(p*o)-d,z:0}}unproject(e,i){const{n:o,c:l,r0:d}=this,p=d+i;let _=Math.atan2(e,Math.abs(p))*Math.sign(p);p*o<0&&(_-=Math.PI*Math.sign(e)*Math.sign(p));const x=Wt(this.center[0])*o;_=rn(_,-Math.PI-x,Math.PI-x);const b=Ut(In(_/o)+this.center[0],-180,180),S=Math.asin(Ut((l-(e*e+p*p)*o*o)/(2*o),-1,1)),M=Ut(In(S),-85.051129,ps);return new Un(b,M)}}const Lf=1.340264,Of=-.081106,Pf=893e-6,Bf=.003796,dm=Math.sqrt(3)/2;class Jx extends oc{project(e,i){i=i/180*Math.PI,e=e/180*Math.PI;const o=Math.asin(dm*Math.sin(i)),l=o*o,d=l*l*l;return{x:.5*(e*Math.cos(o)/(dm*(Lf+3*Of*l+d*(7*Pf+9*Bf*l)))/Math.PI+.5),y:1-.5*(o*(Lf+Of*l+d*(Pf+Bf*l))/Math.PI+1),z:0}}unproject(e,i){e=(2*e-.5)*Math.PI;let o=i=(2*(1-i)-1)*Math.PI,l=o*o,d=l*l*l;for(let S,M,R,I=0;I<12&&(M=o*(Lf+Of*l+d*(Pf+Bf*l))-i,R=Lf+3*Of*l+d*(7*Pf+9*Bf*l),S=M/R,o=Ut(o-S,-Math.PI/3,Math.PI/3),l=o*o,d=l*l*l,!(Math.abs(S)<1e-12));++I);const p=dm*e*(Lf+3*Of*l+d*(7*Pf+9*Bf*l))/Math.cos(o),_=Math.asin(Math.sin(o)/dm),x=Ut(180*p/Math.PI,-180,180),b=Ut(180*_/Math.PI,-85.051129,ps);return new Un(x,b)}}class Qx extends oc{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,i){return{x:.5+e/360,y:.5-i/360,z:0}}unproject(e,i){const o=360*(e-.5),l=Ut(360*(.5-i),-85.051129,ps);return new Un(o,l)}}const gh=Math.PI/2;function vd(n){return Math.tan((gh+n)/2)}class e0 extends oc{constructor(e){super(e),this.center=e.center||[0,30];const[i,o]=this.parallels=e.parallels||[30,30];let l=Wt(i),d=Wt(o);this.southernCenter=l+d<0,this.southernCenter&&(l=-l,d=-d);const p=Math.cos(l),_=vd(l);this.n=l===d?Math.sin(l):Math.log(p/Math.cos(d))/Math.log(vd(d)/_),this.f=p*Math.pow(vd(l),this.n)/this.n}project(e,i){i=Wt(i),this.southernCenter&&(i=-i),e=Wt(e-this.center[0]);const o=1e-6,{n:l,f:d}=this;d>0?i<-gh+o&&(i=-gh+o):i>gh-o&&(i=gh-o);const p=d/Math.pow(vd(i),l);let _=p*Math.sin(l*e),x=d-p*Math.cos(l*e);return _=.5*(_/Math.PI+.5),x=.5*(x/Math.PI+.5),{x:_,y:this.southernCenter?x:1-x,z:0}}unproject(e,i){e=(2*e-.5)*Math.PI,this.southernCenter&&(i=1-i),i=(2*(1-i)-.5)*Math.PI;const{n:o,f:l}=this,d=l-i,p=Math.sign(d),_=Math.sign(o)*Math.sqrt(e*e+d*d);let x=Math.atan2(e,Math.abs(d))*p;d*o<0&&(x-=Math.PI*Math.sign(e)*p);const b=Ut(In(x/o)+this.center[0],-180,180),S=Ut(In(2*Math.atan(Math.pow(l/_,1/o))-gh),-85.051129,ps);return new Un(b,this.southernCenter?-S:S)}}class Vy extends oc{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,i){return{x:Gs(e),y:$s(i),z:0}}unproject(e,i){const o=ra(e),l=zr(i);return new Un(o,l)}}const Ff=Wt(ps);class Uf extends oc{project(e,i){const o=(i=Wt(i))*i,l=o*o;return{x:.5*((e=Wt(e))*(.8707-.131979*o+l*(l*(.003971*o-.001529*l)-.013791))/Math.PI+.5),y:1-.5*(i*(1.007226+o*(.015085+l*(.028874*o-.044475-.005916*l)))/Math.PI+1),z:0}}unproject(e,i){e=(2*e-.5)*Math.PI;let o=i=(2*(1-i)-1)*Math.PI,l=25,d=0,p=o*o;do{p=o*o;const b=p*p;d=(o*(1.007226+p*(.015085+b*(.028874*p-.044475-.005916*b)))-i)/(1.007226+p*(.045255+b*(.259866*p-.311325-.005916*11*b))),o=Ut(o-d,-Ff,Ff)}while(Math.abs(d)>1e-6&&--l>0);p=o*o;const _=Ut(In(e/(.8707+p*(p*(p*p*p*(.003971-.001529*p)-.013791)-.131979))),-180,180),x=In(o);return new Un(_,x)}}const jy=Wt(ps);class t0 extends oc{project(e,i){i=Wt(i),e=Wt(e);const o=Math.cos(i),l=2/Math.PI,d=Math.acos(o*Math.cos(e/2)),p=Math.sin(d)/d,_=.5*(e*l+2*o*Math.sin(e/2)/p)||0,x=.5*(i+Math.sin(i)/p)||0;return{x:.5*(_/Math.PI+.5),y:1-.5*(x/Math.PI+1),z:0}}unproject(e,i){let o=e=(2*e-.5)*Math.PI,l=i=(2*(1-i)-1)*Math.PI,d=25;const p=1e-6;let _=0,x=0;do{const b=Math.cos(l),S=Math.sin(l),M=2*S*b,R=S*S,I=b*b,L=Math.cos(o/2),N=Math.sin(o/2),$=2*L*N,te=N*N,ce=1-I*L*L,ne=ce?1/ce:0,oe=ce?Math.acos(b*L)*Math.sqrt(1/ce):0,me=.5*(2*oe*b*N+2*o/Math.PI)-e,he=.5*(oe*S+l)-i,Ae=.5*ne*(I*te+oe*b*L*R)+1/Math.PI,Se=ne*($*M/4-oe*S*N),Fe=.125*ne*(M*N-oe*S*I*$),Xe=.5*ne*(R*L+oe*te*b)+.5,Me=Se*Fe-Xe*Ae;_=(he*Se-me*Xe)/Me,x=(me*Fe-he*Ae)/Me,o=Ut(o-_,-Math.PI,Math.PI),l=Ut(l-x,-jy,jy)}while((Math.abs(_)>p||Math.abs(x)>p)&&--d>0);return new Un(In(o),In(l))}}class Gy extends oc{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Wt(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,i){const{scale:o,cosPhi:l}=this;return{x:Wt(e)*l*o+.5,y:-Math.sin(Wt(i))/l*o+.5,z:0}}unproject(e,i){const{scale:o,cosPhi:l}=this,d=-(i-.5)/o,p=Ut(In((e-.5)/o)/l,-180,180),_=Math.asin(Ut(d*l,-1,1)),x=Ut(In(_),-85.051129,ps);return new Un(p,x)}}class n0 extends Vy{constructor(e){super(e),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug","custom"],this.range=[3,5]}projectTilePoint(e,i,o){const l=fh(e,i,o);return ji(l,l,kf(Tl(o))),{x:l[0],y:l[1],z:l[2]}}locationPoint(e,i){const o=zf(i.lat,i.lng),l=aa([],o),d=e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(i),e._centerAltitude):e._centerAltitude;af(o,o,l,fs(1,0)*qt*d);const p=Zs(new Float64Array(16));return Kc(p,e.pixelMatrix,e.globeMatrix),ji(o,o,p),new Ge(o[0],o[1])}pixelsPerMeter(e,i){return fs(1,0)*i}pixelSpaceConversion(e,i,o){const l=fs(1,e)*i,d=Bn(fs(1,45)*i,l,o);return this.pixelsPerMeter(e,i)/d}createTileMatrix(e,i,o){const l=Vg(Tl(o.canonical));return Kc(new Float64Array(16),e.globeMatrix,l)}createInversionMatrix(e,i){const{center:o}=e,l=kf(Tl(i));return Qc(l,l,Wt(o.lng)),nf(l,l,Wt(o.lat)),Jc(l,l,[e._pixelsPerMercatorPixel,e._pixelsPerMercatorPixel,1]),Float32Array.from(l)}pointCoordinate(e,i,o,l){return Zx(e,i,o,!0)||new qs(0,0)}pointCoordinate3D(e,i,o){const l=this.pointCoordinate(e,i,o,0);return[l.x,l.y,l.z]}isPointAboveHorizon(e,i){return!Zx(e,i.x,i.y,!1)}farthestPixelDistance(e){const i=function(l,d){const p=l.cameraToCenterDistance,_=l._centerAltitude*d,x=l._camera,b=l._camera.forward(),S=au([],Eo([],b,-p),[0,0,_]),M=l.worldSize/(2*Math.PI),R=[0,0,-M],I=l.width/l.height,L=Math.tan(l.fovAboveCenter),N=Eo([],x.up(),L),$=Eo([],x.right(),L*I),te=aa([],au([],au([],b,N),$)),ce=[];let ne;if(new cg(S,te).closestPointOnSphere(R,M,ce)){const oe=au([],ce,R),me=qo([],oe,S);ne=Math.cos(l.fovAboveCenter)*gs(me)}else{const oe=qo([],S,R),me=qo([],R,S);aa(me,me);const he=gs(oe)-M;ne=Math.sqrt(he*(he+2*M));const Ae=Math.acos(ne/(M+he))-Math.acos($o(b,me));ne*=Math.cos(Ae)}return 1.01*ne}(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),o=ph(e.zoom);if(o>0){const l=Ny(e,fs(1,e.center.lat)*e.worldSize),d=e.worldSize/(2*Math.PI),p=Math.max(e.width,e.height)/e.worldSize*Math.PI;return Bn(i,l+d*(1-Math.cos(p)),Math.pow(o,10))}return i}upVector(e,i,o){return fh(i,o,e,1)}upVectorScale(e){return{metersToTile:hh*If(Tl(e))}}}function $y(n){const e=n.parallels,i=!!e&&Math.abs(e[0]+e[1])<.01;switch(n.name){case"mercator":return new Vy(n);case"equirectangular":return new Qx(n);case"naturalEarth":return new Uf(n);case"equalEarth":return new Jx(n);case"winkelTripel":return new t0(n);case"albers":return i?new Gy(n):new Kx(n);case"lambertConformalConic":return i?new Gy(n):new e0(n);case"globe":return new n0(n)}throw new Error(`Invalid projection name: ${n.name}`)}const i0=ff.types,r0=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Nf(n,e,i,o,l,d,p,_,x,b,S,M,R){const I=_?Math.min(du,Math.round(_[0])):0,L=_?Math.min(du,Math.round(_[1])):0;n.emplaceBack(e,i,Math.round(32*o),Math.round(32*l),d,p,(I<<1)+(x?1:0),L,16*b,16*S,256*M,256*R)}function fm(n,e,i,o,l,d,p){n.emplaceBack(e,i,o,l,d,p)}function pm(n,e,i,o,l){n.emplaceBack(e,i,o,l),n.emplaceBack(e,i,o,l),n.emplaceBack(e,i,o,l),n.emplaceBack(e,i,o,l)}function a0(n){for(const e of n.sections)if(W(e.text))return!0;return!1}class $g{constructor(e){this.layoutVertexArray=new yi,this.indexArray=new Wn,this.programConfigurations=e,this.segments=new Dr,this.dynamicLayoutVertexArray=new Qa,this.opacityVertexArray=new hr,this.placedSymbolArray=new qu,this.globeExtVertexArray=new Fn}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,i,o,l){this.isEmpty()||(o&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Cg.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,i),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Ax.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,r0,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,Mx.members,!0)),this.opacityVertexBuffer.itemSize=1),(o||l)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}ft($g,"SymbolBuffers");class qg{constructor(e,i,o){this.layoutVertexArray=new e,this.layoutAttributes=i,this.indexArray=new o,this.segments=new Dr,this.collisionVertexArray=new Mn,this.collisionVertexArrayExt=new Ln}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Rx.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,Dx.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}ft(qg,"CollisionBuffers");class sc{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(p=>p.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Zs([]),this.placementViewportMatrix=Zs([]);const i=this.layers[0]._unevaluatedLayout._values;this.textSizeData=oh(this.zoom,i["text-size"]),this.iconSizeData=oh(this.zoom,i["icon-size"]);const o=this.layers[0].layout,l=o.get("symbol-sort-key"),d=o.get("symbol-z-order");this.canOverlap=o.get("text-allow-overlap")||o.get("icon-allow-overlap")||o.get("text-ignore-placement")||o.get("icon-ignore-placement"),this.sortFeaturesByKey=d!=="viewport-y"&&l.constantOr(1)!==void 0,this.sortFeaturesByY=(d==="viewport-y"||d==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=o.get("text-writing-mode").map(p=>qa[p]),this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id),this.sourceID=e.sourceID,this.projection=e.projection}createArrays(){this.text=new $g(new vi(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new $g(new vi(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new Zc,this.lineVertexArray=new $h,this.symbolInstances=new Gh}calculateGlyphDependencies(e,i,o,l,d){for(let p=0;p<e.length;p++)if(i[e.charCodeAt(p)]=!0,l&&d){const _=yf[e.charAt(p)];_&&(i[_.charCodeAt(0)]=!0)}}populate(e,i,o,l){const d=this.layers[0],p=d.layout,_=this.projection.name==="globe",x=p.get("text-font"),b=p.get("text-field"),S=p.get("icon-image"),M=(b.value.kind!=="constant"||b.value.value instanceof Ar&&!b.value.value.isEmpty()||b.value.value.toString().length>0)&&(x.value.kind!=="constant"||x.value.value.length>0),R=S.value.kind!=="constant"||!!S.value.value||Object.keys(S.parameters).length>0,I=p.get("symbol-sort-key");if(this.features=[],!M&&!R)return;const L=i.iconDependencies,N=i.glyphDependencies,$=i.availableImages,te=new ve(this.zoom);for(const{feature:ce,id:ne,index:oe,sourceLayerIndex:me}of e){const he=d._featureFilter.needGeometry,Ae=Wu(ce,he);if(!d._featureFilter.filter(te,Ae,o))continue;if(he||(Ae.geometry=tu(ce,o,l)),_&&ce.type!==1&&o.z<=5){const Me=Ae.geometry,Ve=.98078528056,$e=(Ke,tt)=>$o(fh(Ke.x,Ke.y,o,1),fh(tt.x,tt.y,o,1))<Ve;for(let Ke=0;Ke<Me.length;Ke++)Me[Ke]=w1(Me[Ke],$e)}let Se,Fe;if(M){const Me=d.getValueAndResolveTokens("text-field",Ae,o,$),Ve=Ar.factory(Me);a0(Ve)&&(this.hasRTLText=!0),(!this.hasRTLText||re()==="unavailable"||this.hasRTLText&&we.isParsed())&&(Se=vy(Ve,d,Ae))}if(R){const Me=d.getValueAndResolveTokens("icon-image",Ae,o,$);Fe=Me instanceof Ci?Me:Ci.fromString(Me)}if(!Se&&!Fe)continue;const Xe=this.sortFeaturesByKey?I.evaluate(Ae,{},o):void 0;if(this.features.push({id:ne,text:Se,icon:Fe,index:oe,sourceLayerIndex:me,geometry:Ae.geometry,properties:ce.properties,type:i0[ce.type],sortKey:Xe}),Fe&&(L[Fe.name]=!0),Se){const Me=x.evaluate(Ae,{},o).join(","),Ve=p.get("text-rotation-alignment")==="map"&&p.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(qa.vertical)>=0;for(const $e of Se.sections)if($e.image)L[$e.image.name]=!0;else{const Ke=w(Se.toString()),tt=$e.fontStack||Me,ke=N[tt]=N[tt]||{};this.calculateGlyphDependencies($e.text,ke,Ve,this.allowVerticalPlacement,Ke)}}}p.get("symbol-placement")==="line"&&(this.features=function(ce){const ne={},oe={},me=[];let he=0;function Ae(Me){me.push(ce[Me]),he++}function Se(Me,Ve,$e){const Ke=oe[Me];return delete oe[Me],oe[Ve]=Ke,me[Ke].geometry[0].pop(),me[Ke].geometry[0]=me[Ke].geometry[0].concat($e[0]),Ke}function Fe(Me,Ve,$e){const Ke=ne[Ve];return delete ne[Ve],ne[Me]=Ke,me[Ke].geometry[0].shift(),me[Ke].geometry[0]=$e[0].concat(me[Ke].geometry[0]),Ke}function Xe(Me,Ve,$e){const Ke=$e?Ve[0][Ve[0].length-1]:Ve[0][0];return`${Me}:${Ke.x}:${Ke.y}`}for(let Me=0;Me<ce.length;Me++){const Ve=ce[Me],$e=Ve.geometry,Ke=Ve.text?Ve.text.toString():null;if(!Ke){Ae(Me);continue}const tt=Xe(Ke,$e),ke=Xe(Ke,$e,!0);if(tt in oe&&ke in ne&&oe[tt]!==ne[ke]){const st=Fe(tt,ke,$e),jt=Se(tt,ke,me[st].geometry);delete ne[tt],delete oe[ke],oe[Xe(Ke,me[jt].geometry,!0)]=jt,me[st].geometry=null}else tt in oe?Se(tt,ke,$e):ke in ne?Fe(tt,ke,$e):(Ae(Me),ne[tt]=he-1,oe[ke]=he-1)}return me.filter(Me=>Me.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ce,ne)=>ce.sortKey-ne.sortKey)}update(e,i,o,l){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,i,this.layers,o,l),this.icon.programConfigurations.updatePaintArrays(e,i,this.layers,o,l))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=$y(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,i){const o=this.lineVertexArray.length;if(e.segment!==void 0)for(const{x:l,y:d}of i)this.lineVertexArray.emplaceBack(l,d);return{lineStartIndex:o,lineLength:this.lineVertexArray.length-o}}addSymbols(e,i,o,l,d,p,_,x,b,S,M,R,I,L){const N=e.indexArray,$=e.layoutVertexArray,te=e.globeExtVertexArray,ce=e.segments.prepareSegment(4*i.length,$,N,this.canOverlap?p.sortKey:void 0),ne=this.glyphOffsetArray.length,oe=ce.vertexLength,me=this.allowVerticalPlacement&&_===qa.vertical?Math.PI/2:0,he=p.text&&p.text.sections;for(let Se=0;Se<i.length;Se++){const{tl:Fe,tr:Xe,bl:Me,br:Ve,tex:$e,pixelOffsetTL:Ke,pixelOffsetBR:tt,minFontScaleX:ke,minFontScaleY:st,glyphOffset:jt,isSDF:pt,sectionIndex:Et}=i[Se],lt=ce.vertexLength,Gt=jt[1];if(Nf($,b.x,b.y,Fe.x,Gt+Fe.y,$e.x,$e.y,o,pt,Ke.x,Ke.y,ke,st),Nf($,b.x,b.y,Xe.x,Gt+Xe.y,$e.x+$e.w,$e.y,o,pt,tt.x,Ke.y,ke,st),Nf($,b.x,b.y,Me.x,Gt+Me.y,$e.x,$e.y+$e.h,o,pt,Ke.x,tt.y,ke,st),Nf($,b.x,b.y,Ve.x,Gt+Ve.y,$e.x+$e.w,$e.y+$e.h,o,pt,tt.x,tt.y,ke,st),x){const{x:yn,y:mn,z:pn}=x.anchor,[$t,Qn,Jt]=x.up;fm(te,yn,mn,pn,$t,Qn,Jt),fm(te,yn,mn,pn,$t,Qn,Jt),fm(te,yn,mn,pn,$t,Qn,Jt),fm(te,yn,mn,pn,$t,Qn,Jt),pm(e.dynamicLayoutVertexArray,yn,mn,pn,me)}else pm(e.dynamicLayoutVertexArray,b.x,b.y,b.z,me);N.emplaceBack(lt,lt+1,lt+2),N.emplaceBack(lt+1,lt+2,lt+3),ce.vertexLength+=4,ce.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(jt[0]),Se!==i.length-1&&Et===i[Se+1].sectionIndex||e.programConfigurations.populatePaintArrays($.length,p,p.index,{},I,L,he&&he[Et])}const Ae=x?x.anchor:b;e.placedSymbolArray.emplaceBack(Ae.x,Ae.y,Ae.z,b.x,b.y,ne,this.glyphOffsetArray.length-ne,oe,S,M,b.segment,o?o[0]:0,o?o[1]:0,l[0],l[1],_,0,!1,0,R,0)}_commitLayoutVertex(e,i,o,l,d,p,_){e.emplaceBack(i,o,l,d,p,Math.round(_.x),Math.round(_.y))}_addCollisionDebugVertices(e,i,o,l,d,p,_){const x=o.segments.prepareSegment(4,o.layoutVertexArray,o.indexArray),b=x.vertexLength,S=_.tileAnchorX,M=_.tileAnchorY;for(let I=0;I<4;I++)o.collisionVertexArray.emplaceBack(0,0,0,0);o.collisionVertexArrayExt.emplaceBack(i,-e.padding,-e.padding),o.collisionVertexArrayExt.emplaceBack(i,e.padding,-e.padding),o.collisionVertexArrayExt.emplaceBack(i,e.padding,e.padding),o.collisionVertexArrayExt.emplaceBack(i,-e.padding,e.padding),this._commitLayoutVertex(o.layoutVertexArray,l,d,p,S,M,new Ge(e.x1,e.y1)),this._commitLayoutVertex(o.layoutVertexArray,l,d,p,S,M,new Ge(e.x2,e.y1)),this._commitLayoutVertex(o.layoutVertexArray,l,d,p,S,M,new Ge(e.x2,e.y2)),this._commitLayoutVertex(o.layoutVertexArray,l,d,p,S,M,new Ge(e.x1,e.y2)),x.vertexLength+=4;const R=o.indexArray;R.emplaceBack(b,b+1),R.emplaceBack(b+1,b+2),R.emplaceBack(b+2,b+3),R.emplaceBack(b+3,b),x.primitiveLength+=4}_addTextDebugCollisionBoxes(e,i,o,l,d,p){for(let _=l;_<d;_++){const x=o.get(_),b=this.getSymbolInstanceTextSize(e,p,i,_);this._addCollisionDebugVertices(x,b,this.textCollisionBox,x.projectedAnchorX,x.projectedAnchorY,x.projectedAnchorZ,p)}}_addIconDebugCollisionBoxes(e,i,o,l,d,p){for(let _=l;_<d;_++){const x=o.get(_),b=this.getSymbolInstanceIconSize(e,i,p.placedIconSymbolIndex);this._addCollisionDebugVertices(x,b,this.iconCollisionBox,x.projectedAnchorX,x.projectedAnchorY,x.projectedAnchorZ,p)}}generateCollisionDebugBuffers(e,i){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new qg(di,yy.members,wo),this.iconCollisionBox=new qg(di,yy.members,wo);const o=hd(this.iconSizeData,e),l=hd(this.textSizeData,e);for(let d=0;d<this.symbolInstances.length;d++){const p=this.symbolInstances.get(d);this._addTextDebugCollisionBoxes(l,e,i,p.textBoxStartIndex,p.textBoxEndIndex,p),this._addTextDebugCollisionBoxes(l,e,i,p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p),this._addIconDebugCollisionBoxes(o,e,i,p.iconBoxStartIndex,p.iconBoxEndIndex,p),this._addIconDebugCollisionBoxes(o,e,i,p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex,p)}}getSymbolInstanceTextSize(e,i,o,l){const d=this.text.placedSymbolArray.get(i.rightJustifiedTextSymbolIndex>=0?i.rightJustifiedTextSymbolIndex:i.centerJustifiedTextSymbolIndex>=0?i.centerJustifiedTextSymbolIndex:i.leftJustifiedTextSymbolIndex>=0?i.leftJustifiedTextSymbolIndex:i.verticalPlacedTextSymbolIndex>=0?i.verticalPlacedTextSymbolIndex:l),p=cd(this.textSizeData,e,d)/br;return this.tilePixelRatio*p}getSymbolInstanceIconSize(e,i,o){const l=this.icon.placedSymbolArray.get(o),d=cd(this.iconSizeData,e,l);return this.tilePixelRatio*d}_commitDebugCollisionVertexUpdate(e,i,o){e.emplaceBack(i,-o,-o),e.emplaceBack(i,o,-o),e.emplaceBack(i,o,o),e.emplaceBack(i,-o,o)}_updateTextDebugCollisionBoxes(e,i,o,l,d,p){for(let _=l;_<d;_++){const x=o.get(_),b=this.getSymbolInstanceTextSize(e,p,i,_);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,b,x.padding)}}_updateIconDebugCollisionBoxes(e,i,o,l,d,p){for(let _=l;_<d;_++){const x=o.get(_),b=this.getSymbolInstanceIconSize(e,i,p);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,b,x.padding)}}updateCollisionDebugBuffers(e,i){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const o=hd(this.iconSizeData,e),l=hd(this.textSizeData,e);for(let d=0;d<this.symbolInstances.length;d++){const p=this.symbolInstances.get(d);this._updateTextDebugCollisionBoxes(l,e,i,p.textBoxStartIndex,p.textBoxEndIndex,p),this._updateTextDebugCollisionBoxes(l,e,i,p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p),this._updateIconDebugCollisionBoxes(o,e,i,p.iconBoxStartIndex,p.iconBoxEndIndex,p.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(o,e,i,p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex,p.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,i,o,l,d,p,_,x,b){const S={};if(i<o){const{x1:M,y1:R,x2:I,y2:L,padding:N,projectedAnchorX:$,projectedAnchorY:te,projectedAnchorZ:ce,tileAnchorX:ne,tileAnchorY:oe,featureIndex:me}=e.get(i);S.textBox={x1:M,y1:R,x2:I,y2:L,padding:N,projectedAnchorX:$,projectedAnchorY:te,projectedAnchorZ:ce,tileAnchorX:ne,tileAnchorY:oe},S.textFeatureIndex=me}if(l<d){const{x1:M,y1:R,x2:I,y2:L,padding:N,projectedAnchorX:$,projectedAnchorY:te,projectedAnchorZ:ce,tileAnchorX:ne,tileAnchorY:oe,featureIndex:me}=e.get(l);S.verticalTextBox={x1:M,y1:R,x2:I,y2:L,padding:N,projectedAnchorX:$,projectedAnchorY:te,projectedAnchorZ:ce,tileAnchorX:ne,tileAnchorY:oe},S.verticalTextFeatureIndex=me}if(p<_){const{x1:M,y1:R,x2:I,y2:L,padding:N,projectedAnchorX:$,projectedAnchorY:te,projectedAnchorZ:ce,tileAnchorX:ne,tileAnchorY:oe,featureIndex:me}=e.get(p);S.iconBox={x1:M,y1:R,x2:I,y2:L,padding:N,projectedAnchorX:$,projectedAnchorY:te,projectedAnchorZ:ce,tileAnchorX:ne,tileAnchorY:oe},S.iconFeatureIndex=me}if(x<b){const{x1:M,y1:R,x2:I,y2:L,padding:N,projectedAnchorX:$,projectedAnchorY:te,projectedAnchorZ:ce,tileAnchorX:ne,tileAnchorY:oe,featureIndex:me}=e.get(x);S.verticalIconBox={x1:M,y1:R,x2:I,y2:L,padding:N,projectedAnchorX:$,projectedAnchorY:te,projectedAnchorZ:ce,tileAnchorX:ne,tileAnchorY:oe},S.verticalIconFeatureIndex=me}return S}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let i=0;i<this.symbolInstances.length;i++){const o=this.symbolInstances.get(i);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,o.textBoxStartIndex,o.textBoxEndIndex,o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o.iconBoxStartIndex,o.iconBoxEndIndex,o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,i){const o=e.placedSymbolArray.get(i),l=o.vertexStartIndex+4*o.numGlyphs;for(let d=o.vertexStartIndex;d<l;d+=4)e.indexArray.emplaceBack(d,d+1,d+2),e.indexArray.emplaceBack(d+1,d+2,d+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const i=Math.sin(e),o=Math.cos(e),l=[],d=[],p=[];for(let _=0;_<this.symbolInstances.length;++_){p.push(_);const x=this.symbolInstances.get(_);l.push(0|Math.round(i*x.tileAnchorX+o*x.tileAnchorY)),d.push(x.featureIndex)}return p.sort((_,x)=>l[_]-l[x]||d[x]-d[_]),p}addToSortKeyRanges(e,i){const o=this.sortKeyRanges[this.sortKeyRanges.length-1];o&&o.sortKey===i?o.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:i,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const i of this.symbolInstanceIndexes){const o=this.symbolInstances.get(i);this.featureSortOrder.push(o.featureIndex);const{rightJustifiedTextSymbolIndex:l,centerJustifiedTextSymbolIndex:d,leftJustifiedTextSymbolIndex:p,verticalPlacedTextSymbolIndex:_,placedIconSymbolIndex:x,verticalPlacedIconSymbolIndex:b}=o;l>=0&&this.addIndicesForPlacedSymbol(this.text,l),d>=0&&d!==l&&this.addIndicesForPlacedSymbol(this.text,d),p>=0&&p!==d&&p!==l&&this.addIndicesForPlacedSymbol(this.text,p),_>=0&&this.addIndicesForPlacedSymbol(this.text,_),x>=0&&this.addIndicesForPlacedSymbol(this.icon,x),b>=0&&this.addIndicesForPlacedSymbol(this.icon,b)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}ft(sc,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),sc.MAX_GLYPHS=65535,sc.addDynamicAttributes=pm;const o0=new Pt({"symbol-placement":new be(Ne.layout_symbol["symbol-placement"]),"symbol-spacing":new be(Ne.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new be(Ne.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Re(Ne.layout_symbol["symbol-sort-key"]),"symbol-z-order":new be(Ne.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new be(Ne.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new be(Ne.layout_symbol["icon-ignore-placement"]),"icon-optional":new be(Ne.layout_symbol["icon-optional"]),"icon-rotation-alignment":new be(Ne.layout_symbol["icon-rotation-alignment"]),"icon-size":new Re(Ne.layout_symbol["icon-size"]),"icon-text-fit":new be(Ne.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new be(Ne.layout_symbol["icon-text-fit-padding"]),"icon-image":new Re(Ne.layout_symbol["icon-image"]),"icon-rotate":new Re(Ne.layout_symbol["icon-rotate"]),"icon-padding":new be(Ne.layout_symbol["icon-padding"]),"icon-keep-upright":new be(Ne.layout_symbol["icon-keep-upright"]),"icon-offset":new Re(Ne.layout_symbol["icon-offset"]),"icon-anchor":new Re(Ne.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new be(Ne.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new be(Ne.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new be(Ne.layout_symbol["text-rotation-alignment"]),"text-field":new Re(Ne.layout_symbol["text-field"]),"text-font":new Re(Ne.layout_symbol["text-font"]),"text-size":new Re(Ne.layout_symbol["text-size"]),"text-max-width":new Re(Ne.layout_symbol["text-max-width"]),"text-line-height":new Re(Ne.layout_symbol["text-line-height"]),"text-letter-spacing":new Re(Ne.layout_symbol["text-letter-spacing"]),"text-justify":new Re(Ne.layout_symbol["text-justify"]),"text-radial-offset":new Re(Ne.layout_symbol["text-radial-offset"]),"text-variable-anchor":new be(Ne.layout_symbol["text-variable-anchor"]),"text-anchor":new Re(Ne.layout_symbol["text-anchor"]),"text-max-angle":new be(Ne.layout_symbol["text-max-angle"]),"text-writing-mode":new be(Ne.layout_symbol["text-writing-mode"]),"text-rotate":new Re(Ne.layout_symbol["text-rotate"]),"text-padding":new be(Ne.layout_symbol["text-padding"]),"text-keep-upright":new be(Ne.layout_symbol["text-keep-upright"]),"text-transform":new Re(Ne.layout_symbol["text-transform"]),"text-offset":new Re(Ne.layout_symbol["text-offset"]),"text-allow-overlap":new be(Ne.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new be(Ne.layout_symbol["text-ignore-placement"]),"text-optional":new be(Ne.layout_symbol["text-optional"])});var Hg={paint:new Pt({"icon-opacity":new Re(Ne.paint_symbol["icon-opacity"]),"icon-color":new Re(Ne.paint_symbol["icon-color"]),"icon-halo-color":new Re(Ne.paint_symbol["icon-halo-color"]),"icon-halo-width":new Re(Ne.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Re(Ne.paint_symbol["icon-halo-blur"]),"icon-translate":new be(Ne.paint_symbol["icon-translate"]),"icon-translate-anchor":new be(Ne.paint_symbol["icon-translate-anchor"]),"text-opacity":new Re(Ne.paint_symbol["text-opacity"]),"text-color":new Re(Ne.paint_symbol["text-color"],{runtimeType:Qr,getOverride:n=>n.textColor,hasOverride:n=>!!n.textColor}),"text-halo-color":new Re(Ne.paint_symbol["text-halo-color"]),"text-halo-width":new Re(Ne.paint_symbol["text-halo-width"]),"text-halo-blur":new Re(Ne.paint_symbol["text-halo-blur"]),"text-translate":new be(Ne.paint_symbol["text-translate"]),"text-translate-anchor":new be(Ne.paint_symbol["text-translate-anchor"])}),layout:o0};class qy{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:Or,this.defaultValue=e}evaluate(e){if(e.formattedSection){const i=this.defaultValue.property.overrides;if(i&&i.hasOverride(e.formattedSection))return i.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}ft(qy,"FormatSectionOverride",{omit:["defaultValue"]});class mm extends js{constructor(e){super(e,Hg)}recalculate(e,i){super.recalculate(e,i),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const o=this.layout.get("text-writing-mode");if(o){const l=[];for(const d of o)l.indexOf(d)<0&&l.push(d);this.layout._values["text-writing-mode"]=l}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(e,i,o,l){const d=this.layout.get(e).evaluate(i,{},o,l),p=this._unevaluatedLayout._values[e];return p.isDataDriven()||Fs(p.value)||!d?d:function(_,x){return x.replace(/{([^{}]+)}/g,(b,S)=>S in _?String(_[S]):"")}(i.properties,d)}createBucket(e){return new sc(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of Hg.paint.overridableProperties){if(!mm.hasPaintOverride(this.layout,e))continue;const i=this.paint.get(e),o=new qy(i),l=new Lu(o,i.property.specification);let d=null;d=i.value.kind==="constant"||i.value.kind==="source"?new vo("source",l):new Fh("composite",l,i.value.zoomStops,i.value._interpolationType),this.paint._values[e]=new Ye(i.property,d,i.parameters)}}_handleOverridablePaintPropertyUpdate(e,i,o){return!(!this.layout||i.isDataDriven()||o.isDataDriven())&&mm.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,i){const o=e.get("text-field"),l=Hg.paint.properties[i];let d=!1;const p=_=>{for(const x of _)if(l.overrides&&l.overrides.hasOverride(x))return void(d=!0)};if(o.value.kind==="constant"&&o.value.value instanceof Ar)p(o.value.value.sections);else if(o.value.kind==="source"){const _=b=>{d||(b instanceof Ol&&oi(b.value)===ko?p(b.value.sections):b instanceof il?p(b.sections):b.eachChild(_))},x=o.value;x._styleExpression&&_(x._styleExpression.expression)}return d}getProgramConfiguration(e){return new Zu(this,e)}}var s0={paint:new Pt({"background-color":new be(Ne.paint_background["background-color"]),"background-pattern":new be(Ne.paint_background["background-pattern"]),"background-opacity":new be(Ne.paint_background["background-opacity"])})},l0={paint:new Pt({"raster-opacity":new be(Ne.paint_raster["raster-opacity"]),"raster-hue-rotate":new be(Ne.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new be(Ne.paint_raster["raster-brightness-min"]),"raster-brightness-max":new be(Ne.paint_raster["raster-brightness-max"]),"raster-saturation":new be(Ne.paint_raster["raster-saturation"]),"raster-contrast":new be(Ne.paint_raster["raster-contrast"]),"raster-resampling":new be(Ne.paint_raster["raster-resampling"]),"raster-fade-duration":new be(Ne.paint_raster["raster-fade-duration"])})};class u0 extends js{constructor(e){super(e,{}),this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}var c0={paint:new Pt({"sky-type":new be(Ne.paint_sky["sky-type"]),"sky-atmosphere-sun":new be(Ne.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new be(Ne.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new be(Ne.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new be(Ne.paint_sky["sky-gradient-radius"]),"sky-gradient":new wt(Ne.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new be(Ne.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new be(Ne.paint_sky["sky-atmosphere-color"]),"sky-opacity":new be(Ne.paint_sky["sky-opacity"])})};function Zg(n,e,i){const o=[0,0,1],l=G_([]);return qp(l,l,i?-Wt(n)+Math.PI:Wt(n)),of(l,l,-Wt(e)),td(o,o,l),aa(o,o)}const h0={circle:class extends js{constructor(n){super(n,Jv)}createBucket(n){return new ng(n)}queryRadius(n){const e=n;return Yh("circle-radius",this,e)+Yh("circle-stroke-width",this,e)+Kh(this.paint.get("circle-translate"))}queryIntersectsFeature(n,e,i,o,l,d,p,_){const x=tf(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),d.angle,n.pixelToTileUnitsFactor),b=this.paint.get("circle-radius").evaluate(e,i)+this.paint.get("circle-stroke-width").evaluate(e,i);return nd(n,o,d,p,_,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",x,b)}getProgramIds(){return["circle"]}getProgramConfiguration(n){return new Zu(this,n)}},heatmap:class extends js{createBucket(n){return new pg(n)}constructor(n){super(n,ad),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(n){n==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=lf({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(n){return Yh("heatmap-radius",this,n)}queryIntersectsFeature(n,e,i,o,l,d,p,_){const x=this.paint.get("heatmap-radius").evaluate(e,i);return nd(n,o,d,p,_,!0,!0,new Ge(0,0),x)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(n){return new Zu(this,n)}},hillshade:class extends js{constructor(n){super(n,uf)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends js{constructor(n){super(n,Y_)}getProgramIds(){const n=this.paint.get("fill-pattern"),e=n&&n.constantOr(1),i=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&i.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),i}getProgramConfiguration(n){return new Zu(this,n)}recalculate(n,e){super.recalculate(n,e);const i=this.paint._values["fill-outline-color"];i.value.kind==="constant"&&i.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(n){return new Ju(n)}queryRadius(){return Kh(this.paint.get("fill-translate"))}queryIntersectsFeature(n,e,i,o,l,d){return!n.queryGeometry.isAboveHorizon&&rg(ag(n.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),d.angle,n.pixelToTileUnitsFactor),o)}isTileClipped(){return!0}},"fill-extrusion":class extends js{constructor(n){super(n,wx)}createBucket(n){return new pf(n)}queryRadius(){return Kh(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(n){return new Zu(this,n)}queryIntersectsFeature(n,e,i,o,l,d,p,_,x){const b=tf(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),d.angle,n.pixelToTileUnitsFactor),S=this.paint.get("fill-extrusion-height").evaluate(e,i),M=this.paint.get("fill-extrusion-base").evaluate(e,i),R=[0,0],I=_&&d.elevation,L=d.elevation?d.elevation.exaggeration():1,N=n.tile.getBucket(this);if(I&&N instanceof pf){const oe=N.centroidVertexArray,me=x+1;me<oe.length&&(R[0]=oe.geta_centroid_pos0(me),R[1]=oe.geta_centroid_pos1(me))}if(R[0]===0&&R[1]===1)return!1;d.projection.name==="globe"&&(o=cy([o],[new Ge(0,0),new Ge(qt,qt)],n.tileID.canonical).map(oe=>oe.polygon).flat());const $=I?_:null,[te,ce]=function(oe,me,he,Ae,Se,Fe,Xe,Me,Ve,$e,Ke){return oe.projection.name==="globe"?function(tt,ke,st,jt,pt,Et,lt,Gt,yn,mn,pn){const $t=[],Qn=[],Jt=tt.projection.upVectorScale(pn,tt.center.lat,tt.worldSize).metersToTile,En=[0,0,0,1],fi=[0,0,0,1],ki=(pi,Fi,Ji,fr)=>{pi[0]=Fi,pi[1]=Ji,pi[2]=fr,pi[3]=1},bi=Eg();st>0&&(st+=bi),jt+=bi;for(const pi of ke){const Fi=[],Ji=[];for(const fr of pi){const ti=fr.x+pt.x,$n=fr.y+pt.y,nr=tt.projection.projectTilePoint(ti,$n,pn),qn=tt.projection.upVector(pn,fr.x,fr.y);let Zi=st,Fr=jt;if(lt){const An=ud(ti,$n,st,jt,lt,Gt,yn,mn);Zi+=An.base,Fr+=An.top}st!==0?ki(En,nr.x+qn[0]*Jt*Zi,nr.y+qn[1]*Jt*Zi,nr.z+qn[2]*Jt*Zi):ki(En,nr.x,nr.y,nr.z),ki(fi,nr.x+qn[0]*Jt*Fr,nr.y+qn[1]*Jt*Fr,nr.z+qn[2]*Jt*Fr),ji(En,En,Et),ji(fi,fi,Et),Fi.push(new ld(En[0],En[1],En[2])),Ji.push(new ld(fi[0],fi[1],fi[2]))}$t.push(Fi),Qn.push(Ji)}return[$t,Qn]}(oe,me,he,Ae,Se,Fe,Xe,Me,Ve,$e,Ke):Xe?function(tt,ke,st,jt,pt,Et,lt,Gt,yn){const mn=[],pn=[],$t=[0,0,0,1];for(const Qn of tt){const Jt=[],En=[];for(const fi of Qn){const ki=fi.x+jt.x,bi=fi.y+jt.y,pi=ud(ki,bi,ke,st,Et,lt,Gt,yn);$t[0]=ki,$t[1]=bi,$t[2]=pi.base,$t[3]=1,th($t,$t,pt),$t[3]=Math.max($t[3],1e-5);const Fi=new ld($t[0]/$t[3],$t[1]/$t[3],$t[2]/$t[3]);$t[0]=ki,$t[1]=bi,$t[2]=pi.top,$t[3]=1,th($t,$t,pt),$t[3]=Math.max($t[3],1e-5);const Ji=new ld($t[0]/$t[3],$t[1]/$t[3],$t[2]/$t[3]);Jt.push(Fi),En.push(Ji)}mn.push(Jt),pn.push(En)}return[mn,pn]}(me,he,Ae,Se,Fe,Xe,Me,Ve,$e):function(tt,ke,st,jt,pt){const Et=[],lt=[],Gt=pt[8]*ke,yn=pt[9]*ke,mn=pt[10]*ke,pn=pt[11]*ke,$t=pt[8]*st,Qn=pt[9]*st,Jt=pt[10]*st,En=pt[11]*st;for(const fi of tt){const ki=[],bi=[];for(const pi of fi){const Fi=pi.x+jt.x,Ji=pi.y+jt.y,fr=pt[0]*Fi+pt[4]*Ji+pt[12],ti=pt[1]*Fi+pt[5]*Ji+pt[13],$n=pt[2]*Fi+pt[6]*Ji+pt[14],nr=pt[3]*Fi+pt[7]*Ji+pt[15],qn=fr+Gt,Zi=ti+yn,Fr=$n+mn,An=Math.max(nr+pn,1e-5),pr=fr+$t,wr=ti+Qn,Tr=$n+Jt,Er=Math.max(nr+En,1e-5);ki.push(new ld(qn/An,Zi/An,Fr/An)),bi.push(new ld(pr/Er,wr/Er,Tr/Er))}Et.push(ki),lt.push(bi)}return[Et,lt]}(me,he,Ae,Se,Fe)}(d,o,M,S,b,p,$,R,L,d.center.lat,n.tileID.canonical),ne=n.queryGeometry;return function(oe,me,he){let Ae=1/0;rg(he,me)&&(Ae=So(he,me[0]));for(let Se=0;Se<me.length;Se++){const Fe=me[Se],Xe=oe[Se];for(let Me=0;Me<Fe.length-1;Me++){const Ve=Fe[Me],$e=[Ve,Fe[Me+1],Xe[Me+1],Xe[Me],Ve];ig(he,$e)&&(Ae=Math.min(Ae,So(he,$e)))}}return Ae!==1/0&&Ae}(te,ce,ne.isPointQuery()?ne.screenBounds:ne.screenGeometry)}},line:class extends js{constructor(n){super(n,gy),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(n){if(n==="line-gradient"){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof Mc,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(n,e){super.recalculate(n,e),this.paint._values["line-floorwidth"]=_y.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,n)}createBucket(n){return new _f(n)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(n){return new Zu(this,n)}queryRadius(n){const e=n,i=Sg(Yh("line-width",this,e),Yh("line-gap-width",this,e)),o=Yh("line-offset",this,e);return i/2+Math.abs(o)+Kh(this.paint.get("line-translate"))}queryIntersectsFeature(n,e,i,o,l,d){if(n.queryGeometry.isAboveHorizon)return!1;const p=ag(n.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),d.angle,n.pixelToTileUnitsFactor),_=n.pixelToTileUnitsFactor/2*Sg(this.paint.get("line-width").evaluate(e,i),this.paint.get("line-gap-width").evaluate(e,i)),x=this.paint.get("line-offset").evaluate(e,i);return x&&(o=function(b,S){const M=[],R=new Ge(0,0);for(let I=0;I<b.length;I++){const L=b[I],N=[];for(let $=0;$<L.length;$++){const te=L[$-1],ce=L[$],ne=L[$+1],oe=$===0?R:ce.sub(te)._unit()._perp(),me=$===L.length-1?R:ne.sub(ce)._unit()._perp(),he=oe._add(me)._unit();he._mult(1/(he.x*me.x+he.y*me.y)),N.push(he._mult(S)._add(ce))}M.push(N)}return M}(o,x*n.pixelToTileUnitsFactor)),function(b,S,M){for(let R=0;R<S.length;R++){const I=S[R];if(b.length>=3){for(let L=0;L<I.length;L++)if(dr(b,I[L]))return!0}if(Go(b,I,M))return!0}return!1}(p,o,_)}isTileClipped(){return!0}},symbol:mm,background:class extends js{constructor(n){super(n,s0)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends js{constructor(n){super(n,l0)}getProgramIds(){return["raster"]}},sky:class extends js{constructor(n){super(n,c0),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(n){n==="sky-gradient"?this._updateColorRamp():n!=="sky-atmosphere-sun"&&n!=="sky-atmosphere-halo-color"&&n!=="sky-atmosphere-color"&&n!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=lf({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(n){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=n.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}return!1}getCenter(n,e){if(this.paint.get("sky-type")==="atmosphere"){const o=this.paint.get("sky-atmosphere-sun"),l=!o,d=n.style.light,p=d.properties.get("position");return l&&d.properties.get("anchor")==="viewport"&&Vn("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),l?Zg(p.azimuthal,90-p.polar,e):Zg(o[0],90-o[1],e)}const i=this.paint.get("sky-gradient-center");return Zg(i[0],90-i[1],e)}is3D(){return!1}isSky(){return!0}markSkyboxValid(n){this._skyboxInvalidated=!1,this._lightPosition=n.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const n=this.paint.get("sky-type");return n==="atmosphere"?["skyboxCapture","skybox"]:n==="gradient"?["skyboxGradient"]:null}}};class El{constructor(e,i,o,l){this.context=e,this.format=o,this.texture=e.gl.createTexture(),this.update(i,l)}update(e,i,o){const{width:l,height:d}=e,{context:p}=this,{gl:_}=p,{HTMLImageElement:x,HTMLCanvasElement:b,HTMLVideoElement:S,ImageData:M,ImageBitmap:R}=Oe;if(_.bindTexture(_.TEXTURE_2D,this.texture),p.pixelStoreUnpackFlipY.set(!1),p.pixelStoreUnpack.set(1),p.pixelStoreUnpackPremultiplyAlpha.set(this.format===_.RGBA&&(!i||i.premultiply!==!1)),o||this.size&&this.size[0]===l&&this.size[1]===d){const{x:I,y:L}=o||{x:0,y:0};e instanceof x||e instanceof b||e instanceof S||e instanceof M||R&&e instanceof R?_.texSubImage2D(_.TEXTURE_2D,0,I,L,_.RGBA,_.UNSIGNED_BYTE,e):_.texSubImage2D(_.TEXTURE_2D,0,I,L,l,d,_.RGBA,_.UNSIGNED_BYTE,e.data)}else this.size=[l,d],e instanceof x||e instanceof b||e instanceof S||e instanceof M||R&&e instanceof R?_.texImage2D(_.TEXTURE_2D,0,this.format,this.format,_.UNSIGNED_BYTE,e):_.texImage2D(_.TEXTURE_2D,0,this.format,l,d,0,this.format,_.UNSIGNED_BYTE,e.data);this.useMipmap=Boolean(i&&i.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&_.generateMipmap(_.TEXTURE_2D)}bind(e,i){const{context:o}=this,{gl:l}=o;l.bindTexture(l.TEXTURE_2D,this.texture),e!==this.filter&&(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,e),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,this.useMipmap?e===l.NEAREST?l.NEAREST_MIPMAP_NEAREST:l.LINEAR_MIPMAP_NEAREST:e),this.filter=e),i!==this.wrap&&(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,i),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,i),this.wrap=i)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class xd{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class Xg{constructor(){this.tasks={},this.taskQueue=[],Yr(["process"],this),this.invoker=new xd(this.process),this.nextId=0}add(e,i){const o=this.nextId++,l=function({type:d,isSymbolTile:p,zoom:_}){return _=_||0,d==="message"?0:d!=="maybePrepare"||p?d!=="parseTile"||p?d==="parseTile"&&p?300-_:d==="maybePrepare"&&p?400-_:500:200-_:100-_}(i);if(l===0){Ri();try{e()}finally{}return{cancel:()=>{}}}return this.tasks[o]={fn:e,metadata:i,priority:l,id:o},this.taskQueue.push(o),this.invoker.trigger(),{cancel:()=>{delete this.tasks[o]}}}process(){Ri();try{if(this.taskQueue=this.taskQueue.filter(o=>!!this.tasks[o]),!this.taskQueue.length)return;const e=this.pick();if(e===null)return;const i=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!i)return;i.fn()}finally{}}pick(){let e=null,i=1/0;for(let l=0;l<this.taskQueue.length;l++){const d=this.tasks[this.taskQueue[l]];d.priority<i&&(i=d.priority,e=l)}if(e===null)return null;const o=this.taskQueue[e];return this.taskQueue.splice(e,1),o}remove(){this.invoker.remove()}}class bd{constructor(e){this._stringToNumber={},this._numberToString=[];for(let i=0;i<e.length;i++){const o=e[i];this._stringToNumber[o]=i,this._numberToString[i]=o}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}const Wg=["tile","layer","source","sourceLayer","state"];class Hy{constructor(e,i,o,l,d){this.type="Feature",this._vectorTileFeature=e,this._z=i,this._x=o,this._y=l,this.properties=e.properties,this.id=d}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={type:"Feature",geometry:this.geometry,properties:this.properties};this.id!==void 0&&(e.id=this.id);for(const i of Wg)this[i]!==void 0&&(e[i]=this[i]);return e}}const xs=32,Sl=33,bs=new Uint16Array(8184);for(let n=0;n<2046;n++){let e=n+2,i=0,o=0,l=0,d=0,p=0,_=0;for(1&e?l=d=p=xs:i=o=_=xs;(e>>=1)>1;){const b=i+l>>1,S=o+d>>1;1&e?(l=i,d=o,i=p,o=_):(i=l,o=d,l=p,d=_),p=b,_=S}const x=4*n;bs[x+0]=i,bs[x+1]=o,bs[x+2]=l,bs[x+3]=d}const Zo=new Uint16Array(2178),fu=new Uint8Array(1089),lc=new Uint16Array(1089);function uc(n){return n===0?-.03125:n===32?.03125:0}var pu=yt([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const _h={type:2,extent:qt,loadGeometry:()=>[[new Ge(0,0),new Ge(8193,0),new Ge(8193,8193),new Ge(0,8193),new Ge(0,0)]]};class wd{constructor(e,i,o,l,d){this.tileID=e,this.uid=rr(),this.uses=0,this.tileSize=i,this.tileZoom=o,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=d,this.expiredRequestCount=0,this.state="loading",l&&l.transform&&(this.projection=l.transform.projection)}registerFadeDuration(e){const i=e+this.timeAdded;i<Rt.now()||this.fadeEndTime&&i<this.fadeEndTime||(this.fadeEndTime=i)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=mh(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(e,i,o){if(this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(l,d){const p={};if(!d)return p;for(const _ of l){const x=_.layerIds.map(b=>d.getLayer(b)).filter(Boolean);if(x.length!==0){_.layers=x,_.stateDependentLayerIds&&(_.stateDependentLayers=_.stateDependentLayerIds.map(b=>x.filter(S=>S.id===b)[0]));for(const b of x)p[b.id]=_}}return p}(e.buckets,i.style),this.hasSymbolBuckets=!1;for(const l in this.buckets){const d=this.buckets[l];if(d instanceof sc){if(this.hasSymbolBuckets=!0,!o)break;d.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const l in this.buckets){const d=this.buckets[l];if(d instanceof sc&&d.hasRTLText){this.hasRTLText=!0,we.isLoading()||we.isLoaded()||re()!=="deferred"||Ce();break}}this.queryPadding=0;for(const l in this.buckets){const d=this.buckets[l];this.queryPadding=Math.max(this.queryPadding,i.style.getLayer(l).queryRadius(d))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas)}else this.collisionBoxArray=new $u}unloadVectorData(){if(this.hasData()){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(e){return this.buckets[e.id]}upload(e){for(const o in this.buckets){const l=this.buckets[o];l.uploadPending()&&l.upload(e)}const i=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new El(e,this.imageAtlas.image,i.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new El(e,this.glyphAtlasImage,i.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new El(e,this.lineAtlas.image,i.ALPHA),this.lineAtlas.uploaded=!0)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,i,o,l,d,p,_,x){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:l,pixelPosMatrix:_,transform:p,params:d,tileTransform:this.tileTransform},e,i,o):{}}querySourceFeatures(e,i){const o=this.latestFeatureIndex;if(!o||!o.rawTileData)return;const l=o.loadVTLayers(),d=i?i.sourceLayer:"",p=l._geojsonTileLayer||l[d];if(!p)return;const _=cl(i&&i.filter),{z:x,x:b,y:S}=this.tileID.canonical,M={z:x,x:b,y:S};for(let R=0;R<p.length;R++){const I=p.feature(R);if(_.needGeometry){const $=Wu(I,!0);if(!_.filter(new ve(this.tileID.overscaledZ),$,this.tileID.canonical))continue}else if(!_.filter(new ve(this.tileID.overscaledZ),I))continue;const L=o.getId(I,d),N=new Hy(I,x,b,S,L);N.tile=M,e.push(N)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const i=this.expirationTime;if(e.cacheControl){const o=sr(e.cacheControl);o["max-age"]&&(this.expirationTime=Date.now()+1e3*o["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const o=Date.now();let l=!1;if(this.expirationTime>o)l=!1;else if(i)if(this.expirationTime<i)l=!0;else{const d=this.expirationTime-i;d?this.expirationTime=o+Math.max(d,3e4):l=!0}else l=!0;l?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,i){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0||!i)return;const o=this.latestFeatureIndex.loadVTLayers(),l=i.style.listImages();for(const d in this.buckets){if(!i.style.hasLayer(d))continue;const p=this.buckets[d],_=p.layers[0].sourceLayer||"_geojsonTileLayer",x=o[_],b=e[_];if(!x||!b||Object.keys(b).length===0)continue;if(p.update(b,x,l,this.imageAtlas&&this.imageAtlas.patternPositions||{}),p instanceof _f||p instanceof Ju){const M=i.style._getSourceCache(p.layers[0].source);i._terrain&&i._terrain.enabled&&M&&p.programConfigurations.needsUpload&&i._terrain._clearRenderCacheForTile(M.id,this.tileID)}const S=i&&i.style&&i.style.getLayer(d);S&&(this.queryPadding=Math.max(this.queryPadding,S.queryRadius(p)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Rt.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=Rt.now()+e}setTexture(e,i){const o=i.context,l=o.gl;this.texture=this.texture||i.getTileTexture(e.width),this.texture?this.texture.update(e,{useMipmap:!0}):(this.texture=new El(o,e,l.RGBA,{useMipmap:!0}),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE),o.extTextureFilterAnisotropic&&l.texParameterf(l.TEXTURE_2D,o.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,o.extTextureFilterAnisotropicMax))}setDependencies(e,i){const o={};for(const l of i)o[l]=!0;this.dependencies[e]=o}hasDependency(e,i){for(const o of e){const l=this.dependencies[o];if(l){for(const d of i)if(l[d])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(e,i){if(!i||i.name==="mercator"||this._tileDebugBuffer)return;const o=tu(_h,this.tileID.canonical,this.tileTransform)[0],l=new Gn,d=new rt;for(let p=0;p<o.length;p++){const{x:_,y:x}=o[p];l.emplaceBack(_,x),d.emplaceBack(p)}d.emplaceBack(0),this._tileDebugIndexBuffer=e.createIndexBuffer(d),this._tileDebugBuffer=e.createVertexBuffer(l,ic.members),this._tileDebugSegments=Dr.simpleSegment(0,0,l.length,d.length)}_makeTileBoundsBuffers(e,i){if(this._tileBoundsBuffer||!i||i.name==="mercator")return;const o=tu(_h,this.tileID.canonical,this.tileTransform)[0];let l,d;if(this.isRaster){const p=function(_,x){const b=mh(_,x),S=Math.pow(2,_.z);for(let $=0;$<Sl;$++)for(let te=0;te<Sl;te++){const ce=ra((_.x+(te+uc(te))/xs)/S),ne=zr((_.y+($+uc($))/xs)/S),oe=x.project(ce,ne),me=$*Sl+te;Zo[2*me+0]=Math.round((oe.x*b.scale-b.x)*qt),Zo[2*me+1]=Math.round((oe.y*b.scale-b.y)*qt)}fu.fill(0),lc.fill(0);for(let $=2045;$>=0;$--){const te=4*$,ce=bs[te+0],ne=bs[te+1],oe=bs[te+2],me=bs[te+3],he=ce+oe>>1,Ae=ne+me>>1,Se=he+Ae-ne,Fe=Ae+ce-he,Xe=ne*Sl+ce,Me=me*Sl+oe,Ve=Ae*Sl+he,$e=Math.hypot((Zo[2*Xe+0]+Zo[2*Me+0])/2-Zo[2*Ve+0],(Zo[2*Xe+1]+Zo[2*Me+1])/2-Zo[2*Ve+1])>=16;if(fu[Ve]=fu[Ve]||($e?1:0),$<1022){const Ke=(ne+Fe>>1)*Sl+(ce+Se>>1),tt=(me+Fe>>1)*Sl+(oe+Se>>1);fu[Ve]=fu[Ve]||fu[Ke]||fu[tt]}}const M=new hi,R=new Wn;let I=0;function L($,te){const ce=te*Sl+$;return lc[ce]===0&&(M.emplaceBack(Zo[2*ce+0],Zo[2*ce+1],$*qt/xs,te*qt/xs),lc[ce]=++I),lc[ce]-1}function N($,te,ce,ne,oe,me){const he=$+ce>>1,Ae=te+ne>>1;if(Math.abs($-oe)+Math.abs(te-me)>1&&fu[Ae*Sl+he])N(oe,me,$,te,he,Ae),N(ce,ne,oe,me,he,Ae);else{const Se=L($,te),Fe=L(ce,ne),Xe=L(oe,me);R.emplaceBack(Se,Fe,Xe)}}return N(0,0,xs,xs,xs,0),N(xs,xs,0,0,0,xs),{vertices:M,indices:R}}(this.tileID.canonical,i);l=p.vertices,d=p.indices}else{l=new hi,d=new Wn;for(const{x:_,y:x}of o)l.emplaceBack(_,x,0,0);const p=nh.exports(l.int16,void 0,4);for(let _=0;_<p.length;_+=3)d.emplaceBack(p[_],p[_+1],p[_+2])}this._tileBoundsBuffer=e.createVertexBuffer(l,pu.members),this._tileBoundsIndexBuffer=e.createIndexBuffer(d),this._tileBoundsSegments=Dr.simpleSegment(0,0,l.length,d.length)}_makeGlobeTileDebugBuffers(e,i){const o=i.projection;if(!o||o.name!=="globe"||i.freezeTileCoverage)return;const l=this.tileID.canonical,d=kf(Ly(l,i)),p=ph(i.zoom);let _;p>0&&(_=Gp(new Float64Array(16),i.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(e,l,i,d,_,p),this._makeGlobeTileDebugTextBuffer(e,l,i,d,_,p)}_globePoint(e,i,o,l,d,p,_){let x=fh(e,i,o);if(p){const b=1<<o.z,S=Gs(l.center.lng),M=$s(l.center.lat),R=(o.x+.5)/b-S;let I=0;R>.5?I=-1:R<-.5&&(I=1);let L=(e/qt+o.x)/b+I,N=(i/qt+o.y)/b;L=(L-S)*l._pixelsPerMercatorPixel+S,N=(N-M)*l._pixelsPerMercatorPixel+M;const $=[L*l.worldSize,N*l.worldSize,0];ji($,$,p),x=dh(x,$,_)}return ji(x,x,d)}_makeGlobeTileDebugBorderBuffer(e,i,o,l,d,p){const _=new Gn,x=new rt,b=new _i,S=(R,I,L,N,$)=>{const te=(L-R)/($-1),ce=(N-I)/($-1),ne=_.length;for(let oe=0;oe<$;oe++){const me=R+oe*te,he=I+oe*ce;_.emplaceBack(me,he);const Ae=this._globePoint(me,he,i,o,l,d,p);b.emplaceBack(Ae[0],Ae[1],Ae[2]),x.emplaceBack(ne+oe)}},M=qt;S(0,0,M,0,16),S(M,0,M,M,16),S(M,M,0,M,16),S(0,M,0,0,16),this._tileDebugIndexBuffer=e.createIndexBuffer(x),this._tileDebugBuffer=e.createVertexBuffer(_,ic.members),this._globeTileDebugBorderBuffer=e.createVertexBuffer(b,Df.members),this._tileDebugSegments=Dr.simpleSegment(0,0,_.length,x.length)}_makeGlobeTileDebugTextBuffer(e,i,o,l,d,p){const _=new Gn,x=new Wn,b=new _i,S=25;x.reserve(32),_.reserve(S),b.reserve(S);const M=(R,I)=>S*R+I;for(let R=0;R<S;R++){const I=2048*R;for(let L=0;L<S;L++){const N=2048*L;_.emplaceBack(N,I);const $=this._globePoint(N,I,i,o,l,d,p);b.emplaceBack($[0],$[1],$[2])}}for(let R=0;R<4;R++)for(let I=0;I<4;I++){const L=M(R,I),N=M(R,I+1),$=M(R+1,I),te=M(R+1,I+1);x.emplaceBack(L,N,$),x.emplaceBack($,N,te)}this._tileDebugTextIndexBuffer=e.createIndexBuffer(x),this._tileDebugTextBuffer=e.createVertexBuffer(_,ic.members),this._globeTileDebugTextBuffer=e.createVertexBuffer(b,Df.members),this._tileDebugTextSegments=Dr.simpleSegment(0,0,S,32)}}class Yg{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,i,o){const l=String(i);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][l]=this.stateChanges[e][l]||{},Kn(this.stateChanges[e][l],o),this.deletedStates[e]===null){this.deletedStates[e]={};for(const d in this.state[e])d!==l&&(this.deletedStates[e][d]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][l]===null){this.deletedStates[e][l]={};for(const d in this.state[e][l])o[d]||(this.deletedStates[e][l][d]=null)}else for(const d in o)this.deletedStates[e]&&this.deletedStates[e][l]&&this.deletedStates[e][l][d]===null&&delete this.deletedStates[e][l][d]}removeFeatureState(e,i,o){if(this.deletedStates[e]===null)return;const l=String(i);if(this.deletedStates[e]=this.deletedStates[e]||{},o&&i!==void 0)this.deletedStates[e][l]!==null&&(this.deletedStates[e][l]=this.deletedStates[e][l]||{},this.deletedStates[e][l][o]=null);else if(i!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][l])for(o in this.deletedStates[e][l]={},this.stateChanges[e][l])this.deletedStates[e][l][o]=null;else this.deletedStates[e][l]=null;else this.deletedStates[e]=null}getState(e,i){const o=String(i),l=Kn({},(this.state[e]||{})[o],(this.stateChanges[e]||{})[o]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const d=this.deletedStates[e][i];if(d===null)return{};for(const p in d)delete l[p]}return l}initializeTileState(e,i){e.setFeatureState(this.state,i)}coalesceChanges(e,i){const o={};for(const l in this.stateChanges){this.state[l]=this.state[l]||{};const d={};for(const p in this.stateChanges[l])this.state[l][p]||(this.state[l][p]={}),Kn(this.state[l][p],this.stateChanges[l][p]),d[p]=this.state[l][p];o[l]=d}for(const l in this.deletedStates){this.state[l]=this.state[l]||{};const d={};if(this.deletedStates[l]===null)for(const p in this.state[l])d[p]={},this.state[l][p]={};else for(const p in this.deletedStates[l]){if(this.deletedStates[l][p]===null)this.state[l][p]={};else for(const _ of Object.keys(this.deletedStates[l][p]))delete this.state[l][p][_];d[p]=this.state[l][p]}o[l]=o[l]||{},Kn(o[l],d)}if(this.stateChanges={},this.deletedStates={},Object.keys(o).length!==0)for(const l in e)e[l].setFeatureState(o,i)}}class Zy{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,i){const o=this.toIdx(e,i);return{min:this.minimums[o],max:this.maximums[o]}}isLeaf(e,i){return this.leaves[this.toIdx(e,i)]}toIdx(e,i){return i*this.size+e}}function Kg(n,e,i,o){let l=0,d=Number.MAX_VALUE;for(let p=0;p<3;p++)if(Math.abs(o[p])<1e-15){if(i[p]<n[p]||i[p]>e[p])return null}else{const _=1/o[p];let x=(n[p]-i[p])*_,b=(e[p]-i[p])*_;if(x>b){const S=x;x=b,b=S}if(x>l&&(l=x),b<d&&(d=b),l>d)return null}return l}function Jg(n,e,i,o,l,d,p,_,x,b,S){const M=o-n,R=l-e,I=d-i,L=p-n,N=_-e,$=x-i,te=S[1]*$-S[2]*N,ce=S[2]*L-S[0]*$,ne=S[0]*N-S[1]*L,oe=M*te+R*ce+I*ne;if(Math.abs(oe)<1e-15)return null;const me=1/oe,he=b[0]-n,Ae=b[1]-e,Se=b[2]-i,Fe=(he*te+Ae*ce+Se*ne)*me;if(Fe<0||Fe>1)return null;const Xe=Ae*I-Se*R,Me=Se*M-he*I,Ve=he*R-Ae*M,$e=(S[0]*Xe+S[1]*Me+S[2]*Ve)*me;return $e<0||Fe+$e>1?null:(L*Xe+N*Me+$*Ve)*me}function Vf(n,e,i){return(n-e)/(i-e)}function ws(n,e,i,o,l,d,p,_,x){const b=1<<i,S=d-o,M=p-l,R=(n+1)/b*S+o,I=(e+0)/b*M+l,L=(e+1)/b*M+l;_[0]=(n+0)/b*S+o,_[1]=I,x[0]=R,x[1]=L}class gm{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const i=function(d){const p=Math.ceil(Math.log2(d.dim/8)),_=[];let x=Math.ceil(Math.pow(2,p));const b=1/x,S=(I,L,N,$,te)=>{const ce=$?1:0,ne=(I+1)*N-ce,oe=L*N,me=(L+1)*N-ce;te[0]=I*N,te[1]=oe,te[2]=ne,te[3]=me};let M=new Zy(x);const R=[];for(let I=0;I<x*x;I++){S(I%x,Math.floor(I/x),b,!1,R);const L=Ha(R[0],R[1],d),N=Ha(R[2],R[1],d),$=Ha(R[2],R[3],d),te=Ha(R[0],R[3],d);M.minimums.push(Math.min(L,N,$,te)),M.maximums.push(Math.max(L,N,$,te)),M.leaves.push(1)}for(_.push(M),x/=2;x>=1;x/=2){const I=_[_.length-1];M=new Zy(x);for(let L=0;L<x*x;L++){S(L%x,Math.floor(L/x),2,!0,R);const N=I.getElevation(R[0],R[1]),$=I.getElevation(R[2],R[1]),te=I.getElevation(R[2],R[3]),ce=I.getElevation(R[0],R[3]),ne=I.isLeaf(R[0],R[1]),oe=I.isLeaf(R[2],R[1]),me=I.isLeaf(R[2],R[3]),he=I.isLeaf(R[0],R[3]),Ae=Math.min(N.min,$.min,te.min,ce.min),Se=Math.max(N.max,$.max,te.max,ce.max),Fe=ne&&oe&&me&&he;M.maximums.push(Se),M.minimums.push(Ae),M.leaves.push(Se-Ae<=5&&Fe?1:0)}_.push(M)}return _}(this.dem),o=i.length-1,l=i[o];this._addNode(l.minimums[0],l.maximums[0],l.leaves[0]),this._construct(i,0,0,o,0)}raycastRoot(e,i,o,l,d,p,_=1){return Kg([e,i,-100],[o,l,this.maximums[0]*_],d,p)}raycast(e,i,o,l,d,p,_=1){if(!this.nodeCount)return null;const x=this.raycastRoot(e,i,o,l,d,p,_);if(x==null)return null;const b=[],S=[],M=[],R=[],I=[{idx:0,t:x,nodex:0,nodey:0,depth:0}];for(;I.length>0;){const{idx:L,t:N,nodex:$,nodey:te,depth:ce}=I.pop();if(this.leaves[L]){ws($,te,ce,e,i,o,l,M,R);const oe=1<<ce,me=($+0)/oe,he=($+1)/oe,Ae=(te+0)/oe,Se=(te+1)/oe,Fe=Ha(me,Ae,this.dem)*_,Xe=Ha(he,Ae,this.dem)*_,Me=Ha(he,Se,this.dem)*_,Ve=Ha(me,Se,this.dem)*_,$e=Jg(M[0],M[1],Fe,R[0],M[1],Xe,R[0],R[1],Me,d,p),Ke=Jg(R[0],R[1],Me,M[0],R[1],Ve,M[0],M[1],Fe,d,p),tt=Math.min($e!==null?$e:Number.MAX_VALUE,Ke!==null?Ke:Number.MAX_VALUE);if(tt!==Number.MAX_VALUE)return tt;{const ke=af([],d,p,N);if(jf(Fe,Xe,Ve,Me,Vf(ke[0],M[0],R[0]),Vf(ke[1],M[1],R[1]))>=ke[2])return N}continue}let ne=0;for(let oe=0;oe<this._siblingOffset.length;oe++){ws(($<<1)+this._siblingOffset[oe][0],(te<<1)+this._siblingOffset[oe][1],ce+1,e,i,o,l,M,R),M[2]=-100,R[2]=this.maximums[this.childOffsets[L]+oe]*_;const me=Kg(M,R,d,p);if(me!=null){const he=me;b[oe]=he;let Ae=!1;for(let Se=0;Se<ne&&!Ae;Se++)he>=b[S[Se]]&&(S.splice(Se,0,oe),Ae=!0);Ae||(S[ne]=oe),ne++}}for(let oe=0;oe<ne;oe++){const me=S[oe];I.push({idx:this.childOffsets[L]+me,t:b[me],nodex:($<<1)+this._siblingOffset[me][0],nodey:(te<<1)+this._siblingOffset[me][1],depth:ce+1})}}return null}_addNode(e,i,o){return this.minimums.push(e),this.maximums.push(i),this.leaves.push(o),this.childOffsets.push(0),this.nodeCount++}_construct(e,i,o,l,d){if(e[l].isLeaf(i,o)===1)return;this.childOffsets[d]||(this.childOffsets[d]=this.nodeCount);const p=l-1,_=e[p];let x=0,b=0;for(let S=0;S<this._siblingOffset.length;S++){const M=2*i+this._siblingOffset[S][0],R=2*o+this._siblingOffset[S][1],I=_.getElevation(M,R),L=_.isLeaf(M,R),N=this._addNode(I.min,I.max,L);L&&(x|=1<<S),b||(b=N)}for(let S=0;S<this._siblingOffset.length;S++)x&1<<S||this._construct(e,2*i+this._siblingOffset[S][0],2*o+this._siblingOffset[S][1],p,b+S)}}function jf(n,e,i,o,l,d){return Bn(Bn(n,i,d),Bn(e,o,d),l)}function Ha(n,e,i){const o=i.dim,l=Ut(n*o-.5,0,o-1),d=Ut(e*o-.5,0,o-1),p=Math.floor(l),_=Math.floor(d),x=Math.min(p+1,o-1),b=Math.min(_+1,o-1);return jf(i.get(p,_),i.get(x,_),i.get(p,b),i.get(x,b),l-p,d-_)}const mu={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class oa{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,i,o,l=!1,d=!1){if(this.uid=e,i.height!==i.width)throw new RangeError("DEM tiles must be square");if(o&&o!=="mapbox"&&o!=="terrarium")return Vn(`"${o}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=i.height;const p=this.dim=i.height-2,_=new Uint32Array(i.data.buffer);if(this.pixels=new Uint8Array(i.data.buffer),this.encoding=o||"mapbox",this.borderReady=l,!l){for(let x=0;x<p;x++)_[this._idx(-1,x)]=_[this._idx(0,x)],_[this._idx(p,x)]=_[this._idx(p-1,x)],_[this._idx(x,-1)]=_[this._idx(x,0)],_[this._idx(x,p)]=_[this._idx(x,p-1)];_[this._idx(-1,-1)]=_[this._idx(0,0)],_[this._idx(p,-1)]=_[this._idx(p-1,0)],_[this._idx(-1,p)]=_[this._idx(0,p-1)],_[this._idx(p,p)]=_[this._idx(p-1,p-1)],d&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new gm(this)}get(e,i,o=!1){o&&(e=Ut(e,-1,this.dim),i=Ut(i,-1,this.dim));const l=4*this._idx(e,i);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(this.pixels[l],this.pixels[l+1],this.pixels[l+2])}static getUnpackVector(e){return mu[e]}get unpackVector(){return mu[this.encoding]}_idx(e,i){if(e<-1||e>=this.dim+1||i<-1||i>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(i+1)*this.stride+(e+1)}_unpackMapbox(e,i,o){return(256*e*256+256*i+o)/10-1e4}_unpackTerrarium(e,i,o){return 256*e+i+o/256-32768}static pack(e,i){const o=[0,0,0,0],l=oa.getUnpackVector(i);let d=Math.floor((e+l[3])/l[2]);return o[2]=d%256,d=Math.floor(d/256),o[1]=d%256,d=Math.floor(d/256),o[0]=d,o}getPixels(){return new Ki({width:this.stride,height:this.stride},this.pixels)}backfillBorder(e,i,o){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let l=i*this.dim,d=i*this.dim+this.dim,p=o*this.dim,_=o*this.dim+this.dim;switch(i){case-1:l=d-1;break;case 1:d=l+1}switch(o){case-1:p=_-1;break;case 1:_=p+1}const x=-i*this.dim,b=-o*this.dim;for(let S=p;S<_;S++)for(let M=l;M<d;M++){const R=4*this._idx(M,S),I=4*this._idx(M+x,S+b);this.pixels[R+0]=e.pixels[I+0],this.pixels[R+1]=e.pixels[I+1],this.pixels[R+2]=e.pixels[I+2],this.pixels[R+3]=e.pixels[I+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}ft(oa,"DEMData"),ft(gm,"DemMinMaxQuadTree",{omit:["dem"]});class Za{constructor(e,i){this.max=e,this.onRemove=i,this.reset()}reset(){for(const e in this.data)for(const i of this.data[e])i.timeout&&clearTimeout(i.timeout),this.onRemove(i.value);return this.data={},this.order=[],this}add(e,i,o){const l=e.wrapped().key;this.data[l]===void 0&&(this.data[l]=[]);const d={value:i,timeout:void 0};if(o!==void 0&&(d.timeout=setTimeout(()=>{this.remove(e,d)},o)),this.data[l].push(d),this.order.push(l),this.order.length>this.max){const p=this._getAndRemoveByKey(this.order[0]);p&&this.onRemove(p)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const i=this.data[e].shift();return i.timeout&&clearTimeout(i.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),i.value}getByKey(e){const i=this.data[e];return i?i[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,i){if(!this.has(e))return this;const o=e.wrapped().key,l=i===void 0?0:this.data[o].indexOf(i),d=this.data[o][l];return this.data[o].splice(l,1),d.timeout&&clearTimeout(d.timeout),this.data[o].length===0&&delete this.data[o],this.onRemove(d.value),this.order.splice(this.order.indexOf(o),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const i=this._getAndRemoveByKey(this.order[0]);i&&this.onRemove(i)}return this}filter(e){const i=[];for(const o in this.data)for(const l of this.data[o])e(l.value)||i.push(l);for(const o of i)this.remove(o.value.tileID,o)}}class cc{constructor(e,i,o){this.func=e,this.mask=i,this.range=o}}cc.ReadOnly=!1,cc.ReadWrite=!0,cc.disabled=new cc(519,cc.ReadOnly,[0,1]);const to=7680;class Xs{constructor(e,i,o,l,d,p){this.test=e,this.ref=i,this.mask=o,this.fail=l,this.depthFail=d,this.pass=p}}Xs.disabled=new Xs({func:519,mask:0},0,0,to,to,to);class sa{constructor(e,i,o){this.blendFunction=e,this.blendColor=i,this.mask=o}}sa.Replace=[1,0],sa.disabled=new sa(sa.Replace,kn.transparent,[!1,!1,!1,!1]),sa.unblended=new sa(sa.Replace,kn.transparent,[!0,!0,!0,!0]),sa.alphaBlended=new sa([1,771],kn.transparent,[!0,!0,!0,!0]);const Gf=1029,hc=2305;class Ts{constructor(e,i,o){this.enable=e,this.mode=i,this.frontFace=o}}Ts.disabled=new Ts(!1,Gf,hc),Ts.backCCW=new Ts(!0,Gf,hc),Ts.backCW=new Ts(!0,Gf,2304),Ts.frontCW=new Ts(!0,1028,2304),Ts.frontCCW=new Ts(!0,1028,hc);class Es extends an{constructor(e,i,o){super(),this.id=e,this._onlySymbols=o,i.on("data",l=>{l.dataType==="source"&&l.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&l.dataType==="source"&&l.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),i.on("error",()=>{this._sourceErrored=!0}),this._source=i,this._tiles={},this._cache=new Za(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=i.minTileCacheSize,this._maxTileCacheSize=i.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new Yg,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(e){this.map=e,this._minTileCacheSize=this._minTileCacheSize===void 0&&e?e._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&e?e._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const e in this._tiles){const i=this._tiles[e];if(i.state!=="loaded"&&i.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,i){return e.isSymbolTile=this._onlySymbols,this._source.loadTile(e,i)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e,()=>{})}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e,()=>{})}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const i in this._tiles){const o=this._tiles[i];o.upload(e),o.prepare(this.map.style.imageManager)}}getIds(){return ca(this._tiles).map(e=>e.tileID).sort($f).map(e=>e.key)}getRenderableIds(e){const i=[];for(const o in this._tiles)this._isIdRenderable(+o,e)&&i.push(this._tiles[o]);return e?i.sort((o,l)=>{const d=o.tileID,p=l.tileID,_=new Ge(d.canonical.x,d.canonical.y)._rotate(this.transform.angle),x=new Ge(p.canonical.x,p.canonical.y)._rotate(this.transform.angle);return d.overscaledZ-p.overscaledZ||x.y-_.y||x.x-_.x}).map(o=>o.tileID.key):i.map(o=>o.tileID).sort($f).map(o=>o.key)}hasRenderableParent(e){const i=this.findLoadedParent(e,0);return!!i&&this._isIdRenderable(i.tileID.key)}_isIdRenderable(e,i){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(i||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)this._tiles[e].state!=="errored"&&this._reloadTile(+e,"reloading")}}_reloadTile(e,i){const o=this._tiles[e];o&&(o.state!=="loading"&&(o.state=i),this._loadTile(o,this._tileLoaded.bind(this,o,e,i)))}_tileLoaded(e,i,o,l){if(l)if(e.state="errored",l.status!==404)this._source.fire(new _a(l,{tile:e}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const d=this.map.painter.terrain;this.update(this.transform,d.getScaledDemTileSize(),!0),d.resetTileLookupCache(this.id)}else this.update(this.transform);else e.timeAdded=Rt.now(),o==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(i,e),this._source.type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new co("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}_backfillDEM(e){const i=this.getRenderableIds();for(let l=0;l<i.length;l++){const d=i[l];if(e.neighboringTiles&&e.neighboringTiles[d]){const p=this.getTileByID(d);o(e,p),o(p,e)}}function o(l,d){if(!l.dem||l.dem.borderReady)return;l.needsHillshadePrepare=!0,l.needsDEMTextureUpload=!0;let p=d.tileID.canonical.x-l.tileID.canonical.x;const _=d.tileID.canonical.y-l.tileID.canonical.y,x=Math.pow(2,l.tileID.canonical.z),b=d.tileID.key;p===0&&_===0||Math.abs(_)>1||(Math.abs(p)>1&&(Math.abs(p+x)===1?p+=x:Math.abs(p-x)===1&&(p-=x)),d.dem&&l.dem&&(l.dem.backfillBorder(d.dem,p,_),l.neighboringTiles&&l.neighboringTiles[b]&&(l.neighboringTiles[b].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,i,o,l){for(const d in this._tiles){let p=this._tiles[d];if(l[d]||!p.hasData()||p.tileID.overscaledZ<=i||p.tileID.overscaledZ>o)continue;let _=p.tileID;for(;p&&p.tileID.overscaledZ>i+1;){const b=p.tileID.scaledTo(p.tileID.overscaledZ-1);p=this._tiles[b.key],p&&p.hasData()&&(_=b)}let x=_;for(;x.overscaledZ>i;)if(x=x.scaledTo(x.overscaledZ-1),e[x.key]){l[_.key]=_;break}}}findLoadedParent(e,i){if(e.key in this._loadedParentTiles){const o=this._loadedParentTiles[e.key];return o&&o.tileID.overscaledZ>=i?o:null}for(let o=e.overscaledZ-1;o>=i;o--){const l=e.scaledTo(o),d=this._getLoadedTile(l);if(d)return d}}_getLoadedTile(e){const i=this._tiles[e.key];return i&&i.hasData()?i:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,i){i=i||this._source.tileSize;const o=Math.ceil(e.width/i)+1,l=Math.ceil(e.height/i)+1,d=Math.floor(o*l*5),p=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,d):d,_=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,p):p;this._cache.setMaxSize(_)}handleWrapJump(e){const i=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,i){const o={};for(const l in this._tiles){const d=this._tiles[l];d.tileID=d.tileID.unwrapTo(d.tileID.wrap+i),o[d.tileID.key]=d}this._tiles=o;for(const l in this._timers)clearTimeout(this._timers[l]),delete this._timers[l];for(const l in this._tiles)this._setTileReloadTimer(+l,this._tiles[l])}}update(e,i,o){if(this.transform=e,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!o)return;let l;this.updateCacheSize(e,i),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?l=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(_=>new $a(_.canonical.z,_.wrap,_.canonical.z,_.canonical.x,_.canonical.y)):(l=e.coveringTiles({tileSize:i||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!o,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(l=l.filter(_=>this._source.hasTile(_)))):l=[];const d=this._updateRetainedTiles(l);if(Ws(this._source.type)&&l.length!==0){const _={},x={},b=Object.keys(d);for(const M of b){const R=d[M],I=this._tiles[M];if(!I||I.fadeEndTime&&I.fadeEndTime<=Rt.now())continue;const L=this.findLoadedParent(R,Math.max(R.overscaledZ-Es.maxOverzooming,this._source.minzoom));L&&(this._addTile(L.tileID),_[L.tileID.key]=L.tileID),x[M]=R}const S=l[l.length-1].overscaledZ;for(const M in this._tiles){const R=this._tiles[M];if(d[M]||!R.hasData())continue;let I=R.tileID;for(;I.overscaledZ>S;){I=I.scaledTo(I.overscaledZ-1);const L=this._tiles[I.key];if(L&&L.hasData()&&x[I.key]){d[M]=R.tileID;break}}}for(const M in _)d[M]||(this._coveredTiles[M]=!0,d[M]=_[M])}for(const _ in d)this._tiles[_].clearFadeHold();const p=function(_,x){const b=[];for(const S in _)S in x||b.push(S);return b}(this._tiles,d);for(const _ of p){const x=this._tiles[_];x.hasSymbolBuckets&&!x.holdingForFade()?x.setHoldDuration(this.map._fadeDuration):x.hasSymbolBuckets&&!x.symbolFadeFinished()||this._removeTile(+_)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){const i={};if(e.length===0)return i;const o={},l=e.reduce((b,S)=>Math.min(b,S.overscaledZ),1/0),d=e[0].overscaledZ,p=Math.max(d-Es.maxOverzooming,this._source.minzoom),_=Math.max(d+Es.maxUnderzooming,this._source.minzoom),x={};for(const b of e){const S=this._addTile(b);i[b.key]=b,S.hasData()||l<this._source.maxzoom&&(x[b.key]=b)}this._retainLoadedChildren(x,l,_,i);for(const b of e){let S=this._tiles[b.key];if(S.hasData())continue;if(b.canonical.z>=this._source.maxzoom){const R=b.children(this._source.maxzoom)[0],I=this.getTile(R);if(I&&I.hasData()){i[R.key]=R;continue}}else{const R=b.children(this._source.maxzoom);if(i[R[0].key]&&i[R[1].key]&&i[R[2].key]&&i[R[3].key])continue}let M=S.wasRequested();for(let R=b.overscaledZ-1;R>=p;--R){const I=b.scaledTo(R);if(o[I.key]||(o[I.key]=!0,S=this.getTile(I),!S&&M&&(S=this._addTile(I)),S&&(i[I.key]=I,M=S.wasRequested(),S.hasData())))break}}return i}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const i=[];let o,l=this._tiles[e].tileID;for(;l.overscaledZ>0;){if(l.key in this._loadedParentTiles){o=this._loadedParentTiles[l.key];break}i.push(l.key);const d=l.scaledTo(l.overscaledZ-1);if(o=this._getLoadedTile(d),o)break;l=d}for(const d of i)this._loadedParentTiles[d]=o}}_addTile(e){let i=this._tiles[e.key];if(i)return i;i=this._cache.getAndRemove(e),i&&(this._setTileReloadTimer(e.key,i),i.tileID=e,this._state.initializeTileState(i,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,i)));const o=Boolean(i);if(!o){const l=this.map?this.map.painter:null;i=new wd(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,l,this._isRaster),this._loadTile(i,this._tileLoaded.bind(this,i,e.key,i.state))}return i?(i.uses++,this._tiles[e.key]=i,o||this._source.fire(new co("dataloading",{tile:i,coord:i.tileID,dataType:"source"})),i):null}_setTileReloadTimer(e,i){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const o=i.getExpiryTimeout();o&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},o))}_removeTile(e){const i=this._tiles[e];i&&(i.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),i.uses>0||(i.hasData()&&i.state!=="reloading"?this._cache.add(i.tileID,i,i.getExpiryTimeout()):(i.aborted=!0,this._abortTile(i),this._unloadTile(i))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(e,i,o){const l=[],d=this.transform;if(!d)return l;const p=d.projection.name==="globe",_=Gs(d.center.lng);for(const x in this._tiles){const b=this._tiles[x];if(o&&b.clearQueryDebugViz(),b.holdingForFade())continue;let S;if(p){const M=b.tileID.canonical;if(M.z===0){const R=[Math.abs(Ut(_,...dc(M,-1))-_),Math.abs(Ut(_,...dc(M,1))-_)];S=[0,2*R.indexOf(Math.min(...R))-1]}else{const R=[Math.abs(Ut(_,...dc(M,-1))-_),Math.abs(Ut(_,...dc(M,0))-_),Math.abs(Ut(_,...dc(M,1))-_)];S=[R.indexOf(Math.min(...R))-1]}}else S=[0];for(const M of S){const R=e.containsTile(b,d,i,M);R&&l.push(R)}}return l}getVisibleCoordinates(e){const i=this.getRenderableIds(e).map(o=>this._tiles[o].tileID);for(const o of i)o.projMatrix=this.transform.calculateProjMatrix(o.toUnwrapped());return i}hasTransition(){if(this._source.hasTransition())return!0;if(Ws(this._source.type))for(const e in this._tiles){const i=this._tiles[e];if(i.fadeEndTime!==void 0&&i.fadeEndTime>=Rt.now())return!0}return!1}setFeatureState(e,i,o){this._state.updateState(e=e||"_geojsonTileLayer",i,o)}removeFeatureState(e,i,o){this._state.removeFeatureState(e=e||"_geojsonTileLayer",i,o)}getFeatureState(e,i){return this._state.getState(e=e||"_geojsonTileLayer",i)}setDependencies(e,i,o){const l=this._tiles[e];l&&l.setDependencies(i,o)}reloadTilesForDependencies(e,i){for(const o in this._tiles)this._tiles[o].hasDependency(e,i)&&this._reloadTile(+o,"reloading");this._cache.filter(o=>!o.hasDependency(e,i))}_preloadTiles(e,i){const o=new Map,l=Array.isArray(e)?e:[e],d=this.map.painter.terrain,p=this.usedForTerrain&&d?d.getScaledDemTileSize():this._source.tileSize;for(const _ of l){const x=_.coveringTiles({tileSize:p,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const b of x)o.set(b.key,b);this.usedForTerrain&&_.updateElevation(!1)}Xi(Array.from(o.values()),(_,x)=>{const b=new wd(_,this._source.tileSize*_.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(b,S=>{this._source.type==="raster-dem"&&b.dem&&this._backfillDEM(b),x(S,b)})},i)}}function $f(n,e){const i=Math.abs(2*n.wrap)-+(n.wrap<0),o=Math.abs(2*e.wrap)-+(e.wrap<0);return n.overscaledZ-e.overscaledZ||o-i||e.canonical.y-n.canonical.y||e.canonical.x-n.canonical.x}function Ws(n){return n==="raster"||n==="image"||n==="video"||n==="custom"}function dc(n,e){const i=1<<n.z;return[n.x/i+e,(n.x+1)/i+e]}Es.maxOverzooming=10,Es.maxUnderzooming=3;class Td{constructor(e,i,o){this._demTile=e,this._dem=this._demTile.dem,this._scale=i,this._offset=o}static create(e,i,o){const l=o||e.findDEMTileFor(i);if(!l||!l.dem)return;const d=l.dem,p=l.tileID,_=1<<i.canonical.z-p.canonical.z;return new Td(l,l.tileSize/qt/_,[(i.canonical.x/_-p.canonical.x)*d.dim,(i.canonical.y/_-p.canonical.y)*d.dim])}tileCoordToPixel(e,i){const o=i*this._scale+this._offset[1],l=Math.floor(e*this._scale+this._offset[0]),d=Math.floor(o);return new Ge(l,d)}getElevationAt(e,i,o,l){const d=e*this._scale+this._offset[0],p=i*this._scale+this._offset[1],_=Math.floor(d),x=Math.floor(p),b=this._dem;return l=!!l,o?Bn(Bn(b.get(_,x,l),b.get(_,x+1,l),p-x),Bn(b.get(_+1,x,l),b.get(_+1,x+1,l),p-x),d-_):b.get(_,x,l)}getElevationAtPixel(e,i,o){return this._dem.get(e,i,!!o)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*fs(1,e)*this._dem.stride}}class Qg{constructor(e,i){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new pl(qt,16,0),this.featureIndexArray=new Cp,this.promoteId=i}insert(e,i,o,l,d,p=0){const _=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(o,l,d,p);const x=this.grid;for(let b=0;b<i.length;b++){const S=i[b],M=[1/0,1/0,-1/0,-1/0];for(let R=0;R<S.length;R++){const I=S[R];M[0]=Math.min(M[0],I.x),M[1]=Math.min(M[1],I.y),M[2]=Math.max(M[2],I.x),M[3]=Math.max(M[3],I.y)}M[0]<qt&&M[1]<qt&&M[2]>=0&&M[3]>=0&&x.insert(_,M[0],M[1],M[2],M[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new bg(new sh(this.rawTileData)).layers,this.sourceLayerCoder=new bd(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,i,o,l){this.loadVTLayers();const d=e.params||{},p=cl(d.filter),_=e.tileResult,x=e.transform,b=_.bufferedTilespaceBounds,S=this.grid.query(b.min.x,b.min.y,b.max.x,b.max.y,(L,N,$,te)=>B_(_.bufferedTilespaceGeometry,L,N,$,te));S.sort(_m);let M=null;x.elevation&&S.length>0&&(M=Td.create(x.elevation,this.tileID));const R={};let I;for(let L=0;L<S.length;L++){const N=S[L];if(N===I)continue;I=N;const $=this.featureIndexArray.get(N);let te=null;this.loadMatchingFeature(R,$,p,d.layers,d.availableImages,i,o,l,(ce,ne,oe,me=0)=>(te||(te=tu(ce,this.tileID.canonical,e.tileTransform)),ne.queryIntersectsFeature(_,ce,oe,te,this.z,e.transform,e.pixelPosMatrix,M,me)))}return R}loadMatchingFeature(e,i,o,l,d,p,_,x,b){const{featureIndex:S,bucketIndex:M,sourceLayerIndex:R,layoutVertexArrayOffset:I}=i,L=this.bucketLayerIDs[M];if(l&&!function(ce,ne){for(let oe=0;oe<ce.length;oe++)if(ne.indexOf(ce[oe])>=0)return!0;return!1}(l,L))return;const N=this.sourceLayerCoder.decode(R),$=this.vtLayers[N].feature(S);if(o.needGeometry){const ce=Wu($,!0);if(!o.filter(new ve(this.tileID.overscaledZ),ce,this.tileID.canonical))return}else if(!o.filter(new ve(this.tileID.overscaledZ),$))return;const te=this.getId($,N);for(let ce=0;ce<L.length;ce++){const ne=L[ce];if(l&&l.indexOf(ne)<0)continue;const oe=p[ne];if(!oe)continue;let me={};te!==void 0&&x&&(me=x.getState(oe.sourceLayer||"_geojsonTileLayer",te));const he=Kn({},_[ne]);he.paint=e_(he.paint,oe.paint,$,me,d),he.layout=e_(he.layout,oe.layout,$,me,d);const Ae=!b||b($,oe,me,I);if(!Ae)continue;const Se=new Hy($,this.z,this.x,this.y,te);Se.layer=he;let Fe=e[ne];Fe===void 0&&(Fe=e[ne]=[]),Fe.push({featureIndex:S,feature:Se,intersectionZ:Ae})}}lookupSymbolFeatures(e,i,o,l,d,p,_,x){const b={};this.loadVTLayers();const S=cl(d);for(const M of e)this.loadMatchingFeature(b,{bucketIndex:o,sourceLayerIndex:l,featureIndex:M,layoutVertexArrayOffset:0},S,p,_,x,i);return b}loadFeature(e){const{featureIndex:i,sourceLayerIndex:o}=e;this.loadVTLayers();const l=this.sourceLayerCoder.decode(o),d=this.vtFeatures[l];if(d[i])return d[i];const p=this.vtLayers[l].feature(i);return d[i]=p,p}hasLayer(e){for(const i of this.bucketLayerIDs)for(const o of i)if(e===o)return!0;return!1}getId(e,i){let o=e.id;if(this.promoteId){const l=typeof this.promoteId=="string"?this.promoteId:this.promoteId[i];l!=null&&(o=e.properties[l]),typeof o=="boolean"&&(o=Number(o))}return o}}function e_(n,e,i,o,l){return Lr(n,(d,p)=>{const _=e instanceof it?e.get(p):null;return _&&_.evaluate?_.evaluate(i,o,l):_})}function _m(n,e){return e-n}ft(Qg,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class t_{constructor(e,i){this.width=e,this.height=i,this.nextRow=0,this.image=new vl({width:e,height:i}),this.positions={},this.uploaded=!1}getDash(e,i){const o=this.getKey(e,i);return this.positions[o]}trim(){const e=this.width,i=this.height=or(this.nextRow);this.image.resize({width:e,height:i})}getKey(e,i){return e.join(",")+i}getDashRanges(e,i,o){const l=[];let d=e.length%2==1?-e[e.length-1]*o:0,p=e[0]*o,_=!0;l.push({left:d,right:p,isDash:_,zeroLength:e[0]===0});let x=e[0];for(let b=1;b<e.length;b++){_=!_;const S=e[b];d=x*o,x+=S,p=x*o,l.push({left:d,right:p,isDash:_,zeroLength:S===0})}return l}addRoundDash(e,i,o){const l=i/2;for(let d=-o;d<=o;d++){const p=this.width*(this.nextRow+o+d);let _=0,x=e[_];for(let b=0;b<this.width;b++){b/x.right>1&&(x=e[++_]);const S=Math.abs(b-x.left),M=Math.abs(b-x.right),R=Math.min(S,M);let I;const L=d/o*(l+1);if(x.isDash){const N=l-Math.abs(L);I=Math.sqrt(R*R+N*N)}else I=l-Math.sqrt(R*R+L*L);this.image.data[p+b]=Math.max(0,Math.min(255,I+128))}}}addRegularDash(e,i){for(let x=e.length-1;x>=0;--x){const b=e[x],S=e[x+1];b.zeroLength?e.splice(x,1):S&&S.isDash===b.isDash&&(S.left=b.left,e.splice(x,1))}const o=e[0],l=e[e.length-1];o.isDash===l.isDash&&(o.left=l.left-this.width,l.right=o.right+this.width);const d=this.width*this.nextRow;let p=0,_=e[p];for(let x=0;x<this.width;x++){x/_.right>1&&(_=e[++p]);const b=Math.abs(x-_.left),S=Math.abs(x-_.right),M=Math.min(b,S);this.image.data[d+x]=Math.max(0,Math.min(255,(_.isDash?M:-M)+i+128))}}addDash(e,i){const o=this.getKey(e,i);if(this.positions[o])return this.positions[o];const l=i==="round",d=l?7:0,p=2*d+1;if(this.nextRow+p>this.height)return Vn("LineAtlas out of space"),null;e.length===0&&e.push(1);let _=0;for(let S=0;S<e.length;S++)e[S]<0&&(Vn("Negative value is found in line dasharray, replacing values with 0"),e[S]=0),_+=e[S];if(_!==0){const S=this.width/_,M=this.getDashRanges(e,this.width,S);l?this.addRoundDash(M,S,d):this.addRegularDash(M,i==="square"?.5*S:0)}const x=this.nextRow+d;this.nextRow+=p;const b={tl:[x,d],br:[_,0]};return this.positions[o]=b,b}}ft(t_,"LineAtlas");class Xy{constructor(e){const i={},o=[];for(const _ in e){const x=e[_],b=i[_]={};for(const S in x.glyphs){const M=x.glyphs[+S];if(!M||M.bitmap.width===0||M.bitmap.height===0)continue;const R=M.metrics.localGlyph?2:1,I={x:0,y:0,w:M.bitmap.width+2*R,h:M.bitmap.height+2*R};o.push(I),b[S]=I}}const{w:l,h:d}=Tf(o),p=new vl({width:l||1,height:d||1});for(const _ in e){const x=e[_];for(const b in x.glyphs){const S=x.glyphs[+b];if(!S||S.bitmap.width===0||S.bitmap.height===0)continue;const M=i[_][b],R=S.metrics.localGlyph?2:1;vl.copy(S.bitmap,p,{x:0,y:0},{x:M.x+R,y:M.y+R},S.bitmap)}}this.image=p,this.positions=i}}ft(Xy,"GlyphAtlas");class fc{constructor(e){this.tileID=new $a(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.canonical=e.tileID.canonical,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.enableTerrain=!!e.enableTerrain,this.isSymbolTile=e.isSymbolTile,this.tileTransform=mh(e.tileID.canonical,e.projection),this.projection=e.projection}parse(e,i,o,l,d){this.status="parsing",this.data=e,this.collisionBoxArray=new $u;const p=new bd(Object.keys(e.layers).sort()),_=new Qg(this.tileID,this.promoteId);_.bucketLayerIDs=[];const x={},b=new t_(256,256),S={featureIndex:_,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:b,availableImages:o},M=i.familiesBySource[this.source];for(const me in M){const he=e.layers[me];if(!he)continue;let Ae=!1,Se=!1;for(const Me of M[me])Me[0].type==="symbol"?Ae=!0:Se=!0;if(this.isSymbolTile===!0&&!Ae||this.isSymbolTile===!1&&!Se)continue;he.version===1&&Vn(`Vector tile source "${this.source}" layer "${me}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Fe=p.encode(me),Xe=[];for(let Me=0;Me<he.length;Me++){const Ve=he.feature(Me),$e=_.getId(Ve,me);Xe.push({feature:Ve,id:$e,index:Me,sourceLayerIndex:Fe})}for(const Me of M[me]){const Ve=Me[0];this.isSymbolTile!==void 0&&Ve.type==="symbol"!==this.isSymbolTile||Ve.minzoom&&this.zoom<Math.floor(Ve.minzoom)||Ve.maxzoom&&this.zoom>=Ve.maxzoom||Ve.visibility!=="none"&&(Ed(Me,this.zoom,o),(x[Ve.id]=Ve.createBucket({index:_.bucketLayerIDs.length,layers:Me,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Fe,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:o})).populate(Xe,S,this.tileID.canonical,this.tileTransform),_.bucketLayerIDs.push(Me.map($e=>$e.id)))}}let R,I,L,N;b.trim();const $={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},te=Lr(S.glyphDependencies,me=>Object.keys(me).map(Number));Object.keys(te).length?l.send("getGlyphs",{uid:this.uid,stacks:te},(me,he)=>{R||(R=me,I=he,oe.call(this))},void 0,!1,$):I={};const ce=Object.keys(S.iconDependencies);ce.length?l.send("getImages",{icons:ce,source:this.source,tileID:this.tileID,type:"icons"},(me,he)=>{R||(R=me,L=he,oe.call(this))},void 0,!1,$):L={};const ne=Object.keys(S.patternDependencies);function oe(){if(R)return d(R);if(I&&L&&N){const me=new Xy(I),he=new Ey(L,N);for(const Ae in x){const Se=x[Ae];Se instanceof sc?(Ed(Se.layers,this.zoom,o),Mf(Se,I,me.positions,L,he.iconPositions,this.showCollisionBoxes,o,this.tileID.canonical,this.tileZoom,this.projection)):Se.hasPattern&&(Se instanceof _f||Se instanceof Ju||Se instanceof pf)&&(Ed(Se.layers,this.zoom,o),Se.addFeatures(S,this.tileID.canonical,he.patternPositions,o,this.tileTransform))}this.status="done",d(null,{buckets:ca(x).filter(Ae=>!Ae.isEmpty()),featureIndex:_,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:me.image,lineAtlas:b,imageAtlas:he,glyphMap:this.returnDependencies?I:null,iconMap:this.returnDependencies?L:null,glyphPositions:this.returnDependencies?me.positions:null})}}ne.length?l.send("getImages",{icons:ne,source:this.source,tileID:this.tileID,type:"patterns"},(me,he)=>{R||(R=me,N=he,oe.call(this))},void 0,!1,$):N={},oe.call(this)}}function Ed(n,e,i){const o=new ve(e);for(const l of n)l.recalculate(o,i)}class Cl{constructor(e){this.entries={},this.scheduler=e}request(e,i,o,l){const d=this.entries[e]=this.entries[e]||{callbacks:[]};if(d.result){const[p,_]=d.result;return this.scheduler?this.scheduler.add(()=>{l(p,_)},i):l(p,_),()=>{}}return d.callbacks.push(l),d.cancel||(d.cancel=o((p,_)=>{d.result=[p,_];for(const x of d.callbacks)this.scheduler?this.scheduler.add(()=>{x(p,_)},i):x(p,_);setTimeout(()=>delete this.entries[e],3e3)})),()=>{d.result||(d.callbacks=d.callbacks.filter(p=>p!==l),d.callbacks.length||(d.cancel(),delete this.entries[e]))}}}function ym(n,e,i){const o=JSON.stringify(n.request);return n.data&&(this.deduped.entries[o]={result:[null,n.data]}),this.deduped.request(o,{type:"parseTile",isSymbolTile:n.isSymbolTile,zoom:n.tileZoom},l=>{const d=Pn(n.request,(p,_,x,b)=>{p?l(p):_&&l(null,{vectorTile:i?void 0:new bg(new sh(_)),rawData:_,cacheControl:x,expires:b})});return()=>{d.cancel(),l()}},e)}u.ARRAY_TYPE=ja,u.AUTH_ERR_MSG=Gr,u.Aabb=Ga,u.Actor=class{constructor(n,e,i){this.target=n,this.parent=e,this.mapId=i,this.callbacks={},this.cancelCallbacks={},Yr(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=Ri()?n:Oe,this.scheduler=new Xg}send(n,e,i,o,l=!1,d){const p=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(i.metadata=d,this.callbacks[p]=i);const _=Vr(this.globalScope)?void 0:[];return this.target.postMessage({id:p,type:n,hasCallback:!!i,targetMapId:o,mustQueue:l,sourceMapId:this.mapId,data:wa(e,_)},_),{cancel:()=>{i&&delete this.callbacks[p],this.target.postMessage({id:p,type:"<cancel>",targetMapId:o,sourceMapId:this.mapId})}}}receive(n){const e=n.data,i=e.id;if(i&&(!e.targetMapId||this.mapId===e.targetMapId))if(e.type==="<cancel>"){const o=this.cancelCallbacks[i];delete this.cancelCallbacks[i],o&&o.cancel()}else if(e.mustQueue||Ri()){const o=this.callbacks[i];this.cancelCallbacks[i]=this.scheduler.add(()=>this.processTask(i,e),o&&o.metadata||{type:"message"})}else this.processTask(i,e)}processTask(n,e){if(e.type==="<response>"){const i=this.callbacks[n];delete this.callbacks[n],i&&(e.error?i(Fo(e.error)):i(null,Fo(e.data)))}else{const i=Vr(this.globalScope)?void 0:[],o=e.hasCallback?(d,p)=>{delete this.cancelCallbacks[n],this.target.postMessage({id:n,type:"<response>",sourceMapId:this.mapId,error:d?wa(d):null,data:wa(p,i)},i)}:d=>{},l=Fo(e.data);if(this.parent[e.type])this.parent[e.type](e.sourceMapId,l,o);else if(this.parent.getWorkerSource){const d=e.type.split(".");this.parent.getWorkerSource(e.sourceMapId,d[0],l.source)[d[1]](l,o)}else o(new Error(`Could not find function ${e.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},u.CanonicalTileID=em,u.Color=kn,u.ColorMode=sa,u.CullFaceMode=Ts,u.DEMData=oa,u.DataConstantProperty=be,u.DedupedRequest=Cl,u.DepthMode=cc,u.EXTENT=qt,u.Elevation=class{isDataAvailableAtPoint(n){const e=this._source();if(this.isUsingMockSource()||!e||n.y<0||n.y>1)return!1;const i=e.getSource().maxzoom,o=1<<i,l=Math.floor(n.x),d=Math.floor((n.x-l)*o),p=Math.floor(n.y*o),_=this.findDEMTileFor(new $a(i,l,i,d,p));return!(!_||!_.dem)}getAtPointOrZero(n,e=0){return this.getAtPoint(n,e)||0}getAtPoint(n,e,i=!0){if(this.isUsingMockSource())return null;e==null&&(e=null);const o=this._source();if(!o||n.y<0||n.y>1)return e;const l=o.getSource().maxzoom,d=1<<l,p=Math.floor(n.x),_=n.x-p,x=new $a(l,p,l,Math.floor(_*d),Math.floor(n.y*d)),b=this.findDEMTileFor(x);if(!b||!b.dem)return e;const S=b.dem,M=1<<b.tileID.canonical.z,R=(_*M-b.tileID.canonical.x)*S.dim,I=(n.y*M-b.tileID.canonical.y)*S.dim,L=Math.floor(R),N=Math.floor(I);return(i?this.exaggeration():1)*Bn(Bn(S.get(L,N),S.get(L,N+1),I-N),Bn(S.get(L+1,N),S.get(L+1,N+1),I-N),R-L)}getAtTileOffset(n,e,i){const o=1<<n.canonical.z;return this.getAtPointOrZero(new qs(n.wrap+(n.canonical.x+e/qt)/o,(n.canonical.y+i/qt)/o))}getAtTileOffsetFunc(n,e,i,o){return l=>{const d=this.getAtTileOffset(n,l.x,l.y),p=o.upVector(n.canonical,l.x,l.y);return Eo(p,p,d*o.upVectorScale(n.canonical,e,i).metersToTile),p}}getForTilePoints(n,e,i,o){if(this.isUsingMockSource())return!1;const l=Td.create(this,n,o);return!!l&&(e.forEach(d=>{d[2]=this.exaggeration()*l.getElevationAt(d[0],d[1],i)}),!0)}getMinMaxForTile(n){if(this.isUsingMockSource())return null;const e=this.findDEMTileFor(n);if(!e||!e.dem)return null;const i=e.dem.tree,o=e.tileID,l=1<<n.canonical.z-o.canonical.z;let d=n.canonical.x/l-o.canonical.x,p=n.canonical.y/l-o.canonical.y,_=0;for(let x=0;x<n.canonical.z-o.canonical.z&&!i.leaves[_];x++){d*=2,p*=2;const b=2*Math.floor(p)+Math.floor(d);_=i.childOffsets[_]+b,d%=1,p%=1}return{min:this.exaggeration()*i.minimums[_],max:this.exaggeration()*i.maximums[_]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(n,e,i){throw new Error("Pure virtual method called.")}pointCoordinate(n){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(n){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},u.ErrorEvent=_a,u.EvaluationParameters=ve,u.Event=co,u.Evented=an,u.FillExtrusionBucket=pf,u.Frustum=dg,u.FrustumCorners=hg,u.GLOBE_METERS_TO_ECEF=hh,u.GLOBE_RADIUS=Ho,u.GLOBE_SCALE_MATCH_LATITUDE=45,u.GLOBE_ZOOM_THRESHOLD_MAX=6,u.GLOBE_ZOOM_THRESHOLD_MIN=5,u.GlobeSharedBuffers=class{constructor(n){this._createGrid(n),this._createPoles(n)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const n of this._poleSegments)n.destroy();for(const n of this._gridSegments)n.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const n of this._wireframeSegments)n.destroy()}}_createGrid(n){const e=new Gn,i=new Wn,o=65;for(let l=0;l<o;l++)for(let d=0;d<o;d++)e.emplaceBack(d,l);this._gridSegments=[];for(let l=0,d=0;l<rc.length;l++){const p=rc[l];for(let x=0;x<p;x++)for(let b=0;b<64;b++){const S=x*o+b;i.emplaceBack(S+1,S,S+o),i.emplaceBack(S+o,S+o+1,S+1)}const _=64*p*2;this._gridSegments.push(Dr.simpleSegment(0,d,(p+1)*o,_)),d+=_}this._gridBuffer=n.createVertexBuffer(e,ic.members),this._gridIndexBuffer=n.createIndexBuffer(i,!0)}_createPoles(n){const e=new Wn;for(let l=0;l<=yd;l++)e.emplaceBack(0,l+1,l+2);this._poleIndexBuffer=n.createIndexBuffer(e,!0);const i=new Hc,o=new Hc;this._poleSegments=[];for(let l=0,d=0;l<5;l++){const p=360/(1<<l);i.emplaceBack(0,-Ho,0,.5,0),o.emplaceBack(0,-Ho,0,.5,1);for(let _=0;_<=yd;_++){const x=_/yd,b=Bn(0,p,x),[S,M,R]=ac(Wx,Yx,b,Ho);i.emplaceBack(S,M,R,x,0),o.emplaceBack(S,M,R,x,1)}this._poleSegments.push(Dr.simpleSegment(d,0,66,64)),d+=66}this._poleNorthVertexBuffer=n.createVertexBuffer(i,Rf,!1),this._poleSouthVertexBuffer=n.createVertexBuffer(o,Rf,!1)}getGridBuffers(n){return[this._gridBuffer,this._gridIndexBuffer,this._gridSegments[n]]}getPoleBuffers(n){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[n]]}getWirefameBuffers(n,e){if(!this._wireframeSegments){const i=new wo,o=yd,l=o+1;this._wireframeSegments=[];for(let d=0,p=0;d<rc.length;d++){const _=rc[d];for(let b=0;b<_;b++)for(let S=0;S<o;S++){const M=b*l+S;i.emplaceBack(M,M+1),i.emplaceBack(M,M+l),i.emplaceBack(M,M+l+1)}const x=_*o*3;this._wireframeSegments.push(Dr.simpleSegment(0,p,(_+1)*l,x)),p+=x}this._wireframeIndexBuffer=n.createIndexBuffer(i)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[e]]}},u.GlyphManager=_d,u.ImagePosition=uh,u.LivePerformanceUtils=We,u.LngLat=Un,u.LngLatBounds=eu,u.LocalGlyphMode=gd,u.MAX_MERCATOR_LATITUDE=ps,u.MercatorCoordinate=qs,u.ONE_EM=br,u.OverscaledTileID=$a,u.PerformanceMarkers=Te,u.Properties=Pt,u.RGBAImage=Ki,u.Ray=cg,u.RequestManager=class{constructor(n,e,i){this._transformRequestFn=n,this._customAccessToken=e,this._silenceAuthErrors=!!i,this._createSkuToken()}_createSkuToken(){const n=function(){let e="";for(let i=0;i<10;i++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",zn,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=n.token,this._skuTokenExpiresAt=n.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(n,e){return this._transformRequestFn&&this._transformRequestFn(n,e)||{url:n}}normalizeStyleURL(n,e){if(!Zn(n))return n;const i=Sa(n);return i.path=`/styles/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||e)}normalizeGlyphsURL(n,e){if(!Zn(n))return n;const i=Sa(n);return i.path=`/fonts/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||e)}normalizeSourceURL(n,e,i,o){if(!Zn(n))return n;const l=Sa(n);return l.path=`/v4/${l.authority}.json`,l.params.push("secure"),i&&l.params.push(`language=${i}`),o&&l.params.push(`worldview=${o}`),this._makeAPIURL(l,this._customAccessToken||e)}normalizeSpriteURL(n,e,i,o){const l=Sa(n);return Zn(n)?(l.path=`/styles/v1${l.path}/sprite${e}${i}`,this._makeAPIURL(l,this._customAccessToken||o)):(l.path+=`${e}${i}`,Ua(l))}normalizeTileURL(n,e,i){if(this._isSkuTokenExpired()&&this._createSkuToken(),n&&!Zn(n))return n;const o=Sa(n);o.path=o.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||i&&o.authority!=="raster"&&i===512?"@2x":""}${gt.supported?".webp":"$1"}`),o.authority==="raster"?o.path=`/${at.RASTER_URL_PREFIX}${o.path}`:(o.path=o.path.replace(/^.+\/v4\//,"/"),o.path=`/${at.TILE_URL_VERSION}${o.path}`);const l=this._customAccessToken||function(d){for(const p of d){const _=p.match(/^access_token=(.*)$/);if(_)return _[1]}return null}(o.params)||at.ACCESS_TOKEN;return at.REQUIRE_ACCESS_TOKEN&&l&&this._skuToken&&o.params.push(`sku=${this._skuToken}`),this._makeAPIURL(o,l)}canonicalizeTileURL(n,e){const i=Sa(n);if(!i.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!i.path.match(/\.[\w]+$/))return n;let o="mapbox://";i.path.match(/^\/raster\/v1\//)?o+=`raster/${i.path.replace(`/${at.RASTER_URL_PREFIX}/`,"")}`:o+=`tiles/${i.path.replace(`/${at.TILE_URL_VERSION}/`,"")}`;let l=i.params;return e&&(l=l.filter(d=>!d.match(/^access_token=/))),l.length&&(o+=`?${l.join("&")}`),o}canonicalizeTileset(n,e){const i=!!e&&Zn(e),o=[];for(const l of n.tiles||[])gi(l)?o.push(this.canonicalizeTileURL(l,i)):o.push(l);return o}_makeAPIURL(n,e){const i="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",o=Sa(at.API_URL);if(n.protocol=o.protocol,n.authority=o.authority,n.protocol==="http"){const l=n.params.indexOf("secure");l>=0&&n.params.splice(l,1)}if(o.path!=="/"&&(n.path=`${o.path}${n.path}`),!at.REQUIRE_ACCESS_TOKEN)return Ua(n);if(e=e||at.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error(`An API access token is required to use Mapbox GL. ${i}`);if(e[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${i}`)}return n.params=n.params.filter(l=>l.indexOf("access_token")===-1),n.params.push(`access_token=${e||""}`),Ua(n)}},u.ResourceType=_r,u.SegmentVector=Dr,u.SourceCache=Es,u.StencilMode=Xs,u.StructArrayLayout1ui2=rt,u.StructArrayLayout2f1f2i16=kt,u.StructArrayLayout2i4=Gn,u.StructArrayLayout2ui4=wo,u.StructArrayLayout3f12=Ln,u.StructArrayLayout3ui6=Wn,u.StructArrayLayout4i8=hi,u.StructArrayLayout5f20=Hc,u.Texture=El,u.Tile=wd,u.Transitionable=je,u.Uniform1f=Xc,u.Uniform1i=class extends Vs{constructor(n){super(n),this.current=0}set(n,e,i){this.fetchUniformLocation(n,e)&&this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))}},u.Uniform2f=class extends Vs{constructor(n){super(n),this.current=[0,0]}set(n,e,i){this.fetchUniformLocation(n,e)&&(i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1])))}},u.Uniform3f=class extends Vs{constructor(n){super(n),this.current=[0,0,0]}set(n,e,i){this.fetchUniformLocation(n,e)&&(i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2])))}},u.Uniform4f=Wc,u.UniformColor=Ip,u.UniformMatrix2f=class extends Vs{constructor(n){super(n),this.current=Jm}set(n,e,i){if(this.fetchUniformLocation(n,e)){for(let o=0;o<4;o++)if(i[o]!==this.current[o]){this.current=i,this.gl.uniformMatrix2fv(this.location,!1,i);break}}}},u.UniformMatrix3f=class extends Vs{constructor(n){super(n),this.current=Km}set(n,e,i){if(this.fetchUniformLocation(n,e)){for(let o=0;o<9;o++)if(i[o]!==this.current[o]){this.current=i,this.gl.uniformMatrix3fv(this.location,!1,i);break}}}},u.UniformMatrix4f=class extends Vs{constructor(n){super(n),this.current=Ym}set(n,e,i){if(this.fetchUniformLocation(n,e)){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(let o=1;o<16;o++)if(i[o]!==this.current[o]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}}}},u.UnwrappedTileID=dy,u.ValidationError=mt,u.VectorTileFeature=ff,u.VectorTileWorkerSource=class extends an{constructor(n,e,i,o,l){super(),this.actor=n,this.layerIndex=e,this.availableImages=i,this.loadVectorData=l||ym,this.loading={},this.loaded={},this.deduped=new Cl(n.scheduler),this.isSpriteLoaded=o,this.scheduler=n.scheduler}loadTile(n,e){const i=n.uid,o=n&&n.request,l=o&&o.collectResourceTiming,d=this.loading[i]=new fc(n);d.abort=this.loadVectorData(n,(p,_)=>{const x=!this.loading[i];if(delete this.loading[i],x||p||!_)return d.status="done",x||(this.loaded[i]=d),e(p);const b=_.rawData,S={};_.expires&&(S.expires=_.expires),_.cacheControl&&(S.cacheControl=_.cacheControl),d.vectorTile=_.vectorTile||new bg(new sh(b));const M=()=>{d.parse(d.vectorTile,this.layerIndex,this.availableImages,this.actor,(R,I)=>{if(R||!I)return e(R);const L={};if(l){const N=ot(o);N.length>0&&(L.resourceTiming=JSON.parse(JSON.stringify(N)))}e(null,Kn({rawTileData:b.slice(0)},I,S,L))})};this.isSpriteLoaded?M():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(M,{type:"parseTile",isSymbolTile:n.isSymbolTile,zoom:n.tileZoom}):M()}),this.loaded=this.loaded||{},this.loaded[i]=d})}reloadTile(n,e){const i=this.loaded,o=n.uid,l=this;if(i&&i[o]){const d=i[o];d.showCollisionBoxes=n.showCollisionBoxes,d.enableTerrain=!!n.enableTerrain,d.projection=n.projection,d.tileTransform=mh(n.tileID.canonical,n.projection);const p=(_,x)=>{const b=d.reloadCallback;b&&(delete d.reloadCallback,d.parse(d.vectorTile,l.layerIndex,this.availableImages,l.actor,b)),e(_,x)};d.status==="parsing"?d.reloadCallback=p:d.status==="done"&&(d.vectorTile?d.parse(d.vectorTile,this.layerIndex,this.availableImages,this.actor,p):p())}}abortTile(n,e){const i=n.uid,o=this.loading[i];o&&(o.abort&&o.abort(),delete this.loading[i]),e()}removeTile(n,e){const i=this.loaded,o=n.uid;i&&i[o]&&delete i[o],e()}},u.WritingMode=qa,u.add=au,u.addDynamicAttributes=pm,u.adjoint=function(n,e){var i=e[0],o=e[1],l=e[2],d=e[3],p=e[4],_=e[5],x=e[6],b=e[7],S=e[8];return n[0]=p*S-_*b,n[1]=l*b-o*S,n[2]=o*_-l*p,n[3]=_*x-d*S,n[4]=i*S-l*x,n[5]=l*d-i*_,n[6]=d*b-p*x,n[7]=o*x-i*b,n[8]=i*p-o*d,n},u.asyncAll=Xi,u.bezier=_n,u.bindAll=Yr,u.boundsAttributes=pu,u.bufferConvexPolygon=function(n,e){const i=[];for(let o=0;o<n.length;o++){const l=rn(o-1,-1,n.length-1),d=rn(o+1,-1,n.length-1),p=n[o],_=n[d],x=n[l].sub(p).unit(),b=_.sub(p).unit(),S=b.angleWithSep(x.x,x.y),M=x.add(b).unit().mult(-1*e/Math.sin(S/2));i.push(p.add(M))}return i},u.cacheEntryPossiblyAdded=function(n){Fa++,Fa>Cr&&(n.getActor().send("enforceCacheSizeLimit",Kr),Fa=0)},u.calculateGlobeLabelMatrix=function(n,e){const{x:i,y:o}=n.point,l=By(i,o,n.worldSize/n._pixelsPerMercatorPixel,0,0);return Kc(l,l,Vg(Tl(e)))},u.calculateGlobeMatrix=function(n){const{x:e,y:i}=n.point,{lng:o,lat:l}=n._center;return By(e,i,n.worldSize,o,l)},u.calculateGlobeMercatorMatrix=function(n){const e=n.pixelsPerMeter,i=e/fs(1,n.center.lat),o=Zs(new Float64Array(16));return Jh(o,o,[n.point.x,n.point.y,0]),Jc(o,o,[i,i,e]),Float32Array.from(o)},u.circumferenceAtLatitude=eg,u.clamp=Ut,u.clearTileCache=function(n){if(!jr())return;const e=Oe.caches.delete(Ba);n&&e.catch(n).then(()=>n())},u.clipLine=Sf,u.clone=function(n){var e=new ja(16);return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],e},u.clone$1=Ui,u.collisionCircleLayout=zx,u.config=at,u.conjugate=function(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n[3]=e[3],n},u.create=function(){var n=new ja(16);return ja!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0),n[0]=1,n[5]=1,n[10]=1,n[15]=1,n},u.create$1=U_,u.createExpression=ul,u.createLayout=yt,u.createStyleLayer=function(n){return n.type==="custom"?new u0(n):new h0[n.type](n)},u.cross=ug,u.degToRad=Wt,u.distance=function(n,e){return Math.hypot(e[0]-n[0],e[1]-n[1],e[2]-n[2])},u.div=function(n,e,i){return n[0]=e[0]/i[0],n[1]=e[1]/i[1],n[2]=e[2]/i[2],n},u.dot=$o,u.earthRadius=Fp,u.ease=On,u.easeCubicInOut=ua,u.ecefToLatLng=function([n,e,i]){const o=Math.hypot(n,e,i),l=Math.atan2(n,i),d=.5*Math.PI-Math.acos(-e/o);return new Un(In(l),In(d))},u.emitValidationErrors=Uu,u.endsWith=er,u.enforceCacheSizeLimit=function(n){Di(),Ni&&Ni.then(e=>{e.keys().then(i=>{for(let o=0;o<i.length-n;o++)e.delete(i[o])})})},u.evaluateSizeForFeature=cd,u.evaluateSizeForZoom=hd,u.evaluateVariableOffset=Dy,u.evented=le,u.exactEquals=function(n,e){return n[0]===e[0]&&n[1]===e[1]&&n[2]===e[2]&&n[3]===e[3]},u.exactEquals$1=function(n,e){return n[0]===e[0]&&n[1]===e[1]&&n[2]===e[2]},u.exported=Rt,u.exported$1=gt,u.extend=Kn,u.extend$1=ya,u.fillExtrusionHeightLift=Eg,u.filterObject=mr,u.fromMat4=function(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[4],n[4]=e[5],n[5]=e[6],n[6]=e[8],n[7]=e[9],n[8]=e[10],n},u.fromQuat=function(n,e){var i=e[0],o=e[1],l=e[2],d=e[3],p=i+i,_=o+o,x=l+l,b=i*p,S=o*p,M=o*_,R=l*p,I=l*_,L=l*x,N=d*p,$=d*_,te=d*x;return n[0]=1-M-L,n[1]=S+te,n[2]=R-$,n[3]=0,n[4]=S-te,n[5]=1-b-L,n[6]=I+N,n[7]=0,n[8]=R+$,n[9]=I-N,n[10]=1-b-M,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n},u.fromRotation=function(n,e){var i=Math.sin(e),o=Math.cos(e);return n[0]=o,n[1]=i,n[2]=0,n[3]=-i,n[4]=o,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n},u.fromScaling=iu,u.furthestTileCorner=function(n){const e=Math.round((n+45+360)%360/90)%4;return Ai[e]},u.getAABBPointSquareDist=function(n,e,i){let o=0;for(let l=0;l<2;++l){const d=i?i[l]:0;n[l]>d&&(o+=(n[l]-d)*(n[l]-d)),e[l]<d&&(o+=(d-e[l])*(d-e[l]))}return o},u.getAnchorAlignment=hu,u.getAnchorJustification=ch,u.getBounds=function(n){let e=1/0,i=1/0,o=-1/0,l=-1/0;for(const d of n)e=Math.min(e,d.x),i=Math.min(i,d.y),o=Math.max(o,d.x),l=Math.max(l,d.y);return{min:new Ge(e,i),max:new Ge(o,l)}},u.getColumn=gr,u.getGridMatrix=function(n,e,i,o){const l=e.getNorth(),d=e.getSouth(),p=e.getWest(),_=e.getEast(),x=1<<n.z,b=_-p,S=l-d,M=b/yd,R=-S/rc[i],I=[0,M,0,R,0,0,l,p,0];if(n.z>0){const L=180/o;og(I,I,[L/b+1,0,0,0,L/S+1,0,-.5*L/M,.5*L/R,1])}return I[2]=x,I[5]=n.x,I[8]=n.y,I},u.getImage=ri,u.getJSON=function(n,e){return sn(Kn(n,{type:"json"}),e)},u.getLatitudinalLod=function(n){const e=80.051129;n=Ut(n,-80.051129,e)/e*90;const i=Math.pow(Math.abs(Math.sin(Wt(n))),3);return Math.round(i*(rc.length-1))},u.getMapSessionAPI=ue,u.getPerformanceMeasurement=ot,u.getProjection=$y,u.getRTLTextPluginStatus=re,u.getReferrer=Nt,u.getTilePoint=function(n,{x:e,y:i},o=0){return new Ge(((e-o)*n.scale-n.x)*qt,(i*n.scale-n.y)*qt)},u.getTileVec3=function(n,e,i=0){return ed(((e.x-i)*n.scale-n.x)*qt,(e.y*n.scale-n.y)*qt,Xu(e.z,e.y))},u.getVideo=function(n,e){const i=Oe.document.createElement("video");i.muted=!0,i.onloadstart=function(){e(null,i)};for(let o=0;o<n.length;o++){const l=Oe.document.createElement("source");Jn(n[o])||(i.crossOrigin="Anonymous"),l.src=n[o],i.appendChild(l)}return{cancel:()=>{}}},u.globeCenterToScreenPoint=function(n){const e=[0,0,0],i=Zs(new Float64Array(16));return Kc(i,n.pixelMatrix,n.globeMatrix),ji(e,e,i),new Ge(e[0],e[1])},u.globeDenormalizeECEF=Vg,u.globeECEFOrigin=function(n,e){const i=[0,0,0];return ji(i,i,kf(Tl(e.canonical))),ji(i,i,n),i},u.globeNormalizeECEF=kf,u.globePixelsToTileUnits=function(n,e){return qt/(512*Math.pow(2,n))*If(Tl(e))},u.globePoleMatrixForTile=function(n,e,i){const o=Zs(new Float64Array(16)),l=(e/(1<<n)-.5)*Math.PI*2;return Qc(o,i.globeMatrix,l),Float32Array.from(o)},u.globeTileBounds=Tl,u.globeTiltAtLngLat=Fy,u.globeToMercatorTransition=ph,u.globeUseCustomAntiAliasing=function(n,e,i){const o=ph(i.zoom),l=n.style.map._antialias,d=!!e.extStandardDerivatives,p=e.extStandardDerivativesForceOff||n.terrain&&n.terrain.exaggeration()>0;return o===0&&!l&&!p&&d},u.identity=Zs,u.identity$1=G_,u.invert=Gp,u.isFullscreen=function(){return!!Oe.document.fullscreenElement||!!Oe.document.webkitFullscreenElement},u.isLngLatBehindGlobe=jg,u.isMapAuthenticated=function(n){return _e.has(n)},u.isMapboxURL=Zn,u.isSafariWithAntialiasingBug=function(n){const e=n.navigator?n.navigator.userAgent:null;return!!Vr(n)&&e&&(e.match("Version/15.4")||e.match("Version/15.5")||e.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},u.latFromMercatorY=zr,u.latLngToECEF=zf,u.len=Qv,u.length=gs,u.length$1=function(n){return Math.hypot(n[0],n[1],n[2],n[3])},u.lngFromMercatorX=ra,u.loadVectorTile=ym,u.makeRequest=sn,u.mapValue=function(n,e,i,o,l){return Ut((n-e)/(i-e)*(l-o)+o,o,l)},u.mercatorScale=To,u.mercatorXfromLng=Gs,u.mercatorYfromLat=$s,u.mercatorZfromAltitude=fs,u.mul=Yu,u.mul$1=N_,u.multiply=Kc,u.multiply$1=og,u.multiply$2=lg,u.nextPowerOfTwo=or,u.normalize=aa,u.normalize$1=$_,u.normalize$2=j_,u.number=Bn,u.ortho=function(n,e,i,o,l,d,p){var _=1/(e-i),x=1/(o-l),b=1/(d-p);return n[0]=-2*_,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*x,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*b,n[11]=0,n[12]=(e+i)*_,n[13]=(l+o)*x,n[14]=(p+d)*b,n[15]=1,n},u.pbf=sh,u.perspective=function(n,e,i,o,l){var d,p=1/Math.tan(e/2);return n[0]=p/i,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=p,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,l!=null&&l!==1/0?(n[10]=(l+o)*(d=1/(o-l)),n[14]=2*l*o*d):(n[10]=-1,n[14]=-2*o),n},u.pick=function(n,e){const i={};for(let o=0;o<e.length;o++){const l=e[o];l in n&&(i[l]=n[l])}return i},u.plugin=we,u.pointGeometry=Ge,u.polesInViewport=function(n){const e=Zs(new Float64Array(16));Kc(e,n.pixelMatrix,n.globeMatrix);const i=[0,Co,0],o=[0,vs,0];return ji(i,i,e),ji(o,o,e),[i[0]>0&&i[0]<=n.width&&i[1]>0&&i[1]<=n.height&&!jg(n,new Un(n.center.lat,90)),o[0]>0&&o[0]<=n.width&&o[1]>0&&o[1]<=n.height&&!jg(n,new Un(n.center.lat,-90))]},u.polygonContainsPoint=dr,u.polygonIntersectsBox=B_,u.polygonIntersectsPolygon=ig,u.polygonizeBounds=function(n,e,i=0,o=!0){const l=new Ge(i,i),d=n.sub(l),p=e.add(l),_=[d,new Ge(p.x,d.y),p,new Ge(d.x,p.y)];return o&&_.push(d.clone()),_},u.posAttributes=ic,u.postMapLoadEvent=O,u.postPerformanceEvent=se,u.postTurnstileEvent=V,u.potpack=Tf,u.prevPowerOfTwo=function(n){return n<=1?1:Math.pow(2,Math.floor(Math.log(n)/Math.LN2))},u.radToDeg=In,u.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],u.registerForPluginStateChange=function(n){return n({pluginStatus:ee,pluginURL:Q}),le.on("pluginStateChange",n),n},u.removeAuthState=function(n){_e.delete(n)},u.renderColorRamp=lf,u.resample=Qd,u.rotateX=nf,u.rotateX$1=of,u.rotateY=Qc,u.rotateY$1=qp,u.rotateZ=function(n,e,i){var o=Math.sin(i),l=Math.cos(i),d=e[0],p=e[1],_=e[2],x=e[3],b=e[4],S=e[5],M=e[6],R=e[7];return e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=d*l+b*o,n[1]=p*l+S*o,n[2]=_*l+M*o,n[3]=x*l+R*o,n[4]=b*l-d*o,n[5]=S*l-p*o,n[6]=M*l-_*o,n[7]=R*l-x*o,n},u.rotateZ$1=function(n,e,i){i*=.5;var o=e[0],l=e[1],d=e[2],p=e[3],_=Math.sin(i),x=Math.cos(i);return n[0]=o*x+l*_,n[1]=l*x-o*_,n[2]=d*x+p*_,n[3]=p*x-d*_,n},u.scale=Jc,u.scale$1=V_,u.scale$2=Eo,u.scaleAndAdd=af,u.set=function(n,e,i,o){return n[0]=e,n[1]=i,n[2]=o,n},u.setCacheLimits=function(n,e){Kr=n,Cr=e},u.setColumn=function(n,e,i){n[4*e+0]=i[0],n[4*e+1]=i[1],n[4*e+2]=i[2],n[4*e+3]=i[3]},u.setRTLTextPlugin=function(n,e,i=!1){if(ee===X||ee===Y||ee===G)throw new Error("setRTLTextPlugin cannot be called multiple times.");Q=Rt.resolveURL(n),ee=X,q=e,fe(),i||Ce()},u.smoothstep=Hi,u.spec=Ne,u.squaredLength=function(n){var e=n[0],i=n[1],o=n[2];return e*e+i*i+o*o},u.storeAuthState=function(n,e){e?_e.add(n):_e.delete(n)},u.sub=qo,u.subtract=sg,u.symbolSize=Ix,u.tileAABB=function(n,e,i,o,l,d,p,_,x){if(x.name==="globe")return Ug(n,e,new em(i,o,l));const b=mh({z:i,x:o,y:l},x);return new Ga([(d+b.x/b.scale)*e,e*(b.y/b.scale),p],[(d+b.x2/b.scale)*e,e*(b.y2/b.scale),_])},u.tileCornersToBounds=hm,u.tileTransform=mh,u.transformMat3=function(n,e,i){var o=e[0],l=e[1],d=e[2];return n[0]=o*i[0]+l*i[3]+d*i[6],n[1]=o*i[1]+l*i[4]+d*i[7],n[2]=o*i[2]+l*i[5]+d*i[8],n},u.transformMat4=ji,u.transformMat4$1=th,u.transformQuat=td,u.transitionTileAABBinECEF=Ly,u.translate=Jh,u.transpose=function(n,e){if(n===e){var i=e[1],o=e[2],l=e[5];n[1]=e[3],n[2]=e[6],n[3]=i,n[5]=e[7],n[6]=o,n[7]=l}else n[0]=e[0],n[1]=e[3],n[2]=e[6],n[3]=e[1],n[4]=e[4],n[5]=e[7],n[6]=e[2],n[7]=e[5],n[8]=e[8];return n},u.triggerPluginCompletionEvent=ae,u.uniqueId=rr,u.updateGlobeVertexNormal=function(n,e,i,o,l){const d=5*e+2;n.float32[d+0]=i,n.float32[d+1]=o,n.float32[d+2]=l},u.validateCustomStyleLayer=function(n){const e=[],i=n.id;return i===void 0&&e.push({message:`layers.${i}: missing required property "id"`}),n.render===void 0&&e.push({message:`layers.${i}: missing required method "render"`}),n.renderingMode&&n.renderingMode!=="2d"&&n.renderingMode!=="3d"&&e.push({message:`layers.${i}: property "renderingMode" must be either "2d" or "3d"`}),e},u.validateFilter=n=>Ca(Zl(n)),u.validateFog=n=>Ca(Xl(n)),u.validateLayer=n=>Ca(Bu(n)),u.validateLight=n=>Ca(bp(n)),u.validateSource=n=>Ca(vp(n)),u.validateStyle=fl,u.validateTerrain=n=>Ca(Fu(n)),u.values=ca,u.vectorTile=Kp,u.version=Ft,u.warnOnce=Vn,u.window=Oe,u.wrap=rn}),Sn(["./shared"],function(u){function Oe(J){if(typeof J=="number"||typeof J=="boolean"||typeof J=="string"||J==null)return JSON.stringify(J);if(Array.isArray(J)){let V="[";for(const K of J)V+=`${Oe(K)},`;return`${V}]`}let P="{";for(const V of Object.keys(J).sort())P+=`${V}:${Oe(J[V])},`;return`${P}}`}function Ft(J){let P="";for(const V of u.refProperties)P+=`/${Oe(J[V])}`;return P}class Hn{constructor(P){this.keyCache={},P&&this.replace(P)}replace(P){this._layerConfigs={},this._layers={},this.update(P,[])}update(P,V){for(const O of P)this._layerConfigs[O.id]=O,(this._layers[O.id]=u.createStyleLayer(O)).compileFilter(),this.keyCache[O.id]&&delete this.keyCache[O.id];for(const O of V)delete this.keyCache[O],delete this._layerConfigs[O],delete this._layers[O];this.familiesBySource={};const K=function(O,Z){const se={};for(let ue=0;ue<O.length;ue++){const _e=Z&&Z[O[ue].id]||Ft(O[ue]);Z&&(Z[O[ue].id]=_e);let Te=se[_e];Te||(Te=se[_e]=[]),Te.push(O[ue])}const pe=[];for(const ue in se)pe.push(se[ue]);return pe}(u.values(this._layerConfigs),this.keyCache);for(const O of K){const Z=O.map(We=>this._layers[We.id]),se=Z[0];if(se.visibility==="none")continue;const pe=se.source||"";let ue=this.familiesBySource[pe];ue||(ue=this.familiesBySource[pe]={});const _e=se.sourceLayer||"_geojsonTileLayer";let Te=ue[_e];Te||(Te=ue[_e]=[]),Te.push(Z)}}}class at{loadTile(P,V){const{uid:K,encoding:O,rawImageData:Z,padding:se,buildQuadTree:pe}=P,ue=u.window.ImageBitmap&&Z instanceof u.window.ImageBitmap?this.getImageData(Z,se):Z;V(null,new u.DEMData(K,ue,O,se<1,pe))}getImageData(P,V){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(P.width,P.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=P.width,this.offscreenCanvas.height=P.height,this.offscreenCanvasContext.drawImage(P,0,0,P.width,P.height);const K=this.offscreenCanvasContext.getImageData(-V,-V,P.width+2*V,P.height+2*V);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),K}}var gt=function J(P,V){var K,O=P&&P.type;if(O==="FeatureCollection")for(K=0;K<P.features.length;K++)J(P.features[K],V);else if(O==="GeometryCollection")for(K=0;K<P.geometries.length;K++)J(P.geometries[K],V);else if(O==="Feature")J(P.geometry,V);else if(O==="Polygon")bt(P.coordinates,V);else if(O==="MultiPolygon")for(K=0;K<P.coordinates.length;K++)bt(P.coordinates[K],V);return P};function bt(J,P){if(J.length!==0){en(J[0],P);for(var V=1;V<J.length;V++)en(J[V],!P)}}function en(J,P){for(var V=0,K=0,O=0,Z=J.length,se=Z-1;O<Z;se=O++){var pe=(J[O][0]-J[se][0])*(J[se][1]+J[O][1]),ue=V+pe;K+=Math.abs(V)>=Math.abs(pe)?V-ue+pe:pe-ue+V,V=ue}V+K>=0!=!!P&&J.reverse()}const Ir=u.VectorTileFeature.prototype.toGeoJSON;class Ea{constructor(P){this._feature=P,this.extent=u.EXTENT,this.type=P.type,this.properties=P.tags,"id"in P&&!isNaN(P.id)&&(this.id=parseInt(P.id,10))}loadGeometry(){if(this._feature.type===1){const P=[];for(const V of this._feature.geometry)P.push([new u.pointGeometry(V[0],V[1])]);return P}{const P=[];for(const V of this._feature.geometry){const K=[];for(const O of V)K.push(new u.pointGeometry(O[0],O[1]));P.push(K)}return P}}toGeoJSON(P,V,K){return Ir.call(this,P,V,K)}}class kr{constructor(P){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=u.EXTENT,this.length=P.length,this._features=P}feature(P){return new Ea(this._features[P])}}var zn={exports:{}},Rn=u.pointGeometry,Oi=u.vectorTile.VectorTileFeature,Ge=Nn;function Nn(J,P){this.options=P||{},this.features=J,this.length=J.length}function xn(J,P){this.id=typeof J.id=="number"?J.id:void 0,this.type=J.type,this.rawGeometry=J.type===1?[J.geometry]:J.geometry,this.properties=J.tags,this.extent=P||4096}Nn.prototype.feature=function(J){return new xn(this.features[J],this.options.extent)},xn.prototype.loadGeometry=function(){var J=this.rawGeometry;this.geometry=[];for(var P=0;P<J.length;P++){for(var V=J[P],K=[],O=0;O<V.length;O++)K.push(new Rn(V[O][0],V[O][1]));this.geometry.push(K)}return this.geometry},xn.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var J=this.geometry,P=1/0,V=-1/0,K=1/0,O=-1/0,Z=0;Z<J.length;Z++)for(var se=J[Z],pe=0;pe<se.length;pe++){var ue=se[pe];P=Math.min(P,ue.x),V=Math.max(V,ue.x),K=Math.min(K,ue.y),O=Math.max(O,ue.y)}return[P,K,V,O]},xn.prototype.toGeoJSON=Oi.prototype.toGeoJSON;var Wr=u.pbf,Wt=Ge;function In(J){var P=new Wr;return function(V,K){for(var O in V.layers)K.writeMessage(3,Ai,V.layers[O])}(J,P),P.finish()}function Ai(J,P){var V;P.writeVarintField(15,J.version||1),P.writeStringField(1,J.name||""),P.writeVarintField(5,J.extent||4096);var K={keys:[],values:[],keycache:{},valuecache:{}};for(V=0;V<J.length;V++)K.feature=J.feature(V),P.writeMessage(2,ua,K);var O=K.keys;for(V=0;V<O.length;V++)P.writeStringField(3,O[V]);var Z=K.values;for(V=0;V<Z.length;V++)P.writeMessage(4,rn,Z[V])}function ua(J,P){var V=J.feature;V.id!==void 0&&P.writeVarintField(1,V.id),P.writeMessage(2,_n,J),P.writeVarintField(3,V.type),P.writeMessage(4,Hi,V)}function _n(J,P){var V=J.feature,K=J.keys,O=J.values,Z=J.keycache,se=J.valuecache;for(var pe in V.properties){var ue=V.properties[pe],_e=Z[pe];if(ue!==null){_e===void 0&&(K.push(pe),Z[pe]=_e=K.length-1),P.writeVarint(_e);var Te=typeof ue;Te!=="string"&&Te!=="boolean"&&Te!=="number"&&(ue=JSON.stringify(ue));var We=Te+":"+ue,qe=se[We];qe===void 0&&(O.push(ue),se[We]=qe=O.length-1),P.writeVarint(qe)}}}function On(J,P){return(P<<3)+(7&J)}function Ut(J){return J<<1^J>>31}function Hi(J,P){for(var V=J.loadGeometry(),K=J.type,O=0,Z=0,se=V.length,pe=0;pe<se;pe++){var ue=V[pe],_e=1;K===1&&(_e=ue.length),P.writeVarint(On(1,_e));for(var Te=K===3?ue.length-1:ue.length,We=0;We<Te;We++){We===1&&K!==1&&P.writeVarint(On(2,Te-1));var qe=ue[We].x-O,ct=ue[We].y-Z;P.writeVarint(Ut(qe)),P.writeVarint(Ut(ct)),O+=qe,Z+=ct}K===3&&P.writeVarint(On(7,1))}}function rn(J,P){var V=typeof J;V==="string"?P.writeStringField(1,J):V==="boolean"?P.writeBooleanField(7,J):V==="number"&&(J%1!=0?P.writeDoubleField(3,J):J<0?P.writeSVarintField(6,J):P.writeVarintField(5,J))}function Xi(J,P,V,K,O,Z){if(O-K<=V)return;const se=K+O>>1;ca(J,P,se,K,O,Z%2),Xi(J,P,V,K,se-1,Z+1),Xi(J,P,V,se+1,O,Z+1)}function ca(J,P,V,K,O,Z){for(;O>K;){if(O-K>600){const _e=O-K+1,Te=V-K+1,We=Math.log(_e),qe=.5*Math.exp(2*We/3),ct=.5*Math.sqrt(We*qe*(_e-qe)/_e)*(Te-_e/2<0?-1:1);ca(J,P,V,Math.max(K,Math.floor(V-Te*qe/_e+ct)),Math.min(O,Math.floor(V+(_e-Te)*qe/_e+ct)),Z)}const se=P[2*V+Z];let pe=K,ue=O;for(Kn(J,P,K,V),P[2*O+Z]>se&&Kn(J,P,K,O);pe<ue;){for(Kn(J,P,pe,ue),pe++,ue--;P[2*pe+Z]<se;)pe++;for(;P[2*ue+Z]>se;)ue--}P[2*K+Z]===se?Kn(J,P,K,ue):(ue++,Kn(J,P,ue,O)),ue<=V&&(K=ue+1),V<=ue&&(O=ue-1)}}function Kn(J,P,V,K){ha(J,V,K),ha(P,2*V,2*K),ha(P,2*V+1,2*K+1)}function ha(J,P,V){const K=J[P];J[P]=J[V],J[V]=K}function rr(J,P,V,K){const O=J-V,Z=P-K;return O*O+Z*Z}zn.exports=In,zn.exports.fromVectorTileJs=In,zn.exports.fromGeojsonVt=function(J,P){P=P||{};var V={};for(var K in J)V[K]=new Wt(J[K].features,P),V[K].name=K,V[K].version=P.version,V[K].extent=P.extent;return In({layers:V})},zn.exports.GeoJSONWrapper=Wt;const ar=J=>J[0],or=J=>J[1];class da{constructor(P,V=ar,K=or,O=64,Z=Float64Array){this.nodeSize=O,this.points=P;const se=P.length<65536?Uint16Array:Uint32Array,pe=this.ids=new se(P.length),ue=this.coords=new Z(2*P.length);for(let _e=0;_e<P.length;_e++)pe[_e]=_e,ue[2*_e]=V(P[_e]),ue[2*_e+1]=K(P[_e]);Xi(pe,ue,O,0,pe.length-1,0)}range(P,V,K,O){return function(Z,se,pe,ue,_e,Te,We){const qe=[0,Z.length-1,0],ct=[];let ot,_t;for(;qe.length;){const Lt=qe.pop(),on=qe.pop(),cn=qe.pop();if(on-cn<=We){for(let ui=cn;ui<=on;ui++)ot=se[2*ui],_t=se[2*ui+1],ot>=pe&&ot<=_e&&_t>=ue&&_t<=Te&&ct.push(Z[ui]);continue}const Rt=Math.floor((cn+on)/2);ot=se[2*Rt],_t=se[2*Rt+1],ot>=pe&&ot<=_e&&_t>=ue&&_t<=Te&&ct.push(Z[Rt]);const ai=(Lt+1)%2;(Lt===0?pe<=ot:ue<=_t)&&(qe.push(cn),qe.push(Rt-1),qe.push(ai)),(Lt===0?_e>=ot:Te>=_t)&&(qe.push(Rt+1),qe.push(on),qe.push(ai))}return ct}(this.ids,this.coords,P,V,K,O,this.nodeSize)}within(P,V,K){return function(O,Z,se,pe,ue,_e){const Te=[0,O.length-1,0],We=[],qe=ue*ue;for(;Te.length;){const ct=Te.pop(),ot=Te.pop(),_t=Te.pop();if(ot-_t<=_e){for(let ai=_t;ai<=ot;ai++)rr(Z[2*ai],Z[2*ai+1],se,pe)<=qe&&We.push(O[ai]);continue}const Lt=Math.floor((_t+ot)/2),on=Z[2*Lt],cn=Z[2*Lt+1];rr(on,cn,se,pe)<=qe&&We.push(O[Lt]);const Rt=(ct+1)%2;(ct===0?se-ue<=on:pe-ue<=cn)&&(Te.push(_t),Te.push(Lt-1),Te.push(Rt)),(ct===0?se+ue>=on:pe+ue>=cn)&&(Te.push(Lt+1),Te.push(ot),Te.push(Rt))}return We}(this.ids,this.coords,P,V,K,this.nodeSize)}}const Yr={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:J=>J},er=Math.fround||(Lr=new Float32Array(1),J=>(Lr[0]=+J,Lr[0]));var Lr;class mr{constructor(P){this.options=Pi(Object.create(Yr),P),this.trees=new Array(this.options.maxZoom+1)}load(P){const{log:V,minZoom:K,maxZoom:O,nodeSize:Z}=this.options;V&&console.time("total time");const se=`prepare ${P.length} points`;V&&console.time(se),this.points=P;let pe=[];for(let ue=0;ue<P.length;ue++)P[ue].geometry&&pe.push(fa(P[ue],ue));this.trees[O+1]=new da(pe,Vr,pa,Z,Float32Array),V&&console.timeEnd(se);for(let ue=O;ue>=K;ue--){const _e=+Date.now();pe=this._cluster(pe,ue),this.trees[ue]=new da(pe,Vr,pa,Z,Float32Array),V&&console.log("z%d: %d clusters in %dms",ue,pe.length,+Date.now()-_e)}return V&&console.timeEnd("total time"),this}getClusters(P,V){let K=((P[0]+180)%360+360)%360-180;const O=Math.max(-90,Math.min(90,P[1]));let Z=P[2]===180?180:((P[2]+180)%360+360)%360-180;const se=Math.max(-90,Math.min(90,P[3]));if(P[2]-P[0]>=360)K=-180,Z=180;else if(K>Z){const Te=this.getClusters([K,O,180,se],V),We=this.getClusters([-180,O,Z,se],V);return Te.concat(We)}const pe=this.trees[this._limitZoom(V)],ue=pe.range(Yt(K),Ri(se),Yt(Z),Ri(O)),_e=[];for(const Te of ue){const We=pe.points[Te];_e.push(We.numPoints?Vn(We):this.points[We.index])}return _e}getChildren(P){const V=this._getOriginId(P),K=this._getOriginZoom(P),O="No cluster with the specified id.",Z=this.trees[K];if(!Z)throw new Error(O);const se=Z.points[V];if(!se)throw new Error(O);const pe=this.options.radius/(this.options.extent*Math.pow(2,K-1)),ue=Z.within(se.x,se.y,pe),_e=[];for(const Te of ue){const We=Z.points[Te];We.parentId===P&&_e.push(We.numPoints?Vn(We):this.points[We.index])}if(_e.length===0)throw new Error(O);return _e}getLeaves(P,V,K){const O=[];return this._appendLeaves(O,P,V=V||10,K=K||0,0),O}getTile(P,V,K){const O=this.trees[this._limitZoom(P)],Z=Math.pow(2,P),{extent:se,radius:pe}=this.options,ue=pe/se,_e=(K-ue)/Z,Te=(K+1+ue)/Z,We={features:[]};return this._addTileFeatures(O.range((V-ue)/Z,_e,(V+1+ue)/Z,Te),O.points,V,K,Z,We),V===0&&this._addTileFeatures(O.range(1-ue/Z,_e,1,Te),O.points,Z,K,Z,We),V===Z-1&&this._addTileFeatures(O.range(0,_e,ue/Z,Te),O.points,-1,K,Z,We),We.features.length?We:null}getClusterExpansionZoom(P){let V=this._getOriginZoom(P)-1;for(;V<=this.options.maxZoom;){const K=this.getChildren(P);if(V++,K.length!==1)break;P=K[0].properties.cluster_id}return V}_appendLeaves(P,V,K,O,Z){const se=this.getChildren(V);for(const pe of se){const ue=pe.properties;if(ue&&ue.cluster?Z+ue.point_count<=O?Z+=ue.point_count:Z=this._appendLeaves(P,ue.cluster_id,K,O,Z):Z<O?Z++:P.push(pe),P.length===K)break}return Z}_addTileFeatures(P,V,K,O,Z,se){for(const pe of P){const ue=V[pe],_e=ue.numPoints;let Te,We,qe;if(_e)Te=mi(ue),We=ue.x,qe=ue.y;else{const _t=this.points[ue.index];Te=_t.properties,We=Yt(_t.geometry.coordinates[0]),qe=Ri(_t.geometry.coordinates[1])}const ct={type:1,geometry:[[Math.round(this.options.extent*(We*Z-K)),Math.round(this.options.extent*(qe*Z-O))]],tags:Te};let ot;_e?ot=ue.id:this.options.generateId?ot=ue.index:this.points[ue.index].id&&(ot=this.points[ue.index].id),ot!==void 0&&(ct.id=ot),se.features.push(ct)}}_limitZoom(P){return Math.max(this.options.minZoom,Math.min(Math.floor(+P),this.options.maxZoom+1))}_cluster(P,V){const K=[],{radius:O,extent:Z,reduce:se,minPoints:pe}=this.options,ue=O/(Z*Math.pow(2,V));for(let _e=0;_e<P.length;_e++){const Te=P[_e];if(Te.zoom<=V)continue;Te.zoom=V;const We=this.trees[V+1],qe=We.within(Te.x,Te.y,ue),ct=Te.numPoints||1;let ot=ct;for(const _t of qe){const Lt=We.points[_t];Lt.zoom>V&&(ot+=Lt.numPoints||1)}if(ot>ct&&ot>=pe){let _t=Te.x*ct,Lt=Te.y*ct,on=se&&ct>1?this._map(Te,!0):null;const cn=(_e<<5)+(V+1)+this.points.length;for(const Rt of qe){const ai=We.points[Rt];if(ai.zoom<=V)continue;ai.zoom=V;const ui=ai.numPoints||1;_t+=ai.x*ui,Lt+=ai.y*ui,ai.parentId=cn,se&&(on||(on=this._map(Te,!0)),se(on,this._map(ai)))}Te.parentId=cn,K.push(Ui(_t/ot,Lt/ot,cn,ot,on))}else if(K.push(Te),ot>1)for(const _t of qe){const Lt=We.points[_t];Lt.zoom<=V||(Lt.zoom=V,K.push(Lt))}}return K}_getOriginId(P){return P-this.points.length>>5}_getOriginZoom(P){return(P-this.points.length)%32}_map(P,V){if(P.numPoints)return V?Pi({},P.properties):P.properties;const K=this.points[P.index].properties,O=this.options.map(K);return V&&O===K?Pi({},O):O}}function Ui(J,P,V,K,O){return{x:er(J),y:er(P),zoom:1/0,id:V,parentId:-1,numPoints:K,properties:O}}function fa(J,P){const[V,K]=J.geometry.coordinates;return{x:er(Yt(V)),y:er(Ri(K)),zoom:1/0,index:P,parentId:-1}}function Vn(J){return{type:"Feature",id:J.id,properties:mi(J),geometry:{type:"Point",coordinates:[(P=J.x,360*(P-.5)),sr(J.y)]}};var P}function mi(J){const P=J.numPoints,V=P>=1e4?`${Math.round(P/1e3)}k`:P>=1e3?Math.round(P/100)/10+"k":P;return Pi(Pi({},J.properties),{cluster:!0,cluster_id:J.id,point_count:P,point_count_abbreviated:V})}function Yt(J){return J/360+.5}function Ri(J){const P=Math.sin(J*Math.PI/180),V=.5-.25*Math.log((1+P)/(1-P))/Math.PI;return V<0?0:V>1?1:V}function sr(J){const P=(180-360*J)*Math.PI/180;return 360*Math.atan(Math.exp(P))/Math.PI-90}function Pi(J,P){for(const V in P)J[V]=P[V];return J}function Vr(J){return J.x}function pa(J){return J.y}function gr(J,P,V,K){for(var O,Z=K,se=V-P>>1,pe=V-P,ue=J[P],_e=J[P+1],Te=J[V],We=J[V+1],qe=P+3;qe<V;qe+=3){var ct=Ba(J[qe],J[qe+1],ue,_e,Te,We);if(ct>Z)O=qe,Z=ct;else if(ct===Z){var ot=Math.abs(qe-se);ot<pe&&(O=qe,pe=ot)}}Z>K&&(O-P>3&&gr(J,P,O,K),J[O+2]=Z,V-O>3&&gr(J,O,V,K))}function Ba(J,P,V,K,O,Z){var se=O-V,pe=Z-K;if(se!==0||pe!==0){var ue=((J-V)*se+(P-K)*pe)/(se*se+pe*pe);ue>1?(V=O,K=Z):ue>0&&(V+=se*ue,K+=pe*ue)}return(se=J-V)*se+(pe=P-K)*pe}function Ni(J,P,V,K){var O={id:J===void 0?null:J,type:P,geometry:V,tags:K,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Z){var se=Z.geometry,pe=Z.type;if(pe==="Point"||pe==="MultiPoint"||pe==="LineString")lr(Z,se);else if(pe==="Polygon"||pe==="MultiLineString")for(var ue=0;ue<se.length;ue++)lr(Z,se[ue]);else if(pe==="MultiPolygon")for(ue=0;ue<se.length;ue++)for(var _e=0;_e<se[ue].length;_e++)lr(Z,se[ue][_e])}(O),O}function lr(J,P){for(var V=0;V<P.length;V+=3)J.minX=Math.min(J.minX,P[V]),J.minY=Math.min(J.minY,P[V+1]),J.maxX=Math.max(J.maxX,P[V]),J.maxY=Math.max(J.maxY,P[V+1])}function Kr(J,P,V,K){if(P.geometry){var O=P.geometry.coordinates,Z=P.geometry.type,se=Math.pow(V.tolerance/((1<<V.maxZoom)*V.extent),2),pe=[],ue=P.id;if(V.promoteId?ue=P.properties[V.promoteId]:V.generateId&&(ue=K||0),Z==="Point")Cr(O,pe);else if(Z==="MultiPoint")for(var _e=0;_e<O.length;_e++)Cr(O[_e],pe);else if(Z==="LineString")jr(O,pe,se,!1);else if(Z==="MultiLineString"){if(V.lineMetrics){for(_e=0;_e<O.length;_e++)jr(O[_e],pe=[],se,!1),J.push(Ni(ue,"LineString",pe,P.properties));return}Di(O,pe,se,!1)}else if(Z==="Polygon")Di(O,pe,se,!0);else{if(Z!=="MultiPolygon"){if(Z==="GeometryCollection"){for(_e=0;_e<P.geometry.geometries.length;_e++)Kr(J,{id:ue,geometry:P.geometry.geometries[_e],properties:P.properties},V,K);return}throw new Error("Input data is not a valid GeoJSON object.")}for(_e=0;_e<O.length;_e++){var Te=[];Di(O[_e],Te,se,!0),pe.push(Te)}}J.push(Ni(ue,Z,pe,P.properties))}}function Cr(J,P){P.push(ma(J[0])),P.push(Fa(J[1])),P.push(0)}function jr(J,P,V,K){for(var O,Z,se=0,pe=0;pe<J.length;pe++){var ue=ma(J[pe][0]),_e=Fa(J[pe][1]);P.push(ue),P.push(_e),P.push(0),pe>0&&(se+=K?(O*_e-ue*Z)/2:Math.sqrt(Math.pow(ue-O,2)+Math.pow(_e-Z,2))),O=ue,Z=_e}var Te=P.length-3;P[2]=1,gr(P,0,Te,V),P[Te+2]=1,P.size=Math.abs(se),P.start=0,P.end=P.size}function Di(J,P,V,K){for(var O=0;O<J.length;O++){var Z=[];jr(J[O],Z,V,K),P.push(Z)}}function ma(J){return J/360+.5}function Fa(J){var P=Math.sin(J*Math.PI/180),V=.5-.25*Math.log((1+P)/(1-P))/Math.PI;return V<0?0:V>1?1:V}function _r(J,P,V,K,O,Z,se,pe){if(K/=P,Z>=(V/=P)&&se<K)return J;if(se<V||Z>=K)return null;for(var ue=[],_e=0;_e<J.length;_e++){var Te=J[_e],We=Te.geometry,qe=Te.type,ct=O===0?Te.minX:Te.minY,ot=O===0?Te.maxX:Te.maxY;if(ct>=V&&ot<K)ue.push(Te);else if(!(ot<V||ct>=K)){var _t=[];if(qe==="Point"||qe==="MultiPoint")vt(We,_t,V,K,O);else if(qe==="LineString")Nt(We,_t,V,K,O,!1,pe.lineMetrics);else if(qe==="MultiLineString")Pn(We,_t,V,K,O,!1);else if(qe==="Polygon")Pn(We,_t,V,K,O,!0);else if(qe==="MultiPolygon")for(var Lt=0;Lt<We.length;Lt++){var on=[];Pn(We[Lt],on,V,K,O,!0),on.length&&_t.push(on)}if(_t.length){if(pe.lineMetrics&&qe==="LineString"){for(Lt=0;Lt<_t.length;Lt++)ue.push(Ni(Te.id,qe,_t[Lt],Te.tags));continue}qe!=="LineString"&&qe!=="MultiLineString"||(_t.length===1?(qe="LineString",_t=_t[0]):qe="MultiLineString"),qe!=="Point"&&qe!=="MultiPoint"||(qe=_t.length===3?"Point":"MultiPoint"),ue.push(Ni(Te.id,qe,_t,Te.tags))}}}return ue.length?ue:null}function vt(J,P,V,K,O){for(var Z=0;Z<J.length;Z+=3){var se=J[Z+O];se>=V&&se<=K&&(P.push(J[Z]),P.push(J[Z+1]),P.push(J[Z+2]))}}function Nt(J,P,V,K,O,Z,se){for(var pe,ue,_e=sn(J),Te=O===0?ur:Vi,We=J.start,qe=0;qe<J.length-3;qe+=3){var ct=J[qe],ot=J[qe+1],_t=J[qe+2],Lt=J[qe+3],on=J[qe+4],cn=O===0?ct:ot,Rt=O===0?Lt:on,ai=!1;se&&(pe=Math.sqrt(Math.pow(ct-Lt,2)+Math.pow(ot-on,2))),cn<V?Rt>V&&(ue=Te(_e,ct,ot,Lt,on,V),se&&(_e.start=We+pe*ue)):cn>K?Rt<K&&(ue=Te(_e,ct,ot,Lt,on,K),se&&(_e.start=We+pe*ue)):Jn(_e,ct,ot,_t),Rt<V&&cn>=V&&(ue=Te(_e,ct,ot,Lt,on,V),ai=!0),Rt>K&&cn<=K&&(ue=Te(_e,ct,ot,Lt,on,K),ai=!0),!Z&&ai&&(se&&(_e.end=We+pe*ue),P.push(_e),_e=sn(J)),se&&(We+=pe)}var ui=J.length-3;ct=J[ui],ot=J[ui+1],_t=J[ui+2],(cn=O===0?ct:ot)>=V&&cn<=K&&Jn(_e,ct,ot,_t),ui=_e.length-3,Z&&ui>=3&&(_e[ui]!==_e[0]||_e[ui+1]!==_e[1])&&Jn(_e,_e[0],_e[1],_e[2]),_e.length&&P.push(_e)}function sn(J){var P=[];return P.size=J.size,P.start=J.start,P.end=J.end,P}function Pn(J,P,V,K,O,Z){for(var se=0;se<J.length;se++)Nt(J[se],P,V,K,O,Z,!1)}function Jn(J,P,V,K){J.push(P),J.push(V),J.push(K)}function ur(J,P,V,K,O,Z){var se=(Z-P)/(K-P);return J.push(Z),J.push(V+(O-V)*se),J.push(1),se}function Vi(J,P,V,K,O,Z){var se=(Z-V)/(O-V);return J.push(P+(K-P)*se),J.push(Z),J.push(1),se}function yr(J,P){for(var V=[],K=0;K<J.length;K++){var O,Z=J[K],se=Z.type;if(se==="Point"||se==="MultiPoint"||se==="LineString")O=ri(Z.geometry,P);else if(se==="MultiLineString"||se==="Polygon"){O=[];for(var pe=0;pe<Z.geometry.length;pe++)O.push(ri(Z.geometry[pe],P))}else if(se==="MultiPolygon")for(O=[],pe=0;pe<Z.geometry.length;pe++){for(var ue=[],_e=0;_e<Z.geometry[pe].length;_e++)ue.push(ri(Z.geometry[pe][_e],P));O.push(ue)}V.push(Ni(Z.id,se,O,Z.tags))}return V}function ri(J,P){var V=[];V.size=J.size,J.start!==void 0&&(V.start=J.start,V.end=J.end);for(var K=0;K<J.length;K+=3)V.push(J[K]+P,J[K+1],J[K+2]);return V}function Gr(J,P){if(J.transformed)return J;var V,K,O,Z=1<<J.z,se=J.x,pe=J.y;for(V=0;V<J.features.length;V++){var ue=J.features[V],_e=ue.geometry,Te=ue.type;if(ue.geometry=[],Te===1)for(K=0;K<_e.length;K+=2)ue.geometry.push(Zn(_e[K],_e[K+1],P,Z,se,pe));else for(K=0;K<_e.length;K++){var We=[];for(O=0;O<_e[K].length;O+=2)We.push(Zn(_e[K][O],_e[K][O+1],P,Z,se,pe));ue.geometry.push(We)}}return J.transformed=!0,J}function Zn(J,P,V,K,O,Z){return[Math.round(V*(J*K-O)),Math.round(V*(P*K-Z))]}function gi(J,P,V,K,O){for(var Z=P===O.maxZoom?0:O.tolerance/((1<<P)*O.extent),se={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:V,y:K,z:P,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},pe=0;pe<J.length;pe++){se.numFeatures++,Wa(se,J[pe],Z,O);var ue=J[pe].minX,_e=J[pe].minY,Te=J[pe].maxX,We=J[pe].maxY;ue<se.minX&&(se.minX=ue),_e<se.minY&&(se.minY=_e),Te>se.maxX&&(se.maxX=Te),We>se.maxY&&(se.maxY=We)}return se}function Wa(J,P,V,K){var O=P.geometry,Z=P.type,se=[];if(Z==="Point"||Z==="MultiPoint")for(var pe=0;pe<O.length;pe+=3)se.push(O[pe]),se.push(O[pe+1]),J.numPoints++,J.numSimplified++;else if(Z==="LineString")ga(se,O,J,V,!1,!1);else if(Z==="MultiLineString"||Z==="Polygon")for(pe=0;pe<O.length;pe++)ga(se,O[pe],J,V,Z==="Polygon",pe===0);else if(Z==="MultiPolygon")for(var ue=0;ue<O.length;ue++){var _e=O[ue];for(pe=0;pe<_e.length;pe++)ga(se,_e[pe],J,V,!0,pe===0)}if(se.length){var Te=P.tags||null;if(Z==="LineString"&&K.lineMetrics){for(var We in Te={},P.tags)Te[We]=P.tags[We];Te.mapbox_clip_start=O.start/O.size,Te.mapbox_clip_end=O.end/O.size}var qe={geometry:se,type:Z==="Polygon"||Z==="MultiPolygon"?3:Z==="LineString"||Z==="MultiLineString"?2:1,tags:Te};P.id!==null&&(qe.id=P.id),J.features.push(qe)}}function ga(J,P,V,K,O,Z){var se=K*K;if(K>0&&P.size<(O?se:K))V.numPoints+=P.length/3;else{for(var pe=[],ue=0;ue<P.length;ue+=3)(K===0||P[ue+2]>se)&&(V.numSimplified++,pe.push(P[ue]),pe.push(P[ue+1])),V.numPoints++;O&&function(_e,Te){for(var We=0,qe=0,ct=_e.length,ot=ct-2;qe<ct;ot=qe,qe+=2)We+=(_e[qe]-_e[ot])*(_e[qe+1]+_e[ot+1]);if(We>0===Te)for(qe=0,ct=_e.length;qe<ct/2;qe+=2){var _t=_e[qe],Lt=_e[qe+1];_e[qe]=_e[ct-2-qe],_e[qe+1]=_e[ct-1-qe],_e[ct-2-qe]=_t,_e[ct-1-qe]=Lt}}(pe,Z),J.push(pe)}}function Ya(J,P){var V=(P=this.options=function(O,Z){for(var se in Z)O[se]=Z[se];return O}(Object.create(this.options),P)).debug;if(V&&console.time("preprocess data"),P.maxZoom<0||P.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(P.promoteId&&P.generateId)throw new Error("promoteId and generateId cannot be used together.");var K=function(O,Z){var se=[];if(O.type==="FeatureCollection")for(var pe=0;pe<O.features.length;pe++)Kr(se,O.features[pe],Z,pe);else Kr(se,O.type==="Feature"?O:{geometry:O},Z);return se}(J,P);this.tiles={},this.tileCoords=[],V&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",P.indexMaxZoom,P.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),K=function(O,Z){var se=Z.buffer/Z.extent,pe=O,ue=_r(O,1,-1-se,se,0,-1,2,Z),_e=_r(O,1,1-se,2+se,0,-1,2,Z);return(ue||_e)&&(pe=_r(O,1,-se,1+se,0,-1,2,Z)||[],ue&&(pe=yr(ue,1).concat(pe)),_e&&(pe=pe.concat(yr(_e,-1)))),pe}(K,P),K.length&&this.splitTile(K,0,0,0),V&&(K.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function zo(J,P,V){return 32*((1<<J)*V+P)+J}function Sa(J,P){const V=J.tileID.canonical;if(!this._geoJSONIndex)return P(null,null);const K=this._geoJSONIndex.getTile(V.z,V.x,V.y);if(!K)return P(null,null);const O=new kr(K.features);let Z=zn.exports(O);Z.byteOffset===0&&Z.byteLength===Z.buffer.byteLength||(Z=new Uint8Array(Z)),P(null,{vectorTile:O,rawData:Z.buffer})}Ya.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Ya.prototype.splitTile=function(J,P,V,K,O,Z,se){for(var pe=[J,P,V,K],ue=this.options,_e=ue.debug;pe.length;){K=pe.pop(),V=pe.pop(),P=pe.pop(),J=pe.pop();var Te=1<<P,We=zo(P,V,K),qe=this.tiles[We];if(!qe&&(_e>1&&console.time("creation"),qe=this.tiles[We]=gi(J,P,V,K,ue),this.tileCoords.push({z:P,x:V,y:K}),_e)){_e>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",P,V,K,qe.numFeatures,qe.numPoints,qe.numSimplified),console.timeEnd("creation"));var ct="z"+P;this.stats[ct]=(this.stats[ct]||0)+1,this.total++}if(qe.source=J,O){if(P===ue.maxZoom||P===O)continue;var ot=1<<O-P;if(V!==Math.floor(Z/ot)||K!==Math.floor(se/ot))continue}else if(P===ue.indexMaxZoom||qe.numPoints<=ue.indexMaxPoints)continue;if(qe.source=null,J.length!==0){_e>1&&console.time("clipping");var _t,Lt,on,cn,Rt,ai,ui=.5*ue.buffer/ue.extent,co=.5-ui,_a=.5+ui,an=1+ui;_t=Lt=on=cn=null,Rt=_r(J,Te,V-ui,V+_a,0,qe.minX,qe.maxX,ue),ai=_r(J,Te,V+co,V+an,0,qe.minX,qe.maxX,ue),J=null,Rt&&(_t=_r(Rt,Te,K-ui,K+_a,1,qe.minY,qe.maxY,ue),Lt=_r(Rt,Te,K+co,K+an,1,qe.minY,qe.maxY,ue),Rt=null),ai&&(on=_r(ai,Te,K-ui,K+_a,1,qe.minY,qe.maxY,ue),cn=_r(ai,Te,K+co,K+an,1,qe.minY,qe.maxY,ue),ai=null),_e>1&&console.timeEnd("clipping"),pe.push(_t||[],P+1,2*V,2*K),pe.push(Lt||[],P+1,2*V,2*K+1),pe.push(on||[],P+1,2*V+1,2*K),pe.push(cn||[],P+1,2*V+1,2*K+1)}}},Ya.prototype.getTile=function(J,P,V){var K=this.options,O=K.extent,Z=K.debug;if(J<0||J>24)return null;var se=1<<J,pe=zo(J,P=(P%se+se)%se,V);if(this.tiles[pe])return Gr(this.tiles[pe],O);Z>1&&console.log("drilling down to z%d-%d-%d",J,P,V);for(var ue,_e=J,Te=P,We=V;!ue&&_e>0;)_e--,Te=Math.floor(Te/2),We=Math.floor(We/2),ue=this.tiles[zo(_e,Te,We)];return ue&&ue.source?(Z>1&&console.log("found parent tile z%d-%d-%d",_e,Te,We),Z>1&&console.time("drilling down"),this.splitTile(ue.source,_e,Te,We,J,P,V),Z>1&&console.timeEnd("drilling down"),this.tiles[pe]?Gr(this.tiles[pe],O):null):null};class Ua extends u.VectorTileWorkerSource{constructor(P,V,K,O,Z){super(P,V,K,O,Sa),Z&&(this.loadGeoJSON=Z)}loadData(P,V){const K=P&&P.request,O=K&&K.collectResourceTiming;this.loadGeoJSON(P,(Z,se)=>{if(Z||!se)return V(Z);if(typeof se!="object")return V(new Error(`Input data given to '${P.source}' is not a valid GeoJSON object.`));{gt(se,!0);try{if(P.filter){const ue=u.createExpression(P.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ue.result==="error")throw new Error(ue.value.map(Te=>`${Te.key}: ${Te.message}`).join(", "));se={type:"FeatureCollection",features:se.features.filter(Te=>ue.value.evaluate({zoom:0},Te))}}this._geoJSONIndex=P.cluster?new mr(function({superclusterOptions:ue,clusterProperties:_e}){if(!_e||!ue)return ue;const Te={},We={},qe={accumulated:null,zoom:0},ct={properties:null},ot=Object.keys(_e);for(const _t of ot){const[Lt,on]=_e[_t],cn=u.createExpression(on),Rt=u.createExpression(typeof Lt=="string"?[Lt,["accumulated"],["get",_t]]:Lt);Te[_t]=cn.value,We[_t]=Rt.value}return ue.map=_t=>{ct.properties=_t;const Lt={};for(const on of ot)Lt[on]=Te[on].evaluate(qe,ct);return Lt},ue.reduce=(_t,Lt)=>{ct.properties=Lt;for(const on of ot)qe.accumulated=_t[on],_t[on]=We[on].evaluate(qe,ct)},ue}(P)).load(se.features):function(ue,_e){return new Ya(ue,_e)}(se,P.geojsonVtOptions)}catch(ue){return V(ue)}this.loaded={};const pe={};if(O){const ue=u.getPerformanceMeasurement(K);ue&&(pe.resourceTiming={},pe.resourceTiming[P.source]=JSON.parse(JSON.stringify(ue)))}V(null,pe)}})}reloadTile(P,V){const K=this.loaded;return K&&K[P.uid]?super.reloadTile(P,V):this.loadTile(P,V)}loadGeoJSON(P,V){if(P.request)u.getJSON(P.request,V);else{if(typeof P.data!="string")return V(new Error(`Input data given to '${P.source}' is not a valid GeoJSON object.`));try{return V(null,JSON.parse(P.data))}catch{return V(new Error(`Input data given to '${P.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(P,V){try{V(null,this._geoJSONIndex.getClusterExpansionZoom(P.clusterId))}catch(K){V(K)}}getClusterChildren(P,V){try{V(null,this._geoJSONIndex.getChildren(P.clusterId))}catch(K){V(K)}}getClusterLeaves(P,V){try{V(null,this._geoJSONIndex.getLeaves(P.clusterId,P.limit,P.offset))}catch(K){V(K)}}}class Io{constructor(P){this.self=P,this.actor=new u.Actor(P,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=u.getProjection({name:"mercator"}),this.workerSourceTypes={vector:u.VectorTileWorkerSource,geojson:Ua},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(V,K)=>{if(this.workerSourceTypes[V])throw new Error(`Worker source with name "${V}" already registered.`);this.workerSourceTypes[V]=K},this.self.registerRTLTextPlugin=V=>{if(u.plugin.isParsed())throw new Error("RTL text plugin already registered.");u.plugin.applyArabicShaping=V.applyArabicShaping,u.plugin.processBidirectionalText=V.processBidirectionalText,u.plugin.processStyledBidirectionalText=V.processStyledBidirectionalText}}clearCaches(P,V,K){delete this.layerIndexes[P],delete this.availableImages[P],delete this.workerSources[P],delete this.demWorkerSources[P],K()}checkIfReady(P,V,K){K()}setReferrer(P,V){this.referrer=V}spriteLoaded(P,V){this.isSpriteLoaded[P]=V;for(const K in this.workerSources[P]){const O=this.workerSources[P][K];for(const Z in O)O[Z]instanceof u.VectorTileWorkerSource&&(O[Z].isSpriteLoaded=V,O[Z].fire(new u.Event("isSpriteLoaded")))}}setImages(P,V,K){this.availableImages[P]=V;for(const O in this.workerSources[P]){const Z=this.workerSources[P][O];for(const se in Z)Z[se].availableImages=V}K()}enableTerrain(P,V,K){this.terrain=V,K()}setProjection(P,V){this.projections[P]=u.getProjection(V)}setLayers(P,V,K){this.getLayerIndex(P).replace(V),K()}updateLayers(P,V,K){this.getLayerIndex(P).update(V.layers,V.removedIds),K()}loadTile(P,V,K){const O=this.enableTerrain?u.extend({enableTerrain:this.terrain},V):V;O.projection=this.projections[P]||this.defaultProjection,this.getWorkerSource(P,V.type,V.source).loadTile(O,K)}loadDEMTile(P,V,K){const O=this.enableTerrain?u.extend({buildQuadTree:this.terrain},V):V;this.getDEMWorkerSource(P,V.source).loadTile(O,K)}reloadTile(P,V,K){const O=this.enableTerrain?u.extend({enableTerrain:this.terrain},V):V;O.projection=this.projections[P]||this.defaultProjection,this.getWorkerSource(P,V.type,V.source).reloadTile(O,K)}abortTile(P,V,K){this.getWorkerSource(P,V.type,V.source).abortTile(V,K)}removeTile(P,V,K){this.getWorkerSource(P,V.type,V.source).removeTile(V,K)}removeSource(P,V,K){if(!this.workerSources[P]||!this.workerSources[P][V.type]||!this.workerSources[P][V.type][V.source])return;const O=this.workerSources[P][V.type][V.source];delete this.workerSources[P][V.type][V.source],O.removeSource!==void 0?O.removeSource(V,K):K()}loadWorkerSource(P,V,K){try{this.self.importScripts(V.url),K()}catch(O){K(O.toString())}}syncRTLPluginState(P,V,K){try{u.plugin.setState(V);const O=u.plugin.getPluginURL();if(u.plugin.isLoaded()&&!u.plugin.isParsed()&&O!=null){this.self.importScripts(O);const Z=u.plugin.isParsed();K(Z?void 0:new Error(`RTL Text Plugin failed to import scripts from ${O}`),Z)}}catch(O){K(O.toString())}}getAvailableImages(P){let V=this.availableImages[P];return V||(V=[]),V}getLayerIndex(P){let V=this.layerIndexes[P];return V||(V=this.layerIndexes[P]=new Hn),V}getWorkerSource(P,V,K){if(this.workerSources[P]||(this.workerSources[P]={}),this.workerSources[P][V]||(this.workerSources[P][V]={}),!this.workerSources[P][V][K]){const O={send:(Z,se,pe,ue,_e,Te)=>{this.actor.send(Z,se,pe,P,_e,Te)},scheduler:this.actor.scheduler};this.workerSources[P][V][K]=new this.workerSourceTypes[V](O,this.getLayerIndex(P),this.getAvailableImages(P),this.isSpriteLoaded[P])}return this.workerSources[P][V][K]}getDEMWorkerSource(P,V){return this.demWorkerSources[P]||(this.demWorkerSources[P]={}),this.demWorkerSources[P][V]||(this.demWorkerSources[P][V]=new at),this.demWorkerSources[P][V]}enforceCacheSizeLimit(P,V){u.enforceCacheSizeLimit(V)}getWorkerPerformanceMetrics(P,V,K){K(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Io(self)),Io}),Sn(["./shared"],function(u){function Oe(h,r){if(Array.isArray(h)){if(!Array.isArray(r)||h.length!==r.length)return!1;for(let s=0;s<h.length;s++)if(!Oe(h[s],r[s]))return!1;return!0}if(typeof h=="object"&&h!==null&&r!==null){if(typeof r!="object"||Object.keys(h).length!==Object.keys(r).length)return!1;for(const s in h)if(!Oe(h[s],r[s]))return!1;return!0}return h===r}var Ft=Hn;function Hn(h){return!function(r){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var f,g,y=new Blob([""],{type:"text/javascript"}),w=URL.createObjectURL(y);try{g=new Worker(w),f=!0}catch{f=!1}return g&&g.terminate(),URL.revokeObjectURL(w),f}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var f=document.createElement("canvas");f.width=f.height=1;var g=f.getContext("2d");if(!g)return!1;var y=g.getImageData(0,0,1,1);return y&&y.width===f.width}()?(at[s=r&&r.failIfMajorPerformanceCaveat]===void 0&&(at[s]=function(f){var g,y=function(w){var E=document.createElement("canvas"),C=Object.create(Hn.webGLContextAttributes);return C.failIfMajorPerformanceCaveat=w,E.getContext("webgl",C)||E.getContext("experimental-webgl",C)}(f);if(!y)return!1;try{g=y.createShader(y.VERTEX_SHADER)}catch{return!1}return!(!g||y.isContextLost())&&(y.shaderSource(g,"void main() {}"),y.compileShader(g),y.getShaderParameter(g,y.COMPILE_STATUS)===!0)}(s)),at[s]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var s}(h)}var at={};function gt(h,r,s){const f=u.window.document.createElement(h);return r!==void 0&&(f.className=r),s&&s.appendChild(f),f}function bt(h,r,s){const f=u.window.document.createElementNS("http://www.w3.org/2000/svg",h);for(const g of Object.keys(r))f.setAttributeNS(null,g,r[g]);return s&&s.appendChild(f),f}Hn.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const en=u.window.document&&u.window.document.documentElement.style,Ir=en&&en.userSelect!==void 0?"userSelect":"WebkitUserSelect";let Ea;function kr(){en&&Ir&&(Ea=en[Ir],en[Ir]="none")}function zn(){en&&Ir&&(en[Ir]=Ea)}function Rn(h){h.preventDefault(),h.stopPropagation(),u.window.removeEventListener("click",Rn,!0)}function Oi(){u.window.addEventListener("click",Rn,!0),u.window.setTimeout(()=>{u.window.removeEventListener("click",Rn,!0)},0)}function Ge(h,r){const s=h.getBoundingClientRect();return Wr(h,s,r)}function Nn(h,r){const s=h.getBoundingClientRect(),f=[];for(let g=0;g<r.length;g++)f.push(Wr(h,s,r[g]));return f}function xn(h){return u.window.InstallTrigger!==void 0&&h.button===2&&h.ctrlKey&&u.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:h.button}function Wr(h,r,s){const f=h.offsetWidth===r.width?1:h.offsetWidth/r.width;return new u.pointGeometry((s.clientX-r.left)*f,(s.clientY-r.top)*f)}function Wt(h,r){var s=r[0],f=r[1],g=r[2],y=r[3],w=s*y-g*f;return w?(h[0]=y*(w=1/w),h[1]=-f*w,h[2]=-g*w,h[3]=s*w,h):null}function In(h){const{userImage:r}=h;return!!(r&&r.render&&r.render())&&(h.data.replace(new Uint8Array(r.data.buffer)),!0)}class Ai extends u.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new u.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(r){if(this.loaded!==r&&(this.loaded=r,r)){for(const{ids:s,callback:f}of this.requestors)this._notify(s,f);this.requestors=[]}}hasImage(r){return!!this.getImage(r)}getImage(r){return this.images[r]}addImage(r,s){this._validate(r,s)&&(this.images[r]=s)}_validate(r,s){let f=!0;return this._validateStretch(s.stretchX,s.data&&s.data.width)||(this.fire(new u.ErrorEvent(new Error(`Image "${r}" has invalid "stretchX" value`))),f=!1),this._validateStretch(s.stretchY,s.data&&s.data.height)||(this.fire(new u.ErrorEvent(new Error(`Image "${r}" has invalid "stretchY" value`))),f=!1),this._validateContent(s.content,s)||(this.fire(new u.ErrorEvent(new Error(`Image "${r}" has invalid "content" value`))),f=!1),f}_validateStretch(r,s){if(!r)return!0;let f=0;for(const g of r){if(g[0]<f||g[1]<g[0]||s<g[1])return!1;f=g[1]}return!0}_validateContent(r,s){return!(r&&(r.length!==4||r[0]<0||s.data.width<r[0]||r[1]<0||s.data.height<r[1]||r[2]<0||s.data.width<r[2]||r[3]<0||s.data.height<r[3]||r[2]<r[0]||r[3]<r[1]))}updateImage(r,s){s.version=this.images[r].version+1,this.images[r]=s,this.updatedImages[r]=!0}removeImage(r){const s=this.images[r];delete this.images[r],delete this.patterns[r],s.userImage&&s.userImage.onRemove&&s.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(r,s){let f=!0;if(!this.isLoaded())for(const g of r)this.images[g]||(f=!1);this.isLoaded()||f?this._notify(r,s):this.requestors.push({ids:r,callback:s})}_notify(r,s){const f={};for(const g of r){this.images[g]||this.fire(new u.Event("styleimagemissing",{id:g}));const y=this.images[g];y?f[g]={data:y.data.clone(),pixelRatio:y.pixelRatio,sdf:y.sdf,version:y.version,stretchX:y.stretchX,stretchY:y.stretchY,content:y.content,hasRenderCallback:Boolean(y.userImage&&y.userImage.render)}:u.warnOnce(`Image "${g}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}s(null,f)}getPixelSize(){const{width:r,height:s}=this.atlasImage;return{width:r,height:s}}getPattern(r){const s=this.patterns[r],f=this.getImage(r);if(!f)return null;if(s&&s.position.version===f.version)return s.position;if(s)s.position.version=f.version;else{const g={w:f.data.width+2,h:f.data.height+2,x:0,y:0},y=new u.ImagePosition(g,f);this.patterns[r]={bin:g,position:y}}return this._updatePatternAtlas(),this.patterns[r].position}bind(r){const s=r.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new u.Texture(r,this.atlasImage,s.RGBA),this.atlasTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE)}_updatePatternAtlas(){const r=[];for(const y in this.patterns)r.push(this.patterns[y].bin);const{w:s,h:f}=u.potpack(r),g=this.atlasImage;g.resize({width:s||1,height:f||1});for(const y in this.patterns){const{bin:w}=this.patterns[y],E=w.x+1,C=w.y+1,z=this.images[y].data,D=z.width,B=z.height;u.RGBAImage.copy(z,g,{x:0,y:0},{x:E,y:C},{width:D,height:B}),u.RGBAImage.copy(z,g,{x:0,y:B-1},{x:E,y:C-1},{width:D,height:1}),u.RGBAImage.copy(z,g,{x:0,y:0},{x:E,y:C+B},{width:D,height:1}),u.RGBAImage.copy(z,g,{x:D-1,y:0},{x:E-1,y:C},{width:1,height:B}),u.RGBAImage.copy(z,g,{x:0,y:0},{x:E+D,y:C},{width:1,height:B})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(r){for(const s of r){if(this.callbackDispatchedThisFrame[s])continue;this.callbackDispatchedThisFrame[s]=!0;const f=this.images[s];In(f)&&this.updateImage(s,f)}}}const ua=new u.Properties({anchor:new u.DataConstantProperty(u.spec.light.anchor),position:new class{constructor(){this.specification=u.spec.light.position}possiblyEvaluate(h,r){return function([s,f,g]){const y=u.degToRad(f+90),w=u.degToRad(g);return{x:s*Math.cos(y)*Math.sin(w),y:s*Math.sin(y)*Math.sin(w),z:s*Math.cos(w),azimuthal:f,polar:g}}(h.expression.evaluate(r))}interpolate(h,r,s){return{x:u.number(h.x,r.x,s),y:u.number(h.y,r.y,s),z:u.number(h.z,r.z,s),azimuthal:u.number(h.azimuthal,r.azimuthal,s),polar:u.number(h.polar,r.polar,s)}}},color:new u.DataConstantProperty(u.spec.light.color),intensity:new u.DataConstantProperty(u.spec.light.intensity)}),_n="-transition";class On extends u.Evented{constructor(r){super(),this._transitionable=new u.Transitionable(ua),this.setLight(r),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(r,s={}){if(!this._validate(u.validateLight,r,s))for(const f in r){const g=r[f];u.endsWith(f,_n)?this._transitionable.setTransition(f.slice(0,-_n.length),g):this._transitionable.setValue(f,g)}}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,s,f){return(!f||f.validate!==!1)&&u.emitValidationErrors(this,r.call(u.validateStyle,u.extend({value:s,style:{glyphs:!0,sprite:!0},styleSpec:u.spec})))}}const Ut=new u.Properties({source:new u.DataConstantProperty(u.spec.terrain.source),exaggeration:new u.DataConstantProperty(u.spec.terrain.exaggeration)}),Hi="-transition";class rn extends u.Evented{constructor(r,s){super(),this._transitionable=new u.Transitionable(Ut),this.set(r),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=s}get(){return this._transitionable.serialize()}set(r){for(const s in r){const f=r[s];u.endsWith(s,Hi)?this._transitionable.setTransition(s.slice(0,-Hi.length),f):this._transitionable.setValue(s,f)}}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}}function Xi(h,r,s,f){const g=u.smoothstep(45,65,s),[y,w]=ca(h,f),E=u.length(r);let C=1-Math.min(1,Math.exp((E-y)/(w-y)*-6));return C*=C*C,C=Math.min(1,1.00747*C),C*g*h.alpha}function ca(h,r){const s=.5/Math.tan(.5*r);return[h.range[0]+s,h.range[1]+s]}const Kn=new u.Properties({range:new u.DataConstantProperty(u.spec.fog.range),color:new u.DataConstantProperty(u.spec.fog.color),"high-color":new u.DataConstantProperty(u.spec.fog["high-color"]),"space-color":new u.DataConstantProperty(u.spec.fog["space-color"]),"horizon-blend":new u.DataConstantProperty(u.spec.fog["horizon-blend"]),"star-intensity":new u.DataConstantProperty(u.spec.fog["star-intensity"])}),ha="-transition";class rr extends u.Evented{constructor(r,s){super(),this._transitionable=new u.Transitionable(Kn),this.set(r),this._transitioning=this._transitionable.untransitioned(),this._transform=s}get state(){const r=this._transform,s=r.projection.name==="globe",f=u.globeToMercatorTransition(r.zoom),g=this.properties.get("range"),y=[.5,3];return{range:s?[u.number(y[0],g[0],f),u.number(y[1],g[1],f)]:g,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(r,s={}){if(!this._validate(u.validateFog,r,s)){for(const f of Object.keys(u.spec.fog))r&&r[f]===void 0&&(r[f]=u.spec.fog[f].default);for(const f in r){const g=r[f];u.endsWith(f,ha)?this._transitionable.setTransition(f.slice(0,-ha.length),g):this._transitionable.setValue(f,g)}}}getOpacity(r){if(!this._transform.projection.supportsFog)return 0;const s=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:u.smoothstep(45,65,r))*s.a}getOpacityAtLatLng(r,s){return this._transform.projection.supportsFog?function(f,g,y){const w=u.MercatorCoordinate.fromLngLat(g),E=y.elevation?y.elevation.getAtPointOrZero(w):0,C=[w.x,w.y,E];return u.transformMat4(C,C,y.mercatorFogMatrix),Xi(f,C,y.pitch,y._fov)}(this.state,r,s):0}getFovAdjustedRange(r){return this._transform.projection.supportsFog?ca(this.state,r):[0,1]}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,s,f){return(!f||f.validate!==!1)&&u.emitValidationErrors(this,r.call(u.validateStyle,u.extend({value:s,style:{glyphs:!0,sprite:!0},styleSpec:u.spec})))}}class ar{constructor(r,s){this.workerPool=r,this.actors=[],this.currentActor=0,this.id=u.uniqueId();const f=this.workerPool.acquire(this.id);for(let g=0;g<f.length;g++){const y=new ar.Actor(f[g],s,this.id);y.name=`Worker ${g}`,this.actors.push(y)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(r,s,f){u.asyncAll(this.actors,(g,y)=>{g.send(r,s,y)},f=f||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(r=>{r.remove()}),this.actors=[],this.workerPool.release(this.id)}}function or(h,r,s){return r*(u.EXTENT/(h.tileSize*Math.pow(2,s-h.tileID.overscaledZ)))}ar.Actor=u.Actor;class da{constructor(r,s,f,g){this.screenBounds=r,this.cameraPoint=s,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=f,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,g)}static createFromScreenPoints(r,s){let f,g;if(r instanceof u.pointGeometry||typeof r[0]=="number"){const y=u.pointGeometry.convert(r);f=[y],g=s.isPointAboveHorizon(y)}else{const y=u.pointGeometry.convert(r[0]),w=u.pointGeometry.convert(r[1]);f=[y,w],g=u.polygonizeBounds(y,w).every(E=>s.isPointAboveHorizon(E))}return new da(f,s.getCameraPoint(),g,s)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(r){return u.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],r)}bufferedCameraGeometry(r){const s=this.screenBounds[0],f=this.screenBounds.length===1?this.screenBounds[0].add(new u.pointGeometry(1,1)):this.screenBounds[1],g=u.polygonizeBounds(s,f,0,!1);return this.cameraPoint.y>f.y&&(this.cameraPoint.x>s.x&&this.cameraPoint.x<f.x?g.splice(3,0,this.cameraPoint):this.cameraPoint.x>=f.x?g[2]=this.cameraPoint:this.cameraPoint.x<=s.x&&(g[3]=this.cameraPoint)),u.bufferConvexPolygon(g,r)}bufferedCameraGeometryGlobe(r){const s=this.screenBounds[0],f=this.screenBounds.length===1?this.screenBounds[0].add(new u.pointGeometry(1,1)):this.screenBounds[1],g=u.polygonizeBounds(s,f,r),y=this.cameraPoint.clone();switch(3*((y.y>s.y)+(y.y>f.y))+((y.x>s.x)+(y.x>f.x))){case 0:g[0]=y,g[4]=y.clone();break;case 1:g.splice(1,0,y);break;case 2:g[1]=y;break;case 3:g.splice(4,0,y);break;case 5:g.splice(2,0,y);break;case 6:g[3]=y;break;case 7:g.splice(3,0,y);break;case 8:g[2]=y}return g}containsTile(r,s,f,g=0){const y=r.queryPadding/s._pixelsPerMercatorPixel+1,w=f?this._bufferedCameraMercator(y,s):this._bufferedScreenMercator(y,s);let E=r.tileID.wrap+(w.unwrapped?g:0);const C=w.polygon.map(G=>u.getTilePoint(r.tileTransform,G,E));if(!u.polygonIntersectsBox(C,0,0,u.EXTENT,u.EXTENT))return;E=r.tileID.wrap+(this.screenGeometryMercator.unwrapped?g:0);const z=this.screenGeometryMercator.polygon.map(G=>u.getTileVec3(r.tileTransform,G,E)),D=z.map(G=>new u.pointGeometry(G[0],G[1])),B=s.getFreeCameraOptions().position||new u.MercatorCoordinate(0,0,0),j=u.getTileVec3(r.tileTransform,B,E),W=z.map(G=>{const q=u.sub(G,G,j);return u.normalize(q,q),new u.Ray(j,q)}),X=or(r,1,s.zoom)*s._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:D,tilespaceRays:W,bufferedTilespaceGeometry:C,bufferedTilespaceBounds:(Y=u.getBounds(C),Y.min.x=u.clamp(Y.min.x,0,u.EXTENT),Y.min.y=u.clamp(Y.min.y,0,u.EXTENT),Y.max.x=u.clamp(Y.max.x,0,u.EXTENT),Y.max.y=u.clamp(Y.max.y,0,u.EXTENT),Y),tile:r,tileID:r.tileID,pixelToTileUnitsFactor:X};var Y}_bufferedScreenMercator(r,s){const f=Lr(r);if(this._screenRaycastCache[f])return this._screenRaycastCache[f];{let g;return g=s.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(r),s):{polygon:this.bufferedScreenGeometry(r).map(y=>s.pointCoordinate3D(y)),unwrapped:!0},this._screenRaycastCache[f]=g,g}}_bufferedCameraMercator(r,s){const f=Lr(r);if(this._cameraRaycastCache[f])return this._cameraRaycastCache[f];{let g;return g=s.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(r),s):{polygon:this.bufferedCameraGeometry(r).map(y=>s.pointCoordinate3D(y)),unwrapped:!0},this._cameraRaycastCache[f]=g,g}}_projectAndResample(r,s){const f=function(y,w){const E=u.multiply([],w.pixelMatrix,w.globeMatrix),C=[0,-u.GLOBE_RADIUS,0,1],z=[0,u.GLOBE_RADIUS,0,1],D=[0,0,0,1];u.transformMat4$1(C,C,E),u.transformMat4$1(z,z,E),u.transformMat4$1(D,D,E);const B=new u.pointGeometry(C[0]/C[3],C[1]/C[3]),j=new u.pointGeometry(z[0]/z[3],z[1]/z[3]),W=u.polygonContainsPoint(y,B)&&C[3]<D[3],X=u.polygonContainsPoint(y,j)&&z[3]<D[3];if(!W&&!X)return null;const Y=function(re,Ce,we){for(let ve=1;ve<re.length;ve++){const nt=er(Ce.pointCoordinate3D(re[ve-1]).x),Ee=er(Ce.pointCoordinate3D(re[ve]).x);if(we<0){if(nt<Ee)return{idx:ve,t:-nt/(Ee-1-nt)}}else if(Ee<nt)return{idx:ve,t:(1-nt)/(Ee+1-nt)}}return null}(y,w,W?-1:1);if(!Y)return null;const{idx:G,t:q}=Y;let ee=G>1?Yr(y.slice(0,G),w):[],Q=G<y.length?Yr(y.slice(G),w):[];ee=ee.map(re=>new u.pointGeometry(er(re.x),re.y)),Q=Q.map(re=>new u.pointGeometry(er(re.x),re.y));const ae=[...ee];ae.length===0&&ae.push(Q[Q.length-1]);const fe=u.number(ae[ae.length-1].y,(Q.length===0?ee[0]:Q[0]).y,q);let le;return le=W?[new u.pointGeometry(0,fe),new u.pointGeometry(0,0),new u.pointGeometry(1,0),new u.pointGeometry(1,fe)]:[new u.pointGeometry(1,fe),new u.pointGeometry(1,1),new u.pointGeometry(0,1),new u.pointGeometry(0,fe)],ae.push(...le),Q.length===0?ae.push(ee[0]):ae.push(...Q),{polygon:ae.map(re=>new u.MercatorCoordinate(re.x,re.y)),unwrapped:!1}}(r,s);if(f)return f;const g=function(y,w){let E=!1,C=-1/0,z=0;for(let B=0;B<y.length-1;B++)y[B].x>C&&(C=y[B].x,z=B);for(let B=0;B<y.length-1;B++){const j=(z+B)%(y.length-1),W=y[j],X=y[j+1];Math.abs(W.x-X.x)>.5&&(W.x<X.x?(W.x+=1,j===0&&(y[y.length-1].x+=1)):(X.x+=1,j+1===y.length-1&&(y[0].x+=1)),E=!0)}const D=u.mercatorXfromLng(w.center.lng);return E&&D<Math.abs(D-1)&&y.forEach(B=>{B.x-=1}),{polygon:y,unwrapped:E}}(Yr(r,s).map(y=>new u.pointGeometry(er(y.x),y.y)),s);return{polygon:g.polygon.map(y=>new u.MercatorCoordinate(y.x,y.y)),unwrapped:g.unwrapped}}}function Yr(h,r){return u.resample(h,s=>{const f=r.pointCoordinate3D(s);s.x=f.x,s.y=f.y},1/256)}function er(h){return h<0?1+h%1:h%1}function Lr(h){return 100*h|0}function mr(h,r,s,f,g){const y=function(w,E){if(w)return g(w);if(E){h.url&&E.tiles&&h.tiles&&delete h.tiles;const C=u.pick(u.extend(E,h),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);E.vector_layers&&(C.vectorLayers=E.vector_layers,C.vectorLayerIds=C.vectorLayers.map(z=>z.id)),C.tiles=r.canonicalizeTileset(C,h.url),g(null,C)}};return h.url?u.getJSON(r.transformRequest(r.normalizeSourceURL(h.url,null,s,f),u.ResourceType.Source),y):u.exported.frame(()=>y(null,h))}class Ui{constructor(r,s,f){this.bounds=u.LngLatBounds.convert(this.validateBounds(r)),this.minzoom=s||0,this.maxzoom=f||24}validateBounds(r){return Array.isArray(r)&&r.length===4?[Math.max(-180,r[0]),Math.max(-90,r[1]),Math.min(180,r[2]),Math.min(90,r[3])]:[-180,-90,180,90]}contains(r){const s=Math.pow(2,r.z),f=Math.floor(u.mercatorXfromLng(this.bounds.getWest())*s),g=Math.floor(u.mercatorYfromLat(this.bounds.getNorth())*s),y=Math.ceil(u.mercatorXfromLng(this.bounds.getEast())*s),w=Math.ceil(u.mercatorYfromLat(this.bounds.getSouth())*s);return r.x>=f&&r.x<y&&r.y>=g&&r.y<w}}class fa{constructor(r,s,f){this.context=r;const g=r.gl;this.buffer=g.createBuffer(),this.dynamicDraw=Boolean(f),this.context.unbindVAO(),r.bindElementBuffer.set(this.buffer),g.bufferData(g.ELEMENT_ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||s.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(r){const s=this.context.gl;this.context.unbindVAO(),this.bind(),s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Vn={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class mi{constructor(r,s,f,g){this.length=s.length,this.attributes=f,this.itemSize=s.bytesPerElement,this.dynamicDraw=g,this.context=r;const y=r.gl;this.buffer=y.createBuffer(),r.bindVertexBuffer.set(this.buffer),y.bufferData(y.ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||s.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(r){const s=this.context.gl;this.bind(),s.bufferSubData(s.ARRAY_BUFFER,0,r.arrayBuffer)}enableAttributes(r,s){for(let f=0;f<this.attributes.length;f++){const g=s.attributes[this.attributes[f].name];g!==void 0&&r.enableVertexAttribArray(g)}}setVertexAttribPointers(r,s,f){for(let g=0;g<this.attributes.length;g++){const y=this.attributes[g],w=s.attributes[y.name];w!==void 0&&r.vertexAttribPointer(w,y.components,r[Vn[y.type]],!1,this.itemSize,y.offset+this.itemSize*(f||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Yt{constructor(r){this.gl=r.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(r){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Ri extends Yt{getDefault(){return u.Color.transparent}set(r){const s=this.current;(r.r!==s.r||r.g!==s.g||r.b!==s.b||r.a!==s.a||this.dirty)&&(this.gl.clearColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class sr extends Yt{getDefault(){return 1}set(r){(r!==this.current||this.dirty)&&(this.gl.clearDepth(r),this.current=r,this.dirty=!1)}}class Pi extends Yt{getDefault(){return 0}set(r){(r!==this.current||this.dirty)&&(this.gl.clearStencil(r),this.current=r,this.dirty=!1)}}class Vr extends Yt{getDefault(){return[!0,!0,!0,!0]}set(r){const s=this.current;(r[0]!==s[0]||r[1]!==s[1]||r[2]!==s[2]||r[3]!==s[3]||this.dirty)&&(this.gl.colorMask(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class pa extends Yt{getDefault(){return!0}set(r){(r!==this.current||this.dirty)&&(this.gl.depthMask(r),this.current=r,this.dirty=!1)}}class gr extends Yt{getDefault(){return 255}set(r){(r!==this.current||this.dirty)&&(this.gl.stencilMask(r),this.current=r,this.dirty=!1)}}class Ba extends Yt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(r){const s=this.current;(r.func!==s.func||r.ref!==s.ref||r.mask!==s.mask||this.dirty)&&(this.gl.stencilFunc(r.func,r.ref,r.mask),this.current=r,this.dirty=!1)}}class Ni extends Yt{getDefault(){const r=this.gl;return[r.KEEP,r.KEEP,r.KEEP]}set(r){const s=this.current;(r[0]!==s[0]||r[1]!==s[1]||r[2]!==s[2]||this.dirty)&&(this.gl.stencilOp(r[0],r[1],r[2]),this.current=r,this.dirty=!1)}}class lr extends Yt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;r?s.enable(s.STENCIL_TEST):s.disable(s.STENCIL_TEST),this.current=r,this.dirty=!1}}class Kr extends Yt{getDefault(){return[0,1]}set(r){const s=this.current;(r[0]!==s[0]||r[1]!==s[1]||this.dirty)&&(this.gl.depthRange(r[0],r[1]),this.current=r,this.dirty=!1)}}class Cr extends Yt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;r?s.enable(s.DEPTH_TEST):s.disable(s.DEPTH_TEST),this.current=r,this.dirty=!1}}class jr extends Yt{getDefault(){return this.gl.LESS}set(r){(r!==this.current||this.dirty)&&(this.gl.depthFunc(r),this.current=r,this.dirty=!1)}}class Di extends Yt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;r?s.enable(s.BLEND):s.disable(s.BLEND),this.current=r,this.dirty=!1}}class ma extends Yt{getDefault(){const r=this.gl;return[r.ONE,r.ZERO]}set(r){const s=this.current;(r[0]!==s[0]||r[1]!==s[1]||this.dirty)&&(this.gl.blendFunc(r[0],r[1]),this.current=r,this.dirty=!1)}}class Fa extends Yt{getDefault(){return u.Color.transparent}set(r){const s=this.current;(r.r!==s.r||r.g!==s.g||r.b!==s.b||r.a!==s.a||this.dirty)&&(this.gl.blendColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class _r extends Yt{getDefault(){return this.gl.FUNC_ADD}set(r){(r!==this.current||this.dirty)&&(this.gl.blendEquation(r),this.current=r,this.dirty=!1)}}class vt extends Yt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;r?s.enable(s.CULL_FACE):s.disable(s.CULL_FACE),this.current=r,this.dirty=!1}}class Nt extends Yt{getDefault(){return this.gl.BACK}set(r){(r!==this.current||this.dirty)&&(this.gl.cullFace(r),this.current=r,this.dirty=!1)}}class sn extends Yt{getDefault(){return this.gl.CCW}set(r){(r!==this.current||this.dirty)&&(this.gl.frontFace(r),this.current=r,this.dirty=!1)}}class Pn extends Yt{getDefault(){return null}set(r){(r!==this.current||this.dirty)&&(this.gl.useProgram(r),this.current=r,this.dirty=!1)}}class Jn extends Yt{getDefault(){return this.gl.TEXTURE0}set(r){(r!==this.current||this.dirty)&&(this.gl.activeTexture(r),this.current=r,this.dirty=!1)}}class ur extends Yt{getDefault(){const r=this.gl;return[0,0,r.drawingBufferWidth,r.drawingBufferHeight]}set(r){const s=this.current;(r[0]!==s[0]||r[1]!==s[1]||r[2]!==s[2]||r[3]!==s[3]||this.dirty)&&(this.gl.viewport(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class Vi extends Yt{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;s.bindFramebuffer(s.FRAMEBUFFER,r),this.current=r,this.dirty=!1}}class yr extends Yt{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;s.bindRenderbuffer(s.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class ri extends Yt{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;s.bindTexture(s.TEXTURE_2D,r),this.current=r,this.dirty=!1}}class Gr extends Yt{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;s.bindBuffer(s.ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class Zn extends Yt{getDefault(){return null}set(r){const s=this.gl;s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class gi extends Yt{constructor(r){super(r),this.vao=r.extVertexArrayObject}getDefault(){return null}set(r){this.vao&&(r!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(r),this.current=r,this.dirty=!1)}}class Wa extends Yt{getDefault(){return 4}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_ALIGNMENT,r),this.current=r,this.dirty=!1}}class ga extends Yt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),this.current=r,this.dirty=!1}}class Ya extends Yt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,r),this.current=r,this.dirty=!1}}class zo extends Yt{constructor(r,s){super(r),this.context=r,this.parent=s}getDefault(){return null}}class Sa extends zo{setDirty(){this.dirty=!0}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class Ua extends zo{attachment(){return this.gl.DEPTH_ATTACHMENT}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferRenderbuffer(s.FRAMEBUFFER,this.attachment(),s.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class Io extends Ua{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class J{constructor(r,s,f,g){this.context=r,this.width=s,this.height=f;const y=this.framebuffer=r.gl.createFramebuffer();this.colorAttachment=new Sa(r,y),g&&(this.depthAttachment=new Ua(r,y))}destroy(){const r=this.context.gl,s=this.colorAttachment.get();if(s&&r.deleteTexture(s),this.depthAttachment){const f=this.depthAttachment.get();f&&r.deleteRenderbuffer(f)}r.deleteFramebuffer(this.framebuffer)}}class P{constructor(r){this.gl=r,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Ri(this),this.clearDepth=new sr(this),this.clearStencil=new Pi(this),this.colorMask=new Vr(this),this.depthMask=new pa(this),this.stencilMask=new gr(this),this.stencilFunc=new Ba(this),this.stencilOp=new Ni(this),this.stencilTest=new lr(this),this.depthRange=new Kr(this),this.depthTest=new Cr(this),this.depthFunc=new jr(this),this.blend=new Di(this),this.blendFunc=new ma(this),this.blendColor=new Fa(this),this.blendEquation=new _r(this),this.cullFace=new vt(this),this.cullFaceSide=new Nt(this),this.frontFace=new sn(this),this.program=new Pn(this),this.activeTexture=new Jn(this),this.viewport=new ur(this),this.bindFramebuffer=new Vi(this),this.bindRenderbuffer=new yr(this),this.bindTexture=new ri(this),this.bindVertexBuffer=new Gr(this),this.bindElementBuffer=new Zn(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new gi(this),this.pixelStoreUnpack=new Wa(this),this.pixelStoreUnpackPremultiplyAlpha=new ga(this),this.pixelStoreUnpackFlipY=new Ya(this),this.extTextureFilterAnisotropic=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=r.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=r.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=r.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=r.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.extTextureHalfFloat=r.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(r.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=r.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=r.getExtension("OES_standard_derivatives"),this.extTimerQuery=r.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(r,s){return new fa(this,r,s)}createVertexBuffer(r,s,f){return new mi(this,r,s,f)}createRenderbuffer(r,s,f){const g=this.gl,y=g.createRenderbuffer();return this.bindRenderbuffer.set(y),g.renderbufferStorage(g.RENDERBUFFER,r,s,f),this.bindRenderbuffer.set(null),y}createFramebuffer(r,s,f){return new J(this,r,s,f)}clear({color:r,depth:s,stencil:f}){const g=this.gl;let y=0;r&&(y|=g.COLOR_BUFFER_BIT,this.clearColor.set(r),this.colorMask.set([!0,!0,!0,!0])),s!==void 0&&(y|=g.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(s),this.depthMask.set(!0)),f!==void 0&&(y|=g.STENCIL_BUFFER_BIT,this.clearStencil.set(f),this.stencilMask.set(255)),g.clear(y)}setCullFace(r){r.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(r.mode),this.frontFace.set(r.frontFace))}setDepthMode(r){r.func!==this.gl.ALWAYS||r.mask?(this.depthTest.set(!0),this.depthFunc.set(r.func),this.depthMask.set(r.mask),this.depthRange.set(r.range)):this.depthTest.set(!1)}setStencilMode(r){r.test.func!==this.gl.ALWAYS||r.mask?(this.stencilTest.set(!0),this.stencilMask.set(r.mask),this.stencilOp.set([r.fail,r.depthFail,r.pass]),this.stencilFunc.set({func:r.test.func,ref:r.ref,mask:r.test.mask})):this.stencilTest.set(!1)}setColorMode(r){Oe(r.blendFunction,u.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(r.blendFunction),this.blendColor.set(r.blendColor)),this.colorMask.set(r.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class V extends u.Evented{constructor(r,s,f,g){super(),this.id=r,this.dispatcher=f,this.setEventedParent(g),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=u.extend({type:"raster"},s),u.extend(this,u.pick(s,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new u.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=mr(this._options,this.map._requestManager,null,null,(r,s)=>{this._tileJSONRequest=null,this._loaded=!0,r?this.fire(new u.ErrorEvent(r)):s&&(u.extend(this,s),s.bounds&&(this.tileBounds=new Ui(s.bounds,this.minzoom,this.maxzoom)),u.postTurnstileEvent(s.tiles),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(r){this.map=r,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return u.extend({},this._options)}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}loadTile(r,s){const f=u.exported.devicePixelRatio>=2,g=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme),f,this.tileSize);r.request=u.getImage(this.map._requestManager.transformRequest(g,u.ResourceType.Tile),(y,w,E,C)=>(delete r.request,r.aborted?(r.state="unloaded",s(null)):y?(r.state="errored",s(y)):w?(this.map._refreshExpiredTiles&&r.setExpiryData({cacheControl:E,expires:C}),r.setTexture(w,this.map.painter),r.state="loaded",u.cacheEntryPossiblyAdded(this.dispatcher),void s(null)):s(null)))}static loadTileData(r,s,f){r.setTexture(s,f)}static unloadTileData(r,s){r.texture&&s.saveTileTexture(r.texture)}abortTile(r,s){r.request&&(r.request.cancel(),delete r.request),s()}unloadTile(r,s){r.texture&&this.map.painter.saveTileTexture(r.texture),s()}hasTransition(){return!1}}let K;function O(h,r,s,f,g,y,w,E){const C=[h,s,g,r,f,y,1,1,1],z=[w,E,1],D=u.adjoint([],C),[B,j,W]=u.transformMat3(z,z,u.transpose(D,D));return u.multiply$1(C,[B,0,0,0,j,0,0,0,W],C)}class Z extends u.Evented{constructor(r,s,f,g){super(),this.id=r,this.dispatcher=f,this.coordinates=s.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(g),this.options=s,this._dirty=!1}load(r,s){this._loaded=s||!1,this.fire(new u.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=u.getImage(this.map._requestManager.transformRequest(this.url,u.ResourceType.Image),(f,g)=>{if(this._imageRequest=null,this._loaded=!0,f)this.fire(new u.ErrorEvent(f));else if(g){const{HTMLImageElement:y}=u.window;this.image=g instanceof y?u.exported.getImageData(g):g,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,r&&(this.coordinates=r),this._finishLoading()}})}loaded(){return this._loaded}updateImage(r){return this.image&&r.url?(this._imageRequest&&r.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=r.url,this.load(r.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(r){this.map=r,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(r){this.coordinates=r,this._boundsArray=void 0;const s=r.map(u.MercatorCoordinate.fromLngLat);return this.tileID=function(f){let g=1/0,y=1/0,w=-1/0,E=-1/0;for(const B of f)g=Math.min(g,B.x),y=Math.min(y,B.y),w=Math.max(w,B.x),E=Math.max(E,B.y);const C=Math.max(w-g,E-y),z=Math.max(0,Math.floor(-Math.log(C)/Math.LN2)),D=Math.pow(2,z);return new u.CanonicalTileID(z,Math.floor((g+w)/2*D),Math.floor((y+E)/2*D))}(s),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new u.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(r){for(const C in this.tiles){const z=this.tiles[C];z.state!=="loaded"&&(z.state="loaded",z.texture=this.texture)}if(this._boundsArray)return;const s=u.tileTransform(this.tileID,this.map.transform.projection),[f,g,y,w]=this.coordinates.map(C=>{const z=s.projection.project(C[0],C[1]);return u.getTilePoint(s,z)._round()});this.perspectiveTransform=function(C,z,D,B,j,W,X,Y,G,q){const ee=O(0,0,C,0,0,z,C,z),Q=O(D,B,j,W,X,Y,G,q);return u.multiply$1(Q,u.adjoint(ee,ee),Q),[Q[6]/Q[8]*C/u.EXTENT,Q[7]/Q[8]*z/u.EXTENT]}(this.width,this.height,f.x,f.y,g.x,g.y,w.x,w.y,y.x,y.y);const E=this._boundsArray=new u.StructArrayLayout4i8;E.emplaceBack(f.x,f.y,0,0),E.emplaceBack(g.x,g.y,u.EXTENT,0),E.emplaceBack(w.x,w.y,0,u.EXTENT),E.emplaceBack(y.x,y.y,u.EXTENT,u.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=r.createVertexBuffer(E,u.boundsAttributes.members),this.boundsSegments=u.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const r=this.map.painter.context,s=r.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new u.Texture(r,this.image,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(r)}loadTile(r,s){this.tileID&&this.tileID.equals(r.tileID.canonical)?(this.tiles[String(r.tileID.wrap)]=r,r.buckets={},s(null)):(r.state="errored",s(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const se={vector:class extends u.Evented{constructor(h,r,s,f){if(super(),this.id=h,this.dispatcher=s,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,u.extend(this,u.pick(r,["url","scheme","tileSize","promoteId"])),this._options=u.extend({type:"vector"},r),this._collectResourceTiming=r.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(f),this._tileWorkers={},this._deduped=new u.DedupedRequest}load(h){this._loaded=!1,this.fire(new u.Event("dataloading",{dataType:"source"}));const r=Array.isArray(this.map._language)?this.map._language.join():this.map._language,s=this.map._worldview;this._tileJSONRequest=mr(this._options,this.map._requestManager,r,s,(f,g)=>{this._tileJSONRequest=null,this._loaded=!0,f?(r&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${r}`),s&&s.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${s}`),this.fire(new u.ErrorEvent(f))):g&&(u.extend(this,g),g.bounds&&(this.tileBounds=new Ui(g.bounds,this.minzoom,this.maxzoom)),u.postTurnstileEvent(g.tiles,this.map._requestManager._customAccessToken),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"content"}))),h&&h(f)})}loaded(){return this._loaded}hasTile(h){return!this.tileBounds||this.tileBounds.contains(h.canonical)}onAdd(h){this.map=h,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>{const h=this.map.style._getSourceCaches(this.id);for(const r of h)r.clearTiles()})}setSourceProperty(h){h(),this.reload()}setTiles(h){return this._options.tiles=h,this.reload(),this}setUrl(h){return this.url=h,this._options.url=h,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return u.extend({},this._options)}loadTile(h,r){const s=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme)),f={request:this.map._requestManager.transformRequest(s,u.ResourceType.Tile),data:void 0,uid:h.uid,tileID:h.tileID,tileZoom:h.tileZoom,zoom:h.tileID.overscaledZ,tileSize:this.tileSize*h.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:u.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:h.isSymbolTile};if(f.request.collectResourceTiming=this._collectResourceTiming,h.actor&&h.state!=="expired")h.state==="loading"?h.reloadCallback=r:h.request=h.actor.send("reloadTile",f,g.bind(this));else if(h.actor=this._tileWorkers[s]=this._tileWorkers[s]||this.dispatcher.getActor(),this.dispatcher.ready)h.request=h.actor.send("loadTile",f,g.bind(this),void 0,!0);else{const y=u.loadVectorTile.call({deduped:this._deduped},f,(w,E)=>{w||!E?g.call(this,w):(f.data={cacheControl:E.cacheControl,expires:E.expires,rawData:E.rawData.slice(0)},h.actor&&h.actor.send("loadTile",f,g.bind(this),void 0,!0))},!0);h.request={cancel:y}}function g(y,w){return delete h.request,h.aborted?r(null):y&&y.status!==404?r(y):(w&&w.resourceTiming&&(h.resourceTiming=w.resourceTiming),this.map._refreshExpiredTiles&&w&&h.setExpiryData(w),h.loadVectorData(w,this.map.painter),u.cacheEntryPossiblyAdded(this.dispatcher),r(null),void(h.reloadCallback&&(this.loadTile(h,h.reloadCallback),h.reloadCallback=null)))}}abortTile(h){h.request&&(h.request.cancel(),delete h.request),h.actor&&h.actor.send("abortTile",{uid:h.uid,type:this.type,source:this.id})}unloadTile(h){h.unloadVectorData(),h.actor&&h.actor.send("removeTile",{uid:h.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}},raster:V,"raster-dem":class extends V{constructor(h,r,s,f){super(h,r,s,f),this.type="raster-dem",this.maxzoom=22,this._options=u.extend({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox"}loadTile(h,r){const s=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function f(g,y){g&&(h.state="errored",r(g)),y&&(h.dem=y,h.dem.onDeserialize(),h.needsHillshadePrepare=!0,h.needsDEMTextureUpload=!0,h.state="loaded",r(null))}h.request=u.getImage(this.map._requestManager.transformRequest(s,u.ResourceType.Tile),function(g,y,w,E){if(delete h.request,h.aborted)h.state="unloaded",r(null);else if(g)h.state="errored",r(g);else if(y){this.map._refreshExpiredTiles&&h.setExpiryData({cacheControl:w,expires:E});const C=u.window.ImageBitmap&&y instanceof u.window.ImageBitmap&&(K==null&&(K=u.window.OffscreenCanvas&&new u.window.OffscreenCanvas(1,1).getContext("2d")&&typeof u.window.createImageBitmap=="function"),K),z=1-(y.width-u.prevPowerOfTwo(y.width))/2;z<1||h.neighboringTiles||(h.neighboringTiles=this._getNeighboringTiles(h.tileID));const D=C?y:u.exported.getImageData(y,z),B={uid:h.uid,coord:h.tileID,source:this.id,rawImageData:D,encoding:this.encoding,padding:z};h.actor&&h.state!=="expired"||(h.actor=this.dispatcher.getActor(),h.actor.send("loadDEMTile",B,f.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(h){const r=h.canonical,s=Math.pow(2,r.z),f=(r.x-1+s)%s,g=r.x===0?h.wrap-1:h.wrap,y=(r.x+1+s)%s,w=r.x+1===s?h.wrap+1:h.wrap,E={};return E[new u.OverscaledTileID(h.overscaledZ,g,r.z,f,r.y).key]={backfilled:!1},E[new u.OverscaledTileID(h.overscaledZ,w,r.z,y,r.y).key]={backfilled:!1},r.y>0&&(E[new u.OverscaledTileID(h.overscaledZ,g,r.z,f,r.y-1).key]={backfilled:!1},E[new u.OverscaledTileID(h.overscaledZ,h.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},E[new u.OverscaledTileID(h.overscaledZ,w,r.z,y,r.y-1).key]={backfilled:!1}),r.y+1<s&&(E[new u.OverscaledTileID(h.overscaledZ,g,r.z,f,r.y+1).key]={backfilled:!1},E[new u.OverscaledTileID(h.overscaledZ,h.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},E[new u.OverscaledTileID(h.overscaledZ,w,r.z,y,r.y+1).key]={backfilled:!1}),E}unloadTile(h){h.demTexture&&this.map.painter.saveTileTexture(h.demTexture),h.fbo&&(h.fbo.destroy(),delete h.fbo),h.dem&&delete h.dem,delete h.neighboringTiles,h.state="unloaded"}},geojson:class extends u.Evented{constructor(h,r,s,f){super(),this.id=h,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=s.getActor(),this.setEventedParent(f),this._data=r.data,this._options=u.extend({},r),this._collectResourceTiming=r.collectResourceTiming,r.maxzoom!==void 0&&(this.maxzoom=r.maxzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId;const g=u.EXTENT/this.tileSize;this.workerOptions=u.extend({source:this.id,cluster:r.cluster||!1,geojsonVtOptions:{buffer:(r.buffer!==void 0?r.buffer:128)*g,tolerance:(r.tolerance!==void 0?r.tolerance:.375)*g,extent:u.EXTENT,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:r.clusterMaxZoom!==void 0?r.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,r.clusterMinPoints||2),extent:u.EXTENT,radius:(r.clusterRadius!==void 0?r.clusterRadius:50)*g,log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter},r.workerOptions)}onAdd(h){this.map=h,this.setData(this._data)}setData(h){return this._data=h,this._updateWorkerData(),this}getClusterExpansionZoom(h,r){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:h,source:this.id},r),this}getClusterChildren(h,r){return this.actor.send("geojson.getClusterChildren",{clusterId:h,source:this.id},r),this}getClusterLeaves(h,r,s,f){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:h,limit:r,offset:s},f),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new u.Event("dataloading",{dataType:"source"})),this._loaded=!1;const h=u.extend({},this.workerOptions),r=this._data;typeof r=="string"?(h.request=this.map._requestManager.transformRequest(u.exported.resolveURL(r),u.ResourceType.Source),h.request.collectResourceTiming=this._collectResourceTiming):h.data=JSON.stringify(r),this._pendingLoad=this.actor.send(`${this.type}.loadData`,h,(s,f)=>{if(this._loaded=!0,this._pendingLoad=null,s)this.fire(new u.ErrorEvent(s));else{const g={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&f&&f.resourceTiming&&f.resourceTiming[this.id]&&(g.resourceTiming=f.resourceTiming[this.id]),this.fire(new u.Event("data",g)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(h,r){const s=h.actor?"reloadTile":"loadTile";h.actor=this.actor,h.request=this.actor.send(s,{type:this.type,uid:h.uid,tileID:h.tileID,tileZoom:h.tileZoom,zoom:h.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:u.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(f,g)=>(delete h.request,h.unloadVectorData(),h.aborted?r(null):f?r(f):(h.loadVectorData(g,this.map.painter,s==="reloadTile"),r(null))),void 0,s==="loadTile")}abortTile(h){h.request&&(h.request.cancel(),delete h.request),h.aborted=!0}unloadTile(h){h.unloadVectorData(),this.actor.send("removeTile",{uid:h.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return u.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Z{constructor(h,r,s,f){super(h,r,s,f),this.roundZoom=!0,this.type="video",this.options=r}load(){this._loaded=!1;const h=this.options;this.urls=[];for(const r of h.urls)this.urls.push(this.map._requestManager.transformRequest(r,u.ResourceType.Source).url);u.getVideo(this.urls,(r,s)=>{this._loaded=!0,r?this.fire(new u.ErrorEvent(r)):s&&(this.video=s,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(h){if(this.video){const r=this.video.seekable;h<r.start(0)||h>r.end(0)?this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${r.start(0)} and ${r.end(0)}-second mark.`))):this.video.currentTime=h}}getVideo(){return this.video}onAdd(h){this.map||(this.map=h,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const h=this.map.painter.context,r=h.gl;this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new u.Texture(h,this.video,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(h)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Z,canvas:class extends Z{constructor(h,r,s,f){super(h,r,s,f),r.coordinates?Array.isArray(r.coordinates)&&r.coordinates.length===4&&!r.coordinates.some(g=>!Array.isArray(g)||g.length!==2||g.some(y=>typeof y!="number"))||this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${h}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${h}`,null,'missing required property "coordinates"'))),r.animate&&typeof r.animate!="boolean"&&this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${h}`,null,'optional "animate" property must be a boolean value'))),r.canvas?typeof r.canvas=="string"||r.canvas instanceof u.window.HTMLCanvasElement||this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${h}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${h}`,null,'missing required property "canvas"'))),this.options=r,this.animate=r.animate===void 0||r.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof u.window.HTMLCanvasElement?this.options.canvas:u.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new u.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(h){this.map=h,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let h=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,h=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,h=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const r=this.map.painter.context;this.texture?(h||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new u.Texture(r,this.canvas,r.gl.RGBA,{premultiply:!0}),this._prepareData(r)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const h of[this.canvas.width,this.canvas.height])if(isNaN(h)||h<=0)return!0;return!1}},custom:class extends u.Evented{constructor(h,r,s,f){super(),this.id=h,this.type="custom",this._dataType="raster",this._dispatcher=s,this._implementation=r,this.setEventedParent(f),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new u.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new u.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Ui(this._implementation.bounds,this.minzoom,this.maxzoom)),r.update=this._update.bind(this),r.clearTiles=this._clearTiles.bind(this),r.coveringTiles=this._coveringTiles.bind(this),u.extend(this,u.pick(r,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return u.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new u.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(h){this._map=h,this._loaded=!1,this.fire(new u.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(h),this.load()}onRemove(h){this._implementation.onRemove&&this._implementation.onRemove(h)}hasTile(h){if(this._implementation.hasTile){const{x:r,y:s,z:f}=h.canonical;return this._implementation.hasTile({x:r,y:s,z:f})}return!this.tileBounds||this.tileBounds.contains(h.canonical)}loadTile(h,r){const{x:s,y:f,z:g}=h.tileID.canonical,y=new u.window.AbortController;h.request=Promise.resolve(this._implementation.loadTile({x:s,y:f,z:g},{signal:y.signal})).then(function(w){return delete h.request,h.aborted?(h.state="unloaded",r(null)):w===void 0?(h.state="errored",r(null)):w===null?(this.loadTileData(h,{width:this.tileSize,height:this.tileSize,data:null}),h.state="loaded",r(null)):function(E){return E instanceof u.window.ImageData||E instanceof u.window.HTMLCanvasElement||E instanceof u.window.ImageBitmap||E instanceof u.window.HTMLImageElement}(w)?(this.loadTileData(h,w),h.state="loaded",void r(null)):(h.state="errored",r(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}.bind(this)).catch(w=>{w.code!==20&&(h.state="errored",r(w))}),h.request.cancel=()=>y.abort()}loadTileData(h,r){V.loadTileData(h,r,this._map.painter)}unloadTileData(h){V.unloadTileData(h,this._map.painter)}unloadTile(h,r){if(this.unloadTileData(h),this._implementation.unloadTile){const{x:s,y:f,z:g}=h.tileID.canonical;this._implementation.unloadTile({x:s,y:f,z:g})}r()}abortTile(h,r){h.request&&h.request.cancel&&(h.request.cancel(),delete h.request),r()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(h=>({x:h.canonical.x,y:h.canonical.y,z:h.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new u.Event("data",{dataType:"source",sourceDataType:"content"}))}}},pe=function(h,r,s,f){const g=new se[r.type](h,r,s,f);if(g.id!==h)throw new Error(`Expected Source id to be ${h} instead of ${g.id}`);return u.bindAll(["load","abort","unload","serialize","prepare"],g),g};function ue(h,r){const s=u.identity([]);return u.scale(s,s,[.5*h.width,.5*-h.height,1]),u.translate(s,s,[1,-1,0]),u.multiply(s,s,h.calculateProjMatrix(r.toUnwrapped())),Float32Array.from(s)}function _e(h,r,s,f,g,y,w,E=!1){const C=h.tilesIn(f,w,E);C.sort(We);const z=[];for(const B of C)z.push({wrappedTileID:B.tile.tileID.wrapped().key,queryResults:B.tile.queryRenderedFeatures(r,s,h._state,B,g,y,ue(h.transform,B.tile.tileID),E)});const D=function(B){const j={},W={};for(const X of B){const Y=X.queryResults,G=X.wrappedTileID,q=W[G]=W[G]||{};for(const ee in Y){const Q=Y[ee],ae=q[ee]=q[ee]||{},fe=j[ee]=j[ee]||[];for(const le of Q)ae[le.featureIndex]||(ae[le.featureIndex]=!0,fe.push(le))}}return j}(z);for(const B in D)D[B].forEach(j=>{const W=j.feature,X=W.layer;X&&X.type!=="background"&&X.type!=="sky"&&(W.source=X.source,X["source-layer"]&&(W.sourceLayer=X["source-layer"]),W.state=W.id!==void 0?h.getFeatureState(X["source-layer"],W.id):{})});return D}function Te(h,r){const s=h.getRenderableIds().map(y=>h.getTileByID(y)),f=[],g={};for(let y=0;y<s.length;y++){const w=s[y],E=w.tileID.canonical.key;g[E]||(g[E]=!0,w.querySourceFeatures(f,r))}return f}function We(h,r){const s=h.tileID,f=r.tileID;return s.overscaledZ-f.overscaledZ||s.canonical.y-f.canonical.y||s.wrap-f.wrap||s.canonical.x-f.canonical.x}function qe(){return ju.workerClass!=null?new ju.workerClass:new u.window.Worker(ju.workerUrl)}const ct="mapboxgl_preloaded_worker_pool";class ot{constructor(){this.active={}}acquire(r){if(!this.workers)for(this.workers=[];this.workers.length<ot.workerCount;)this.workers.push(new qe);return this.active[r]=!0,this.workers.slice()}release(r){delete this.active[r],this.numActive()===0&&(this.workers.forEach(s=>{s.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[ct]}numActive(){return Object.keys(this.active).length}}let _t;function Lt(){return _t||(_t=new ot),_t}function on(h,r){const s={};for(const f in h)f!=="ref"&&(s[f]=h[f]);return u.refProperties.forEach(f=>{f in r&&(s[f]=r[f])}),s}function cn(h){h=h.slice();const r=Object.create(null);for(let s=0;s<h.length;s++)r[h[s].id]=h[s];for(let s=0;s<h.length;s++)"ref"in h[s]&&(h[s]=on(h[s],r[h[s].ref]));return h}ot.workerCount=2;const Rt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function ai(h,r,s){s.push({command:Rt.addSource,args:[h,r[h]]})}function ui(h,r,s){r.push({command:Rt.removeSource,args:[h]}),s[h]=!0}function co(h,r,s,f){ui(h,s,f),ai(h,r,s)}function _a(h,r,s){let f;for(f in h[s])if(h[s].hasOwnProperty(f)&&f!=="data"&&!Oe(h[s][f],r[s][f]))return!1;for(f in r[s])if(r[s].hasOwnProperty(f)&&f!=="data"&&!Oe(h[s][f],r[s][f]))return!1;return!0}function an(h,r,s,f,g,y){let w;for(w in r=r||{},h=h||{})h.hasOwnProperty(w)&&(Oe(h[w],r[w])||s.push({command:y,args:[f,w,r[w],g]}));for(w in r)r.hasOwnProperty(w)&&!h.hasOwnProperty(w)&&(Oe(h[w],r[w])||s.push({command:y,args:[f,w,r[w],g]}))}function Ne(h){return h.id}function ya(h,r){return h[r.id]=r,h}class Wi{constructor(r,s){this.reset(r,s)}reset(r,s){this.points=r||[],this._distances=[0];for(let f=1;f<this.points.length;f++)this._distances[f]=this._distances[f-1]+this.points[f].dist(this.points[f-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(s||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(r){if(this.points.length===1)return this.points[0];r=u.clamp(r,0,1);let s=1,f=this._distances[s];const g=r*this.paddedLength+this.padding;for(;f<g&&s<this._distances.length;)f=this._distances[++s];const y=s-1,w=this._distances[y],E=f-w,C=E>0?(g-w)/E:0;return this.points[y].mult(1-C).add(this.points[s].mult(C))}}class Ka{constructor(r,s,f){const g=this.boxCells=[],y=this.circleCells=[];this.xCellCount=Math.ceil(r/f),this.yCellCount=Math.ceil(s/f);for(let w=0;w<this.xCellCount*this.yCellCount;w++)g.push([]),y.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=r,this.height=s,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/s,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(r,s,f,g,y){this._forEachCell(s,f,g,y,this._insertBoxCell,this.boxUid++),this.boxKeys.push(r),this.bboxes.push(s),this.bboxes.push(f),this.bboxes.push(g),this.bboxes.push(y)}insertCircle(r,s,f,g){this._forEachCell(s-g,f-g,s+g,f+g,this._insertCircleCell,this.circleUid++),this.circleKeys.push(r),this.circles.push(s),this.circles.push(f),this.circles.push(g)}_insertBoxCell(r,s,f,g,y,w){this.boxCells[y].push(w)}_insertCircleCell(r,s,f,g,y,w){this.circleCells[y].push(w)}_query(r,s,f,g,y,w){if(f<0||r>this.width||g<0||s>this.height)return!y&&[];const E=[];if(r<=0&&s<=0&&this.width<=f&&this.height<=g){if(y)return!0;for(let C=0;C<this.boxKeys.length;C++)E.push({key:this.boxKeys[C],x1:this.bboxes[4*C],y1:this.bboxes[4*C+1],x2:this.bboxes[4*C+2],y2:this.bboxes[4*C+3]});for(let C=0;C<this.circleKeys.length;C++){const z=this.circles[3*C],D=this.circles[3*C+1],B=this.circles[3*C+2];E.push({key:this.circleKeys[C],x1:z-B,y1:D-B,x2:z+B,y2:D+B})}return w?E.filter(w):E}return this._forEachCell(r,s,f,g,this._queryCell,E,{hitTest:y,seenUids:{box:{},circle:{}}},w),y?E.length>0:E}_queryCircle(r,s,f,g,y){const w=r-f,E=r+f,C=s-f,z=s+f;if(E<0||w>this.width||z<0||C>this.height)return!g&&[];const D=[];return this._forEachCell(w,C,E,z,this._queryCellCircle,D,{hitTest:g,circle:{x:r,y:s,radius:f},seenUids:{box:{},circle:{}}},y),g?D.length>0:D}query(r,s,f,g,y){return this._query(r,s,f,g,!1,y)}hitTest(r,s,f,g,y){return this._query(r,s,f,g,!0,y)}hitTestCircle(r,s,f,g){return this._queryCircle(r,s,f,!0,g)}_queryCell(r,s,f,g,y,w,E,C){const z=E.seenUids,D=this.boxCells[y];if(D!==null){const j=this.bboxes;for(const W of D)if(!z.box[W]){z.box[W]=!0;const X=4*W;if(r<=j[X+2]&&s<=j[X+3]&&f>=j[X+0]&&g>=j[X+1]&&(!C||C(this.boxKeys[W]))){if(E.hitTest)return w.push(!0),!0;w.push({key:this.boxKeys[W],x1:j[X],y1:j[X+1],x2:j[X+2],y2:j[X+3]})}}}const B=this.circleCells[y];if(B!==null){const j=this.circles;for(const W of B)if(!z.circle[W]){z.circle[W]=!0;const X=3*W;if(this._circleAndRectCollide(j[X],j[X+1],j[X+2],r,s,f,g)&&(!C||C(this.circleKeys[W]))){if(E.hitTest)return w.push(!0),!0;{const Y=j[X],G=j[X+1],q=j[X+2];w.push({key:this.circleKeys[W],x1:Y-q,y1:G-q,x2:Y+q,y2:G+q})}}}}}_queryCellCircle(r,s,f,g,y,w,E,C){const z=E.circle,D=E.seenUids,B=this.boxCells[y];if(B!==null){const W=this.bboxes;for(const X of B)if(!D.box[X]){D.box[X]=!0;const Y=4*X;if(this._circleAndRectCollide(z.x,z.y,z.radius,W[Y+0],W[Y+1],W[Y+2],W[Y+3])&&(!C||C(this.boxKeys[X])))return w.push(!0),!0}}const j=this.circleCells[y];if(j!==null){const W=this.circles;for(const X of j)if(!D.circle[X]){D.circle[X]=!0;const Y=3*X;if(this._circlesCollide(W[Y],W[Y+1],W[Y+2],z.x,z.y,z.radius)&&(!C||C(this.circleKeys[X])))return w.push(!0),!0}}}_forEachCell(r,s,f,g,y,w,E,C){const z=this._convertToXCellCoord(r),D=this._convertToYCellCoord(s),B=this._convertToXCellCoord(f),j=this._convertToYCellCoord(g);for(let W=z;W<=B;W++)for(let X=D;X<=j;X++)if(y.call(this,r,s,f,g,this.xCellCount*X+W,w,E,C))return}_convertToXCellCoord(r){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(r*this.xScale)))}_convertToYCellCoord(r){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(r*this.yScale)))}_circlesCollide(r,s,f,g,y,w){const E=g-r,C=y-s,z=f+w;return z*z>E*E+C*C}_circleAndRectCollide(r,s,f,g,y,w,E){const C=(w-g)/2,z=Math.abs(r-(g+C));if(z>C+f)return!1;const D=(E-y)/2,B=Math.abs(s-(y+D));if(B>D+f)return!1;if(z<=C||B<=D)return!0;const j=z-C,W=B-D;return j*j+W*W<=f*f}}const Ec=Math.tan(85*Math.PI/180);function Jr(h,r,s,f,g,y,w){const E=u.create();if(s)if(y.name==="globe"){const C=u.calculateGlobeLabelMatrix(g,r);u.multiply(E,E,C)}else{const C=Wt([],w);E[0]=C[0],E[1]=C[1],E[4]=C[2],E[5]=C[3],f||u.rotateZ(E,E,g.angle)}else u.multiply(E,g.labelPlaneMatrix,h);return E}function el(h,r,s,f,g,y,w){const E=Jr(h,r,s,f,g,y,w);return y.name==="globe"&&s||(E[2]=E[6]=E[10]=E[14]=0),E}function Eu(h,r,s,f,g,y,w){if(s){if(y.name==="globe"){const E=Jr(h,r,s,f,g,y,w);return u.invert(E,E),u.multiply(E,h,E),E}{const E=u.clone(h),C=u.identity([]);return C[0]=w[0],C[1]=w[1],C[4]=w[2],C[5]=w[3],u.multiply(E,E,C),f||u.rotateZ(E,E,-g.angle),E}}return g.glCoordMatrix}function Or(h,r,s,f){const g=[h,r,s,1];s?u.transformMat4$1(g,g,f):Si(g,g,f);const y=g[3];return g[0]/=y,g[1]/=y,g[2]/=y,g}function ht(h,r){return Math.min(.5+h/r*.5,1.5)}function bn(h,r){const s=h[0]/h[3],f=h[1]/h[3];return s>=-r[0]&&s<=r[0]&&f>=-r[1]&&f<=r[1]}function hn(h,r,s,f,g,y,w,E,C,z){const D=s.transform,B=f?h.textSizeData:h.iconSizeData,j=u.evaluateSizeForZoom(B,s.transform.zoom),W=D.projection.name==="globe",X=[256/s.width*2+1,256/s.height*2+1],Y=f?h.text.dynamicLayoutVertexArray:h.icon.dynamicLayoutVertexArray;Y.clear();let G=null;W&&(G=f?h.text.globeExtVertexArray:h.icon.globeExtVertexArray);const q=h.lineVertexArray,ee=f?h.text.placedSymbolArray:h.icon.placedSymbolArray,Q=s.transform.width/s.transform.height;let ae,fe=!1;for(let le=0;le<ee.length;le++){const re=ee.get(le),{numGlyphs:Ce,writingMode:we}=re;if(we!==u.WritingMode.vertical||fe||ae===u.WritingMode.horizontal||(fe=!0),ae=we,(re.hidden||we===u.WritingMode.vertical)&&!fe){Mr(Ce,Y);continue}fe=!1;const ve=new u.pointGeometry(re.tileAnchorX,re.tileAnchorY);let{x:nt,y:Ee,z:je}=D.projection.projectTilePoint(ve.x,ve.y,z.canonical);if(C){const[Pt,St,Ht]=C(ve);nt+=Pt,Ee+=St,je+=Ht}const De=[nt,Ee,je,1];if(u.transformMat4$1(De,De,r),!bn(De,X)){Mr(Ce,Y);continue}const Ze=ht(s.transform.cameraToCenterDistance,De[3]),Le=u.evaluateSizeForFeature(B,j,re),Ye=w?Le/Ze:Le*Ze,it=Or(nt,Ee,je,g);if(it[3]<=0){Mr(Ce,Y);continue}let be={};const Re=w?null:C,wt=nn(re,Ye,!1,E,r,g,y,h.glyphOffsetArray,q,Y,G,it,ve,be,Q,Re,D.projection,z,w);fe=wt.useVertical,Re&&wt.needsFlipping&&(be={}),(wt.notEnoughRoom||fe||wt.needsFlipping&&nn(re,Ye,!0,E,r,g,y,h.glyphOffsetArray,q,Y,G,it,ve,be,Q,Re,D.projection,z,w).notEnoughRoom)&&Mr(Ce,Y)}f?(h.text.dynamicLayoutVertexBuffer.updateData(Y),G&&h.text.globeExtVertexBuffer.updateData(G)):(h.icon.dynamicLayoutVertexBuffer.updateData(Y),G&&h.icon.globeExtVertexBuffer.updateData(G))}function Qr(h,r,s,f,g,y,w,E,C,z,D,B,j,W,X,Y){const{lineStartIndex:G,glyphStartIndex:q,segment:ee}=E,Q=q+E.numGlyphs,ae=G+E.lineLength,fe=r.getoffsetX(q),le=r.getoffsetX(Q-1),re=fo(h*fe,s,f,g,y,w,ee,G,ae,C,z,D,B,j,!0,W,X,Y);if(!re)return null;const Ce=fo(h*le,s,f,g,y,w,ee,G,ae,C,z,D,B,j,!0,W,X,Y);return Ce?{first:re,last:Ce}:null}function $r(h,r,s,f){return h===u.WritingMode.horizontal&&Math.abs(f)>Math.abs(s)?{useVertical:!0}:h===u.WritingMode.vertical?f>0?{needsFlipping:!0}:null:r!==0&&function(g,y){return g===0||Math.abs(y/g)>Ec}(s,f)?r===1?{needsFlipping:!0}:null:s<0?{needsFlipping:!0}:null}function nn(h,r,s,f,g,y,w,E,C,z,D,B,j,W,X,Y,G,q,ee){const Q=r/24,ae=h.lineOffsetX*Q,fe=h.lineOffsetY*Q,{lineStartIndex:le,glyphStartIndex:re,numGlyphs:Ce,segment:we,writingMode:ve,flipState:nt}=h,Ee=le+h.lineLength,je=De=>{if(D){const[it,be,Re]=De.up,wt=z.length;u.updateGlobeVertexNormal(D,wt+0,it,be,Re),u.updateGlobeVertexNormal(D,wt+1,it,be,Re),u.updateGlobeVertexNormal(D,wt+2,it,be,Re),u.updateGlobeVertexNormal(D,wt+3,it,be,Re)}const[Ze,Le,Ye]=De.point;u.addDynamicAttributes(z,Ze,Le,Ye,De.angle)};if(Ce>1){const De=Qr(Q,E,ae,fe,s,B,j,h,C,y,W,Y,!1,G,q,ee);if(!De)return{notEnoughRoom:!0};if(f&&!s){let[Ze,Le,Ye]=De.first.point,[it,be,Re]=De.last.point;[Ze,Le]=Or(Ze,Le,Ye,w),[it,be]=Or(it,be,Re,w);const wt=$r(ve,nt,(it-Ze)*X,be-Le);if(h.flipState=wt&&wt.needsFlipping?1:2,wt)return wt}je(De.first);for(let Ze=re+1;Ze<re+Ce-1;Ze++){const Le=fo(Q*E.getoffsetX(Ze),ae,fe,s,B,j,we,le,Ee,C,y,W,Y,!1,!1,G,q,ee);if(!Le)return z.length-=4*(Ze-re),{notEnoughRoom:!0};je(Le)}je(De.last)}else{if(f&&!s){const Ze=Or(j.x,j.y,0,g),Le=le+we+1,Ye=new u.pointGeometry(C.getx(Le),C.gety(Le)),it=Or(Ye.x,Ye.y,0,g),be=it[3]>0?it:ko(j,Ye,Ze,1,g,void 0,G,q.canonical),Re=$r(ve,nt,(be[0]-Ze[0])*X,be[1]-Ze[1]);if(h.flipState=Re&&Re.needsFlipping?1:2,Re)return Re}const De=fo(Q*E.getoffsetX(re),ae,fe,s,B,j,we,le,Ee,C,y,W,Y,!1,!1,G,q,ee);if(!De)return{notEnoughRoom:!0};je(De)}return{}}function ho(h,r,s,f,g){const{x:y,y:w,z:E}=f.projectTilePoint(h.x,h.y,r);if(!g)return Or(y,w,E,s);const[C,z,D]=g(h);return Or(y+C,w+z,E+D,s)}function ko(h,r,s,f,g,y,w,E){const C=ho(h.sub(r)._unit()._add(h),E,g,w,y);return u.sub(C,s,C),u.normalize(C,C),u.scaleAndAdd(C,s,C,f)}function fo(h,r,s,f,g,y,w,E,C,z,D,B,j,W,X,Y,G,q){const ee=f?h-r:h+r;let Q=ee>0?1:-1,ae=0;f&&(Q*=-1,ae=Math.PI),Q<0&&(ae+=Math.PI);let fe=E+w+(Q>0?0:1)|0,le=g,re=g,Ce=0,we=0;const ve=Math.abs(ee),nt=[],Ee=[];let je=y,De=je;const Ze=()=>ko(De,je,re,ve-Ce+1,D,j,Y,G.canonical);for(;Ce+we<=ve;){if(fe+=Q,fe<E||fe>=C)return null;if(re=le,De=je,nt.push(re),W&&Ee.push(De),je=new u.pointGeometry(z.getx(fe),z.gety(fe)),le=B[fe],!le){const Ht=ho(je,G.canonical,D,Y,j);le=Ht[3]>0?B[fe]=Ht:Ze()}Ce+=we,we=u.distance(re,le)}X&&j&&(B[fe]&&(le=Ze(),we=u.distance(re,le)),B[fe]=le);const Le=(ve-Ce)/we,Ye=je.sub(De)._mult(Le)._add(De),it=u.sub([],le,re),be=u.scaleAndAdd([],re,it,Le);let Re=[0,0,1],wt=it[0],Pt=it[1];if(q&&(Re=Y.upVector(G.canonical,Ye.x,Ye.y),Re[0]!==0||Re[1]!==0||Re[2]!==1)){const Ht=[Re[2],0,-Re[0]],fn=u.cross([],Re,Ht);u.normalize(Ht,Ht),u.normalize(fn,fn),wt=u.dot(it,Ht),Pt=u.dot(it,fn)}if(s){const Ht=u.cross([],Re,it);u.normalize(Ht,Ht),u.scaleAndAdd(be,be,Ht,s*Q)}const St=ae+Math.atan2(Pt,wt);return nt.push(be),W&&Ee.push(Ye),{point:be,angle:St,path:nt,tilePath:Ee,up:Re}}function Mr(h,r){const s=r.length,f=s+4*h;r.resize(f),r.float32.fill(-1/0,4*s,4*f)}function Si(h,r,s){const f=r[0],g=r[1];return h[0]=s[0]*f+s[4]*g+s[12],h[1]=s[1]*f+s[5]*g+s[13],h[3]=s[3]*f+s[7]*g+s[15],h}const po=100;class mo{constructor(r,s,f=new Ka(r.width+200,r.height+200,25),g=new Ka(r.width+200,r.height+200,25)){this.transform=r,this.grid=f,this.ignoredGrid=g,this.pitchfactor=Math.cos(r._pitch)*r.cameraToCenterDistance,this.screenRightBoundary=r.width+po,this.screenBottomBoundary=r.height+po,this.gridRightBoundary=r.width+200,this.gridBottomBoundary=r.height+200,this.fogState=s}placeCollisionBox(r,s,f,g,y,w,E,C){let z=f.projectedAnchorX,D=f.projectedAnchorY,B=f.projectedAnchorZ;const j=f.elevation,W=f.tileID,X=r.getProjection();if(j&&W){const[le,re,Ce]=X.upVector(W.canonical,f.tileAnchorX,f.tileAnchorY),we=X.upVectorScale(W.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;z+=le*j*we,D+=re*j*we,B+=Ce*j*we}const Y=this.projectAndGetPerspectiveRatio(E,z,D,B,f.tileID,X.name==="globe"||!!j||this.transform.pitch>0,X),G=w*Y.perspectiveRatio,q=(f.x1*s+g.x-f.padding)*G+Y.point.x,ee=(f.y1*s+g.y-f.padding)*G+Y.point.y,Q=(f.x2*s+g.x+f.padding)*G+Y.point.x,ae=(f.y2*s+g.y+f.padding)*G+Y.point.y,fe=Y.perspectiveRatio<=.55||Y.occluded;return!this.isInsideGrid(q,ee,Q,ae)||!y&&this.grid.hitTest(q,ee,Q,ae,C)||fe?{box:[],offscreen:!1,occluded:Y.occluded}:{box:[q,ee,Q,ae],offscreen:this.isOffscreen(q,ee,Q,ae),occluded:!1}}placeCollisionCircles(r,s,f,g,y,w,E,C,z,D,B,j,W,X,Y){const G=[],q=this.transform.elevation,ee=r.getProjection(),Q=q?q.getAtTileOffsetFunc(Y,this.transform.center.lat,this.transform.worldSize,ee):null,ae=new u.pointGeometry(f.tileAnchorX,f.tileAnchorY);let{x:fe,y:le,z:re}=ee.projectTilePoint(ae.x,ae.y,Y.canonical);if(Q){const[Ye,it,be]=Q(ae);fe+=Ye,le+=it,re+=be}const Ce=ee.name==="globe",we=this.projectAndGetPerspectiveRatio(E,fe,le,re,Y,Ce||!!q||this.transform.pitch>0,ee),{perspectiveRatio:ve}=we,nt=(B?w/ve:w*ve)/u.ONE_EM,Ee=Or(fe,le,re,C),je=we.signedDistanceFromCamera>0?Qr(nt,y,f.lineOffsetX*nt,f.lineOffsetY*nt,!1,Ee,ae,f,g,C,{},q&&!B?Q:null,B&&!!q,ee,Y,B):null;let De=!1,Ze=!1,Le=!0;if(je&&!we.occluded){const Ye=.5*W*ve+X,it=new u.pointGeometry(-100,-100),be=new u.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),Re=new Wi,{first:wt,last:Pt}=je,St=wt.path.length;let Ht=[];for(let yt=St-1;yt>=1;yt--)Ht.push(wt.path[yt]);for(let yt=1;yt<Pt.path.length;yt++)Ht.push(Pt.path[yt]);const fn=2.5*Ye;z&&(Ht=Ht.map(([yt,ei,Gn],_i)=>(Q&&!Ce&&(Gn=Q(_i<St-1?wt.tilePath[St-1-_i]:Pt.tilePath[_i-St+2])[2]),Or(yt,ei,Gn,z))),Ht.some(yt=>yt[3]<=0)&&(Ht=[]));let Bt=[];if(Ht.length>0){let yt=1/0,ei=-1/0,Gn=1/0,_i=-1/0;for(const hi of Ht)yt=Math.min(yt,hi[0]),Gn=Math.min(Gn,hi[1]),ei=Math.max(ei,hi[0]),_i=Math.max(_i,hi[1]);ei>=it.x&&yt<=be.x&&_i>=it.y&&Gn<=be.y&&(Bt=[Ht.map(hi=>new u.pointGeometry(hi[0],hi[1]))],(yt<it.x||ei>be.x||Gn<it.y||_i>be.y)&&(Bt=u.clipLine(Bt,it.x,it.y,be.x,be.y)))}for(const yt of Bt){Re.reset(yt,.25*Ye);let ei=0;ei=Re.length<=.5*Ye?1:Math.ceil(Re.paddedLength/fn)+1;for(let Gn=0;Gn<ei;Gn++){const _i=Gn/Math.max(ei-1,1),hi=Re.lerp(_i),Va=hi.x+po,Qa=hi.y+po;G.push(Va,Qa,Ye,0);const Ma=Va-Ye,hs=Qa-Ye,Mi=Va+Ye,yi=Qa+Ye;if(Le=Le&&this.isOffscreen(Ma,hs,Mi,yi),Ze=Ze||this.isInsideGrid(Ma,hs,Mi,yi),!s&&this.grid.hitTestCircle(Va,Qa,Ye,j)&&(De=!0,!D))return{circles:[],offscreen:!1,collisionDetected:De,occluded:!1}}}}return{circles:!D&&De||!Ze?[]:G,offscreen:Le,collisionDetected:De,occluded:we.occluded}}queryRenderedSymbols(r){if(r.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const s=[];let f=1/0,g=1/0,y=-1/0,w=-1/0;for(const D of r){const B=new u.pointGeometry(D.x+po,D.y+po);f=Math.min(f,B.x),g=Math.min(g,B.y),y=Math.max(y,B.x),w=Math.max(w,B.y),s.push(B)}const E=this.grid.query(f,g,y,w).concat(this.ignoredGrid.query(f,g,y,w)),C={},z={};for(const D of E){const B=D.key;if(C[B.bucketInstanceId]===void 0&&(C[B.bucketInstanceId]={}),C[B.bucketInstanceId][B.featureIndex])continue;const j=[new u.pointGeometry(D.x1,D.y1),new u.pointGeometry(D.x2,D.y1),new u.pointGeometry(D.x2,D.y2),new u.pointGeometry(D.x1,D.y2)];u.polygonIntersectsPolygon(s,j)&&(C[B.bucketInstanceId][B.featureIndex]=!0,z[B.bucketInstanceId]===void 0&&(z[B.bucketInstanceId]=[]),z[B.bucketInstanceId].push(B.featureIndex))}return z}insertCollisionBox(r,s,f,g,y){(s?this.ignoredGrid:this.grid).insert({bucketInstanceId:f,featureIndex:g,collisionGroupID:y},r[0],r[1],r[2],r[3])}insertCollisionCircles(r,s,f,g,y){const w=s?this.ignoredGrid:this.grid,E={bucketInstanceId:f,featureIndex:g,collisionGroupID:y};for(let C=0;C<r.length;C+=4)w.insertCircle(E,r[C],r[C+1],r[C+2])}projectAndGetPerspectiveRatio(r,s,f,g,y,w,E){const C=[s,f,g,1];let z=!1;if(g||this.transform.pitch>0){u.transformMat4$1(C,C,r);const B=E.name==="globe";this.fogState&&y&&!B&&(z=function(W,X,Y,G,q,ee){const Q=ee.calculateFogTileMatrix(q),ae=[X,Y,G];return u.transformMat4(ae,ae,Q),Xi(W,ae,ee.pitch,ee._fov)}(this.fogState,s,f,g,y.toUnwrapped(),this.transform)>.9)}else Si(C,C,r);const D=C[3];return{point:new u.pointGeometry((C[0]/D+1)/2*this.transform.width+po,(-C[1]/D+1)/2*this.transform.height+po),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(E)/D*.5,1.5),signedDistanceFromCamera:D,occluded:w&&C[2]>D||z}}isOffscreen(r,s,f,g){return f<po||r>=this.screenRightBoundary||g<po||s>this.screenBottomBoundary}isInsideGrid(r,s,f,g){return f>=0&&r<this.gridRightBoundary&&g>=0&&s<this.gridBottomBoundary}getViewportMatrix(){const r=u.identity([]);return u.translate(r,r,[-100,-100,0]),r}}function tl(h,r,s){const f=r.createTileMatrix(h,h.worldSize,s.toUnwrapped());return u.multiply(new Float32Array(16),h.projMatrix,f)}function Ds(h,r,s){if(r.projection.name===s.projection.name)return h.projMatrix;const f=s.clone();return f.setProjection(r.projection),tl(f,r.getProjection(),h)}function ts(h,r,s){return r.name===s.projection.name?h.projMatrix:tl(s,r,h)}class Su{constructor(r,s,f,g){this.opacity=r?Math.max(0,Math.min(1,r.opacity+(r.placed?s:-s))):g&&f?1:0,this.placed=f}isHidden(){return this.opacity===0&&!this.placed}}class Dn{constructor(r,s,f,g,y,w=!1){this.text=new Su(r?r.text:null,s,f,y),this.icon=new Su(r?r.icon:null,s,g,y),this.clipped=w}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class zs{constructor(r,s,f,g=!1){this.text=r,this.icon=s,this.skipFade=f,this.clipped=g}}class nl{constructor(){this.invProjMatrix=u.create(),this.viewportMatrix=u.create(),this.circles=[]}}class dn{constructor(r,s,f,g,y){this.bucketInstanceId=r,this.featureIndex=s,this.sourceLayerIndex=f,this.bucketIndex=g,this.tileID=y}}class ea{constructor(r){this.crossSourceCollisions=r,this.maxGroupID=0,this.collisionGroups={}}get(r){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[r]){const s=++this.maxGroupID;this.collisionGroups[r]={ID:s,predicate:f=>f.collisionGroupID===s}}return this.collisionGroups[r]}}function kn(h,r,s,f,g){const{horizontalAlign:y,verticalAlign:w}=u.getAnchorAlignment(h),E=-(y-.5)*r,C=-(w-.5)*s,z=u.evaluateVariableOffset(h,f);return new u.pointGeometry(E+z[0]*g,C+z[1]*g)}function Lo(h,r,s,f,g){const y=new u.pointGeometry(h,r);return s&&y._rotate(f?g:-g),y}class ns{constructor(r,s,f,g,y){this.transform=r.clone(),this.projection=r.projection.name,this.collisionIndex=new mo(this.transform,y),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=s,this.retainedQueryData={},this.collisionGroups=new ea(f),this.collisionCircleArrays={},this.prevPlacement=g,g&&(g.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(r,s,f,g){const y=f.getBucket(s),w=f.latestFeatureIndex;if(!y||!w||s.id!==y.layerIds[0])return;const E=y.layers[0].layout,C=f.collisionBoxArray,z=Math.pow(2,this.transform.zoom-f.tileID.overscaledZ),D=f.tileSize/u.EXTENT,B=f.tileID.toUnwrapped();this.transform.setProjection(y.projection);const j=(W=f.tileID,X=y.getProjection(),Y=this.transform,X.name===this.projection?Y.calculateProjMatrix(W.toUnwrapped()):tl(Y,X,W));var W,X,Y;const G=E.get("text-pitch-alignment")==="map",q=E.get("text-rotation-alignment")==="map";s.compileFilter();const ee=s.dynamicFilter(),Q=s.dynamicFilterNeedsFeature(),ae=this.transform.calculatePixelsToTileUnitsMatrix(f),fe=el(j,f.tileID.canonical,G,q,this.transform,y.getProjection(),ae);let le=null;if(G){const we=Eu(j,f.tileID.canonical,G,q,this.transform,y.getProjection(),ae);le=u.multiply([],this.transform.labelPlaneMatrix,we)}let re=null;ee&&f.latestFeatureIndex&&(re={unwrappedTileID:B,dynamicFilter:ee,dynamicFilterNeedsFeature:Q,featureIndex:f.latestFeatureIndex}),this.retainedQueryData[y.bucketInstanceId]=new dn(y.bucketInstanceId,w,y.sourceLayerIndex,y.index,f.tileID);const Ce={bucket:y,layout:E,posMatrix:j,textLabelPlaneMatrix:fe,labelToScreenMatrix:le,clippingData:re,scale:z,textPixelRatio:D,holdingForFade:f.holdingForFade(),collisionBoxArray:C,partiallyEvaluatedTextSize:u.evaluateSizeForZoom(y.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:u.evaluateSizeForZoom(y.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(y.sourceID)};if(g)for(const we of y.sortKeyRanges){const{sortKey:ve,symbolInstanceStart:nt,symbolInstanceEnd:Ee}=we;r.push({sortKey:ve,symbolInstanceStart:nt,symbolInstanceEnd:Ee,parameters:Ce})}else r.push({symbolInstanceStart:0,symbolInstanceEnd:y.symbolInstances.length,parameters:Ce})}attemptAnchorPlacement(r,s,f,g,y,w,E,C,z,D,B,j,W,X,Y,G,q,ee){const{textOffset0:Q,textOffset1:ae,crossTileID:fe}=j,le=[Q,ae],re=kn(r,f,g,le,y),Ce=this.collisionIndex.placeCollisionBox(X,y,s,Lo(re.x,re.y,w,E,this.transform.angle),B,C,z,D.predicate);if(G){const we=X.getSymbolInstanceIconSize(ee,this.transform.zoom,j.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(X,we,G,Lo(re.x,re.y,w,E,this.transform.angle),B,C,z,D.predicate).box.length===0)return}if(Ce.box.length>0){let we;return this.prevPlacement&&this.prevPlacement.variableOffsets[fe]&&this.prevPlacement.placements[fe]&&this.prevPlacement.placements[fe].text&&(we=this.prevPlacement.variableOffsets[fe].anchor),this.variableOffsets[fe]={textOffset:le,width:f,height:g,anchor:r,textScale:y,prevAnchor:we},this.markUsedJustification(X,r,j,Y),X.allowVerticalPlacement&&(this.markUsedOrientation(X,Y,j),this.placedOrientations[fe]=Y),{shift:re,placedGlyphBoxes:Ce}}}placeLayerBucketPart(r,s,f,g){const{bucket:y,layout:w,posMatrix:E,textLabelPlaneMatrix:C,labelToScreenMatrix:z,clippingData:D,textPixelRatio:B,holdingForFade:j,collisionBoxArray:W,partiallyEvaluatedTextSize:X,partiallyEvaluatedIconSize:Y,collisionGroup:G}=r.parameters,q=w.get("text-optional"),ee=w.get("icon-optional"),Q=w.get("text-allow-overlap"),ae=w.get("icon-allow-overlap"),fe=w.get("text-rotation-alignment")==="map",le=w.get("text-pitch-alignment")==="map",re=w.get("icon-text-fit")!=="none",Ce=w.get("symbol-z-order")==="viewport-y";this.transform.setProjection(y.projection);let we=Q&&(ae||!y.hasIconData()||ee),ve=ae&&(Q||!y.hasTextData()||q);!y.collisionArrays&&W&&y.deserializeCollisionBoxes(W),f&&g&&y.updateCollisionDebugBuffers(this.transform.zoom,W);const nt=(Ee,je,De)=>{const{crossTileID:Ze,numVerticalGlyphVertices:Le}=Ee;if(D){const Mi={zoom:this.transform.zoom,pitch:this.transform.pitch};let yi=null;if(D.dynamicFilterNeedsFeature){const Fn=this.retainedQueryData[y.bucketInstanceId];yi=D.featureIndex.loadFeature({featureIndex:Ee.featureIndex,bucketIndex:Fn.bucketIndex,sourceLayerIndex:Fn.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,D.dynamicFilter)(Mi,yi,this.retainedQueryData[y.bucketInstanceId].tileID.canonical,new u.pointGeometry(Ee.tileAnchorX,Ee.tileAnchorY),this.transform.calculateDistanceTileData(D.unwrappedTileID)))return this.placements[Ze]=new zs(!1,!1,!1,!0),void(s[Ze]=!0)}if(s[Ze])return;if(j)return void(this.placements[Ze]=new zs(!1,!1,!1));let Ye=!1,it=!1,be=!0,Re=!1,wt=!1,Pt=null,St={box:null,offscreen:null,occluded:null},Ht={box:null,offscreen:null,occluded:null},fn=null,Bt=null,yt=null,ei=0,Gn=0,_i=0;De.textFeatureIndex?ei=De.textFeatureIndex:Ee.useRuntimeCollisionCircles&&(ei=Ee.featureIndex),De.verticalTextFeatureIndex&&(Gn=De.verticalTextFeatureIndex);const hi=Mi=>{Mi.tileID=this.retainedQueryData[y.bucketInstanceId].tileID;const yi=this.transform.elevation;(yi||Mi.elevation)&&(Mi.elevation=yi?yi.getAtTileOffset(Mi.tileID,Mi.tileAnchorX,Mi.tileAnchorY):0)},Va=De.textBox;if(Va){hi(Va);const Mi=Fn=>{let hr=u.WritingMode.horizontal;if(y.allowVerticalPlacement&&!Fn&&this.prevPlacement){const Ta=this.prevPlacement.placedOrientations[Ze];Ta&&(this.placedOrientations[Ze]=Ta,hr=Ta,this.markUsedOrientation(y,hr,Ee))}return hr},yi=(Fn,hr)=>{if(y.allowVerticalPlacement&&Le>0&&De.verticalTextBox){for(const Ta of y.writingModes)if(Ta===u.WritingMode.vertical?(St=hr(),Ht=St):St=Fn(),St&&St.box&&St.box.length)break}else St=Fn()};if(w.get("text-variable-anchor")){let Fn=w.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Ze]){const di=this.prevPlacement.variableOffsets[Ze];Fn.indexOf(di.anchor)>0&&(Fn=Fn.filter(kt=>kt!==di.anchor),Fn.unshift(di.anchor))}const hr=(di,kt,Mn)=>{const Ln=y.getSymbolInstanceTextSize(X,Ee,this.transform.zoom,je),Wn=(di.x2-di.x1)*Ln+2*di.padding,vr=(di.y2-di.y1)*Ln+2*di.padding,Vo=re&&!ae?kt:null;Vo&&hi(Vo);let ds={box:[],offscreen:!1,occluded:!1};const Hc=Q?2*Fn.length:Fn.length;for(let Gu=0;Gu<Hc;++Gu){const wo=this.attemptAnchorPlacement(Fn[Gu%Fn.length],di,Wn,vr,Ln,fe,le,B,E,G,Gu>=Fn.length,Ee,je,y,Mn,Vo,X,Y);if(wo&&(ds=wo.placedGlyphBoxes,ds&&ds.box&&ds.box.length)){Ye=!0,Pt=wo.shift;break}}return ds};yi(()=>hr(Va,De.iconBox,u.WritingMode.horizontal),()=>{const di=De.verticalTextBox;return di&&hi(di),y.allowVerticalPlacement&&!(St&&St.box&&St.box.length)&&Le>0&&di?hr(di,De.verticalIconBox,u.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),St&&(Ye=St.box,be=St.offscreen,Re=St.occluded);const Ta=Mi(St&&St.box);if(!Ye&&this.prevPlacement){const di=this.prevPlacement.variableOffsets[Ze];di&&(this.variableOffsets[Ze]=di,this.markUsedJustification(y,di.anchor,Ee,Ta))}}else{const Fn=(hr,Ta)=>{const di=y.getSymbolInstanceTextSize(X,Ee,this.transform.zoom,je),kt=this.collisionIndex.placeCollisionBox(y,di,hr,new u.pointGeometry(0,0),Q,B,E,G.predicate);return kt&&kt.box&&kt.box.length&&(this.markUsedOrientation(y,Ta,Ee),this.placedOrientations[Ze]=Ta),kt};yi(()=>Fn(Va,u.WritingMode.horizontal),()=>{const hr=De.verticalTextBox;return y.allowVerticalPlacement&&Le>0&&hr?(hi(hr),Fn(hr,u.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),Mi(St&&St.box&&St.box.length)}}if(fn=St,Ye=fn&&fn.box&&fn.box.length>0,be=fn&&fn.offscreen,Re=fn&&fn.occluded,Ee.useRuntimeCollisionCircles){const Mi=y.text.placedSymbolArray.get(Ee.centerJustifiedTextSymbolIndex>=0?Ee.centerJustifiedTextSymbolIndex:Ee.verticalPlacedTextSymbolIndex),yi=u.evaluateSizeForFeature(y.textSizeData,X,Mi),Fn=w.get("text-padding");Bt=this.collisionIndex.placeCollisionCircles(y,Q,Mi,y.lineVertexArray,y.glyphOffsetArray,yi,E,C,z,f,le,G.predicate,Ee.collisionCircleDiameter*yi/u.ONE_EM,Fn,this.retainedQueryData[y.bucketInstanceId].tileID),Ye=Q||Bt.circles.length>0&&!Bt.collisionDetected,be=be&&Bt.offscreen,Re=Bt.occluded}if(De.iconFeatureIndex&&(_i=De.iconFeatureIndex),De.iconBox){const Mi=yi=>{hi(yi);const Fn=re&&Pt?Lo(Pt.x,Pt.y,fe,le,this.transform.angle):new u.pointGeometry(0,0),hr=y.getSymbolInstanceIconSize(Y,this.transform.zoom,Ee.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(y,hr,yi,Fn,ae,B,E,G.predicate)};Ht&&Ht.box&&Ht.box.length&&De.verticalIconBox?(yt=Mi(De.verticalIconBox),it=yt.box.length>0):(yt=Mi(De.iconBox),it=yt.box.length>0),be=be&&yt.offscreen,wt=yt.occluded}const Qa=q||Ee.numHorizontalGlyphVertices===0&&Le===0,Ma=ee||Ee.numIconVertices===0;if(Qa||Ma?Ma?Qa||(it=it&&Ye):Ye=it&&Ye:it=Ye=it&&Ye,Ye&&fn&&fn.box&&this.collisionIndex.insertCollisionBox(fn.box,w.get("text-ignore-placement"),y.bucketInstanceId,Ht&&Ht.box&&Gn?Gn:ei,G.ID),it&&yt&&this.collisionIndex.insertCollisionBox(yt.box,w.get("icon-ignore-placement"),y.bucketInstanceId,_i,G.ID),Bt&&(Ye&&this.collisionIndex.insertCollisionCircles(Bt.circles,w.get("text-ignore-placement"),y.bucketInstanceId,ei,G.ID),f)){const Mi=y.bucketInstanceId;let yi=this.collisionCircleArrays[Mi];yi===void 0&&(yi=this.collisionCircleArrays[Mi]=new nl);for(let Fn=0;Fn<Bt.circles.length;Fn+=4)yi.circles.push(Bt.circles[Fn+0]),yi.circles.push(Bt.circles[Fn+1]),yi.circles.push(Bt.circles[Fn+2]),yi.circles.push(Bt.collisionDetected?1:0)}const hs=y.projection.name!=="globe";we=we&&(hs||!Re),ve=ve&&(hs||!wt),this.placements[Ze]=new zs(Ye||we,it||ve,be||y.justReloaded),s[Ze]=!0};if(Ce){const Ee=y.getSortedSymbolIndexes(this.transform.angle);for(let je=Ee.length-1;je>=0;--je){const De=Ee[je];nt(y.symbolInstances.get(De),De,y.collisionArrays[De])}}else for(let Ee=r.symbolInstanceStart;Ee<r.symbolInstanceEnd;Ee++)nt(y.symbolInstances.get(Ee),Ee,y.collisionArrays[Ee]);if(f&&y.bucketInstanceId in this.collisionCircleArrays){const Ee=this.collisionCircleArrays[y.bucketInstanceId];u.invert(Ee.invProjMatrix,E),Ee.viewportMatrix=this.collisionIndex.getViewportMatrix()}y.justReloaded=!1}markUsedJustification(r,s,f,g){const{leftJustifiedTextSymbolIndex:y,centerJustifiedTextSymbolIndex:w,rightJustifiedTextSymbolIndex:E,verticalPlacedTextSymbolIndex:C,crossTileID:z}=f,D=u.getAnchorJustification(s),B=g===u.WritingMode.vertical?C:D==="left"?y:D==="center"?w:D==="right"?E:-1;y>=0&&(r.text.placedSymbolArray.get(y).crossTileID=B>=0&&y!==B?0:z),w>=0&&(r.text.placedSymbolArray.get(w).crossTileID=B>=0&&w!==B?0:z),E>=0&&(r.text.placedSymbolArray.get(E).crossTileID=B>=0&&E!==B?0:z),C>=0&&(r.text.placedSymbolArray.get(C).crossTileID=B>=0&&C!==B?0:z)}markUsedOrientation(r,s,f){const g=s===u.WritingMode.horizontal||s===u.WritingMode.horizontalOnly?s:0,y=s===u.WritingMode.vertical?s:0,{leftJustifiedTextSymbolIndex:w,centerJustifiedTextSymbolIndex:E,rightJustifiedTextSymbolIndex:C,verticalPlacedTextSymbolIndex:z}=f,D=r.text.placedSymbolArray;w>=0&&(D.get(w).placedOrientation=g),E>=0&&(D.get(E).placedOrientation=g),C>=0&&(D.get(C).placedOrientation=g),z>=0&&(D.get(z).placedOrientation=y)}commit(r){this.commitTime=r,this.zoomAtLastRecencyCheck=this.transform.zoom;const s=this.prevPlacement;let f=!1;this.prevZoomAdjustment=s?s.zoomAdjustment(this.transform.zoom):0;const g=s?s.symbolFadeChange(r):1,y=s?s.opacities:{},w=s?s.variableOffsets:{},E=s?s.placedOrientations:{};for(const C in this.placements){const z=this.placements[C],D=y[C];D?(this.opacities[C]=new Dn(D,g,z.text,z.icon,null,z.clipped),f=f||z.text!==D.text.placed||z.icon!==D.icon.placed):(this.opacities[C]=new Dn(null,g,z.text,z.icon,z.skipFade,z.clipped),f=f||z.text||z.icon)}for(const C in y){const z=y[C];if(!this.opacities[C]){const D=new Dn(z,g,!1,!1);D.isHidden()||(this.opacities[C]=D,f=f||z.text.placed||z.icon.placed)}}for(const C in w)this.variableOffsets[C]||!this.opacities[C]||this.opacities[C].isHidden()||(this.variableOffsets[C]=w[C]);for(const C in E)this.placedOrientations[C]||!this.opacities[C]||this.opacities[C].isHidden()||(this.placedOrientations[C]=E[C]);f?this.lastPlacementChangeTime=r:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=s?s.lastPlacementChangeTime:r)}updateLayerOpacities(r,s){const f={};for(const g of s){const y=g.getBucket(r);y&&g.latestFeatureIndex&&r.id===y.layerIds[0]&&this.updateBucketOpacities(y,f,g.collisionBoxArray)}}updateBucketOpacities(r,s,f){r.hasTextData()&&r.text.opacityVertexArray.clear(),r.hasIconData()&&r.icon.opacityVertexArray.clear(),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexArray.clear(),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexArray.clear();const g=r.layers[0].layout,y=!!r.layers[0].dynamicFilter(),w=new Dn(null,0,!1,!1,!0),E=g.get("text-allow-overlap"),C=g.get("icon-allow-overlap"),z=g.get("text-variable-anchor"),D=g.get("text-rotation-alignment")==="map",B=g.get("text-pitch-alignment")==="map",j=g.get("icon-text-fit")!=="none",W=new Dn(null,0,E&&(C||!r.hasIconData()||g.get("icon-optional")),C&&(E||!r.hasTextData()||g.get("text-optional")),!0);!r.collisionArrays&&f&&(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData())&&r.deserializeCollisionBoxes(f);const X=(G,q,ee)=>{for(let Q=0;Q<q/4;Q++)G.opacityVertexArray.emplaceBack(ee)};let Y=0;for(let G=0;G<r.symbolInstances.length;G++){const q=r.symbolInstances.get(G),{numHorizontalGlyphVertices:ee,numVerticalGlyphVertices:Q,crossTileID:ae,numIconVertices:fe}=q;let le=this.opacities[ae];s[ae]?le=w:le||(le=W,this.opacities[ae]=le),s[ae]=!0;const re=ee>0||Q>0,Ce=fe>0,we=this.placedOrientations[ae],ve=we===u.WritingMode.vertical,nt=we===u.WritingMode.horizontal||we===u.WritingMode.horizontalOnly;if(!re&&!Ce||le.isHidden()||Y++,re){const Ee=tr(le.text);X(r.text,ee,ve?_o:Ee),X(r.text,Q,nt?_o:Ee);const je=le.text.isHidden(),{leftJustifiedTextSymbolIndex:De,centerJustifiedTextSymbolIndex:Ze,rightJustifiedTextSymbolIndex:Le,verticalPlacedTextSymbolIndex:Ye}=q,it=r.text.placedSymbolArray,be=je||ve?1:0;De>=0&&(it.get(De).hidden=be),Ze>=0&&(it.get(Ze).hidden=be),Le>=0&&(it.get(Le).hidden=be),Ye>=0&&(it.get(Ye).hidden=je||nt?1:0);const Re=this.variableOffsets[ae];Re&&this.markUsedJustification(r,Re.anchor,q,we);const wt=this.placedOrientations[ae];wt&&(this.markUsedJustification(r,"left",q,wt),this.markUsedOrientation(r,wt,q))}if(Ce){const Ee=tr(le.icon),{placedIconSymbolIndex:je,verticalPlacedIconSymbolIndex:De}=q,Ze=r.icon.placedSymbolArray,Le=le.icon.isHidden()?1:0;je>=0&&(X(r.icon,fe,ve?_o:Ee),Ze.get(je).hidden=Le),De>=0&&(X(r.icon,q.numVerticalIconVertices,nt?_o:Ee),Ze.get(De).hidden=Le)}if(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData()){const Ee=r.collisionArrays[G];if(Ee){let je=new u.pointGeometry(0,0),De=!0;if(Ee.textBox||Ee.verticalTextBox){if(z){const Le=this.variableOffsets[ae];Le?(je=kn(Le.anchor,Le.width,Le.height,Le.textOffset,Le.textScale),D&&je._rotate(B?this.transform.angle:-this.transform.angle)):De=!1}y&&(De=!le.clipped),Ee.textBox&&Ar(r.textCollisionBox.collisionVertexArray,le.text.placed,!De||ve,je.x,je.y),Ee.verticalTextBox&&Ar(r.textCollisionBox.collisionVertexArray,le.text.placed,!De||nt,je.x,je.y)}const Ze=De&&Boolean(!nt&&Ee.verticalIconBox);Ee.iconBox&&Ar(r.iconCollisionBox.collisionVertexArray,le.icon.placed,Ze,j?je.x:0,j?je.y:0),Ee.verticalIconBox&&Ar(r.iconCollisionBox.collisionVertexArray,le.icon.placed,!Ze,j?je.x:0,j?je.y:0)}}}if(r.fullyClipped=Y===0,r.sortFeatures(this.transform.angle),this.retainedQueryData[r.bucketInstanceId]&&(this.retainedQueryData[r.bucketInstanceId].featureSortOrder=r.featureSortOrder),r.hasTextData()&&r.text.opacityVertexBuffer&&r.text.opacityVertexBuffer.updateData(r.text.opacityVertexArray),r.hasIconData()&&r.icon.opacityVertexBuffer&&r.icon.opacityVertexBuffer.updateData(r.icon.opacityVertexArray),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexBuffer&&r.iconCollisionBox.collisionVertexBuffer.updateData(r.iconCollisionBox.collisionVertexArray),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexBuffer&&r.textCollisionBox.collisionVertexBuffer.updateData(r.textCollisionBox.collisionVertexArray),r.bucketInstanceId in this.collisionCircleArrays){const G=this.collisionCircleArrays[r.bucketInstanceId];r.placementInvProjMatrix=G.invProjMatrix,r.placementViewportMatrix=G.viewportMatrix,r.collisionCircleArray=G.circles,delete this.collisionCircleArrays[r.bucketInstanceId]}}symbolFadeChange(r){return this.fadeDuration===0?1:(r-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(r){return Math.max(0,(this.transform.zoom-r)/1.5)}hasTransitions(r){return this.stale||r-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(r,s){const f=this.zoomAtLastRecencyCheck===s?1-this.zoomAdjustment(s):1;return this.zoomAtLastRecencyCheck=s,this.commitTime+this.fadeDuration*f>r}setStale(){this.stale=!0}}function Ar(h,r,s,f,g){h.emplaceBack(r?1:0,s?1:0,f||0,g||0),h.emplaceBack(r?1:0,s?1:0,f||0,g||0),h.emplaceBack(r?1:0,s?1:0,f||0,g||0),h.emplaceBack(r?1:0,s?1:0,f||0,g||0)}const Ci=Math.pow(2,25),Yi=Math.pow(2,24),Ll=Math.pow(2,17),oi=Math.pow(2,16),qr=Math.pow(2,9),go=Math.pow(2,8),Ol=Math.pow(2,1);function tr(h){if(h.opacity===0&&!h.placed)return 0;if(h.opacity===1&&h.placed)return 4294967295;const r=h.placed?1:0,s=Math.floor(127*h.opacity);return s*Ci+r*Yi+s*Ll+r*oi+s*qr+r*go+s*Ol+r}const _o=0;class Cu{constructor(r){this._sortAcrossTiles=r.layout.get("symbol-z-order")!=="viewport-y"&&r.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(r,s,f,g,y){const w=this._bucketParts;for(;this._currentTileIndex<r.length;)if(s.getBucketParts(w,g,r[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,y())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,w.sort((E,C)=>E.sortKey-C.sortKey));this._currentPartIndex<w.length;){const E=w[this._currentPartIndex];if(s.placeLayerBucketPart(E,this._seenCrossTileIDs,f,E.symbolInstanceStart===0),this._currentPartIndex++,y())return!0}return!1}}class va{constructor(r,s,f,g,y,w,E,C){this.placement=new ns(r,y,w,E,C),this._currentPlacementIndex=s.length-1,this._forceFullPlacement=f,this._showCollisionBoxes=g,this._done=!1}isDone(){return this._done}continuePlacement(r,s,f){const g=u.exported.now(),y=()=>{const w=u.exported.now()-g;return!this._forceFullPlacement&&w>2};for(;this._currentPlacementIndex>=0;){const w=s[r[this._currentPlacementIndex]],E=this.placement.collisionIndex.transform.zoom;if(w.type==="symbol"&&(!w.minzoom||w.minzoom<=E)&&(!w.maxzoom||w.maxzoom>E)){if(this._inProgressLayer||(this._inProgressLayer=new Cu(w)),this._inProgressLayer.continuePlacement(f[w.source],this.placement,this._showCollisionBoxes,w,y))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(r){return this.placement.commit(r),this.placement}}const il=512/u.EXTENT/2;class Mu{constructor(r,s,f){this.tileID=r,this.indexedSymbolInstances={},this.bucketInstanceId=f;for(let g=0;g<s.length;g++){const y=s.get(g),w=y.key;this.indexedSymbolInstances[w]||(this.indexedSymbolInstances[w]=[]),this.indexedSymbolInstances[w].push({crossTileID:y.crossTileID,coord:this.getScaledCoordinates(y,r)})}}getScaledCoordinates(r,s){const f=il/Math.pow(2,s.canonical.z-this.tileID.canonical.z);return{x:Math.floor((s.canonical.x*u.EXTENT+r.tileAnchorX)*f),y:Math.floor((s.canonical.y*u.EXTENT+r.tileAnchorY)*f)}}findMatches(r,s,f){const g=this.tileID.canonical.z<s.canonical.z?1:Math.pow(2,this.tileID.canonical.z-s.canonical.z);for(let y=0;y<r.length;y++){const w=r.get(y);if(w.crossTileID)continue;const E=this.indexedSymbolInstances[w.key];if(!E)continue;const C=this.getScaledCoordinates(w,s);for(const z of E)if(Math.abs(z.coord.x-C.x)<=g&&Math.abs(z.coord.y-C.y)<=g&&!f[z.crossTileID]){f[z.crossTileID]=!0,w.crossTileID=z.crossTileID;break}}}}class Is{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class rl{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(r){const s=Math.round((r-this.lng)/360);if(s!==0)for(const f in this.indexes){const g=this.indexes[f],y={};for(const w in g){const E=g[w];E.tileID=E.tileID.unwrapTo(E.tileID.wrap+s),y[E.tileID.key]=E}this.indexes[f]=y}this.lng=r}addBucket(r,s,f){if(this.indexes[r.overscaledZ]&&this.indexes[r.overscaledZ][r.key]){if(this.indexes[r.overscaledZ][r.key].bucketInstanceId===s.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(r.overscaledZ,this.indexes[r.overscaledZ][r.key])}for(let y=0;y<s.symbolInstances.length;y++)s.symbolInstances.get(y).crossTileID=0;this.usedCrossTileIDs[r.overscaledZ]||(this.usedCrossTileIDs[r.overscaledZ]={});const g=this.usedCrossTileIDs[r.overscaledZ];for(const y in this.indexes){const w=this.indexes[y];if(Number(y)>r.overscaledZ)for(const E in w){const C=w[E];C.tileID.isChildOf(r)&&C.findMatches(s.symbolInstances,r,g)}else{const E=w[r.scaledTo(Number(y)).key];E&&E.findMatches(s.symbolInstances,r,g)}}for(let y=0;y<s.symbolInstances.length;y++){const w=s.symbolInstances.get(y);w.crossTileID||(w.crossTileID=f.generate(),g[w.crossTileID]=!0)}return this.indexes[r.overscaledZ]===void 0&&(this.indexes[r.overscaledZ]={}),this.indexes[r.overscaledZ][r.key]=new Mu(r,s.symbolInstances,s.bucketInstanceId),!0}removeBucketCrossTileIDs(r,s){for(const f in s.indexedSymbolInstances)for(const g of s.indexedSymbolInstances[f])delete this.usedCrossTileIDs[r][g.crossTileID]}removeStaleBuckets(r){let s=!1;for(const f in this.indexes){const g=this.indexes[f];for(const y in g)r[g[y].bucketInstanceId]||(this.removeBucketCrossTileIDs(f,g[y]),delete g[y],s=!0)}return s}}class Na{constructor(){this.layerIndexes={},this.crossTileIDs=new Is,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(r,s,f,g){let y=this.layerIndexes[r.id];y===void 0&&(y=this.layerIndexes[r.id]=new rl);let w=!1;const E={};g.name!=="globe"&&y.handleWrapJump(f);for(const C of s){const z=C.getBucket(r);z&&r.id===z.layerIds[0]&&(z.bucketInstanceId||(z.bucketInstanceId=++this.maxBucketInstanceId),y.addBucket(C.tileID,z,this.crossTileIDs)&&(w=!0),E[z.bucketInstanceId]=!0)}return y.removeStaleBuckets(E)&&(w=!0),w}pruneUnusedLayers(r){const s={};r.forEach(f=>{s[f]=!0});for(const f in this.layerIndexes)s[f]||delete this.layerIndexes[f]}}const ks=(h,r)=>u.emitValidationErrors(h,r&&r.filter(s=>s.identifier!=="source.canvas")),Sc=u.pick(Rt,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),Ls=u.pick(Rt,["setCenter","setZoom","setBearing","setPitch"]),Oo={version:8,layers:[],sources:{}},Pl={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class U extends u.Evented{constructor(r,s={}){super(),this.map=r,this.dispatcher=new ar(Lt(),this),this.imageManager=new Ai,this.imageManager.setEventedParent(this),this.glyphManager=new u.GlyphManager(r._requestManager,s.localFontFamily?u.LocalGlyphMode.all:s.localIdeographFontFamily?u.LocalGlyphMode.ideographs:u.LocalGlyphMode.none,s.localFontFamily||s.localIdeographFontFamily),this.crossTileSymbolIndex=new Na,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",u.getReferrer());const f=this;this._rtlTextPluginCallback=U.registerForPluginStateChange(g=>{f.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:g.pluginStatus,pluginURL:g.pluginURL},(y,w)=>{if(u.triggerPluginCompletionEvent(y),w&&w.every(E=>E))for(const E in f._sourceCaches){const C=f._sourceCaches[E],z=C.getSource().type;z!=="vector"&&z!=="geojson"||C.reload()}})}),this.on("data",g=>{if(g.dataType!=="source"||g.sourceDataType!=="metadata")return;const y=this.getSource(g.sourceId);if(y&&y.vectorLayerIds)for(const w in this._layers){const E=this._layers[w];E.source===y.id&&this._validateLayer(E)}})}loadURL(r,s={}){this.fire(new u.Event("dataloading",{dataType:"style"}));const f=typeof s.validate=="boolean"?s.validate:!u.isMapboxURL(r);r=this.map._requestManager.normalizeStyleURL(r,s.accessToken);const g=this.map._requestManager.transformRequest(r,u.ResourceType.Style);this._request=u.getJSON(g,(y,w)=>{this._request=null,y?this.fire(new u.ErrorEvent(y)):w&&this._load(w,f)})}loadJSON(r,s={}){this.fire(new u.Event("dataloading",{dataType:"style"})),this._request=u.exported.frame(()=>{this._request=null,this._load(r,s.validate!==!1)})}loadEmpty(){this.fire(new u.Event("dataloading",{dataType:"style"})),this._load(Oo,!1)}_updateLayerCount(r,s){const f=s?1:-1;r.is3D()&&(this._num3DLayers+=f),r.type==="circle"&&(this._numCircleLayers+=f),r.type==="symbol"&&(this._numSymbolLayers+=f)}_load(r,s){if(s&&ks(this,u.validateStyle(r)))return;this._loaded=!0,this.stylesheet=u.clone$1(r),this._updateMapProjection();for(const g in r.sources)this.addSource(g,r.sources[g],{validate:!1});this._changed=!1,r.sprite?this._loadSprite(r.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(r.glyphs);const f=cn(this.stylesheet.layers);this._order=f.map(g=>g.id),this._layers={},this._serializedLayers={};for(let g of f)g=u.createStyleLayer(g),g.setEventedParent(this,{layer:{id:g.id}}),this._layers[g.id]=g,this._serializedLayers[g.id]=g.serialize(),this._updateLayerCount(g,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new On(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new u.Event("data",{dataType:"style"})),this.fire(new u.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(r){r?this.stylesheet.projection=r:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(r){this._spriteRequest=function(s,f,g){let y,w,E;const C=u.exported.devicePixelRatio>1?"@2x":"";let z=u.getJSON(f.transformRequest(f.normalizeSpriteURL(s,C,".json"),u.ResourceType.SpriteJSON),(j,W)=>{z=null,E||(E=j,y=W,B())}),D=u.getImage(f.transformRequest(f.normalizeSpriteURL(s,C,".png"),u.ResourceType.SpriteImage),(j,W)=>{D=null,E||(E=j,w=W,B())});function B(){if(E)g(E);else if(y&&w){const j=u.exported.getImageData(w),W={};for(const X in y){const{width:Y,height:G,x:q,y:ee,sdf:Q,pixelRatio:ae,stretchX:fe,stretchY:le,content:re}=y[X],Ce=new u.RGBAImage({width:Y,height:G});u.RGBAImage.copy(j,Ce,{x:q,y:ee},{x:0,y:0},{width:Y,height:G}),W[X]={data:Ce,pixelRatio:ae,sdf:Q,stretchX:fe,stretchY:le,content:re}}g(null,W)}}return{cancel(){z&&(z.cancel(),z=null),D&&(D.cancel(),D=null)}}}(r,this.map._requestManager,(s,f)=>{if(this._spriteRequest=null,s)this.fire(new u.ErrorEvent(s));else if(f)for(const g in f)this.imageManager.addImage(g,f[g]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new u.Event("data",{dataType:"style"}))})}_validateLayer(r){const s=this.getSource(r.source);if(!s)return;const f=r.sourceLayer;f&&(s.type==="geojson"||s.vectorLayerIds&&s.vectorLayerIds.indexOf(f)===-1)&&this.fire(new u.ErrorEvent(new Error(`Source layer "${f}" does not exist on source "${s.id}" as specified by style layer "${r.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const r in this._sourceCaches)if(!this._sourceCaches[r].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(r){const s=[];for(const f of r){const g=this._layers[f];g.type!=="custom"&&s.push(g.serialize())}return s}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const r in this._sourceCaches)if(this._sourceCaches[r].hasTransition())return!0;for(const r in this._layers)if(this._layers[r].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(r){return!!this.terrain&&Pl[r.type]}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(r){if(!this._loaded)return;const s=this._changed;if(this._changed){const g=Object.keys(this._updatedLayers),y=Object.keys(this._removedLayers);(g.length||y.length)&&this._updateWorkerLayers(g,y);for(const w in this._updatedSources){const E=this._updatedSources[w];E==="reload"?this._reloadSource(w):E==="clear"&&this._clearSource(w)}this._updateTilesForChangedImages();for(const w in this._updatedPaintProps)this._layers[w].updateTransitions(r);this.light.updateTransitions(r),this.fog&&this.fog.updateTransitions(r),this._resetUpdates()}const f={};for(const g in this._sourceCaches){const y=this._sourceCaches[g];f[g]=y.used,y.used=!1}for(const g of this._order){const y=this._layers[g];if(y.recalculate(r,this._availableImages),!y.isHidden(r.zoom)){const E=this._getLayerSourceCache(y);E&&(E.used=!0)}const w=this.map.painter;if(w){const E=y.getProgramIds();if(!E)continue;const C=y.getProgramConfiguration(r.zoom);for(const z of E)w.useProgram(z,C)}}for(const g in f){const y=this._sourceCaches[g];f[g]!==y.used&&y.getSource().fire(new u.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:y.getSource().id}))}this.light.recalculate(r),this.terrain&&this.terrain.recalculate(r),this.fog&&this.fog.recalculate(r),this.z=r.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),s&&this.fire(new u.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const r=Object.keys(this._changedImages);if(r.length){for(const s in this._sourceCaches)this._sourceCaches[s].reloadTilesForDependencies(["icons","patterns"],r);this._changedImages={}}}_updateWorkerLayers(r,s){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(r),removedIds:s})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(r){if(this._checkLoaded(),ks(this,u.validateStyle(r)))return!1;(r=u.clone$1(r)).layers=cn(r.layers);const s=function(g,y){if(!g)return[{command:Rt.setStyle,args:[y]}];let w=[];try{if(!Oe(g.version,y.version))return[{command:Rt.setStyle,args:[y]}];Oe(g.center,y.center)||w.push({command:Rt.setCenter,args:[y.center]}),Oe(g.zoom,y.zoom)||w.push({command:Rt.setZoom,args:[y.zoom]}),Oe(g.bearing,y.bearing)||w.push({command:Rt.setBearing,args:[y.bearing]}),Oe(g.pitch,y.pitch)||w.push({command:Rt.setPitch,args:[y.pitch]}),Oe(g.sprite,y.sprite)||w.push({command:Rt.setSprite,args:[y.sprite]}),Oe(g.glyphs,y.glyphs)||w.push({command:Rt.setGlyphs,args:[y.glyphs]}),Oe(g.transition,y.transition)||w.push({command:Rt.setTransition,args:[y.transition]}),Oe(g.light,y.light)||w.push({command:Rt.setLight,args:[y.light]}),Oe(g.fog,y.fog)||w.push({command:Rt.setFog,args:[y.fog]}),Oe(g.projection,y.projection)||w.push({command:Rt.setProjection,args:[y.projection]});const E={},C=[];(function(B,j,W,X){let Y;for(Y in j=j||{},B=B||{})B.hasOwnProperty(Y)&&(j.hasOwnProperty(Y)||ui(Y,W,X));for(Y in j)j.hasOwnProperty(Y)&&(B.hasOwnProperty(Y)?Oe(B[Y],j[Y])||(B[Y].type==="geojson"&&j[Y].type==="geojson"&&_a(B,j,Y)?W.push({command:Rt.setGeoJSONSourceData,args:[Y,j[Y].data]}):co(Y,j,W,X)):ai(Y,j,W))})(g.sources,y.sources,C,E);const z=[];g.layers&&g.layers.forEach(B=>{B.source&&E[B.source]?w.push({command:Rt.removeLayer,args:[B.id]}):z.push(B)});let D=g.terrain;D&&E[D.source]&&(w.push({command:Rt.setTerrain,args:[void 0]}),D=void 0),w=w.concat(C),Oe(D,y.terrain)||w.push({command:Rt.setTerrain,args:[y.terrain]}),function(B,j,W){j=j||[];const X=(B=B||[]).map(Ne),Y=j.map(Ne),G=B.reduce(ya,{}),q=j.reduce(ya,{}),ee=X.slice(),Q=Object.create(null);let ae,fe,le,re,Ce,we,ve;for(ae=0,fe=0;ae<X.length;ae++)le=X[ae],q.hasOwnProperty(le)?fe++:(W.push({command:Rt.removeLayer,args:[le]}),ee.splice(ee.indexOf(le,fe),1));for(ae=0,fe=0;ae<Y.length;ae++)le=Y[Y.length-1-ae],ee[ee.length-1-ae]!==le&&(G.hasOwnProperty(le)?(W.push({command:Rt.removeLayer,args:[le]}),ee.splice(ee.lastIndexOf(le,ee.length-fe),1)):fe++,we=ee[ee.length-ae],W.push({command:Rt.addLayer,args:[q[le],we]}),ee.splice(ee.length-ae,0,le),Q[le]=!0);for(ae=0;ae<Y.length;ae++)if(le=Y[ae],re=G[le],Ce=q[le],!Q[le]&&!Oe(re,Ce))if(Oe(re.source,Ce.source)&&Oe(re["source-layer"],Ce["source-layer"])&&Oe(re.type,Ce.type)){for(ve in an(re.layout,Ce.layout,W,le,null,Rt.setLayoutProperty),an(re.paint,Ce.paint,W,le,null,Rt.setPaintProperty),Oe(re.filter,Ce.filter)||W.push({command:Rt.setFilter,args:[le,Ce.filter]}),Oe(re.minzoom,Ce.minzoom)&&Oe(re.maxzoom,Ce.maxzoom)||W.push({command:Rt.setLayerZoomRange,args:[le,Ce.minzoom,Ce.maxzoom]}),re)re.hasOwnProperty(ve)&&ve!=="layout"&&ve!=="paint"&&ve!=="filter"&&ve!=="metadata"&&ve!=="minzoom"&&ve!=="maxzoom"&&(ve.indexOf("paint.")===0?an(re[ve],Ce[ve],W,le,ve.slice(6),Rt.setPaintProperty):Oe(re[ve],Ce[ve])||W.push({command:Rt.setLayerProperty,args:[le,ve,Ce[ve]]}));for(ve in Ce)Ce.hasOwnProperty(ve)&&!re.hasOwnProperty(ve)&&ve!=="layout"&&ve!=="paint"&&ve!=="filter"&&ve!=="metadata"&&ve!=="minzoom"&&ve!=="maxzoom"&&(ve.indexOf("paint.")===0?an(re[ve],Ce[ve],W,le,ve.slice(6),Rt.setPaintProperty):Oe(re[ve],Ce[ve])||W.push({command:Rt.setLayerProperty,args:[le,ve,Ce[ve]]}))}else W.push({command:Rt.removeLayer,args:[le]}),we=ee[ee.lastIndexOf(le)+1],W.push({command:Rt.addLayer,args:[Ce,we]})}(z,y.layers,w)}catch(E){console.warn("Unable to compute style diff:",E),w=[{command:Rt.setStyle,args:[y]}]}return w}(this.serialize(),r).filter(g=>!(g.command in Ls));if(s.length===0)return!1;const f=s.filter(g=>!(g.command in Sc));if(f.length>0)throw new Error(`Unimplemented: ${f.map(g=>g.command).join(", ")}.`);return s.forEach(g=>{g.command!=="setTransition"&&g.command!=="setProjection"&&this[g.command].apply(this,g.args)}),this.stylesheet=r,this._updateMapProjection(),!0}addImage(r,s){return this.getImage(r)?this.fire(new u.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(r,s),this._afterImageUpdated(r),this)}updateImage(r,s){this.imageManager.updateImage(r,s)}getImage(r){return this.imageManager.getImage(r)}removeImage(r){return this.getImage(r)?(this.imageManager.removeImage(r),this._afterImageUpdated(r),this):this.fire(new u.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(r){this._availableImages=this.imageManager.listImages(),this._changedImages[r]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new u.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(r,s,f={}){if(this._checkLoaded(),this.getSource(r)!==void 0)throw new Error("There is already a source with this ID");if(!s.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(s).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(s.type)>=0&&this._validate(u.validateSource,`sources.${r}`,s,null,f))return;this.map&&this.map._collectResourceTiming&&(s.collectResourceTiming=!0);const g=pe(r,s,this.dispatcher,this);g.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(r),source:g.serialize(),sourceId:r}));const y=w=>{const E=(w?"symbol:":"other:")+r,C=this._sourceCaches[E]=new u.SourceCache(E,g,w);(w?this._symbolSourceCaches:this._otherSourceCaches)[r]=C,C.style=this,C.onAdd(this.map)};y(!1),s.type!=="vector"&&s.type!=="geojson"||y(!0),g.onAdd&&g.onAdd(this.map),this._changed=!0}removeSource(r){this._checkLoaded();const s=this.getSource(r);if(!s)throw new Error("There is no source with this ID");for(const g in this._layers)if(this._layers[g].source===r)return this.fire(new u.ErrorEvent(new Error(`Source "${r}" cannot be removed while layer "${g}" is using it.`)));if(this.terrain&&this.terrain.get().source===r)return this.fire(new u.ErrorEvent(new Error(`Source "${r}" cannot be removed while terrain is using it.`)));const f=this._getSourceCaches(r);for(const g of f)delete this._sourceCaches[g.id],delete this._updatedSources[g.id],g.fire(new u.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:g.getSource().id})),g.setEventedParent(null),g.clearTiles();return delete this._otherSourceCaches[r],delete this._symbolSourceCaches[r],s.setEventedParent(null),s.onRemove&&s.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(r,s){this._checkLoaded(),this.getSource(r).setData(s),this._changed=!0}getSource(r){const s=this._getSourceCache(r);return s&&s.getSource()}_getSources(){const r=[];for(const s in this._otherSourceCaches){const f=this._getSourceCache(s);f&&r.push(f.getSource())}return r}addLayer(r,s,f={}){this._checkLoaded();const g=r.id;if(this.getLayer(g))return void this.fire(new u.ErrorEvent(new Error(`Layer with id "${g}" already exists on this map`)));let y;if(r.type==="custom"){if(ks(this,u.validateCustomStyleLayer(r)))return;y=u.createStyleLayer(r)}else{if(typeof r.source=="object"&&(this.addSource(g,r.source),r=u.clone$1(r),r=u.extend(r,{source:g})),this._validate(u.validateLayer,`layers.${g}`,r,{arrayIndex:-1},f))return;y=u.createStyleLayer(r),this._validateLayer(y),y.setEventedParent(this,{layer:{id:g}}),this._serializedLayers[y.id]=y.serialize(),this._updateLayerCount(y,!0)}const w=s?this._order.indexOf(s):this._order.length;if(s&&w===-1)return void this.fire(new u.ErrorEvent(new Error(`Layer with id "${s}" does not exist on this map.`)));this._order.splice(w,0,g),this._layerOrderChanged=!0,this._layers[g]=y;const E=this._getLayerSourceCache(y);if(this._removedLayers[g]&&y.source&&E&&y.type!=="custom"){const C=this._removedLayers[g];delete this._removedLayers[g],C.type!==y.type?this._updatedSources[y.source]="clear":(this._updatedSources[y.source]="reload",E.pause())}this._updateLayer(y),y.onAdd&&y.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(r,s){if(this._checkLoaded(),this._changed=!0,!this._layers[r])return void this.fire(new u.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be moved.`)));if(r===s)return;const f=this._order.indexOf(r);this._order.splice(f,1);const g=s?this._order.indexOf(s):this._order.length;s&&g===-1?this.fire(new u.ErrorEvent(new Error(`Layer with id "${s}" does not exist on this map.`))):(this._order.splice(g,0,r),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(r){this._checkLoaded();const s=this._layers[r];if(!s)return void this.fire(new u.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be removed.`)));s.setEventedParent(null),this._updateLayerCount(s,!1);const f=this._order.indexOf(r);this._order.splice(f,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[r]=s,delete this._layers[r],delete this._serializedLayers[r],delete this._updatedLayers[r],delete this._updatedPaintProps[r],s.onRemove&&s.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(r){return this._layers[r]}hasLayer(r){return r in this._layers}hasLayerType(r){for(const s in this._layers)if(this._layers[s].type===r)return!0;return!1}setLayerZoomRange(r,s,f){this._checkLoaded();const g=this.getLayer(r);g?g.minzoom===s&&g.maxzoom===f||(s!=null&&(g.minzoom=s),f!=null&&(g.maxzoom=f),this._updateLayer(g)):this.fire(new u.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(r,s,f={}){this._checkLoaded();const g=this.getLayer(r);if(g){if(!Oe(g.filter,s))return s==null?(g.filter=void 0,void this._updateLayer(g)):void(this._validate(u.validateFilter,`layers.${g.id}.filter`,s,{layerType:g.type},f)||(g.filter=u.clone$1(s),this._updateLayer(g)))}else this.fire(new u.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be filtered.`)))}getFilter(r){const s=this.getLayer(r);return s&&u.clone$1(s.filter)}setLayoutProperty(r,s,f,g={}){this._checkLoaded();const y=this.getLayer(r);y?Oe(y.getLayoutProperty(s),f)||(y.setLayoutProperty(s,f,g),this._updateLayer(y)):this.fire(new u.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(r,s){const f=this.getLayer(r);if(f)return f.getLayoutProperty(s);this.fire(new u.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style.`)))}setPaintProperty(r,s,f,g={}){this._checkLoaded();const y=this.getLayer(r);y?Oe(y.getPaintProperty(s),f)||(y.setPaintProperty(s,f,g)&&this._updateLayer(y),this._changed=!0,this._updatedPaintProps[r]=!0):this.fire(new u.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(r,s){const f=this.getLayer(r);return f&&f.getPaintProperty(s)}setFeatureState(r,s){this._checkLoaded();const f=r.source,g=r.sourceLayer,y=this.getSource(f);if(!y)return void this.fire(new u.ErrorEvent(new Error(`The source '${f}' does not exist in the map's style.`)));const w=y.type;if(w==="geojson"&&g)return void this.fire(new u.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(w==="vector"&&!g)return void this.fire(new u.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));r.id===void 0&&this.fire(new u.ErrorEvent(new Error("The feature id parameter must be provided.")));const E=this._getSourceCaches(f);for(const C of E)C.setFeatureState(g,r.id,s)}removeFeatureState(r,s){this._checkLoaded();const f=r.source,g=this.getSource(f);if(!g)return void this.fire(new u.ErrorEvent(new Error(`The source '${f}' does not exist in the map's style.`)));const y=g.type,w=y==="vector"?r.sourceLayer:void 0;if(y==="vector"&&!w)return void this.fire(new u.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(s&&typeof r.id!="string"&&typeof r.id!="number")return void this.fire(new u.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const E=this._getSourceCaches(f);for(const C of E)C.removeFeatureState(w,r.id,s)}getFeatureState(r){this._checkLoaded();const s=r.source,f=r.sourceLayer,g=this.getSource(s);if(g){if(g.type!=="vector"||f)return r.id===void 0&&this.fire(new u.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(s)[0].getFeatureState(f,r.id);this.fire(new u.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new u.ErrorEvent(new Error(`The source '${s}' does not exist in the map's style.`)))}getTransition(){return u.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const r={};for(const s in this._sourceCaches){const f=this._sourceCaches[s].getSource();r[f.id]||(r[f.id]=f.serialize())}return u.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:r,layers:this._serializeLayers(this._order)},s=>s!==void 0)}_updateLayer(r){this._updatedLayers[r.id]=!0;const s=this._getLayerSourceCache(r);r.source&&!this._updatedSources[r.source]&&s&&s.getSource().type!=="raster"&&(this._updatedSources[r.source]="reload",s.pause()),this._changed=!0,r.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(r){const s=w=>this._layers[w].type==="fill-extrusion",f={},g=[];for(let w=this._order.length-1;w>=0;w--){const E=this._order[w];if(s(E)){f[E]=w;for(const C of r){const z=C[E];if(z)for(const D of z)g.push(D)}}}g.sort((w,E)=>E.intersectionZ-w.intersectionZ);const y=[];for(let w=this._order.length-1;w>=0;w--){const E=this._order[w];if(s(E))for(let C=g.length-1;C>=0;C--){const z=g[C].feature;if(f[z.layer.id]<w)break;y.push(z),g.pop()}else for(const C of r){const z=C[E];if(z)for(const D of z)y.push(D.feature)}}return y}queryRenderedFeatures(r,s,f){s&&s.filter&&this._validate(u.validateFilter,"queryRenderedFeatures.filter",s.filter,null,s);const g={};if(s&&s.layers){if(!Array.isArray(s.layers))return this.fire(new u.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const C of s.layers){const z=this._layers[C];if(!z)return this.fire(new u.ErrorEvent(new Error(`The layer '${C}' does not exist in the map's style and cannot be queried for features.`))),[];g[z.source]=!0}}const y=[];s.availableImages=this._availableImages;const w=s&&s.layers?s.layers.some(C=>{const z=this.getLayer(C);return z&&z.is3D()}):this.has3DLayers(),E=da.createFromScreenPoints(r,f);for(const C in this._sourceCaches){const z=this._sourceCaches[C].getSource().id;s.layers&&!g[z]||y.push(_e(this._sourceCaches[C],this._layers,this._serializedLayers,E,s,f,w,!!this.map._showQueryGeometry))}return this.placement&&y.push(function(C,z,D,B,j,W,X){const Y={},G=W.queryRenderedSymbols(B),q=[];for(const ee of Object.keys(G).map(Number))q.push(X[ee]);q.sort(We);for(const ee of q){const Q=ee.featureIndex.lookupSymbolFeatures(G[ee.bucketInstanceId],z,ee.bucketIndex,ee.sourceLayerIndex,j.filter,j.layers,j.availableImages,C);for(const ae in Q){const fe=Y[ae]=Y[ae]||[],le=Q[ae];le.sort((re,Ce)=>{const we=ee.featureSortOrder;if(we){const ve=we.indexOf(re.featureIndex);return we.indexOf(Ce.featureIndex)-ve}return Ce.featureIndex-re.featureIndex});for(const re of le)fe.push(re)}}for(const ee in Y)Y[ee].forEach(Q=>{const ae=Q.feature,fe=D(C[ee]).getFeatureState(ae.layer["source-layer"],ae.id);ae.source=ae.layer.source,ae.layer["source-layer"]&&(ae.sourceLayer=ae.layer["source-layer"]),ae.state=fe});return Y}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),E.screenGeometry,s,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(y)}querySourceFeatures(r,s){s&&s.filter&&this._validate(u.validateFilter,"querySourceFeatures.filter",s.filter,null,s);const f=this._getSourceCaches(r);let g=[];for(const y of f)g=g.concat(Te(y,s));return g}addSourceType(r,s,f){return U.getSourceType(r)?f(new Error(`A source type called "${r}" already exists.`)):(U.setSourceType(r,s),s.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:r,url:s.workerSourceURL},f):f(null,null))}getLight(){return this.light.getLight()}setLight(r,s={}){this._checkLoaded();const f=this.light.getLight();let g=!1;for(const w in r)if(!Oe(r[w],f[w])){g=!0;break}if(!g)return;const y=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(r,s),this.light.updateTransitions(y)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(r,s=1){if(this._checkLoaded(),!r)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if(s===1){if(typeof r.source=="object"){const f="terrain-dem-src";this.addSource(f,r.source),r=u.clone$1(r),r=u.extend(r,{source:f})}if(this._validate(u.validateTerrain,"terrain",r))return}if(!this.terrain||this.terrain&&s!==this.terrain.drapeRenderMode)this._createTerrain(r,s);else{const f=this.terrain,g=f.get();for(const y of Object.keys(u.spec.terrain))!r.hasOwnProperty(y)&&u.spec.terrain[y].default&&(r[y]=u.spec.terrain[y].default);for(const y in r)if(!Oe(r[y],g[y])){f.set(r),this.stylesheet.terrain=r;const w=this._setTransitionParameters({duration:0});f.updateTransitions(w);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(r){const s=this.fog=new rr(r,this.map.transform);this.stylesheet.fog=r;const f=this._setTransitionParameters({duration:0});s.updateTransitions(f)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const r of this.map._markers)r._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(r){if(this._checkLoaded(),!r)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const s=this.fog,f=s.get();Object.keys(r).length===0&&s.set(r);for(const g in r)if(!Oe(r[g],f[g])){s.set(r),this.stylesheet.fog=r;const y=this._setTransitionParameters({duration:0});s.updateTransitions(y);break}}else this._createFog(r);this._markersNeedUpdate=!0}_setTransitionParameters(r){return{now:u.exported.now(),transition:u.extend(r,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const r=this._order.filter(f=>this.isLayerDraped(this._layers[f])),s=this._order.filter(f=>!this.isLayerDraped(this._layers[f]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...r),this._drapedFirstOrder.push(...s)}_createTerrain(r,s){const f=this.terrain=new rn(r,s);this.stylesheet.terrain=r,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const g=this._setTransitionParameters({duration:0});f.updateTransitions(g)}_force3DLayerUpdate(){for(const r in this._layers){const s=this._layers[r];s.type==="fill-extrusion"&&this._updateLayer(s)}}_forceSymbolLayerUpdate(){for(const r in this._layers){const s=this._layers[r];s.type==="symbol"&&this._updateLayer(s)}}_validate(r,s,f,g,y={}){return(!y||y.validate!==!1)&&ks(this,r.call(u.validateStyle,u.extend({key:s,style:this.serialize(),value:f,styleSpec:u.spec},g)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),u.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const r in this._layers)this._layers[r].setEventedParent(null);for(const r in this._sourceCaches)this._sourceCaches[r].clearTiles(),this._sourceCaches[r].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(r){const s=this._getSourceCaches(r);for(const f of s)f.clearTiles()}_reloadSource(r){const s=this._getSourceCaches(r);for(const f of s)f.resume(),f.reload()}_reloadSources(){for(const r of this._getSources())r.reload&&r.reload()}_updateSources(r){for(const s in this._sourceCaches)this._sourceCaches[s].update(r)}_generateCollisionBoxes(){for(const r in this._sourceCaches){const s=this._sourceCaches[r];s.resume(),s.reload()}}_updatePlacement(r,s,f,g,y=!1){let w=!1,E=!1;const C={};for(const z of this._order){const D=this._layers[z];if(D.type!=="symbol")continue;if(!C[D.source]){const j=this._getLayerSourceCache(D);if(!j)continue;C[D.source]=j.getRenderableIds(!0).map(W=>j.getTileByID(W)).sort((W,X)=>X.tileID.overscaledZ-W.tileID.overscaledZ||(W.tileID.isLessThan(X.tileID)?-1:1))}const B=this.crossTileSymbolIndex.addLayer(D,C[D.source],r.center.lng,r.projection);w=w||B}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),y=y||this._layerOrderChanged||f===0,this._layerOrderChanged&&this.fire(new u.Event("neworder")),(y||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(u.exported.now(),r.zoom))&&(this.pauseablePlacement=new va(r,this._order,y,s,f,g,this.placement,this.fog&&r.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,C),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(u.exported.now()),E=!0),w&&this.pauseablePlacement.placement.setStale()),E||w)for(const z of this._order){const D=this._layers[z];D.type==="symbol"&&this.placement.updateLayerOpacities(D,C[D.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(u.exported.now())}_releaseSymbolFadeTiles(){for(const r in this._sourceCaches)this._sourceCaches[r].releaseSymbolFadeTiles()}getImages(r,s,f){this.imageManager.getImages(s.icons,f),this._updateTilesForChangedImages();const g=y=>{y&&y.setDependencies(s.tileID.key,s.type,s.icons)};g(this._otherSourceCaches[s.source]),g(this._symbolSourceCaches[s.source])}getGlyphs(r,s,f){this.glyphManager.getGlyphs(s.stacks,f)}getResource(r,s,f){return u.makeRequest(s,f)}_getSourceCache(r){return this._otherSourceCaches[r]}_getLayerSourceCache(r){return r.type==="symbol"?this._symbolSourceCaches[r.source]:this._otherSourceCaches[r.source]}_getSourceCaches(r){const s=[];return this._otherSourceCaches[r]&&s.push(this._otherSourceCaches[r]),this._symbolSourceCaches[r]&&s.push(this._symbolSourceCaches[r]),s}_isSourceCacheLoaded(r){const s=this._getSourceCaches(r);return s.length===0?(this.fire(new u.ErrorEvent(new Error(`There is no source with ID '${r}'`))),!1):s.every(f=>f.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}U.getSourceType=function(h){return se[h]},U.setSourceType=function(h,r){se[h]=r},U.registerForPluginStateChange=u.registerForPluginStateChange;var ge=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0`,Pe="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",He=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,dt=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,Xt=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`;let Ot={},tn={};const Cn=[];Ii(ge,Cn),Ii(He,Cn),Ii(dt,Cn),Ii(Xt,Cn),Ot=It("",He),tn=It(Xt,dt);const si=It(`
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}`,`
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),zi=ge,ci=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var Bi={background:It(`uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
varying vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform vec4 u_color;varying vec4 v_color;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(u_color);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:It(`uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:It(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:It("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:It(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:It(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:It("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:It("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:It("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:It(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:It(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:It(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:It(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:It(`varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
vec3 normal=v_normal;
#endif
float z;vec4 color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);
#else
color=v_color;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;
#endif
#ifdef RENDER_SHADOWS
#ifdef ZERO_ROOF_RADIUS
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#endif
color.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
v_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(color,NdotL);
#else
v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_color*=u_opacity;
#ifdef ZERO_ROOF_RADIUS
v_roof_color=vec4(0.0,0.0,0.0,1.0);
#ifdef LIGHTING_3D_MODE
v_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));
#else
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:It(`uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
varying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,v_NdotL)*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_NdotL=NdotL;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:It(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:It(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
gl_FragColor=apply_lighting(gl_FragColor);
#endif
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:It(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
uniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture2D(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
#ifdef RENDER_LINE_BORDER
float edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);
#ifdef RENDER_LINE_BORDER_AUTO
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}
#else
out_color.rgb=mix(u_border_color.rgb,out_color.rgb,smoothAlpha);
#endif
}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:It(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:It(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:It(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:It(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:It(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:It(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef RENDER_SHADOWS
color.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
const float skirtOffset=24575.0;const float wireframeOffset=0.00015;void main() {v_pos0=a_texture_pos/8192.0;float skirt=float(a_pos.x >=skirtOffset);float elevation=elevation(a_texture_pos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=u_skirt_height*u_skirt_height*wireframeOffset;
#endif
vec2 decodedPos=a_pos-vec2(skirt*skirtOffset,0.0);gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:It(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying float v_depth;void main() {float elevation=elevation(a_texture_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:It(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Pe),skyboxGradient:It(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Pe),skyboxCapture:It(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:It(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);
#else
color=texture2D(u_image0,v_pos0);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 latLng=u_grid_matrix*vec3(a_pos,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;
#ifdef GLOBE_POLES
vec3 up_vector=normalize(globe_pos)*u_tile_up_scale;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
globe_pos+=up_vector*height;
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:It(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:
(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:
uv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`)};function Ii(h,r){const s=h.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let f of s)if(f=f.trim(),f[0]==="#"&&f.includes("if")&&!f.includes("endif")){f=f.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const g=f.split(" ");for(const y of g)r.includes(y)||r.push(y)}}function It(h,r){const s=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,f=r.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),g={},y=[...Cn];return Ii(h,y),Ii(r,y),{fragmentSource:h=h.replace(s,(w,E,C,z,D)=>(g[D]=!0,E==="define"?`
#ifndef HAS_UNIFORM_u_${D}
varying ${C} ${z} ${D};
#else
uniform ${C} ${z} u_${D};
#endif
`:`
#ifdef HAS_UNIFORM_u_${D}
    ${C} ${z} ${D} = u_${D};
#endif
`)),vertexSource:r=r.replace(s,(w,E,C,z,D)=>{const B=z==="float"?"vec2":"vec4",j=D.match(/color/)?"color":B;return g[D]?E==="define"?`
#ifndef HAS_UNIFORM_u_${D}
uniform lowp float u_${D}_t;
attribute ${C} ${B} a_${D};
varying ${C} ${z} ${D};
#else
uniform ${C} ${z} u_${D};
#endif
`:j==="vec4"?`
#ifndef HAS_UNIFORM_u_${D}
    ${D} = a_${D};
#else
    ${C} ${z} ${D} = u_${D};
#endif
`:`
#ifndef HAS_UNIFORM_u_${D}
    ${D} = unpack_mix_${j}(a_${D}, u_${D}_t);
#else
    ${C} ${z} ${D} = u_${D};
#endif
`:E==="define"?`
#ifndef HAS_UNIFORM_u_${D}
uniform lowp float u_${D}_t;
attribute ${C} ${B} a_${D};
#else
uniform ${C} ${z} u_${D};
#endif
`:j==="vec4"?`
#ifndef HAS_UNIFORM_u_${D}
    ${C} ${z} ${D} = a_${D};
#else
    ${C} ${z} ${D} = u_${D};
#endif
`:`
#ifndef HAS_UNIFORM_u_${D}
    ${C} ${z} ${D} = unpack_mix_${j}(a_${D}, u_${D}_t);
#else
    ${C} ${z} ${D} = u_${D};
#endif
`}),staticAttributes:f,usedDefines:y}}class Os{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(r,s,f,g,y,w,E){this.context=r;let C=this.boundPaintVertexBuffers.length!==g.length;for(let D=0;!C&&D<g.length;D++)this.boundPaintVertexBuffers[D]!==g[D]&&(C=!0);let z=this.boundDynamicVertexBuffers.length!==E.length;for(let D=0;!z&&D<E.length;D++)this.boundDynamicVertexBuffers[D]!==E[D]&&(z=!0);if(!r.extVertexArrayObject||!this.vao||this.boundProgram!==s||this.boundLayoutVertexBuffer!==f||C||z||this.boundIndexBuffer!==y||this.boundVertexOffset!==w)this.freshBind(s,f,g,y,w,E);else{r.bindVertexArrayOES.set(this.vao);for(const D of E)D&&D.bind();y&&y.dynamicDraw&&y.bind()}}freshBind(r,s,f,g,y,w){let E;const C=r.numAttributes,z=this.context,D=z.gl;if(z.extVertexArrayObject)this.vao&&this.destroy(),this.vao=z.extVertexArrayObject.createVertexArrayOES(),z.bindVertexArrayOES.set(this.vao),E=0,this.boundProgram=r,this.boundLayoutVertexBuffer=s,this.boundPaintVertexBuffers=f,this.boundIndexBuffer=g,this.boundVertexOffset=y,this.boundDynamicVertexBuffers=w;else{E=z.currentNumAttributes||0;for(let B=C;B<E;B++)D.disableVertexAttribArray(B)}s.enableAttributes(D,r),s.bind(),s.setVertexAttribPointers(D,r,y);for(const B of f)B.enableAttributes(D,r),B.bind(),B.setVertexAttribPointers(D,r,y);for(const B of w)B&&(B.enableAttributes(D,r),B.bind(),B.setVertexAttribPointers(D,r,y));g&&g.bind(),z.currentNumAttributes=C}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function is(h,r){const s=Math.pow(2,r.canonical.z),f=r.canonical.y;return[new u.MercatorCoordinate(0,f/s).toLngLat().lat,new u.MercatorCoordinate(0,(f+1)/s).toLngLat().lat]}function Bl(h,r,s,f,g,y,w){const E=h.context,C=E.gl,z=s.fbo;if(!z)return;h.prepareDrawTile();const D=h.useProgram("hillshade");E.activeTexture.set(C.TEXTURE0),C.bindTexture(C.TEXTURE_2D,z.colorAttachment.get());const B=((Y,G,q,ee)=>{const Q=q.paint.get("hillshade-shadow-color"),ae=q.paint.get("hillshade-highlight-color"),fe=q.paint.get("hillshade-accent-color");let le=q.paint.get("hillshade-illumination-direction")*(Math.PI/180);q.paint.get("hillshade-illumination-anchor")==="viewport"&&(le-=Y.transform.angle);const re=!Y.options.moving;return{u_matrix:ee||Y.transform.calculateProjMatrix(G.tileID.toUnwrapped(),re),u_image:0,u_latrange:is(0,G.tileID),u_light:[q.paint.get("hillshade-exaggeration"),le],u_shadow:Q,u_highlight:ae,u_accent:fe}})(h,s,f,h.terrain?r.projMatrix:null);h.prepareDrawProgram(E,D,r.toUnwrapped());const{tileBoundsBuffer:j,tileBoundsIndexBuffer:W,tileBoundsSegments:X}=h.getTileBoundsBuffers(s);D.draw(E,C.TRIANGLES,g,y,w,u.CullFaceMode.disabled,B,f.id,j,W,X)}function al(h,r,s){if(!r.needsDEMTextureUpload)return;const f=h.context,g=f.gl;f.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||h.getTileTexture(s.stride);const y=s.getPixels();r.demTexture?r.demTexture.update(y,{premultiply:!1}):r.demTexture=new u.Texture(f,y,g.RGBA,{premultiply:!1}),r.needsDEMTextureUpload=!1}function yo(h,r,s,f,g,y){const w=h.context,E=w.gl;if(!r.dem)return;const C=r.dem;if(w.activeTexture.set(E.TEXTURE1),al(h,r,C),!r.demTexture)return;r.demTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE);const z=C.dim;w.activeTexture.set(E.TEXTURE0);let D=r.fbo;if(!D){const X=new u.Texture(w,{width:z,height:z,data:null},E.RGBA);X.bind(E.LINEAR,E.CLAMP_TO_EDGE),D=r.fbo=w.createFramebuffer(z,z,!0),D.colorAttachment.set(X.texture)}w.bindFramebuffer.set(D.framebuffer),w.viewport.set([0,0,z,z]);const{tileBoundsBuffer:B,tileBoundsIndexBuffer:j,tileBoundsSegments:W}=h.getMercatorTileBoundsBuffers();h.useProgram("hillshadePrepare").draw(w,E.TRIANGLES,f,g,y,u.CullFaceMode.disabled,((X,Y)=>{const G=Y.stride,q=u.create();return u.ortho(q,0,u.EXTENT,-u.EXTENT,0,0,1),u.translate(q,q,[0,-u.EXTENT,0]),{u_matrix:q,u_image:1,u_dimension:[G,G],u_zoom:X.overscaledZ,u_unpack:Y.unpackVector}})(r.tileID,C),s.id,B,j,W),r.needsHillshadePrepare=!1}const Ps=h=>({u_matrix:new u.UniformMatrix4f(h),u_image0:new u.Uniform1i(h),u_skirt_height:new u.Uniform1f(h)}),ol=(h,r)=>({u_matrix:h,u_image0:0,u_skirt_height:r}),Cc=(h,r,s,f,g,y,w,E,C,z,D,B,j,W)=>({u_proj_matrix:Float32Array.from(h),u_globe_matrix:r,u_normalize_matrix:Float32Array.from(f),u_merc_matrix:s,u_zoom_transition:g,u_merc_center:y,u_image0:0,u_frustum_tl:w,u_frustum_tr:E,u_frustum_br:C,u_frustum_bl:z,u_globe_pos:D,u_globe_radius:B,u_viewport:j,u_grid_matrix:W?Float32Array.from(W):new Float32Array(9)});function Sh(h,r){return h!=null&&r!=null&&!(!h.hasData()||!r.hasData())&&h.demTexture!=null&&r.demTexture!=null&&h.tileID.key!==r.tileID.key}const Fl=new class{constructor(){this.operations={}}newMorphing(h,r,s,f,g){if(h in this.operations){const y=this.operations[h];y.to.tileID.key!==s.tileID.key&&(y.queued=s)}else this.operations[h]={startTime:f,phase:0,duration:g,from:r,to:s,queued:null}}getMorphValuesForProxy(h){if(!(h in this.operations))return null;const r=this.operations[h];return{from:r.from,to:r.to,phase:r.phase}}update(h){for(const r in this.operations){const s=this.operations[r];for(s.phase=(h-s.startTime)/s.duration;s.phase>=1||!this._validOp(s);)if(!this._nextOp(s,h)){delete this.operations[r];break}}}_nextOp(h,r){return!!h.queued&&(h.from=h.to,h.to=h.queued,h.queued=null,h.phase=0,h.startTime=r,!0)}_validOp(h){return h.from.hasData()&&h.to.hasData()}},Ul={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Au(h,r){const s=1<<h.z;return!r&&(h.x===0||h.x===s-1)||h.y===0||h.y===s-1}const Ru=h=>({u_matrix:h});function Mc(h,r,s,f,g){if(g>0){const y=u.exported.now(),w=(y-h.timeAdded)/g,E=r?(y-r.timeAdded)/g:-1,C=s.getSource(),z=f.coveringZoomLevel({tileSize:C.tileSize,roundZoom:C.roundZoom}),D=!r||Math.abs(r.tileID.overscaledZ-z)>Math.abs(h.tileID.overscaledZ-z),B=D&&h.refreshedUponExpiration?1:u.clamp(D?w:1-E,0,1);return h.refreshedUponExpiration&&w>=1&&(h.refreshedUponExpiration=!1),r?{opacity:1,mix:1-B}:{opacity:B,mix:0}}return{opacity:1,mix:0}}class Bn extends u.SourceCache{constructor(r){const s={type:"raster-dem",maxzoom:r.transform.maxZoom},f=new ar(Lt(),null),g=pe("mock-dem",s,f,r.style);super("mock-dem",g,!1),g.setEventedParent(this),this._sourceLoaded=!0}_loadTile(r,s){r.state="loaded",s(null)}}class Ch extends u.SourceCache{constructor(r){const s=pe("proxy",{type:"geojson",maxzoom:r.transform.maxZoom},new ar(Lt(),null),r.style);super("proxy",s,!1),s.setEventedParent(this),this.map=this.getSource().map=r,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(r,s,f){if(r.freezeTileCoverage)return;this.transform=r;const g=r.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((y,w)=>{if(y[w.key]="",!this._tiles[w.key]){const E=new u.Tile(w,this._source.tileSize*w.overscaleFactor(),r.tileZoom);E.state="loaded",this._tiles[w.key]=E}return y},{});for(const y in this._tiles)y in g||(this.freeFBO(y),this._tiles[y].unloadVectorData(),delete this._tiles[y])}freeFBO(r){const s=this.proxyCachedFBO[r];if(s!==void 0){const f=Object.values(s);this.renderCachePool.push(...f),delete this.proxyCachedFBO[r]}}deallocRenderCache(){this.renderCache.forEach(r=>r.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Po extends u.OverscaledTileID{constructor(r,s,f){super(r.overscaledZ,r.wrap,r.canonical.z,r.canonical.x,r.canonical.y),this.proxyTileKey=s,this.projMatrix=f}}class np extends u.Elevation{constructor(r,s){super(),this.painter=r,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[f,g,y]=function(C){const z=new u.StructArrayLayout4i8,D=new u.StructArrayLayout3ui6,B=131;z.reserve(17161),D.reserve(33800);const j=u.EXTENT/128,W=u.EXTENT+j/2,X=W+j;for(let G=-j;G<X;G+=j)for(let q=-j;q<X;q+=j){const ee=q<0||q>W||G<0||G>W?24575:0,Q=u.clamp(Math.round(q),0,u.EXTENT),ae=u.clamp(Math.round(G),0,u.EXTENT);z.emplaceBack(Q+ee,ae,Q,ae)}const Y=(G,q)=>{const ee=q*B+G;D.emplaceBack(ee+1,ee,ee+B),D.emplaceBack(ee+B,ee+B+1,ee+1)};for(let G=1;G<129;G++)for(let q=1;q<129;q++)Y(q,G);return[0,129].forEach(G=>{for(let q=0;q<130;q++)Y(q,G),Y(G,q)}),[z,D,32768]}(),w=r.context;this.gridBuffer=w.createVertexBuffer(f,u.boundsAttributes.members),this.gridIndexBuffer=w.createIndexBuffer(g),this.gridSegments=u.SegmentVector.simpleSegment(0,0,f.length,g.length),this.gridNoSkirtSegments=u.SegmentVector.simpleSegment(0,0,f.length,y),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Ch(s.map),this.orthoMatrix=u.create(),u.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,u.EXTENT,0,u.EXTENT,0,1);const E=w.gl;this._overlapStencilMode=new u.StencilMode({func:E.GEQUAL,mask:255},0,255,E.KEEP,E.KEEP,E.REPLACE),this._previousZoom=r.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=s,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Bn(s.map)}set style(r){r.on("data",this._onStyleDataEvent.bind(this)),r.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=r,this._checkRenderCacheEfficiency()}update(r,s,f){if(r&&r.terrain){this._style!==r&&(this.style=r),this.enabled=!0;const g=r.terrain.properties;this.sourceCache=r.terrain.drapeRenderMode===0?this._mockSourceCache:r._getSourceCache(g.get("source")),this._exaggeration=g.get("exaggeration");const y=()=>{this.sourceCache.used&&u.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const w=this.getScaledDemTileSize();this.sourceCache.update(s,w,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,y(),this._initializing=!0),y(),s.updateElevation(!0,f),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(s),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(r){this._findCoveringTileCache[r]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const r=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||r.efficiency!==100&&u.warnOnce(`Terrain render cache efficiency is not optimal (${r.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${r.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(r){r.coord&&r.dataType==="source"?this._clearRenderCacheForTile(r.sourceCacheId,r.coord):r.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const r in this._style._sourceCaches)this._style._sourceCaches[r].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(r=>r.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const r=2*this.proxySourceCache.getSource().tileSize;return[r,r]}set useVertexMorphing(r){this._useVertexMorphing=r}updateTileBinding(r){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const s=this.proxySourceCache,f=this.painter.transform;this._initializing&&(this._initializing=f._centerAltitude===0&&this.getAtPointOrZero(u.MercatorCoordinate.fromLngLat(f.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const g=this.proxyCoords=s.getIds().map(C=>{const z=s.getTileByID(C).tileID;return z.projMatrix=f.calculateProjMatrix(z.toUnwrapped()),z});(function(C,z){const D=z.transform.pointCoordinate(z.transform.getCameraPoint()),B=new u.pointGeometry(D.x,D.y);C.sort((j,W)=>{if(W.overscaledZ-j.overscaledZ)return W.overscaledZ-j.overscaledZ;const X=new u.pointGeometry(j.canonical.x+(1<<j.canonical.z)*j.wrap,j.canonical.y),Y=new u.pointGeometry(W.canonical.x+(1<<W.canonical.z)*W.wrap,W.canonical.y),G=B.mult(1<<j.canonical.z);return G.x-=.5,G.y-=.5,G.distSqr(X)-G.distSqr(Y)})})(g,this.painter),this._previousZoom=f.zoom;const y=this.proxyToSource||{};this.proxyToSource={},g.forEach(C=>{this.proxyToSource[C.key]={}}),this.terrainTileForTile={};const w=this._style._sourceCaches;for(const C in w){const z=w[C];if(!z.used||(z!==this.sourceCache&&this.resetTileLookupCache(z.id),this._setupProxiedCoordsForOrtho(z,r[C],y),z.usedForTerrain))continue;const D=r[C];z.getSource().reparseOverscaled&&this._assignTerrainTiles(D)}this.proxiedCoords[s.id]=g.map(C=>new Po(C,C.key,this.orthoMatrix)),this._assignTerrainTiles(g),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(y),this.renderingToTexture=!1,this._updateTimestamp=u.exported.now();const E={};this._visibleDemTiles=[];for(const C of this.proxyCoords){const z=this.terrainTileForTile[C.key];if(!z)continue;const D=z.tileID.key;D in E||(this._visibleDemTiles.push(z),E[D]=D)}}_assignTerrainTiles(r){this._initializing||r.forEach(s=>{if(this.terrainTileForTile[s.key])return;const f=this._findTileCoveringTileID(s,this.sourceCache);f&&(this.terrainTileForTile[s.key]=f)})}_prepareDEMTextures(){const r=this.painter.context,s=r.gl;for(const f in this.terrainTileForTile){const g=this.terrainTileForTile[f],y=g.dem;!y||g.demTexture&&!g.needsDEMTextureUpload||(r.activeTexture.set(s.TEXTURE1),al(this.painter,g,y))}}_prepareDemTileUniforms(r,s,f,g){if(!s||s.demTexture==null)return!1;const y=r.tileID.canonical,w=Math.pow(2,s.tileID.canonical.z-y.z),E=g||"";return f[`u_dem_tl${E}`]=[y.x*w%1,y.y*w%1],f[`u_dem_scale${E}`]=w,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const r=this.painter.context,s=r.gl;if(!this._emptyDepthBufferTexture){const f=new u.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new u.Texture(r,f,s.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let r=0;const s=this._visibleDemTiles.reduce((f,g)=>{if(!g.dem)return f;const y=g.dem.tree.minimums[0];return y>0&&r++,f+y},0);return r?s/r:0}_updateEmptyDEMTexture(){const r=this.painter.context,s=r.gl;r.activeTexture.set(s.TEXTURE2);const f=this._getLoadedAreaMinimum(),g=new u.RGBAImage({width:1,height:1},new Uint8Array(u.DEMData.pack(f,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let y=this._emptyDEMTexture;return y?y.update(g,{premultiply:!1}):y=this._emptyDEMTexture=new u.Texture(r,g,s.RGBA,{premultiply:!1}),y}setupElevationDraw(r,s,f){const g=this.painter.context,y=g.gl,w=(E=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:u.DEMData.getUnpackVector(E),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var E;w.u_dem_size=this.sourceCache.getSource().tileSize,w.u_exaggeration=this.exaggeration();let C=null,z=null,D=1;if(f&&f.morphing&&this._useVertexMorphing){const B=f.morphing.srcDemTile,j=f.morphing.dstDemTile;D=f.morphing.phase,B&&j&&(this._prepareDemTileUniforms(r,B,w,"_prev")&&(z=B),this._prepareDemTileUniforms(r,j,w)&&(C=j))}if(z&&C?(g.activeTexture.set(y.TEXTURE2),C.demTexture.bind(y.NEAREST,y.CLAMP_TO_EDGE,y.NEAREST),g.activeTexture.set(y.TEXTURE4),z.demTexture.bind(y.NEAREST,y.CLAMP_TO_EDGE,y.NEAREST),w.u_dem_lerp=D):(C=this.terrainTileForTile[r.tileID.key],g.activeTexture.set(y.TEXTURE2),(this._prepareDemTileUniforms(r,C,w)?C.demTexture:this.emptyDEMTexture).bind(y.NEAREST,y.CLAMP_TO_EDGE)),g.activeTexture.set(y.TEXTURE3),f&&f.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(y.NEAREST,y.CLAMP_TO_EDGE),this._depthFBO&&(w.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(y.NEAREST,y.CLAMP_TO_EDGE),w.u_depth_size_inv=[1,1]),f&&f.useMeterToDem&&C){const B=(1<<C.tileID.canonical.z)*u.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;w.u_meter_to_dem=B}if(f&&f.labelPlaneMatrixInv&&(w.u_label_plane_matrix_inv=f.labelPlaneMatrixInv),s.setTerrainUniformValues(g,w),this.painter.transform.projection.name==="globe"){const B=this.globeUniformValues(this.painter.transform,r.tileID.canonical,f&&f.useDenormalizedUpVectorScale);s.setGlobeUniformValues(g,B)}}globeUniformValues(r,s,f){const g=r.projection;return{u_tile_tl_up:g.upVector(s,0,0),u_tile_tr_up:g.upVector(s,u.EXTENT,0),u_tile_br_up:g.upVector(s,u.EXTENT,u.EXTENT),u_tile_bl_up:g.upVector(s,0,u.EXTENT),u_tile_up_scale:f?u.GLOBE_METERS_TO_ECEF:g.upVectorScale(s,r.center.lat,r.worldSize).metersToTile}}renderToBackBuffer(r){const s=this.painter,f=this.painter.context;r.length!==0&&(f.bindFramebuffer.set(null),f.viewport.set([0,0,s.width,s.height]),s.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(g,y,w,E,C){if(g.transform.projection.name==="globe")(function(z,D,B,j,W){const X=z.context,Y=X.gl;let G,q;const ee=z.options.showTerrainWireframe?2:0,Q=z.transform,ae=u.globeUseCustomAntiAliasing(z,X,Q),fe=(Ze,Le)=>{if(q===Ze)return;const Ye=[Ul[Ze],"PROJECTION_GLOBE_VIEW"];ae&&Ye.push("CUSTOM_ANTIALIASING"),Le&&Ye.push(Ul[ee]),G=z.useProgram("globeRaster",null,Ye),q=Ze},le=z.colorModeForRenderPass(),re=new u.DepthMode(Y.LEQUAL,u.DepthMode.ReadWrite,z.depthRangeFor3D);Fl.update(W);const Ce=u.calculateGlobeMercatorMatrix(Q),we=[u.mercatorXfromLng(Q.center.lng),u.mercatorYfromLat(Q.center.lat)],ve=ee?[!1,!0]:[!1],nt=z.globeSharedBuffers,Ee=[Q.width*u.exported.devicePixelRatio,Q.height*u.exported.devicePixelRatio],je=Float32Array.from(Q.globeMatrix),De={useDenormalizedUpVectorScale:!0};if(ve.forEach(Ze=>{q=-1;const Le=Ze?Y.LINES:Y.TRIANGLES;for(const Ye of j){const it=B.getTile(Ye),be=u.StencilMode.disabled,Re=D.prevTerrainTileForTile[Ye.key],wt=D.terrainTileForTile[Ye.key];Sh(Re,wt)&&Fl.newMorphing(Ye.key,Re,wt,W,250),X.activeTexture.set(Y.TEXTURE0),it.texture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE);const Pt=Fl.getMorphValuesForProxy(Ye.key),St=Pt?1:0;Pt&&u.extend$1(De,{morphing:{srcDemTile:Pt.from,dstDemTile:Pt.to,phase:u.easeCubicInOut(Pt.phase)}});const Ht=u.tileCornersToBounds(Ye.canonical),fn=u.getLatitudinalLod(Ht.getCenter().lat),Bt=u.getGridMatrix(Ye.canonical,Ht,fn,Q.worldSize/Q._pixelsPerMercatorPixel),yt=u.globeNormalizeECEF(u.globeTileBounds(Ye.canonical)),ei=Cc(Q.projMatrix,je,Ce,yt,u.globeToMercatorTransition(Q.zoom),we,Q.frustumCorners.TL,Q.frustumCorners.TR,Q.frustumCorners.BR,Q.frustumCorners.BL,Q.globeCenterInViewSpace,Q.globeRadius,Ee,Bt);if(fe(St,Ze),D.setupElevationDraw(it,G,De),z.prepareDrawProgram(X,G,Ye.toUnwrapped()),nt){const[Gn,_i,hi]=Ze?nt.getWirefameBuffers(z.context,fn):nt.getGridBuffers(fn);G.draw(X,Le,re,be,le,u.CullFaceMode.backCCW,ei,"globe_raster",Gn,_i,hi)}}}),nt){const Ze=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];ae&&Ze.push("CUSTOM_ANTIALIASING"),G=z.useProgram("globeRaster",null,Ze);for(const Le of j){const{x:Ye,y:it,z:be}=Le.canonical,Re=it===0,wt=it===(1<<be)-1,[Pt,St,Ht,fn]=nt.getPoleBuffers(be);if(fn&&(Re||wt)){const Bt=B.getTile(Le);X.activeTexture.set(Y.TEXTURE0),Bt.texture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE);let yt=u.globePoleMatrixForTile(be,Ye,Q);const ei=u.globeNormalizeECEF(u.globeTileBounds(Le.canonical)),Gn=(_i,hi)=>_i.draw(X,Y.TRIANGLES,re,u.StencilMode.disabled,le,u.CullFaceMode.disabled,Cc(Q.projMatrix,yt,yt,ei,0,we,Q.frustumCorners.TL,Q.frustumCorners.TR,Q.frustumCorners.BR,Q.frustumCorners.BL,Q.globeCenterInViewSpace,Q.globeRadius,Ee),"globe_pole_raster",hi,Ht,fn);D.setupElevationDraw(Bt,G,De),z.prepareDrawProgram(X,G,Le.toUnwrapped()),Re&&Gn(G,Pt),wt&&(yt=u.scale(u.create(),yt,[1,-1,1]),Gn(G,St))}}}})(g,y,w,E,C);else{const z=g.context,D=z.gl;let B,j;const W=g.options.showTerrainWireframe?2:0,X=(Q,ae)=>{if(j===Q)return;const fe=[Ul[Q]];ae&&fe.push(Ul[W]),B=g.useProgram("terrainRaster",null,fe),j=Q},Y=g.colorModeForRenderPass(),G=new u.DepthMode(D.LEQUAL,u.DepthMode.ReadWrite,g.depthRangeFor3D);Fl.update(C);const q=g.transform,ee=6*Math.pow(1.5,22-q.zoom)*y.exaggeration();(W?[!1,!0]:[!1]).forEach(Q=>{j=-1;const ae=Q?D.LINES:D.TRIANGLES,[fe,le]=Q?y.getWirefameBuffer():[y.gridIndexBuffer,y.gridSegments];for(const re of E){const Ce=w.getTile(re),we=u.StencilMode.disabled,ve=y.prevTerrainTileForTile[re.key],nt=y.terrainTileForTile[re.key];Sh(ve,nt)&&Fl.newMorphing(re.key,ve,nt,C,250),z.activeTexture.set(D.TEXTURE0),Ce.texture.bind(D.LINEAR,D.CLAMP_TO_EDGE,D.LINEAR_MIPMAP_NEAREST);const Ee=Fl.getMorphValuesForProxy(re.key),je=Ee?1:0;let De;Ee&&(De={morphing:{srcDemTile:Ee.from,dstDemTile:Ee.to,phase:u.easeCubicInOut(Ee.phase)}});const Ze=ol(re.projMatrix,Au(re.canonical,q.renderWorldCopies)?ee/10:ee);X(je,Q),y.setupElevationDraw(Ce,B,De),g.prepareDrawProgram(z,B,re.toUnwrapped()),B.draw(z,ae,G,we,Y,u.CullFaceMode.backCCW,Ze,"terrain_raster",y.gridBuffer,fe,le)}})}}(s,this,this.proxySourceCache,r,this._updateTimestamp),this.renderingToTexture=!0,s.gpuTimingDeferredRenderEnd(),r.splice(0,r.length))}renderBatch(r){if(this._drapedRenderBatches.length===0)return r+1;this.renderingToTexture=!0;const s=this.painter,f=this.painter.context,g=this.proxySourceCache,y=this.proxiedCoords[g.id],w=this._drapedRenderBatches.shift(),E=[],C=s.style.order;let z=0;for(const D of y){const B=g.getTileByID(D.proxyTileKey),j=g.proxyCachedFBO[D.key]?g.proxyCachedFBO[D.key][r]:void 0,W=j!==void 0?g.renderCache[j]:this.pool[z++],X=j!==void 0;if(B.texture=W.tex,X&&!W.dirty){E.push(B.tileID);continue}let Y;f.bindFramebuffer.set(W.fb.framebuffer),this.renderedToTile=!1,W.dirty&&(f.clear({color:u.Color.transparent,stencil:0}),W.dirty=!1);for(let G=w.start;G<=w.end;++G){const q=s.style._layers[C[G]];if(q.isHidden(s.transform.zoom))continue;const ee=s.style._getLayerSourceCache(q),Q=ee?this.proxyToSource[D.key][ee.id]:[D];if(!Q)continue;const ae=Q;f.viewport.set([0,0,W.fb.width,W.fb.height]),Y!==(ee?ee.id:null)&&(this._setupStencil(W,Q,q,ee),Y=ee?ee.id:null),s.renderLayer(s,ee,q,ae)}this.renderedToTile?(W.dirty=!0,E.push(B.tileID)):X||--z,z===5&&(z=0,this.renderToBackBuffer(E))}return this.renderToBackBuffer(E),this.renderingToTexture=!1,f.bindFramebuffer.set(null),f.viewport.set([0,0,s.width,s.height]),w.end+1}postRender(){}renderCacheEfficiency(r){const s=r.order.length;if(s===0)return{efficiency:100};let f,g=0,y=0,w=!1;for(let E=0;E<s;++E){const C=r._layers[r.order[E]];this._style.isLayerDraped(C)?(w&&++g,++y):w||(w=!0,f=C.id)}return y===0?{efficiency:100}:{efficiency:100*(1-g/y),firstUndrapedLayer:f}}getMinElevationBelowMSL(){let r=0;return this._visibleDemTiles.filter(s=>s.dem).forEach(s=>{r=Math.min(r,s.dem.tree.minimums[0])}),r===0?r:(r-30)*this._exaggeration}raycast(r,s,f){if(!this._visibleDemTiles)return null;const g=this._visibleDemTiles.filter(y=>y.dem).map(y=>{const w=y.tileID,E=1<<w.overscaledZ,{x:C,y:z}=w.canonical,D=C/E,B=(C+1)/E,j=z/E,W=(z+1)/E;return{minx:D,miny:j,maxx:B,maxy:W,t:y.dem.tree.raycastRoot(D,j,B,W,r,s,f),tile:y}});g.sort((y,w)=>(y.t!==null?y.t:Number.MAX_VALUE)-(w.t!==null?w.t:Number.MAX_VALUE));for(const y of g){if(y.t==null)return null;const w=y.tile.dem.tree.raycast(y.minx,y.miny,y.maxx,y.maxy,r,s,f);if(w!=null)return w}return null}_createFBO(){const r=this.painter.context,s=r.gl,f=this.drapeBufferSize;r.activeTexture.set(s.TEXTURE0);const g=new u.Texture(r,{width:f[0],height:f[1],data:null},s.RGBA);g.bind(s.LINEAR,s.CLAMP_TO_EDGE);const y=r.createFramebuffer(f[0],f[1],!1);return y.colorAttachment.set(g.texture),y.depthAttachment=new Io(r,y.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=r.createRenderbuffer(r.gl.DEPTH_STENCIL,f[0],f[1]),this._stencilRef=0,y.depthAttachment.set(this._sharedDepthStencil),r.clear({stencil:0})):y.depthAttachment.set(this._sharedDepthStencil),r.extTextureFilterAnisotropic&&!r.extTextureFilterAnisotropicForceOff&&s.texParameterf(s.TEXTURE_2D,r.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,r.extTextureFilterAnisotropicMax),{fb:y,tex:g,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const r in this._style._sourceCaches)if(this._style._sourceCaches[r].hasTransition())return!0;return this._style.order.some(r=>{const s=this._style._layers[r],f=s.isHidden(this.painter.transform.zoom);return s.type!=="custom"&&!f&&s.hasTransition()})}_clearRasterFadeFromRenderCache(){let r=!1;for(const s in this._style._sourceCaches)if(this._style._sourceCaches[s]._source instanceof V){r=!0;break}if(r)for(let s=0;s<this._style.order.length;++s){const f=this._style._layers[this._style.order[s]],g=f.isHidden(this.painter.transform.zoom),y=this._style._getLayerSourceCache(f);if(f.type!=="raster"||g||!y)continue;const w=f.paint.get("raster-fade-duration");for(const E of this.proxyCoords){const C=this.proxyToSource[E.key][y.id];if(C)for(const z of C){const D=Mc(y.getTile(z),y.findLoadedParent(z,0),y,this.painter.transform,w);(D.opacity!==1||D.mix!==0)&&this._clearRenderCacheForTile(y.id,z)}}}}_setupDrapedRenderBatches(){const r=this._style.order,s=r.length;if(s===0)return;const f=[];let g,y=0,w=this._style._layers[r[y]];for(;!this._style.isLayerDraped(w)&&w.isHidden(this.painter.transform.zoom)&&++y<s;)w=this._style._layers[r[y]];for(;y<s;++y){const E=this._style._layers[r[y]];E.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(E)?g===void 0&&(g=y):g!==void 0&&(f.push({start:g,end:y-1}),g=void 0))}g!==void 0&&f.push({start:g,end:y-1}),this._drapedRenderBatches=f}_setupRenderCache(r){const s=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,s.renderCache.length>s.renderCachePool.length){const w=Object.values(s.proxyCachedFBO);s.proxyCachedFBO={};for(let E=0;E<w.length;++E){const C=Object.values(w[E]);s.renderCachePool.push(...C)}}return}this._clearRasterFadeFromRenderCache();const f=this.proxyCoords,g=this._tilesDirty;for(let w=f.length-1;w>=0;w--){const E=f[w];if(s.getTileByID(E.key),s.proxyCachedFBO[E.key]!==void 0){const C=r[E.key],z=this.proxyToSource[E.key];let D=0;for(const B in z){const j=z[B],W=C[B];if(!W||W.length!==j.length||j.some((X,Y)=>X!==W[Y]||g[B]&&g[B].hasOwnProperty(X.key))){D=-1;break}++D}for(const B in s.proxyCachedFBO[E.key])s.renderCache[s.proxyCachedFBO[E.key][B]].dirty=D<0||D!==Object.values(C).length}}const y=[...this._drapedRenderBatches];y.sort((w,E)=>E.end-E.start-(w.end-w.start));for(const w of y)for(const E of f){if(s.proxyCachedFBO[E.key])continue;let C=s.renderCachePool.pop();C===void 0&&s.renderCache.length<50&&(C=s.renderCache.length,s.renderCache.push(this._createFBO())),C!==void 0&&(s.proxyCachedFBO[E.key]={},s.proxyCachedFBO[E.key][w.start]=C,s.renderCache[C].dirty=!0)}this._tilesDirty={}}_setupStencil(r,s,f,g){if(!g||!this._sourceTilesOverlap[g.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const y=this.painter.context,w=y.gl;if(s.length<=1)return void(this._overlapStencilType=!1);let E;if(f.isTileClipped())E=s.length,this._overlapStencilMode.test={func:w.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(s[0].overscaledZ>s[s.length-1].overscaledZ))return void(this._overlapStencilType=!1);E=1,this._overlapStencilMode.test={func:w.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+E>255&&(y.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=E,this._overlapStencilMode.ref=this._stencilRef,f.isTileClipped()&&this._renderTileClippingMasks(s,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(r){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[r.key]),this._overlapStencilMode):u.StencilMode.disabled}_renderTileClippingMasks(r,s){const f=this.painter,g=this.painter.context,y=g.gl;f._tileClippingMaskIDs={},g.setColorMode(u.ColorMode.disabled),g.setDepthMode(u.DepthMode.disabled);const w=f.useProgram("clippingMask");for(const E of r){const C=f._tileClippingMaskIDs[E.key]=--s;w.draw(g,y.TRIANGLES,u.DepthMode.disabled,new u.StencilMode({func:y.ALWAYS,mask:0},C,255,y.KEEP,y.KEEP,y.REPLACE),u.ColorMode.disabled,u.CullFaceMode.disabled,Ru(E.projMatrix),"$clipping",f.tileExtentBuffer,f.quadTriangleIndexBuffer,f.tileExtentSegments)}}pointCoordinate(r){const s=this.painter.transform;if(r.x<0||r.x>s.width||r.y<0||r.y>s.height)return null;const f=[r.x,r.y,1,1];u.transformMat4$1(f,f,s.pixelMatrixInverse),u.scale$1(f,f,1/f[3]),f[0]/=s.worldSize,f[1]/=s.worldSize;const g=s._camera.position,y=u.mercatorZfromAltitude(1,s.center.lat),w=[g[0],g[1],g[2]/y,0],E=u.subtract([],f.slice(0,3),w);u.normalize(E,E);const C=this.raycast(w,E,this._exaggeration);return C!==null&&C?(u.scaleAndAdd(w,w,E,C),w[3]=w[2],w[2]*=y,w):null}drawDepth(){const r=this.painter,s=r.context,f=this.proxySourceCache,g=Math.ceil(r.width),y=Math.ceil(r.height);if(!this._depthFBO||this._depthFBO.width===g&&this._depthFBO.height===y||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const w=s.gl,E=s.createFramebuffer(g,y,!0);s.activeTexture.set(w.TEXTURE0);const C=new u.Texture(s,{width:g,height:y,data:null},w.RGBA);C.bind(w.NEAREST,w.CLAMP_TO_EDGE),E.colorAttachment.set(C.texture);const z=s.createRenderbuffer(s.gl.DEPTH_COMPONENT16,g,y);E.depthAttachment.set(z),this._depthFBO=E,this._depthTexture=C}s.bindFramebuffer.set(this._depthFBO.framebuffer),s.viewport.set([0,0,g,y]),function(w,E,C,z){if(w.transform.projection.name==="globe")return;const D=w.context,B=D.gl;D.clear({depth:1});const j=w.useProgram("terrainDepth"),W=new u.DepthMode(B.LESS,u.DepthMode.ReadWrite,w.depthRangeFor3D);for(const X of z){const Y=C.getTile(X),G=ol(X.projMatrix,0);E.setupElevationDraw(Y,j),j.draw(D,B.TRIANGLES,W,u.StencilMode.disabled,u.ColorMode.unblended,u.CullFaceMode.backCCW,G,"terrain_depth",E.gridBuffer,E.gridIndexBuffer,E.gridNoSkirtSegments)}}(r,this,f,this.proxyCoords)}_setupProxiedCoordsForOrtho(r,s,f){if(r.getSource()instanceof Z)return this._setupProxiedCoordsForImageSource(r,s,f);this._findCoveringTileCache[r.id]=this._findCoveringTileCache[r.id]||{};const g=this.proxiedCoords[r.id]=[],y=this.proxyCoords;for(let E=0;E<y.length;E++){const C=y[E],z=this._findTileCoveringTileID(C,r);if(z){const D=this._createProxiedId(C,z,f[C.key]&&f[C.key][r.id]);g.push(D),this.proxyToSource[C.key][r.id]=[D]}}let w=!1;for(let E=0;E<s.length;E++){const C=r.getTile(s[E]);if(!C||!C.hasData())continue;const z=this._findTileCoveringTileID(C.tileID,this.proxySourceCache);if(z&&z.tileID.canonical.z!==C.tileID.canonical.z){const D=this.proxyToSource[z.tileID.key][r.id],B=this._createProxiedId(z.tileID,C,f[z.tileID.key]&&f[z.tileID.key][r.id]);D?D.splice(D.length-1,0,B):this.proxyToSource[z.tileID.key][r.id]=[B],g.push(B),w=!0}}this._sourceTilesOverlap[r.id]=w}_setupProxiedCoordsForImageSource(r,s,f){if(!r.getSource().loaded())return;const g=this.proxiedCoords[r.id]=[],y=this.proxyCoords,w=r.getSource(),E=new u.pointGeometry(w.tileID.x,w.tileID.y)._div(1<<w.tileID.z),C=w.coordinates.map(u.MercatorCoordinate.fromLngLat).reduce((D,B)=>(D.min.x=Math.min(D.min.x,B.x-E.x),D.min.y=Math.min(D.min.y,B.y-E.y),D.max.x=Math.max(D.max.x,B.x-E.x),D.max.y=Math.max(D.max.y,B.y-E.y),D),{min:new u.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new u.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),z=(D,B)=>{const j=D.wrap+D.canonical.x/(1<<D.canonical.z),W=D.canonical.y/(1<<D.canonical.z),X=u.EXTENT/(1<<D.canonical.z),Y=B.wrap+B.canonical.x/(1<<B.canonical.z),G=B.canonical.y/(1<<B.canonical.z);return j+X<Y+C.min.x||j>Y+C.max.x||W+X<G+C.min.y||W>G+C.max.y};for(let D=0;D<y.length;D++){const B=y[D];for(let j=0;j<s.length;j++){const W=r.getTile(s[j]);if(!W||!W.hasData()||z(B,W.tileID))continue;const X=this._createProxiedId(B,W,f[B.key]&&f[B.key][r.id]),Y=this.proxyToSource[B.key][r.id];Y?Y.push(X):this.proxyToSource[B.key][r.id]=[X],g.push(X)}}}_createProxiedId(r,s,f){let g=this.orthoMatrix;if(f){const y=f.find(w=>w.key===s.tileID.key);if(y)return y}if(s.tileID.key!==r.key){const y=r.canonical.z-s.tileID.canonical.z;let w,E,C;g=u.create();const z=s.tileID.wrap-r.wrap<<r.overscaledZ;y>0?(w=u.EXTENT>>y,E=w*((s.tileID.canonical.x<<y)-r.canonical.x+z),C=w*((s.tileID.canonical.y<<y)-r.canonical.y)):(w=u.EXTENT<<-y,E=u.EXTENT*(s.tileID.canonical.x-(r.canonical.x+z<<-y)),C=u.EXTENT*(s.tileID.canonical.y-(r.canonical.y<<-y))),u.ortho(g,0,w,0,w,0,1),u.translate(g,g,[E,C,0])}return new Po(s.tileID,r.key,g)}_findTileCoveringTileID(r,s){let f=s.getTile(r);if(f&&f.hasData())return f;const g=this._findCoveringTileCache[s.id],y=g[r.key];if(f=y?s.getTileByID(y):null,f&&f.hasData()||y===null)return f;let w=f?f.tileID:r,E=w.overscaledZ;const C=s.getSource().minzoom,z=[];if(!y){const B=s.getSource().maxzoom;if(r.canonical.z>=B){const j=r.canonical.z-B;s.getSource().reparseOverscaled?(E=Math.max(r.canonical.z+2,s.transform.tileZoom),w=new u.OverscaledTileID(E,r.wrap,B,r.canonical.x>>j,r.canonical.y>>j)):j!==0&&(E=B,w=new u.OverscaledTileID(E,r.wrap,B,r.canonical.x>>j,r.canonical.y>>j))}w.key!==r.key&&(z.push(w.key),f=s.getTile(w))}const D=B=>{z.forEach(j=>{g[j]=B}),z.length=0};for(E-=1;E>=C&&(!f||!f.hasData());E--){f&&D(f.tileID.key);const B=w.calculateScaledKey(E);if(f=s.getTileByID(B),f&&f.hasData())break;const j=g[B];if(j===null)break;j===void 0?z.push(B):f=s.getTileByID(j)}return D(f?f.tileID.key:null),f&&f.hasData()?f:null}findDEMTileFor(r){return this.enabled?this._findTileCoveringTileID(r,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(r,s){let f=this._tilesDirty[r];f||(f=this._tilesDirty[r]={}),f[s.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const r=function(s){let f=0;const g=new u.StructArrayLayout2ui4,y=131;for(let w=1;w<129;w++){for(let E=1;E<129;E++)f=w*y+E,g.emplaceBack(f,f+1),g.emplaceBack(f,f+y),g.emplaceBack(f+1,f+y),w===128&&g.emplaceBack(f+y,f+y+1);g.emplaceBack(f+1,f+1+y)}return g}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(r),this.wireframeSegments=u.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,r.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class Ac{static cacheKey(r,s,f,g){let y=`${s}${g?g.cacheKey:""}`;for(const w of f)r.usedDefines.includes(w)&&(y+=`/${w}`);return y}constructor(r,s,f,g,y,w){const E=r.gl;this.program=E.createProgram();const C=function(G){const q=[];for(let ee=0;ee<G.length;ee++){if(G[ee]===null)continue;const Q=G[ee].split(" ");q.push(Q.pop())}return q}(f.staticAttributes),z=g?g.getBinderAttributes():[],D=C.concat(z);let B=g?g.defines():[];B=B.concat(w.map(G=>`#define ${G}`));const j=B.concat(r.extStandardDerivatives?`#extension GL_OES_standard_derivatives : enable
`.concat(ci):ci,ci,zi,si.fragmentSource,tn.fragmentSource,f.fragmentSource).join(`
`),W=B.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,zi,si.vertexSource,tn.vertexSource,Ot.vertexSource,f.vertexSource).join(`
`),X=E.createShader(E.FRAGMENT_SHADER);if(E.isContextLost())return void(this.failedToCreate=!0);E.shaderSource(X,j),E.compileShader(X),E.attachShader(this.program,X);const Y=E.createShader(E.VERTEX_SHADER);if(E.isContextLost())this.failedToCreate=!0;else{E.shaderSource(Y,W),E.compileShader(Y),E.attachShader(this.program,Y),this.attributes={},this.numAttributes=D.length;for(let G=0;G<this.numAttributes;G++)D[G]&&(E.bindAttribLocation(this.program,G,D[G]),this.attributes[D[G]]=G);E.linkProgram(this.program),E.deleteShader(Y),E.deleteShader(X),this.fixedUniforms=y(r),this.binderUniforms=g?g.getUniforms(r):[],w.includes("TERRAIN")&&(this.terrainUniforms=(G=>({u_dem:new u.Uniform1i(G),u_dem_prev:new u.Uniform1i(G),u_dem_unpack:new u.Uniform4f(G),u_dem_tl:new u.Uniform2f(G),u_dem_scale:new u.Uniform1f(G),u_dem_tl_prev:new u.Uniform2f(G),u_dem_scale_prev:new u.Uniform1f(G),u_dem_size:new u.Uniform1f(G),u_dem_lerp:new u.Uniform1f(G),u_exaggeration:new u.Uniform1f(G),u_depth:new u.Uniform1i(G),u_depth_size_inv:new u.Uniform2f(G),u_meter_to_dem:new u.Uniform1f(G),u_label_plane_matrix_inv:new u.UniformMatrix4f(G)}))(r)),w.includes("GLOBE")&&(this.globeUniforms=(G=>({u_tile_tl_up:new u.Uniform3f(G),u_tile_tr_up:new u.Uniform3f(G),u_tile_br_up:new u.Uniform3f(G),u_tile_bl_up:new u.Uniform3f(G),u_tile_up_scale:new u.Uniform1f(G)}))(r)),w.includes("FOG")&&(this.fogUniforms=(G=>({u_fog_matrix:new u.UniformMatrix4f(G),u_fog_range:new u.Uniform2f(G),u_fog_color:new u.Uniform4f(G),u_fog_horizon_blend:new u.Uniform1f(G),u_fog_temporal_offset:new u.Uniform1f(G),u_frustum_tl:new u.Uniform3f(G),u_frustum_tr:new u.Uniform3f(G),u_frustum_br:new u.Uniform3f(G),u_frustum_bl:new u.Uniform3f(G),u_globe_pos:new u.Uniform3f(G),u_globe_radius:new u.Uniform1f(G),u_globe_transition:new u.Uniform1f(G),u_is_globe:new u.Uniform1i(G),u_viewport:new u.Uniform2f(G)}))(r))}}setTerrainUniformValues(r,s){if(!this.terrainUniforms)return;const f=this.terrainUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const g in s)f[g]&&f[g].set(this.program,g,s[g])}}setGlobeUniformValues(r,s){if(!this.globeUniforms)return;const f=this.globeUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const g in s)f[g]&&f[g].set(this.program,g,s[g])}}setFogUniformValues(r,s){if(!this.fogUniforms)return;const f=this.fogUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const g in s)f[g].set(this.program,g,s[g])}}draw(r,s,f,g,y,w,E,C,z,D,B,j,W,X,Y){const G=r.gl;if(this.failedToCreate)return;r.program.set(this.program),r.setDepthMode(f),r.setStencilMode(g),r.setColorMode(y),r.setCullFace(w);for(const ee of Object.keys(this.fixedUniforms))this.fixedUniforms[ee].set(this.program,ee,E[ee]);X&&X.setUniforms(this.program,r,this.binderUniforms,j,{zoom:W});const q={[G.LINES]:2,[G.TRIANGLES]:3,[G.LINE_STRIP]:1}[s];for(const ee of B.get()){const Q=ee.vaos||(ee.vaos={});(Q[C]||(Q[C]=new Os)).bind(r,this,z,X?X.getPaintVertexBuffers():[],D,ee.vertexOffset,Y||[]),G.drawElements(s,ee.primitiveLength*q,G.UNSIGNED_SHORT,ee.primitiveOffset*q*2)}}}function Du(h,r){const s=Math.pow(2,r.tileID.overscaledZ),f=r.tileSize*Math.pow(2,h.transform.tileZoom)/s,g=f*(r.tileID.canonical.x+r.tileID.wrap*s),y=f*r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture.size,u_tile_units_to_pixels:1/or(r,1,h.transform.tileZoom),u_pixel_coord_upper:[g>>16,y>>16],u_pixel_coord_lower:[65535&g,65535&y]}}const Mh=u.create(),ip=(h,r,s,f,g,y,w,E,C,z,D)=>{const B=r.style.light,j=B.properties.get("position"),W=[j.x,j.y,j.z],X=u.create$1();B.properties.get("anchor")==="viewport"&&(u.fromRotation(X,-r.transform.angle),u.transformMat3(W,W,X));const Y=B.properties.get("color"),G=r.transform,q={u_matrix:h,u_lightpos:W,u_lightintensity:B.properties.get("intensity"),u_lightcolor:[Y.r,Y.g,Y.b],u_vertical_gradient:+s,u_opacity:f,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Mh,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:g,u_edge_radius:y};return G.projection.name==="globe"&&(q.u_tile_id=[w.canonical.x,w.canonical.y,1<<w.canonical.z],q.u_zoom_transition=C,q.u_inv_rot_matrix=D,q.u_merc_center=z,q.u_up_dir=G.projection.upVector(new u.CanonicalTileID(0,0,0),z[0]*u.EXTENT,z[1]*u.EXTENT),q.u_height_lift=E),q},Ah=(h,r,s,f,g,y,w,E,C,z,D,B)=>{const j=ip(h,r,s,f,g,y,w,C,z,D,B),W={u_height_factor:-Math.pow(2,w.overscaledZ)/E.tileSize/8};return u.extend(j,Du(r,E),W)},Rc=h=>({u_matrix:h}),ta=(h,r,s)=>u.extend(Rc(h),Du(r,s)),Bo=(h,r)=>({u_matrix:h,u_world:r}),cr=(h,r,s,f)=>u.extend(ta(h,r,s),{u_world:f}),rs=u.create(),Rh=(h,r,s,f,g,y)=>{const w=h.transform,E=w.projection.name==="globe";let C;if(y.paint.get("circle-pitch-alignment")==="map")if(E){const D=u.globePixelsToTileUnits(w.zoom,r.canonical)*w._pixelsPerMercatorPixel;C=Float32Array.from([D,0,0,D])}else C=w.calculatePixelsToTileUnitsMatrix(s);else C=new Float32Array([w.pixelsToGLUnits[0],0,0,w.pixelsToGLUnits[1]]);const z={u_camera_to_center_distance:w.cameraToCenterDistance,u_matrix:h.translatePosMatrix(r.projMatrix,s,y.paint.get("circle-translate"),y.paint.get("circle-translate-anchor")),u_device_pixel_ratio:u.exported.devicePixelRatio,u_extrude_scale:C,u_inv_rot_matrix:rs,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(E){z.u_inv_rot_matrix=f,z.u_merc_center=g,z.u_tile_id=[r.canonical.x,r.canonical.y,1<<r.canonical.z],z.u_zoom_transition=u.globeToMercatorTransition(w.zoom);const D=g[0]*u.EXTENT,B=g[1]*u.EXTENT;z.u_up_dir=w.projection.upVector(new u.CanonicalTileID(0,0,0),D,B)}return z},Dh=h=>{const r=[];return h.paint.get("circle-pitch-alignment")==="map"&&r.push("PITCH_WITH_MAP"),h.paint.get("circle-pitch-scale")==="map"&&r.push("SCALE_WITH_MAP"),r},Dc=(h,r,s,f)=>{const g=u.EXTENT/s.tileSize;return{u_matrix:h,u_camera_to_center_distance:r.getCameraToCenterDistance(f),u_extrude_scale:[r.pixelsToGLUnits[0]/g,r.pixelsToGLUnits[1]/g]}},as=(h,r,s=1)=>({u_matrix:h,u_color:r,u_overlay:0,u_overlay_scale:s}),rp=u.create(),zh=(h,r,s,f,g,y,w)=>{const E=h.transform,C=E.projection.name==="globe",z=C?u.globePixelsToTileUnits(E.zoom,r.canonical)*E._pixelsPerMercatorPixel:or(s,1,y),D={u_matrix:r.projMatrix,u_extrude_scale:z,u_intensity:w,u_inv_rot_matrix:rp,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(C){D.u_inv_rot_matrix=f,D.u_merc_center=g,D.u_tile_id=[r.canonical.x,r.canonical.y,1<<r.canonical.z],D.u_zoom_transition=u.globeToMercatorTransition(E.zoom);const B=g[0]*u.EXTENT,j=g[1]*u.EXTENT;D.u_up_dir=E.projection.upVector(new u.CanonicalTileID(0,0,0),B,j)}return D},zc=(h,r,s,f,g,y,w)=>{const E=h.transform,C=E.calculatePixelsToTileUnitsMatrix(r);return{u_matrix:Ud(h,r,s,f),u_pixels_to_tile_units:C,u_device_pixel_ratio:y,u_units_to_pixels:[1/E.pixelsToGLUnits[0],1/E.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:g,u_texsize:Ic(s)?r.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:Ih(r,h.transform),u_alpha_discard_threshold:0,u_trim_offset:w}},os=(h,r,s,f,g)=>{const y=h.transform;return{u_matrix:Ud(h,r,s,f),u_texsize:r.imageAtlasTexture.size,u_pixels_to_tile_units:y.calculatePixelsToTileUnitsMatrix(r),u_device_pixel_ratio:g,u_image:0,u_tile_units_to_pixels:Ih(r,y),u_units_to_pixels:[1/y.pixelsToGLUnits[0],1/y.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function Ih(h,r){return 1/or(h,1,r.tileZoom)}function Ud(h,r,s,f){return h.translatePosMatrix(f||r.tileID.projMatrix,r,s.paint.get("line-translate"),s.paint.get("line-translate-anchor"))}function Ic(h){const r=h.paint.get("line-dasharray").value;return r.value||r.kind!=="constant"}const ap=(h,r,s,f,g,y)=>{return{u_matrix:h,u_tl_parent:r,u_scale_parent:s,u_fade_t:f.mix,u_opacity:f.opacity*g.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:g.paint.get("raster-brightness-min"),u_brightness_high:g.paint.get("raster-brightness-max"),u_saturation_factor:(E=g.paint.get("raster-saturation"),E>0?1-1/(1.001-E):-E),u_contrast_factor:(w=g.paint.get("raster-contrast"),w>0?1/(1-w):1+w),u_spin_weights:Nd(g.paint.get("raster-hue-rotate")),u_perspective_transform:y};var w,E};function Nd(h){h*=Math.PI/180;const r=Math.sin(h),s=Math.cos(h);return[(2*s+1)/3,(-Math.sqrt(3)*r-s+1)/3,(Math.sqrt(3)*r-s+1)/3]}const op=u.create(),kc=(h,r,s,f,g,y,w,E,C,z,D,B,j,W,X,Y)=>{const G=g.transform,q={u_is_size_zoom_constant:+(h==="constant"||h==="source"),u_is_size_feature_constant:+(h==="constant"||h==="camera"),u_size_t:r?r.uSizeT:0,u_size:r?r.uSize:0,u_camera_to_center_distance:G.cameraToCenterDistance,u_rotate_symbol:+s,u_aspect_ratio:G.width/G.height,u_fade_change:g.options.fadeDuration?g.symbolFadeChange:1,u_matrix:y,u_label_plane_matrix:w,u_coord_matrix:E,u_is_text:+C,u_pitch_with_map:+f,u_texsize:z,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:op,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:op,u_up_vector:[0,-1,0]};return Y.name==="globe"&&(q.u_tile_id=[D.canonical.x,D.canonical.y,1<<D.canonical.z],q.u_zoom_transition=B,q.u_inv_rot_matrix=W,q.u_merc_center=j,q.u_camera_forward=G._camera.forward(),q.u_ecef_origin=u.globeECEFOrigin(G.globeMatrix,D.toUnwrapped()),q.u_tile_matrix=Float32Array.from(G.globeMatrix),q.u_up_vector=X),q},Nl=(h,r,s,f,g,y,w,E,C,z,D,B,j,W,X,Y,G)=>u.extend(kc(h,r,s,f,g,y,w,E,C,z,B,j,W,X,Y,G),{u_gamma_scale:f?g.transform.cameraToCenterDistance*Math.cos(g.terrain?0:g.transform._pitch):1,u_device_pixel_ratio:u.exported.devicePixelRatio,u_is_halo:+D}),zu=(h,r,s,f,g,y,w,E,C,z,D,B,j,W,X,Y)=>u.extend(Nl(h,r,s,f,g,y,w,E,!0,C,!0,D,B,j,W,X,Y),{u_texsize_icon:z,u_texture_icon:1}),sp=(h,r,s)=>({u_matrix:h,u_opacity:r,u_color:s}),kh=(h,r,s,f,g)=>u.extend(function(y,w,E){const C=w.imageManager.getPattern(y.toString()),{width:z,height:D}=w.imageManager.getPixelSize(),B=Math.pow(2,E.tileID.overscaledZ),j=E.tileSize*Math.pow(2,w.transform.tileZoom)/B,W=j*(E.tileID.canonical.x+E.tileID.wrap*B),X=j*E.tileID.canonical.y;return{u_image:0,u_pattern_tl:C.tl,u_pattern_br:C.br,u_texsize:[z,D],u_pattern_size:C.displaySize,u_tile_units_to_pixels:1/or(E,1,w.transform.tileZoom),u_pixel_coord_upper:[W>>16,X>>16],u_pixel_coord_lower:[65535&W,65535&X]}}(f,s,g),{u_matrix:h,u_opacity:r}),Nm={fillExtrusion:h=>({u_matrix:new u.UniformMatrix4f(h),u_lightpos:new u.Uniform3f(h),u_lightintensity:new u.Uniform1f(h),u_lightcolor:new u.Uniform3f(h),u_vertical_gradient:new u.Uniform1f(h),u_opacity:new u.Uniform1f(h),u_edge_radius:new u.Uniform1f(h),u_ao:new u.Uniform2f(h),u_tile_id:new u.Uniform3f(h),u_zoom_transition:new u.Uniform1f(h),u_inv_rot_matrix:new u.UniformMatrix4f(h),u_merc_center:new u.Uniform2f(h),u_up_dir:new u.Uniform3f(h),u_height_lift:new u.Uniform1f(h)}),fillExtrusionPattern:h=>({u_matrix:new u.UniformMatrix4f(h),u_lightpos:new u.Uniform3f(h),u_lightintensity:new u.Uniform1f(h),u_lightcolor:new u.Uniform3f(h),u_vertical_gradient:new u.Uniform1f(h),u_height_factor:new u.Uniform1f(h),u_edge_radius:new u.Uniform1f(h),u_ao:new u.Uniform2f(h),u_tile_id:new u.Uniform3f(h),u_zoom_transition:new u.Uniform1f(h),u_inv_rot_matrix:new u.UniformMatrix4f(h),u_merc_center:new u.Uniform2f(h),u_up_dir:new u.Uniform3f(h),u_height_lift:new u.Uniform1f(h),u_image:new u.Uniform1i(h),u_texsize:new u.Uniform2f(h),u_pixel_coord_upper:new u.Uniform2f(h),u_pixel_coord_lower:new u.Uniform2f(h),u_tile_units_to_pixels:new u.Uniform1f(h),u_opacity:new u.Uniform1f(h)}),fill:h=>({u_matrix:new u.UniformMatrix4f(h)}),fillPattern:h=>({u_matrix:new u.UniformMatrix4f(h),u_image:new u.Uniform1i(h),u_texsize:new u.Uniform2f(h),u_pixel_coord_upper:new u.Uniform2f(h),u_pixel_coord_lower:new u.Uniform2f(h),u_tile_units_to_pixels:new u.Uniform1f(h)}),fillOutline:h=>({u_matrix:new u.UniformMatrix4f(h),u_world:new u.Uniform2f(h)}),fillOutlinePattern:h=>({u_matrix:new u.UniformMatrix4f(h),u_world:new u.Uniform2f(h),u_image:new u.Uniform1i(h),u_texsize:new u.Uniform2f(h),u_pixel_coord_upper:new u.Uniform2f(h),u_pixel_coord_lower:new u.Uniform2f(h),u_tile_units_to_pixels:new u.Uniform1f(h)}),circle:h=>({u_camera_to_center_distance:new u.Uniform1f(h),u_extrude_scale:new u.UniformMatrix2f(h),u_device_pixel_ratio:new u.Uniform1f(h),u_matrix:new u.UniformMatrix4f(h),u_inv_rot_matrix:new u.UniformMatrix4f(h),u_merc_center:new u.Uniform2f(h),u_tile_id:new u.Uniform3f(h),u_zoom_transition:new u.Uniform1f(h),u_up_dir:new u.Uniform3f(h)}),collisionBox:h=>({u_matrix:new u.UniformMatrix4f(h),u_camera_to_center_distance:new u.Uniform1f(h),u_extrude_scale:new u.Uniform2f(h)}),collisionCircle:h=>({u_matrix:new u.UniformMatrix4f(h),u_inv_matrix:new u.UniformMatrix4f(h),u_camera_to_center_distance:new u.Uniform1f(h),u_viewport_size:new u.Uniform2f(h)}),debug:h=>({u_color:new u.UniformColor(h),u_matrix:new u.UniformMatrix4f(h),u_overlay:new u.Uniform1i(h),u_overlay_scale:new u.Uniform1f(h)}),clippingMask:h=>({u_matrix:new u.UniformMatrix4f(h)}),heatmap:h=>({u_extrude_scale:new u.Uniform1f(h),u_intensity:new u.Uniform1f(h),u_matrix:new u.UniformMatrix4f(h),u_inv_rot_matrix:new u.UniformMatrix4f(h),u_merc_center:new u.Uniform2f(h),u_tile_id:new u.Uniform3f(h),u_zoom_transition:new u.Uniform1f(h),u_up_dir:new u.Uniform3f(h)}),heatmapTexture:h=>({u_image:new u.Uniform1i(h),u_color_ramp:new u.Uniform1i(h),u_opacity:new u.Uniform1f(h)}),hillshade:h=>({u_matrix:new u.UniformMatrix4f(h),u_image:new u.Uniform1i(h),u_latrange:new u.Uniform2f(h),u_light:new u.Uniform2f(h),u_shadow:new u.UniformColor(h),u_highlight:new u.UniformColor(h),u_accent:new u.UniformColor(h)}),hillshadePrepare:h=>({u_matrix:new u.UniformMatrix4f(h),u_image:new u.Uniform1i(h),u_dimension:new u.Uniform2f(h),u_zoom:new u.Uniform1f(h),u_unpack:new u.Uniform4f(h)}),line:h=>({u_matrix:new u.UniformMatrix4f(h),u_pixels_to_tile_units:new u.UniformMatrix2f(h),u_device_pixel_ratio:new u.Uniform1f(h),u_units_to_pixels:new u.Uniform2f(h),u_dash_image:new u.Uniform1i(h),u_gradient_image:new u.Uniform1i(h),u_image_height:new u.Uniform1f(h),u_texsize:new u.Uniform2f(h),u_tile_units_to_pixels:new u.Uniform1f(h),u_alpha_discard_threshold:new u.Uniform1f(h),u_trim_offset:new u.Uniform2f(h)}),linePattern:h=>({u_matrix:new u.UniformMatrix4f(h),u_texsize:new u.Uniform2f(h),u_pixels_to_tile_units:new u.UniformMatrix2f(h),u_device_pixel_ratio:new u.Uniform1f(h),u_image:new u.Uniform1i(h),u_units_to_pixels:new u.Uniform2f(h),u_tile_units_to_pixels:new u.Uniform1f(h),u_alpha_discard_threshold:new u.Uniform1f(h)}),raster:h=>({u_matrix:new u.UniformMatrix4f(h),u_tl_parent:new u.Uniform2f(h),u_scale_parent:new u.Uniform1f(h),u_fade_t:new u.Uniform1f(h),u_opacity:new u.Uniform1f(h),u_image0:new u.Uniform1i(h),u_image1:new u.Uniform1i(h),u_brightness_low:new u.Uniform1f(h),u_brightness_high:new u.Uniform1f(h),u_saturation_factor:new u.Uniform1f(h),u_contrast_factor:new u.Uniform1f(h),u_spin_weights:new u.Uniform3f(h),u_perspective_transform:new u.Uniform2f(h)}),symbolIcon:h=>({u_is_size_zoom_constant:new u.Uniform1i(h),u_is_size_feature_constant:new u.Uniform1i(h),u_size_t:new u.Uniform1f(h),u_size:new u.Uniform1f(h),u_camera_to_center_distance:new u.Uniform1f(h),u_rotate_symbol:new u.Uniform1i(h),u_aspect_ratio:new u.Uniform1f(h),u_fade_change:new u.Uniform1f(h),u_matrix:new u.UniformMatrix4f(h),u_label_plane_matrix:new u.UniformMatrix4f(h),u_coord_matrix:new u.UniformMatrix4f(h),u_is_text:new u.Uniform1i(h),u_pitch_with_map:new u.Uniform1i(h),u_texsize:new u.Uniform2f(h),u_tile_id:new u.Uniform3f(h),u_zoom_transition:new u.Uniform1f(h),u_inv_rot_matrix:new u.UniformMatrix4f(h),u_merc_center:new u.Uniform2f(h),u_camera_forward:new u.Uniform3f(h),u_tile_matrix:new u.UniformMatrix4f(h),u_up_vector:new u.Uniform3f(h),u_ecef_origin:new u.Uniform3f(h),u_texture:new u.Uniform1i(h)}),symbolSDF:h=>({u_is_size_zoom_constant:new u.Uniform1i(h),u_is_size_feature_constant:new u.Uniform1i(h),u_size_t:new u.Uniform1f(h),u_size:new u.Uniform1f(h),u_camera_to_center_distance:new u.Uniform1f(h),u_rotate_symbol:new u.Uniform1i(h),u_aspect_ratio:new u.Uniform1f(h),u_fade_change:new u.Uniform1f(h),u_matrix:new u.UniformMatrix4f(h),u_label_plane_matrix:new u.UniformMatrix4f(h),u_coord_matrix:new u.UniformMatrix4f(h),u_is_text:new u.Uniform1i(h),u_pitch_with_map:new u.Uniform1i(h),u_texsize:new u.Uniform2f(h),u_texture:new u.Uniform1i(h),u_gamma_scale:new u.Uniform1f(h),u_device_pixel_ratio:new u.Uniform1f(h),u_tile_id:new u.Uniform3f(h),u_zoom_transition:new u.Uniform1f(h),u_inv_rot_matrix:new u.UniformMatrix4f(h),u_merc_center:new u.Uniform2f(h),u_camera_forward:new u.Uniform3f(h),u_tile_matrix:new u.UniformMatrix4f(h),u_up_vector:new u.Uniform3f(h),u_ecef_origin:new u.Uniform3f(h),u_is_halo:new u.Uniform1i(h)}),symbolTextAndIcon:h=>({u_is_size_zoom_constant:new u.Uniform1i(h),u_is_size_feature_constant:new u.Uniform1i(h),u_size_t:new u.Uniform1f(h),u_size:new u.Uniform1f(h),u_camera_to_center_distance:new u.Uniform1f(h),u_rotate_symbol:new u.Uniform1i(h),u_aspect_ratio:new u.Uniform1f(h),u_fade_change:new u.Uniform1f(h),u_matrix:new u.UniformMatrix4f(h),u_label_plane_matrix:new u.UniformMatrix4f(h),u_coord_matrix:new u.UniformMatrix4f(h),u_is_text:new u.Uniform1i(h),u_pitch_with_map:new u.Uniform1i(h),u_texsize:new u.Uniform2f(h),u_texsize_icon:new u.Uniform2f(h),u_texture:new u.Uniform1i(h),u_texture_icon:new u.Uniform1i(h),u_gamma_scale:new u.Uniform1f(h),u_device_pixel_ratio:new u.Uniform1f(h),u_is_halo:new u.Uniform1i(h)}),background:h=>({u_matrix:new u.UniformMatrix4f(h),u_opacity:new u.Uniform1f(h),u_color:new u.UniformColor(h)}),backgroundPattern:h=>({u_matrix:new u.UniformMatrix4f(h),u_opacity:new u.Uniform1f(h),u_image:new u.Uniform1i(h),u_pattern_tl:new u.Uniform2f(h),u_pattern_br:new u.Uniform2f(h),u_texsize:new u.Uniform2f(h),u_pattern_size:new u.Uniform2f(h),u_pixel_coord_upper:new u.Uniform2f(h),u_pixel_coord_lower:new u.Uniform2f(h),u_tile_units_to_pixels:new u.Uniform1f(h)}),terrainRaster:Ps,terrainDepth:Ps,skybox:h=>({u_matrix:new u.UniformMatrix4f(h),u_sun_direction:new u.Uniform3f(h),u_cubemap:new u.Uniform1i(h),u_opacity:new u.Uniform1f(h),u_temporal_offset:new u.Uniform1f(h)}),skyboxGradient:h=>({u_matrix:new u.UniformMatrix4f(h),u_color_ramp:new u.Uniform1i(h),u_center_direction:new u.Uniform3f(h),u_radius:new u.Uniform1f(h),u_opacity:new u.Uniform1f(h),u_temporal_offset:new u.Uniform1f(h)}),skyboxCapture:h=>({u_matrix_3f:new u.UniformMatrix3f(h),u_sun_direction:new u.Uniform3f(h),u_sun_intensity:new u.Uniform1f(h),u_color_tint_r:new u.Uniform4f(h),u_color_tint_m:new u.Uniform4f(h),u_luminance:new u.Uniform1f(h)}),globeRaster:h=>({u_proj_matrix:new u.UniformMatrix4f(h),u_globe_matrix:new u.UniformMatrix4f(h),u_normalize_matrix:new u.UniformMatrix4f(h),u_merc_matrix:new u.UniformMatrix4f(h),u_zoom_transition:new u.Uniform1f(h),u_merc_center:new u.Uniform2f(h),u_image0:new u.Uniform1i(h),u_grid_matrix:new u.UniformMatrix3f(h),u_frustum_tl:new u.Uniform3f(h),u_frustum_tr:new u.Uniform3f(h),u_frustum_br:new u.Uniform3f(h),u_frustum_bl:new u.Uniform3f(h),u_globe_pos:new u.Uniform3f(h),u_globe_radius:new u.Uniform1f(h),u_viewport:new u.Uniform2f(h)}),globeAtmosphere:h=>({u_frustum_tl:new u.Uniform3f(h),u_frustum_tr:new u.Uniform3f(h),u_frustum_br:new u.Uniform3f(h),u_frustum_bl:new u.Uniform3f(h),u_horizon:new u.Uniform1f(h),u_transition:new u.Uniform1f(h),u_fadeout_range:new u.Uniform1f(h),u_color:new u.Uniform4f(h),u_high_color:new u.Uniform4f(h),u_space_color:new u.Uniform4f(h),u_star_intensity:new u.Uniform1f(h),u_star_density:new u.Uniform1f(h),u_star_size:new u.Uniform1f(h),u_temporal_offset:new u.Uniform1f(h),u_horizon_angle:new u.Uniform1f(h),u_rotation_matrix:new u.UniformMatrix4f(h)})};let Iu;function lp(h,r,s,f,g,y,w){const E=h.context,C=E.gl,z=h.transform,D=h.useProgram("collisionBox"),B=[];let j=0,W=0;for(let ae=0;ae<f.length;ae++){const fe=f[ae],le=r.getTile(fe),re=le.getBucket(s);if(!re)continue;const Ce=Ds(fe,re,z);let we=Ce;g[0]===0&&g[1]===0||(we=h.translatePosMatrix(Ce,le,g,y));const ve=w?re.textCollisionBox:re.iconCollisionBox,nt=re.collisionCircleArray;if(nt.length>0){const Ee=u.create(),je=we;u.mul(Ee,re.placementInvProjMatrix,z.glCoordMatrix),u.mul(Ee,Ee,re.placementViewportMatrix),B.push({circleArray:nt,circleOffset:W,transform:je,invTransform:Ee,projection:re.getProjection()}),j+=nt.length/4,W=j}ve&&(h.terrain&&h.terrain.setupElevationDraw(le,D),D.draw(E,C.LINES,u.DepthMode.disabled,u.StencilMode.disabled,h.colorModeForRenderPass(),u.CullFaceMode.disabled,Dc(we,z,le,re.getProjection()),s.id,ve.layoutVertexBuffer,ve.indexBuffer,ve.segments,null,z.zoom,null,[ve.collisionVertexBuffer,ve.collisionVertexBufferExt]))}if(!w||!B.length)return;const X=h.useProgram("collisionCircle"),Y=new u.StructArrayLayout2f1f2i16;Y.resize(4*j),Y._trim();let G=0;for(const ae of B)for(let fe=0;fe<ae.circleArray.length/4;fe++){const le=4*fe,re=ae.circleArray[le+0],Ce=ae.circleArray[le+1],we=ae.circleArray[le+2],ve=ae.circleArray[le+3];Y.emplace(G++,re,Ce,we,ve,0),Y.emplace(G++,re,Ce,we,ve,1),Y.emplace(G++,re,Ce,we,ve,2),Y.emplace(G++,re,Ce,we,ve,3)}(!Iu||Iu.length<2*j)&&(Iu=function(ae){const fe=2*ae,le=new u.StructArrayLayout3ui6;le.resize(fe),le._trim();for(let re=0;re<fe;re++){const Ce=6*re;le.uint16[Ce+0]=4*re+0,le.uint16[Ce+1]=4*re+1,le.uint16[Ce+2]=4*re+2,le.uint16[Ce+3]=4*re+2,le.uint16[Ce+4]=4*re+3,le.uint16[Ce+5]=4*re+0}return le}(j));const q=E.createIndexBuffer(Iu,!0),ee=E.createVertexBuffer(Y,u.collisionCircleLayout.members,!0);for(const ae of B){const fe={u_matrix:ae.transform,u_inv_matrix:ae.invTransform,u_camera_to_center_distance:(Q=z).getCameraToCenterDistance(ae.projection),u_viewport_size:[Q.width,Q.height]};X.draw(E,C.TRIANGLES,u.DepthMode.disabled,u.StencilMode.disabled,h.colorModeForRenderPass(),u.CullFaceMode.disabled,fe,s.id,ee,q,u.SegmentVector.simpleSegment(0,2*ae.circleOffset,ae.circleArray.length,ae.circleArray.length/2),null,z.zoom)}var Q;ee.destroy(),q.destroy()}const Lc=u.create();function Vm({width:h,height:r,anchor:s,textOffset:f,textScale:g},y){const{horizontalAlign:w,verticalAlign:E}=u.getAnchorAlignment(s),C=-(w-.5)*h,z=-(E-.5)*r,D=u.evaluateVariableOffset(s,f);return new u.pointGeometry((C/g+D[0])*y,(z/g+D[1])*y)}function up(h,r,s,f,g,y,w,E,C,z,D){const B=h.text.placedSymbolArray,j=h.text.dynamicLayoutVertexArray,W=h.icon.dynamicLayoutVertexArray,X={},Y=h.getProjection(),G=ts(E,Y,y),q=y.elevation,ee=Y.upVectorScale(E.canonical,y.center.lat,y.worldSize).metersToTile;j.clear();for(let Q=0;Q<B.length;Q++){const ae=B.get(Q),{tileAnchorX:fe,tileAnchorY:le,numGlyphs:re}=ae,Ce=h.allowVerticalPlacement&&!ae.placedOrientation,we=ae.hidden||!ae.crossTileID||Ce?null:f[ae.crossTileID];if(we){let ve=0,nt=0,Ee=0;if(q){const wt=q?q.getAtTileOffset(E,fe,le):0,[Pt,St,Ht]=Y.upVector(E.canonical,fe,le);ve=wt*Pt*ee,nt=wt*St*ee,Ee=wt*Ht*ee}let[je,De,Ze,Le]=Or(ae.projectedAnchorX+ve,ae.projectedAnchorY+nt,ae.projectedAnchorZ+Ee,s?G:w);const Ye=ht(y.getCameraToCenterDistance(Y),Le);let it=g.evaluateSizeForFeature(h.textSizeData,z,ae)*Ye/u.ONE_EM;s&&(it*=h.tilePixelRatio/C);const be=Vm(we,it);s?({x:je,y:De,z:Ze}=Y.projectTilePoint(fe+be.x,le+be.y,E.canonical),[je,De,Ze]=Or(je+ve,De+nt,Ze+Ee,w)):(r&&be._rotate(-y.angle),je+=be.x,De+=be.y,Ze=0);const Re=h.allowVerticalPlacement&&ae.placedOrientation===u.WritingMode.vertical?Math.PI/2:0;for(let wt=0;wt<re;wt++)u.addDynamicAttributes(j,je,De,Ze,Re);D&&ae.associatedIconIndex>=0&&(X[ae.associatedIconIndex]={x:je,y:De,z:Ze,angle:Re})}else Mr(re,j)}if(D){W.clear();const Q=h.icon.placedSymbolArray;for(let ae=0;ae<Q.length;ae++){const fe=Q.get(ae),{numGlyphs:le}=fe,re=X[ae];if(fe.hidden||!re)Mr(le,W);else{const{x:Ce,y:we,z:ve,angle:nt}=re;for(let Ee=0;Ee<le;Ee++)u.addDynamicAttributes(W,Ce,we,ve,nt)}}h.icon.dynamicLayoutVertexBuffer.updateData(W)}h.text.dynamicLayoutVertexBuffer.updateData(j)}function cp(h,r,s){return s.iconsInText&&r?"symbolTextAndIcon":h?"symbolSDF":"symbolIcon"}function Vl(h,r,s,f,g,y,w,E,C,z,D,B){const j=h.context,W=j.gl,X=h.transform,Y=E==="map",G=C==="map",q=Y&&s.layout.get("symbol-placement")!=="point",ee=Y&&!G&&!q,Q=s.layout.get("symbol-sort-key").constantOr(1)!==void 0;let ae=!1;const fe=h.depthModeForSublayer(0,u.DepthMode.ReadOnly),le=[u.mercatorXfromLng(X.center.lng),u.mercatorYfromLat(X.center.lat)],re=s.layout.get("text-variable-anchor"),Ce=X.projection.name==="globe",we=[],ve=[0,-1,0];let nt=ve;!Ce&&!X.mercatorFromTransition||Y||(nt=function(Ee){const je=Ee._camera.getWorldToCamera(Ee.worldSize,1),De=u.multiply([],je,Ee.globeMatrix);u.invert(De,De);const Ze=[0,0,0],Le=[0,1,0,0];return u.transformMat4$1(Le,Le,De),Ze[0]=Le[0],Ze[1]=Le[1],Ze[2]=Le[2],u.normalize(Ze,Ze),Ze}(X));for(const Ee of f){const je=r.getTile(Ee),De=je.getBucket(s);if(!De||De.projection.name==="mercator"&&Ce)continue;const Ze=g?De.text:De.icon;if(!Ze||De.fullyClipped||!Ze.segments.get().length)continue;const Le=Ze.programConfigurations.get(s.id),Ye=g||De.sdfIcons,it=g?De.textSizeData:De.iconSizeData,be=G||X.pitch!==0,Re=u.evaluateSizeForZoom(it,X.zoom);let wt,Pt,St,Ht,fn=[0,0],Bt=null;if(g){if(Pt=je.glyphAtlasTexture,St=W.LINEAR,wt=je.glyphAtlasTexture.size,De.iconsInText){fn=je.imageAtlasTexture.size,Bt=je.imageAtlasTexture;const vr=it.kind==="composite"||it.kind==="camera";Ht=be||h.options.rotating||h.options.zooming||vr?W.LINEAR:W.NEAREST}}else{const vr=s.layout.get("icon-size").constantOr(0)!==1||De.iconsNeedLinear;Pt=je.imageAtlasTexture,St=Ye||h.options.rotating||h.options.zooming||vr||be?W.LINEAR:W.NEAREST,wt=je.imageAtlasTexture.size}const yt=De.projection.name==="globe",ei=yt?nt:ve,Gn=yt?u.globeToMercatorTransition(X.zoom):0,_i=ts(Ee,De.getProjection(),X),hi=X.calculatePixelsToTileUnitsMatrix(je),Va=Jr(_i,je.tileID.canonical,G,Y,X,De.getProjection(),hi),Qa=h.terrain&&G&&q?u.invert(u.create(),Va):Lc,Ma=Eu(_i,je.tileID.canonical,G,Y,X,De.getProjection(),hi),hs=re&&De.hasTextData(),Mi=s.layout.get("icon-text-fit")!=="none"&&hs&&De.hasIconData();if(q){const vr=X.elevation,Vo=vr?vr.getAtTileOffsetFunc(Ee,X.center.lat,X.worldSize,De.getProjection()):null,ds=el(_i,je.tileID.canonical,G,Y,X,De.getProjection(),hi);hn(De,_i,h,g,ds,Ma,G,z,Vo,Ee)}const yi=q||g&&re||Mi,Fn=h.translatePosMatrix(_i,je,y,w),hr=yi?Lc:Va,Ta=h.translatePosMatrix(Ma,je,y,w,!0),di=De.getProjection().createInversionMatrix(X,Ee.canonical),kt=[];h.terrainRenderModeElevated()&&G&&kt.push("PITCH_WITH_MAP_TERRAIN"),yt&&kt.push("PROJECTION_GLOBE_VIEW"),yi&&kt.push("PROJECTED_POS_ON_VIEWPORT");const Mn=Ye&&s.paint.get(g?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Ln;Ln=Ye?De.iconsInText?zu(it.kind,Re,ee,G,h,Fn,hr,Ta,wt,fn,Ee,Gn,le,di,ei,De.getProjection()):Nl(it.kind,Re,ee,G,h,Fn,hr,Ta,g,wt,!0,Ee,Gn,le,di,ei,De.getProjection()):kc(it.kind,Re,ee,G,h,Fn,hr,Ta,g,wt,Ee,Gn,le,di,ei,De.getProjection());const Wn={program:h.useProgram(cp(Ye,g,De),Le,kt),buffers:Ze,uniformValues:Ln,atlasTexture:Pt,atlasTextureIcon:Bt,atlasInterpolation:St,atlasInterpolationIcon:Ht,isSDF:Ye,hasHalo:Mn,tile:je,labelPlaneMatrixInv:Qa};if(Q&&De.canOverlap){ae=!0;const vr=Ze.segments.get();for(const Vo of vr)we.push({segments:new u.SegmentVector([Vo]),sortKey:Vo.sortKey,state:Wn})}else we.push({segments:Ze.segments,sortKey:0,state:Wn})}ae&&we.sort((Ee,je)=>Ee.sortKey-je.sortKey);for(const Ee of we){const je=Ee.state;if(h.terrain&&h.terrain.setupElevationDraw(je.tile,je.program,{useDepthForOcclusion:!Ce,labelPlaneMatrixInv:je.labelPlaneMatrixInv}),j.activeTexture.set(W.TEXTURE0),je.atlasTexture.bind(je.atlasInterpolation,W.CLAMP_TO_EDGE),je.atlasTextureIcon&&(j.activeTexture.set(W.TEXTURE1),je.atlasTextureIcon&&je.atlasTextureIcon.bind(je.atlasInterpolationIcon,W.CLAMP_TO_EDGE)),je.isSDF){const De=je.uniformValues;je.hasHalo&&(De.u_is_halo=1,Vd(je.buffers,Ee.segments,s,h,je.program,fe,D,B,De)),De.u_is_halo=0}Vd(je.buffers,Ee.segments,s,h,je.program,fe,D,B,je.uniformValues)}}function Vd(h,r,s,f,g,y,w,E,C){const z=f.context,D=[h.dynamicLayoutVertexBuffer,h.opacityVertexBuffer,h.globeExtVertexBuffer];g.draw(z,z.gl.TRIANGLES,y,w,E,u.CullFaceMode.disabled,C,s.id,h.layoutVertexBuffer,h.indexBuffer,r,s.paint,f.transform.zoom,h.programConfigurations.get(s.id),D)}function hp(h,r,s,f,g,y,w){const E=h.context.gl,C=s.paint.get("fill-pattern"),z=C&&C.constantOr(1);let D,B,j,W,X;w?(B=z&&!s.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",D=E.LINES):(B=z?"fillPattern":"fill",D=E.TRIANGLES);for(const Y of f){const G=r.getTile(Y);if(z&&!G.patternsLoaded())continue;const q=G.getBucket(s);if(!q)continue;h.prepareDrawTile();const ee=q.programConfigurations.get(s.id),Q=h.useProgram(B,ee);z&&(h.context.activeTexture.set(E.TEXTURE0),G.imageAtlasTexture.bind(E.LINEAR,E.CLAMP_TO_EDGE),ee.updatePaintBuffers());const ae=C.constantOr(null);if(ae&&G.imageAtlas){const le=G.imageAtlas.patternPositions[ae.toString()];le&&ee.setConstantPatternPositions(le)}const fe=h.translatePosMatrix(Y.projMatrix,G,s.paint.get("fill-translate"),s.paint.get("fill-translate-anchor"));if(w){W=q.indexBuffer2,X=q.segments2;const le=h.terrain&&h.terrain.renderingToTexture?h.terrain.drapeBufferSize:[E.drawingBufferWidth,E.drawingBufferHeight];j=B==="fillOutlinePattern"&&z?cr(fe,h,G,le):Bo(fe,le)}else W=q.indexBuffer,X=q.segments,j=z?ta(fe,h,G):Rc(fe);h.prepareDrawProgram(h.context,Q,Y.toUnwrapped()),Q.draw(h.context,D,g,h.stencilModeForClipping(Y),y,u.CullFaceMode.disabled,j,s.id,q.layoutVertexBuffer,W,X,s.paint,h.transform.zoom,ee)}}function Lh(h,r,s,f,g,y,w){const E=h.context,C=E.gl,z=h.transform,D=s.paint.get("fill-extrusion-pattern"),B=D.constantOr(1),j=s.paint.get("fill-extrusion-opacity"),W=[s.paint.get("fill-extrusion-ambient-occlusion-intensity"),s.paint.get("fill-extrusion-ambient-occlusion-radius")],X=s.layout.get("fill-extrusion-edge-radius"),Y=z.projection.name==="globe"?u.fillExtrusionHeightLift():0,G=z.projection.name==="globe",q=G?u.globeToMercatorTransition(z.zoom):0,ee=[u.mercatorXfromLng(z.center.lng),u.mercatorYfromLat(z.center.lat)],Q=[];G&&(Q.push("PROJECTION_GLOBE_VIEW"),h.style.terrainSetForDrapingOnly()&&Q.push("TERRAIN")),W[0]>0&&Q.push("FAUX_AO");for(const ae of f){const fe=r.getTile(ae),le=fe.getBucket(s);if(!le||le.projection.name!==z.projection.name)continue;const re=le.programConfigurations.get(s.id),Ce=h.useProgram(B?"fillExtrusionPattern":"fillExtrusion",re,Q);if(h.terrain){const Ze=h.terrain;if(h.style.terrainSetForDrapingOnly())Ze.setupElevationDraw(fe,Ce,{useMeterToDem:!0});else{if(!le.enableTerrain)continue;if(Ze.setupElevationDraw(fe,Ce,{useMeterToDem:!0}),jm(E,r,ae,le,s,Ze),!le.centroidVertexBuffer){const Le=Ce.attributes.a_centroid_pos;Le!==void 0&&C.vertexAttrib2f(Le,0,0)}}}B&&(h.context.activeTexture.set(C.TEXTURE0),fe.imageAtlasTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),re.updatePaintBuffers());const we=D.constantOr(null);if(we&&fe.imageAtlas){const Ze=fe.imageAtlas.patternPositions[we.toString()];Ze&&re.setConstantPatternPositions(Ze)}const ve=h.translatePosMatrix(ae.projMatrix,fe,s.paint.get("fill-extrusion-translate"),s.paint.get("fill-extrusion-translate-anchor")),nt=z.projection.createInversionMatrix(z,ae.canonical),Ee=s.paint.get("fill-extrusion-vertical-gradient"),je=B?Ah(ve,h,Ee,j,W,X,ae,fe,Y,q,ee,nt):ip(ve,h,Ee,j,W,X,ae,Y,q,ee,nt);h.prepareDrawProgram(E,Ce,ae.toUnwrapped());const De=[];h.terrain&&De.push(le.centroidVertexBuffer),G&&De.push(le.layoutVertexExtBuffer),Ce.draw(E,E.gl.TRIANGLES,g,y,w,u.CullFaceMode.backCCW,je,s.id,le.layoutVertexBuffer,le.indexBuffer,le.segments,s.paint,h.transform.zoom,re,De)}}function jm(h,r,s,f,g,y){const w=[q=>{let ee=q.canonical.x-1,Q=q.wrap;return ee<0&&(ee=(1<<q.canonical.z)-1,Q--),new u.OverscaledTileID(q.overscaledZ,Q,q.canonical.z,ee,q.canonical.y)},q=>{let ee=q.canonical.x+1,Q=q.wrap;return ee===1<<q.canonical.z&&(ee=0,Q++),new u.OverscaledTileID(q.overscaledZ,Q,q.canonical.z,ee,q.canonical.y)},q=>new u.OverscaledTileID(q.overscaledZ,q.wrap,q.canonical.z,q.canonical.x,(q.canonical.y===0?1<<q.canonical.z:q.canonical.y)-1),q=>new u.OverscaledTileID(q.overscaledZ,q.wrap,q.canonical.z,q.canonical.x,q.canonical.y===(1<<q.canonical.z)-1?0:q.canonical.y+1)],E=q=>{const ee=r.getSource().minzoom,Q=fe=>{const le=r.getTileByID(fe);if(le&&le.hasData())return le.getBucket(g)},ae=[0,-1,1];for(const fe of ae){if(q.overscaledZ+fe<ee)continue;const le=Q(q.calculateScaledKey(q.overscaledZ+fe));if(le)return le}},C=[0,0,0],z=(q,ee)=>(C[0]=Math.min(q.min.y,ee.min.y),C[1]=Math.max(q.max.y,ee.max.y),C[2]=u.EXTENT-ee.min.x>q.max.x?ee.min.x-u.EXTENT:q.max.x,C),D=(q,ee)=>(C[0]=Math.min(q.min.x,ee.min.x),C[1]=Math.max(q.max.x,ee.max.x),C[2]=u.EXTENT-ee.min.y>q.max.y?ee.min.y-u.EXTENT:q.max.y,C),B=[(q,ee)=>z(q,ee),(q,ee)=>z(ee,q),(q,ee)=>D(q,ee),(q,ee)=>D(ee,q)],j=new u.pointGeometry(0,0);let W,X,Y;const G=(q,ee,Q,ae,fe)=>{const le=[[ae?Q:q,ae?q:Q,0],[ae?Q:ee,ae?ee:Q,0]],re=fe<0?u.EXTENT+fe:fe,Ce=[ae?re:(q+ee)/2,ae?(q+ee)/2:re,0];return Q===0&&fe<0||Q!==0&&fe>0?y.getForTilePoints(Y,[Ce],!0,X):le.push(Ce),y.getForTilePoints(s,le,!0,W),Math.max(le[0][2],le[1][2],Ce[2])/y.exaggeration()};for(let q=0;q<4;q++){const ee=(q<2?1:5)-q,Q=f.borders[q];if(Q.length===0)continue;const ae=Y=w[q](s),fe=E(ae);if(!(fe&&fe instanceof u.FillExtrusionBucket&&fe.enableTerrain)||f.borderDoneWithNeighborZ[q]===fe.canonical.z&&fe.borderDoneWithNeighborZ[ee]===f.canonical.z||(X=y.findDEMTileFor(ae),!X||!X.dem))continue;if(!W){const we=y.findDEMTileFor(s);if(!we||!we.dem)return;W=we}const le=fe.borders[ee];let re=0;const Ce=fe.borderDoneWithNeighborZ[ee]!==f.canonical.z;if(f.canonical.z===fe.canonical.z){for(let we=0;we<Q.length;we++){const ve=f.featuresOnBorder[Q[we]],nt=ve.borders[q];let Ee;for(;re<le.length&&(Ee=fe.featuresOnBorder[le[re]],!(Ee.borders[ee][1]>nt[0]+3));)Ce&&fe.encodeCentroid(void 0,Ee,!1),re++;if(Ee&&re<le.length){const je=re;let De=0;for(;!(Ee.borders[ee][0]>nt[1]-3)&&(De++,++re!==le.length);)Ee=fe.featuresOnBorder[le[re]];if(Ee=fe.featuresOnBorder[le[je]],ve.intersectsCount()>1||Ee.intersectsCount()>1||De!==1){De!==1&&(re=je),f.encodeCentroid(void 0,ve,!1),Ce&&fe.encodeCentroid(void 0,Ee,!1);continue}const Ze=B[q](ve,Ee),Le=q%2?u.EXTENT-1:0;j.x=G(Ze[0],Math.min(u.EXTENT-1,Ze[1]),Le,q<2,Ze[2]),j.y=0,f.encodeCentroid(j,ve,!1),Ce&&fe.encodeCentroid(j,Ee,!1)}else f.encodeCentroid(void 0,ve,!1)}f.borderDoneWithNeighborZ[q]=fe.canonical.z,f.needsCentroidUpdate=!0,Ce&&(fe.borderDoneWithNeighborZ[ee]=f.canonical.z,fe.needsCentroidUpdate=!0)}else{for(const we of Q)f.encodeCentroid(void 0,f.featuresOnBorder[we],!1);if(Ce){for(const we of le)fe.encodeCentroid(void 0,fe.featuresOnBorder[we],!1);fe.borderDoneWithNeighborZ[ee]=f.canonical.z,fe.needsCentroidUpdate=!0}f.borderDoneWithNeighborZ[q]=fe.canonical.z,f.needsCentroidUpdate=!0}}(f.needsCentroidUpdate||!f.centroidVertexBuffer&&f.centroidVertexArray.length!==0)&&f.uploadCentroid(h)}const Gm=new u.Color(1,0,0,1),$m=new u.Color(0,1,0,1),jd=new u.Color(0,0,1,1),Oc=new u.Color(1,0,1,1),sl=new u.Color(0,1,1,1);function Pc(h,r,s){const f=h.context,g=h.transform,y=f.gl,w=g.projection.name==="globe",E=w?["PROJECTION_GLOBE_VIEW"]:null;let C=s.projMatrix;if(w&&u.globeToMercatorTransition(g.zoom)>0){const ve=u.transitionTileAABBinECEF(s.canonical,g),nt=u.globeDenormalizeECEF(ve);C=u.multiply(new Float32Array(16),g.globeMatrix,nt),u.multiply(C,g.projMatrix,C)}const z=h.useProgram("debug",null,E),D=r.getTileByID(s.key);h.terrain&&h.terrain.setupElevationDraw(D,z);const B=u.DepthMode.disabled,j=u.StencilMode.disabled,W=h.colorModeForRenderPass(),X="$debug";f.activeTexture.set(y.TEXTURE0),h.emptyTexture.bind(y.LINEAR,y.CLAMP_TO_EDGE),w?D._makeGlobeTileDebugBuffers(h.context,g):D._makeDebugTileBoundsBuffers(h.context,g.projection);const Y=D._tileDebugBuffer||h.debugBuffer,G=D._tileDebugIndexBuffer||h.debugIndexBuffer,q=D._tileDebugSegments||h.debugSegments;z.draw(f,y.LINE_STRIP,B,j,W,u.CullFaceMode.disabled,as(C,u.Color.red),X,Y,G,q,null,null,null,[D._globeTileDebugBorderBuffer]);const ee=D.latestRawTileData,Q=Math.floor((ee&&ee.byteLength||0)/1024),ae=r.getTile(s).tileSize,fe=512/Math.min(ae,512)*(s.overscaledZ/g.zoom)*.5;let le=s.canonical.toString();s.overscaledZ!==s.canonical.z&&(le+=` => ${s.overscaledZ}`),le+=` ${Q}kb`,function(ve,nt){ve.initDebugOverlayCanvas();const Ee=ve.debugOverlayCanvas,je=ve.context.gl,De=ve.debugOverlayCanvas.getContext("2d");De.clearRect(0,0,Ee.width,Ee.height),De.shadowColor="white",De.shadowBlur=2,De.lineWidth=1.5,De.strokeStyle="white",De.textBaseline="top",De.font="bold 36px Open Sans, sans-serif",De.fillText(nt,5,5),De.strokeText(nt,5,5),ve.debugOverlayTexture.update(Ee),ve.debugOverlayTexture.bind(je.LINEAR,je.CLAMP_TO_EDGE)}(h,le);const re=D._tileDebugTextBuffer||h.debugBuffer,Ce=D._tileDebugTextIndexBuffer||h.quadTriangleIndexBuffer,we=D._tileDebugTextSegments||h.debugSegments;z.draw(f,y.TRIANGLES,B,j,u.ColorMode.alphaBlended,u.CullFaceMode.disabled,as(C,u.Color.transparent,fe),X,re,Ce,we,null,null,null,[D._globeTileDebugTextBuffer])}function Oh(h,r,s,f){ss(h,0,r+s/2,h.transform.width,s,f)}function Bs(h,r,s,f){ss(h,r-s/2,0,s,h.transform.height,f)}function ss(h,r,s,f,g,y){const w=h.context,E=w.gl;E.enable(E.SCISSOR_TEST),E.scissor(r*u.exported.devicePixelRatio,s*u.exported.devicePixelRatio,f*u.exported.devicePixelRatio,g*u.exported.devicePixelRatio),w.clear({color:y}),E.disable(E.SCISSOR_TEST)}const Bc=u.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:dp}=Bc;function Ja(h,r,s,f){h.emplaceBack(r,s,f)}class jl{constructor(r){this.vertexArray=new u.StructArrayLayout3f12,this.indices=new u.StructArrayLayout3ui6,Ja(this.vertexArray,-1,-1,1),Ja(this.vertexArray,1,-1,1),Ja(this.vertexArray,-1,1,1),Ja(this.vertexArray,1,1,1),Ja(this.vertexArray,-1,-1,-1),Ja(this.vertexArray,1,-1,-1),Ja(this.vertexArray,-1,1,-1),Ja(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=r.createVertexBuffer(this.vertexArray,dp),this.indexBuffer=r.createIndexBuffer(this.indices),this.segment=u.SegmentVector.simpleSegment(0,0,36,12)}}function ll(h,r,s,f,g,y){const w=h.gl,E=r.paint.get("sky-atmosphere-color"),C=r.paint.get("sky-atmosphere-halo-color"),z=r.paint.get("sky-atmosphere-sun-intensity"),D=((B,j,W,X,Y)=>({u_matrix_3f:B,u_sun_direction:j,u_sun_intensity:W,u_color_tint_r:[X.r,X.g,X.b,X.a],u_color_tint_m:[Y.r,Y.g,Y.b,Y.a],u_luminance:5e-5}))(u.fromMat4(u.create$1(),f),g,z,E,C);w.framebufferTexture2D(w.FRAMEBUFFER,w.COLOR_ATTACHMENT0,w.TEXTURE_CUBE_MAP_POSITIVE_X+y,r.skyboxTexture,0),s.draw(h,w.TRIANGLES,u.DepthMode.disabled,u.StencilMode.disabled,u.ColorMode.unblended,u.CullFaceMode.frontCW,D,"skyboxCapture",r.skyboxGeometry.vertexBuffer,r.skyboxGeometry.indexBuffer,r.skyboxGeometry.segment)}const Gd=u.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Xn{constructor(r){const s=new u.StructArrayLayout5f20;s.emplaceBack(-1,1,1,0,0),s.emplaceBack(1,1,1,1,0),s.emplaceBack(1,-1,1,1,1),s.emplaceBack(-1,-1,1,0,1);const f=new u.StructArrayLayout3ui6;f.emplaceBack(0,1,2),f.emplaceBack(2,3,0),this.vertexBuffer=r.createVertexBuffer(s,Gd.members),this.indexBuffer=r.createIndexBuffer(f),this.segments=u.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Pr={symbol:function(h,r,s,f,g){if(h.renderPass!=="translucent")return;const y=u.StencilMode.disabled,w=h.colorModeForRenderPass();s.layout.get("text-variable-anchor")&&function(E,C,z,D,B,j,W){const X=C.transform,Y=B==="map",G=j==="map";for(const q of E){const ee=D.getTile(q),Q=ee.getBucket(z);if(!Q||!Q.text||!Q.text.segments.get().length)continue;const ae=u.evaluateSizeForZoom(Q.textSizeData,X.zoom),fe=ts(q,Q.getProjection(),X),le=X.calculatePixelsToTileUnitsMatrix(ee),re=Jr(fe,ee.tileID.canonical,G,Y,X,Q.getProjection(),le),Ce=z.layout.get("icon-text-fit")!=="none"&&Q.hasIconData();if(ae){const we=Math.pow(2,X.zoom-ee.tileID.overscaledZ);up(Q,Y,G,W,u.symbolSize,X,re,q,we,ae,Ce)}}}(f,h,s,r,s.layout.get("text-rotation-alignment"),s.layout.get("text-pitch-alignment"),g),s.paint.get("icon-opacity").constantOr(1)!==0&&Vl(h,r,s,f,!1,s.paint.get("icon-translate"),s.paint.get("icon-translate-anchor"),s.layout.get("icon-rotation-alignment"),s.layout.get("icon-pitch-alignment"),s.layout.get("icon-keep-upright"),y,w),s.paint.get("text-opacity").constantOr(1)!==0&&Vl(h,r,s,f,!0,s.paint.get("text-translate"),s.paint.get("text-translate-anchor"),s.layout.get("text-rotation-alignment"),s.layout.get("text-pitch-alignment"),s.layout.get("text-keep-upright"),y,w),r.map.showCollisionBoxes&&(lp(h,r,s,f,s.paint.get("text-translate"),s.paint.get("text-translate-anchor"),!0),lp(h,r,s,f,s.paint.get("icon-translate"),s.paint.get("icon-translate-anchor"),!1))},circle:function(h,r,s,f){if(h.renderPass!=="translucent")return;const g=s.paint.get("circle-opacity"),y=s.paint.get("circle-stroke-width"),w=s.paint.get("circle-stroke-opacity"),E=s.layout.get("circle-sort-key").constantOr(1)!==void 0;if(g.constantOr(1)===0&&(y.constantOr(1)===0||w.constantOr(1)===0))return;const C=h.context,z=C.gl,D=h.transform,B=h.depthModeForSublayer(0,u.DepthMode.ReadOnly),j=u.StencilMode.disabled,W=h.colorModeForRenderPass(),X=D.projection.name==="globe",Y=[u.mercatorXfromLng(D.center.lng),u.mercatorYfromLat(D.center.lat)],G=[];for(let ee=0;ee<f.length;ee++){const Q=f[ee],ae=r.getTile(Q),fe=ae.getBucket(s);if(!fe||fe.projection.name!==D.projection.name)continue;const le=fe.programConfigurations.get(s.id),re=Dh(s);X&&re.push("PROJECTION_GLOBE_VIEW");const Ce=h.useProgram("circle",le,re),we=fe.layoutVertexBuffer,ve=fe.globeExtVertexBuffer,nt=fe.indexBuffer,Ee=D.projection.createInversionMatrix(D,Q.canonical),je={programConfiguration:le,program:Ce,layoutVertexBuffer:we,globeExtVertexBuffer:ve,indexBuffer:nt,uniformValues:Rh(h,Q,ae,Ee,Y,s),tile:ae};if(E){const De=fe.segments.get();for(const Ze of De)G.push({segments:new u.SegmentVector([Ze]),sortKey:Ze.sortKey,state:je})}else G.push({segments:fe.segments,sortKey:0,state:je})}E&&G.sort((ee,Q)=>ee.sortKey-Q.sortKey);const q={useDepthForOcclusion:!X};for(const ee of G){const{programConfiguration:Q,program:ae,layoutVertexBuffer:fe,globeExtVertexBuffer:le,indexBuffer:re,uniformValues:Ce,tile:we}=ee.state,ve=ee.segments;h.terrain&&h.terrain.setupElevationDraw(we,ae,q),h.prepareDrawProgram(C,ae,we.tileID.toUnwrapped()),ae.draw(C,z.TRIANGLES,B,j,W,u.CullFaceMode.disabled,Ce,s.id,fe,re,ve,s.paint,D.zoom,Q,[le])}},heatmap:function(h,r,s,f){if(s.paint.get("heatmap-opacity")!==0)if(h.renderPass==="offscreen"){const g=h.context,y=g.gl,w=u.StencilMode.disabled,E=new u.ColorMode([y.ONE,y.ONE],u.Color.transparent,[!0,!0,!0,!0]);(function(W,X,Y,G){const q=W.gl,ee=X.width*G,Q=X.height*G;W.activeTexture.set(q.TEXTURE1),W.viewport.set([0,0,ee,Q]);let ae=Y.heatmapFbo;if(!ae||ae&&(ae.width!==ee||ae.height!==Q)){ae&&ae.destroy();const fe=q.createTexture();q.bindTexture(q.TEXTURE_2D,fe),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_WRAP_S,q.CLAMP_TO_EDGE),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_WRAP_T,q.CLAMP_TO_EDGE),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_MIN_FILTER,q.LINEAR),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_MAG_FILTER,q.LINEAR),ae=Y.heatmapFbo=W.createFramebuffer(ee,Q,!1),function(le,re,Ce,we,ve,nt){const Ee=le.gl;Ee.texImage2D(Ee.TEXTURE_2D,0,Ee.RGBA,ve,nt,0,Ee.RGBA,le.extRenderToTextureHalfFloat?le.extTextureHalfFloat.HALF_FLOAT_OES:Ee.UNSIGNED_BYTE,null),we.colorAttachment.set(Ce)}(W,0,fe,ae,ee,Q)}else q.bindTexture(q.TEXTURE_2D,ae.colorAttachment.get()),W.bindFramebuffer.set(ae.framebuffer)})(g,h,s,h.transform.projection.name==="globe"?.5:.25),g.clear({color:u.Color.transparent});const C=h.transform,z=C.projection.name==="globe",D=z?["PROJECTION_GLOBE_VIEW"]:null,B=z?u.CullFaceMode.frontCCW:u.CullFaceMode.disabled,j=[u.mercatorXfromLng(C.center.lng),u.mercatorYfromLat(C.center.lat)];for(let W=0;W<f.length;W++){const X=f[W];if(r.hasRenderableParent(X))continue;const Y=r.getTile(X),G=Y.getBucket(s);if(!G||G.projection.name!==C.projection.name)continue;const q=G.programConfigurations.get(s.id),ee=h.useProgram("heatmap",q,D),{zoom:Q}=h.transform;h.terrain&&h.terrain.setupElevationDraw(Y,ee),h.prepareDrawProgram(g,ee,X.toUnwrapped());const ae=C.projection.createInversionMatrix(C,X.canonical);ee.draw(g,y.TRIANGLES,u.DepthMode.disabled,w,E,B,zh(h,X,Y,ae,j,Q,s.paint.get("heatmap-intensity")),s.id,G.layoutVertexBuffer,G.indexBuffer,G.segments,s.paint,h.transform.zoom,q,z?[G.globeExtVertexBuffer]:null)}g.viewport.set([0,0,h.width,h.height])}else h.renderPass==="translucent"&&(h.context.setColorMode(h.colorModeForRenderPass()),function(g,y){const w=g.context,E=w.gl,C=y.heatmapFbo;if(!C)return;w.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,C.colorAttachment.get()),w.activeTexture.set(E.TEXTURE1);let z=y.colorRampTexture;z||(z=y.colorRampTexture=new u.Texture(w,y.colorRamp,E.RGBA)),z.bind(E.LINEAR,E.CLAMP_TO_EDGE),g.useProgram("heatmapTexture").draw(w,E.TRIANGLES,u.DepthMode.disabled,u.StencilMode.disabled,g.colorModeForRenderPass(),u.CullFaceMode.disabled,((D,B,j,W)=>({u_image:0,u_color_ramp:1,u_opacity:B.paint.get("heatmap-opacity")}))(0,y),y.id,g.viewportBuffer,g.quadTriangleIndexBuffer,g.viewportSegments,y.paint,g.transform.zoom)}(h,s))},line:function(h,r,s,f){if(h.renderPass!=="translucent")return;const g=s.paint.get("line-opacity"),y=s.paint.get("line-width");if(g.constantOr(1)===0||y.constantOr(1)===0)return;const w=h.depthModeForSublayer(0,u.DepthMode.ReadOnly),E=h.colorModeForRenderPass(),C=h.terrain&&h.terrain.renderingToTexture?1:u.exported.devicePixelRatio,z=s.paint.get("line-dasharray"),D=z.constantOr(1),B=s.layout.get("line-cap"),j=s.paint.get("line-pattern"),W=j.constantOr(1),X=s.paint.get("line-gradient"),Y=W?"linePattern":"line",G=h.context,q=G.gl,ee=(ae=>{const fe=[];Ic(ae)&&fe.push("RENDER_LINE_DASH"),ae.paint.get("line-gradient")&&fe.push("RENDER_LINE_GRADIENT");const le=ae.paint.get("line-trim-offset");le[0]===0&&le[1]===0||fe.push("RENDER_LINE_TRIM_OFFSET");const re=ae.paint.get("line-pattern").constantOr(1),Ce=ae.paint.get("line-opacity").constantOr(1)!==1;return!re&&Ce&&fe.push("RENDER_LINE_ALPHA_DISCARD"),fe})(s);let Q=ee.includes("RENDER_LINE_ALPHA_DISCARD");h.terrain&&h.terrain.clipOrMaskOverlapStencilType()&&(Q=!1);for(const ae of f){const fe=r.getTile(ae);if(W&&!fe.patternsLoaded())continue;const le=fe.getBucket(s);if(!le)continue;h.prepareDrawTile();const re=le.programConfigurations.get(s.id),Ce=h.useProgram(Y,re,ee),we=j.constantOr(null);if(we&&fe.imageAtlas){const Ye=fe.imageAtlas.patternPositions[we.toString()];Ye&&re.setConstantPatternPositions(Ye)}const ve=z.constantOr(null),nt=B.constantOr(null);if(!W&&ve&&nt&&fe.lineAtlas){const Ye=fe.lineAtlas.getDash(ve,nt);Ye&&re.setConstantPatternPositions(Ye)}let[Ee,je]=s.paint.get("line-trim-offset");(nt==="round"||nt==="square")&&Ee!==je&&(Ee===0&&(Ee-=1),je===1&&(je+=1));const De=h.terrain?ae.projMatrix:null,Ze=W?os(h,fe,s,De,C):zc(h,fe,s,De,le.lineClipsArray.length,C,[Ee,je]);if(X){const Ye=le.gradients[s.id];let it=Ye.texture;if(s.gradientVersion!==Ye.version){let be=256;if(s.stepInterpolant){const Re=r.getSource().maxzoom,wt=ae.canonical.z===Re?Math.ceil(1<<h.transform.maxZoom-ae.canonical.z):1;be=u.clamp(u.nextPowerOfTwo(le.maxLineLength/u.EXTENT*1024*wt),256,G.maxTextureSize)}Ye.gradient=u.renderColorRamp({expression:s.gradientExpression(),evaluationKey:"lineProgress",resolution:be,image:Ye.gradient||void 0,clips:le.lineClipsArray}),Ye.texture?Ye.texture.update(Ye.gradient):Ye.texture=new u.Texture(G,Ye.gradient,q.RGBA),Ye.version=s.gradientVersion,it=Ye.texture}G.activeTexture.set(q.TEXTURE1),it.bind(s.stepInterpolant?q.NEAREST:q.LINEAR,q.CLAMP_TO_EDGE)}D&&(G.activeTexture.set(q.TEXTURE0),fe.lineAtlasTexture.bind(q.LINEAR,q.REPEAT),re.updatePaintBuffers()),W&&(G.activeTexture.set(q.TEXTURE0),fe.imageAtlasTexture.bind(q.LINEAR,q.CLAMP_TO_EDGE),re.updatePaintBuffers()),h.prepareDrawProgram(G,Ce,ae.toUnwrapped());const Le=Ye=>{Ce.draw(G,q.TRIANGLES,w,Ye,E,u.CullFaceMode.disabled,Ze,s.id,le.layoutVertexBuffer,le.indexBuffer,le.segments,s.paint,h.transform.zoom,re,[le.layoutVertexBuffer2])};if(Q){const Ye=h.stencilModeForClipping(ae).ref;Ye===0&&h.terrain&&G.clear({stencil:0});const it={func:q.EQUAL,mask:255};Ze.u_alpha_discard_threshold=.8,Le(new u.StencilMode(it,Ye,255,q.KEEP,q.KEEP,q.INVERT)),Ze.u_alpha_discard_threshold=0,Le(new u.StencilMode(it,Ye,255,q.KEEP,q.KEEP,q.KEEP))}else Le(h.stencilModeForClipping(ae))}Q&&(h.resetStencilClippingMasks(),h.terrain&&G.clear({stencil:0}))},fill:function(h,r,s,f){const g=s.paint.get("fill-color"),y=s.paint.get("fill-opacity");if(y.constantOr(1)===0)return;const w=h.colorModeForRenderPass(),E=s.paint.get("fill-pattern"),C=h.opaquePassEnabledForLayer()&&!E.constantOr(1)&&g.constantOr(u.Color.transparent).a===1&&y.constantOr(0)===1?"opaque":"translucent";if(h.renderPass===C){const z=h.depthModeForSublayer(1,h.renderPass==="opaque"?u.DepthMode.ReadWrite:u.DepthMode.ReadOnly);hp(h,r,s,f,z,w,!1)}if(h.renderPass==="translucent"&&s.paint.get("fill-antialias")){const z=h.depthModeForSublayer(s.getPaintProperty("fill-outline-color")?2:0,u.DepthMode.ReadOnly);hp(h,r,s,f,z,w,!0)}},"fill-extrusion":function(h,r,s,f){const g=s.paint.get("fill-extrusion-opacity");if(g!==0&&h.renderPass==="translucent"){const y=new u.DepthMode(h.context.gl.LEQUAL,u.DepthMode.ReadWrite,h.depthRangeFor3D);if(g!==1||s.paint.get("fill-extrusion-pattern").constantOr(1))Lh(h,r,s,f,y,u.StencilMode.disabled,u.ColorMode.disabled),Lh(h,r,s,f,y,h.stencilModeFor3D(),h.colorModeForRenderPass()),h.resetStencilClippingMasks();else{const w=h.colorModeForRenderPass();Lh(h,r,s,f,y,u.StencilMode.disabled,w)}}},hillshade:function(h,r,s,f){if(h.renderPass!=="offscreen"&&h.renderPass!=="translucent")return;const g=h.context,y=h.depthModeForSublayer(0,u.DepthMode.ReadOnly),w=h.colorModeForRenderPass(),E=h.terrain&&h.terrain.renderingToTexture,[C,z]=h.renderPass!=="translucent"||E?[{},f]:h.stencilConfigForOverlap(f);for(const D of z){const B=r.getTile(D);if(B.needsHillshadePrepare&&h.renderPass==="offscreen")yo(h,B,s,y,u.StencilMode.disabled,w);else if(h.renderPass==="translucent"){const j=E&&h.terrain?h.terrain.stencilModeForRTTOverlap(D):C[D.overscaledZ];Bl(h,D,B,s,y,j,w)}}g.viewport.set([0,0,h.width,h.height]),h.resetStencilClippingMasks()},raster:function(h,r,s,f,g,y){if(h.renderPass!=="translucent"||s.paint.get("raster-opacity")===0||!f.length)return;const w=h.context,E=w.gl,C=r.getSource(),z=h.useProgram("raster"),D=h.colorModeForRenderPass(),B=h.terrain&&h.terrain.renderingToTexture,[j,W]=C instanceof Z||B?[{},f]:h.stencilConfigForOverlap(f),X=W[W.length-1].overscaledZ,Y=!h.options.moving;for(const G of W){const q=B?u.DepthMode.disabled:h.depthModeForSublayer(G.overscaledZ-X,s.paint.get("raster-opacity")===1?u.DepthMode.ReadWrite:u.DepthMode.ReadOnly,E.LESS),ee=G.toUnwrapped(),Q=r.getTile(G);if(B&&(!Q||!Q.hasData()))continue;const ae=B?G.projMatrix:h.transform.calculateProjMatrix(ee,Y),fe=h.terrain&&B?h.terrain.stencilModeForRTTOverlap(G):j[G.overscaledZ],le=y?0:s.paint.get("raster-fade-duration");Q.registerFadeDuration(le);const re=r.findLoadedParent(G,0),Ce=Mc(Q,re,r,h.transform,le);let we,ve;h.terrain&&h.terrain.prepareDrawTile();const nt=s.paint.get("raster-resampling")==="nearest"?E.NEAREST:E.LINEAR;w.activeTexture.set(E.TEXTURE0),Q.texture.bind(nt,E.CLAMP_TO_EDGE),w.activeTexture.set(E.TEXTURE1),re?(re.texture.bind(nt,E.CLAMP_TO_EDGE),we=Math.pow(2,re.tileID.overscaledZ-Q.tileID.overscaledZ),ve=[Q.tileID.canonical.x*we%1,Q.tileID.canonical.y*we%1]):Q.texture.bind(nt,E.CLAMP_TO_EDGE);const Ee=ap(ae,ve||[0,0],we||1,Ce,s,C instanceof Z?C.perspectiveTransform:[0,0]);if(h.prepareDrawProgram(w,z,ee),C instanceof Z)C.boundsBuffer&&C.boundsSegments&&z.draw(w,E.TRIANGLES,q,u.StencilMode.disabled,D,u.CullFaceMode.disabled,Ee,s.id,C.boundsBuffer,h.quadTriangleIndexBuffer,C.boundsSegments);else{const{tileBoundsBuffer:je,tileBoundsIndexBuffer:De,tileBoundsSegments:Ze}=h.getTileBoundsBuffers(Q);z.draw(w,E.TRIANGLES,q,fe,D,u.CullFaceMode.disabled,Ee,s.id,je,De,Ze)}}h.resetStencilClippingMasks()},background:function(h,r,s,f){const g=s.paint.get("background-color"),y=s.paint.get("background-opacity");if(y===0)return;const w=h.context,E=w.gl,C=h.transform,z=C.tileSize,D=s.paint.get("background-pattern");if(h.isPatternMissing(D))return;const B=!D&&g.a===1&&y===1&&h.opaquePassEnabledForLayer()?"opaque":"translucent";if(h.renderPass!==B)return;const j=u.StencilMode.disabled,W=h.depthModeForSublayer(0,B==="opaque"?u.DepthMode.ReadWrite:u.DepthMode.ReadOnly),X=h.colorModeForRenderPass(),Y=h.useProgram(D?"backgroundPattern":"background");let G,q=f;q||(G=h.getBackgroundTiles(),q=Object.values(G).map(ee=>ee.tileID)),D&&(w.activeTexture.set(E.TEXTURE0),h.imageManager.bind(h.context));for(const ee of q){const Q=ee.toUnwrapped(),ae=f?ee.projMatrix:h.transform.calculateProjMatrix(Q);h.prepareDrawTile();const fe=r?r.getTile(ee):G?G[ee.key]:new u.Tile(ee,z,C.zoom,h),le=D?kh(ae,y,h,D,{tileID:ee,tileSize:z}):sp(ae,y,g);h.prepareDrawProgram(w,Y,Q);const{tileBoundsBuffer:re,tileBoundsIndexBuffer:Ce,tileBoundsSegments:we}=h.getTileBoundsBuffers(fe);Y.draw(w,E.TRIANGLES,W,j,X,u.CullFaceMode.disabled,le,s.id,re,Ce,we)}},sky:function(h,r,s){const f=h.transform,g=f.projection.name==="mercator"||f.projection.name==="globe"?1:u.smoothstep(7,8,f.zoom),y=s.paint.get("sky-opacity")*g;if(y===0)return;const w=h.context,E=s.paint.get("sky-type"),C=new u.DepthMode(w.gl.LEQUAL,u.DepthMode.ReadOnly,[0,1]),z=h.frameCounter/1e3%1;E==="atmosphere"?h.renderPass==="offscreen"?s.needsSkyboxCapture(h)&&(function(D,B,j,W){const X=D.context,Y=X.gl;let G=B.skyboxFbo;if(!G){G=B.skyboxFbo=X.createFramebuffer(32,32,!1),B.skyboxGeometry=new jl(X),B.skyboxTexture=X.gl.createTexture(),Y.bindTexture(Y.TEXTURE_CUBE_MAP,B.skyboxTexture),Y.texParameteri(Y.TEXTURE_CUBE_MAP,Y.TEXTURE_WRAP_S,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_CUBE_MAP,Y.TEXTURE_WRAP_T,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_CUBE_MAP,Y.TEXTURE_MIN_FILTER,Y.LINEAR),Y.texParameteri(Y.TEXTURE_CUBE_MAP,Y.TEXTURE_MAG_FILTER,Y.LINEAR);for(let ae=0;ae<6;++ae)Y.texImage2D(Y.TEXTURE_CUBE_MAP_POSITIVE_X+ae,0,Y.RGBA,32,32,0,Y.RGBA,Y.UNSIGNED_BYTE,null)}X.bindFramebuffer.set(G.framebuffer),X.viewport.set([0,0,32,32]);const q=B.getCenter(D,!0),ee=D.useProgram("skyboxCapture"),Q=new Float64Array(16);u.identity(Q),u.rotateY(Q,Q,.5*-Math.PI),ll(X,B,ee,Q,q,0),u.identity(Q),u.rotateY(Q,Q,.5*Math.PI),ll(X,B,ee,Q,q,1),u.identity(Q),u.rotateX(Q,Q,.5*-Math.PI),ll(X,B,ee,Q,q,2),u.identity(Q),u.rotateX(Q,Q,.5*Math.PI),ll(X,B,ee,Q,q,3),u.identity(Q),ll(X,B,ee,Q,q,4),u.identity(Q),u.rotateY(Q,Q,Math.PI),ll(X,B,ee,Q,q,5),X.viewport.set([0,0,D.width,D.height])}(h,s),s.markSkyboxValid(h)):h.renderPass==="sky"&&function(D,B,j,W,X){const Y=D.context,G=Y.gl,q=D.transform,ee=D.useProgram("skybox");Y.activeTexture.set(G.TEXTURE0),G.bindTexture(G.TEXTURE_CUBE_MAP,B.skyboxTexture);const Q=((ae,fe,le,re,Ce)=>({u_matrix:ae,u_sun_direction:fe,u_cubemap:0,u_opacity:re,u_temporal_offset:Ce}))(q.skyboxMatrix,B.getCenter(D,!1),0,W,X);D.prepareDrawProgram(Y,ee),ee.draw(Y,G.TRIANGLES,j,u.StencilMode.disabled,D.colorModeForRenderPass(),u.CullFaceMode.backCW,Q,"skybox",B.skyboxGeometry.vertexBuffer,B.skyboxGeometry.indexBuffer,B.skyboxGeometry.segment)}(h,s,C,y,z):E==="gradient"&&h.renderPass==="sky"&&function(D,B,j,W,X){const Y=D.context,G=Y.gl,q=D.transform,ee=D.useProgram("skyboxGradient");B.skyboxGeometry||(B.skyboxGeometry=new jl(Y)),Y.activeTexture.set(G.TEXTURE0);let Q=B.colorRampTexture;Q||(Q=B.colorRampTexture=new u.Texture(Y,B.colorRamp,G.RGBA)),Q.bind(G.LINEAR,G.CLAMP_TO_EDGE);const ae=((fe,le,re,Ce,we)=>({u_matrix:fe,u_color_ramp:0,u_center_direction:le,u_radius:u.degToRad(re),u_opacity:Ce,u_temporal_offset:we}))(q.skyboxMatrix,B.getCenter(D,!1),B.paint.get("sky-gradient-radius"),W,X);D.prepareDrawProgram(Y,ee),ee.draw(Y,G.TRIANGLES,j,u.StencilMode.disabled,D.colorModeForRenderPass(),u.CullFaceMode.backCW,ae,"skyboxGradient",B.skyboxGeometry.vertexBuffer,B.skyboxGeometry.indexBuffer,B.skyboxGeometry.segment)}(h,s,C,y,z)},debug:function(h,r,s){for(let f=0;f<s.length;f++)Pc(h,r,s[f])},custom:function(h,r,s){const f=h.context,g=s.implementation;if(h.transform.projection.unsupportedLayers&&h.transform.projection.unsupportedLayers.includes("custom"))u.warnOnce("Custom layers are not yet supported with non-mercator projections. Use mercator to enable custom layers.");else if(h.renderPass==="offscreen"){const y=g.prerender;y&&(h.setCustomLayerDefaults(),f.setColorMode(h.colorModeForRenderPass()),y.call(g,f.gl,h.transform.customLayerMatrix()),f.setDirty(),h.setBaseState())}else if(h.renderPass==="translucent"){h.setCustomLayerDefaults(),f.setColorMode(h.colorModeForRenderPass()),f.setStencilMode(u.StencilMode.disabled);const y=g.renderingMode==="3d"?new u.DepthMode(h.context.gl.LEQUAL,u.DepthMode.ReadWrite,h.depthRangeFor3D):h.depthModeForSublayer(0,u.DepthMode.ReadOnly);f.setDepthMode(y),g.render(f.gl,h.transform.customLayerMatrix()),f.setDirty(),h.setBaseState(),f.bindFramebuffer.set(null)}}};class fp{constructor(r,s){this.context=new P(r),this.transform=s,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=u.SourceCache.maxUnderzooming+u.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Na,this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(r,s){const f=!!r&&!!r.terrain&&this.transform.projection.supportsTerrain;if(!(f||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new np(this,r));const g=this._terrain;this.transform.elevation=f?g:null,g.update(r,this.transform,s)}_updateFog(r){const s=r.fog;if(!s||this.transform.projection.name==="globe"||s.getOpacity(this.transform.pitch)<1||s.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[f,g]=s.getFovAdjustedRange(this.transform._fov);if(f>g)return void(this.transform.fogCullDistSq=null);const y=f+.78*(g-f);this.transform.fogCullDistSq=y*y}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(r,s){if(this.width=r*u.exported.devicePixelRatio,this.height=s*u.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const f of this.style.order)this.style._layers[f].resize()}setup(){const r=this.context,s=new u.StructArrayLayout2i4;s.emplaceBack(0,0),s.emplaceBack(u.EXTENT,0),s.emplaceBack(0,u.EXTENT),s.emplaceBack(u.EXTENT,u.EXTENT),this.tileExtentBuffer=r.createVertexBuffer(s,u.posAttributes.members),this.tileExtentSegments=u.SegmentVector.simpleSegment(0,0,4,2);const f=new u.StructArrayLayout2i4;f.emplaceBack(0,0),f.emplaceBack(u.EXTENT,0),f.emplaceBack(0,u.EXTENT),f.emplaceBack(u.EXTENT,u.EXTENT),this.debugBuffer=r.createVertexBuffer(f,u.posAttributes.members),this.debugSegments=u.SegmentVector.simpleSegment(0,0,4,5);const g=new u.StructArrayLayout2i4;g.emplaceBack(-1,-1),g.emplaceBack(1,-1),g.emplaceBack(-1,1),g.emplaceBack(1,1),this.viewportBuffer=r.createVertexBuffer(g,u.posAttributes.members),this.viewportSegments=u.SegmentVector.simpleSegment(0,0,4,2);const y=new u.StructArrayLayout4i8;y.emplaceBack(0,0,0,0),y.emplaceBack(u.EXTENT,0,u.EXTENT,0),y.emplaceBack(0,u.EXTENT,0,u.EXTENT),y.emplaceBack(u.EXTENT,u.EXTENT,u.EXTENT,u.EXTENT),this.mercatorBoundsBuffer=r.createVertexBuffer(y,u.boundsAttributes.members),this.mercatorBoundsSegments=u.SegmentVector.simpleSegment(0,0,4,2);const w=new u.StructArrayLayout3ui6;w.emplaceBack(0,1,2),w.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=r.createIndexBuffer(w);const E=new u.StructArrayLayout1ui2;for(const z of[0,1,3,2,0])E.emplaceBack(z);this.debugIndexBuffer=r.createIndexBuffer(E),this.emptyTexture=new u.Texture(r,new u.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),r.gl.RGBA),this.identityMat=u.create();const C=this.context.gl;this.stencilClearMode=new u.StencilMode({func:C.ALWAYS,mask:0},0,255,C.ZERO,C.ZERO,C.ZERO),this.loadTimeStamps.push(u.window.performance.now()),this.atmosphereBuffer=new Xn(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(r){return r._makeTileBoundsBuffers(this.context,this.transform.projection),r._tileBoundsBuffer?{tileBoundsBuffer:r._tileBoundsBuffer,tileBoundsIndexBuffer:r._tileBoundsIndexBuffer,tileBoundsSegments:r._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const r=this.context,s=r.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(r,s.TRIANGLES,u.DepthMode.disabled,this.stencilClearMode,u.ColorMode.disabled,u.CullFaceMode.disabled,Ru(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(r,s,f){if(!s||this.currentStencilSource===s.id||!r.isTileClipped()||!f||f.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let E=!1;for(const C of f)if(this._tileClippingMaskIDs[C.key]===void 0){E=!0;break}if(!E)return}this.currentStencilSource=s.id;const g=this.context,y=g.gl;this.nextStencilID+f.length>256&&this.clearStencil(),g.setColorMode(u.ColorMode.disabled),g.setDepthMode(u.DepthMode.disabled);const w=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const E of f){const C=s.getTile(E),z=this._tileClippingMaskIDs[E.key]=this.nextStencilID++,{tileBoundsBuffer:D,tileBoundsIndexBuffer:B,tileBoundsSegments:j}=this.getTileBoundsBuffers(C);w.draw(g,y.TRIANGLES,u.DepthMode.disabled,new u.StencilMode({func:y.ALWAYS,mask:0},z,255,y.KEEP,y.KEEP,y.REPLACE),u.ColorMode.disabled,u.CullFaceMode.disabled,Ru(E.projMatrix),"$clipping",D,B,j)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const r=this.nextStencilID++,s=this.context.gl;return new u.StencilMode({func:s.NOTEQUAL,mask:255},r,255,s.KEEP,s.KEEP,s.REPLACE)}stencilModeForClipping(r){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(r);const s=this.context.gl;return new u.StencilMode({func:s.EQUAL,mask:255},this._tileClippingMaskIDs[r.key],0,s.KEEP,s.KEEP,s.REPLACE)}stencilConfigForOverlap(r){const s=this.context.gl,f=r.sort((w,E)=>E.overscaledZ-w.overscaledZ),g=f[f.length-1].overscaledZ,y=f[0].overscaledZ-g+1;if(y>1){this.currentStencilSource=void 0,this.nextStencilID+y>256&&this.clearStencil();const w={};for(let E=0;E<y;E++)w[E+g]=new u.StencilMode({func:s.GEQUAL,mask:255},E+this.nextStencilID,255,s.KEEP,s.KEEP,s.REPLACE);return this.nextStencilID+=y,[w,f]}return[{[g]:u.StencilMode.disabled},f]}colorModeForRenderPass(){const r=this.context.gl;return this._showOverdrawInspector?new u.ColorMode([r.CONSTANT_COLOR,r.ONE],new u.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?u.ColorMode.unblended:u.ColorMode.alphaBlended}depthModeForSublayer(r,s,f){if(!this.opaquePassEnabledForLayer())return u.DepthMode.disabled;const g=1-((1+this.currentLayer)*this.numSublayers+r)*this.depthEpsilon;return new u.DepthMode(f||this.context.gl.LEQUAL,s,[g,g])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(r,s){this.style=r,this.options=s,this.imageManager=r.imageManager,this.glyphManager=r.glyphManager,this.symbolFadeChange=r.placement.symbolFadeChange(u.exported.now()),this.imageManager.beginFrame();const f=this.style.order,g=this.style._sourceCaches;for(const C in g){const z=g[C];z.used&&z.prepare(this.context)}const y={},w={},E={};for(const C in g){const z=g[C];y[C]=z.getVisibleCoordinates(),w[C]=y[C].slice().reverse(),E[C]=z.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let C=0;C<f.length;C++)if(this.style._layers[f[C]].is3D()){this.opaquePassCutoff=C;break}if(this.terrain&&(this.terrain.updateTileBinding(E),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new u.GlobeSharedBuffers(this.context)),u.isMapAuthenticated(this.context.gl)){this.renderPass="offscreen";for(const C of f){const z=this.style._layers[C],D=r._getLayerSourceCache(z);if(!z.hasOffscreenPass()||z.isHidden(this.transform.zoom))continue;const B=D?w[D.id]:void 0;(z.type==="custom"||z.isSky()||B&&B.length)&&this.renderLayer(this,D,z,B)}if(this.depthRangeFor3D=[0,1-(r.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:s.showOverdrawInspector?u.Color.black:u.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=s.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=f.length-1;this.currentLayer>=0;this.currentLayer--){const C=this.style._layers[f[this.currentLayer]],z=r._getLayerSourceCache(C);if(C.isSky())continue;const D=z?w[z.id]:void 0;this._renderTileClippingMasks(C,z,D),this.renderLayer(this,z,C,D)}if(this.style.fog&&this.transform.projection.supportsFog&&function(C,z){const D=C.context,B=D.gl,j=C.transform,W=new u.DepthMode(B.LEQUAL,u.DepthMode.ReadOnly,[0,1]),X=C.useProgram("globeAtmosphere",null,j.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),Y=u.globeToMercatorTransition(j.zoom),G=z.properties.get("color").toArray01(),q=z.properties.get("high-color").toArray01(),ee=z.properties.get("space-color").toArray01PremultipliedAlpha(),Q=u.identity$1([]);u.rotateY$1(Q,Q,-u.degToRad(j._center.lng)),u.rotateX$1(Q,Q,u.degToRad(j._center.lat)),u.rotateZ$1(Q,Q,j.angle),u.rotateX$1(Q,Q,-j._pitch);const ae=u.fromQuat(new Float32Array(16),Q),fe=u.mapValue(z.properties.get("star-intensity"),0,1,0,.25),le=5e-4,re=u.mapValue(z.properties.get("horizon-blend"),0,1,le,.25),Ce=u.globeUseCustomAntiAliasing(C,D,j)&&re===le?j.worldSize/(2*Math.PI*1.025)-1:j.globeRadius,we=C.frameCounter/1e3%1,ve=u.length(j.globeCenterInViewSpace),nt=Math.sqrt(Math.pow(ve,2)-Math.pow(Ce,2)),Ee=Math.acos(nt/ve),je=((Ze,Le,Ye,it,be,Re,wt,Pt,St,Ht,fn,Bt,yt,ei)=>({u_frustum_tl:Ze,u_frustum_tr:Le,u_frustum_br:Ye,u_frustum_bl:it,u_horizon:be,u_transition:Re,u_fadeout_range:wt,u_color:Pt,u_high_color:St,u_space_color:Ht,u_star_intensity:fn,u_star_size:5*u.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:Bt,u_horizon_angle:yt,u_rotation_matrix:ei}))(j.frustumCorners.TL,j.frustumCorners.TR,j.frustumCorners.BR,j.frustumCorners.BL,j.frustumCorners.horizon,Y,re,G,q,ee,fe,we,Ee,ae);C.prepareDrawProgram(D,X);const De=C.atmosphereBuffer;De&&X.draw(D,B.TRIANGLES,W,u.StencilMode.disabled,u.ColorMode.alphaBlended,u.CullFaceMode.backCW,je,"skybox",De.vertexBuffer,De.indexBuffer,De.segments)}(this,this.style.fog),this.renderPass="sky",(u.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<f.length;this.currentLayer++){const C=this.style._layers[f[this.currentLayer]],z=r._getLayerSourceCache(C);C.isSky()&&this.renderLayer(this,z,C,z?w[z.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<f.length;){const C=this.style._layers[f[this.currentLayer]],z=r._getLayerSourceCache(C);if(C.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(C)){if(C.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const D=z?(C.type==="symbol"?E:w)[z.id]:void 0;this._renderTileClippingMasks(C,z,z?y[z.id]:void 0),this.renderLayer(this,z,C,D),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let C=null;u.values(this.style._layers).forEach(z=>{const D=r._getLayerSourceCache(z);D&&!z.isHidden(this.transform.zoom)&&(!C||C.getSource().maxzoom<D.getSource().maxzoom)&&(C=D)}),C&&this.options.showTileBoundaries&&Pr.debug(this,C,C.getVisibleCoordinates())}this.options.showPadding&&function(C){const z=C.transform.padding;Oh(C,C.transform.height-(z.top||0),3,Gm),Oh(C,z.bottom||0,3,$m),Bs(C,z.left||0,3,jd),Bs(C,C.transform.width-(z.right||0),3,Oc);const D=C.transform.centerPoint;(function(B,j,W,X){ss(B,j-1,W-10,2,20,X),ss(B,j-10,W-1,20,2,X)})(C,D.x,C.transform.height-D.y,sl)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(u.window.performance.now()),this.saveCanvasCopy())}}renderLayer(r,s,f,g){f.isHidden(this.transform.zoom)||(f.type==="background"||f.type==="sky"||f.type==="custom"||g&&g.length)&&(this.id=f.id,this.gpuTimingStart(f),r.transform.projection.unsupportedLayers&&r.transform.projection.unsupportedLayers.includes(f.type)||Pr[f.type](r,s,f,g,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(r){if(!this.options.gpuTiming)return;const s=this.context.extTimerQuery;let f=this.gpuTimers[r.id];f||(f=this.gpuTimers[r.id]={calls:0,cpuTime:0,query:s.createQueryEXT()}),f.calls++,s.beginQueryEXT(s.TIME_ELAPSED_EXT,f.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const r=this.context.extTimerQuery,s=r.createQueryEXT();this.deferredRenderGpuTimeQueries.push(s),r.beginQueryEXT(r.TIME_ELAPSED_EXT,s)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const r=this.context.extTimerQuery;r.endQueryEXT(r.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const r=this.context.extTimerQuery;r.endQueryEXT(r.TIME_ELAPSED_EXT)}collectGpuTimers(){const r=this.gpuTimers;return this.gpuTimers={},r}collectDeferredRenderGpuQueries(){const r=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],r}queryGpuTimers(r){const s={};for(const f in r){const g=r[f],y=this.context.extTimerQuery,w=y.getQueryObjectEXT(g.query,y.QUERY_RESULT_EXT)/1e6;y.deleteQueryEXT(g.query),s[f]=w}return s}queryGpuTimeDeferredRender(r){if(!this.options.gpuTimingDeferredRender)return 0;const s=this.context.extTimerQuery;let f=0;for(const g of r)f+=s.getQueryObjectEXT(g,s.QUERY_RESULT_EXT)/1e6,s.deleteQueryEXT(g);return f}translatePosMatrix(r,s,f,g,y){if(!f[0]&&!f[1])return r;const w=y?g==="map"?this.transform.angle:0:g==="viewport"?-this.transform.angle:0;if(w){const z=Math.sin(w),D=Math.cos(w);f=[f[0]*D-f[1]*z,f[0]*z+f[1]*D]}const E=[y?f[0]:or(s,f[0],this.transform.zoom),y?f[1]:or(s,f[1],this.transform.zoom),0],C=new Float32Array(16);return u.translate(C,r,E),C}saveTileTexture(r){const s=this._tileTextures[r.size[0]];s?s.push(r):this._tileTextures[r.size[0]]=[r]}getTileTexture(r){const s=this._tileTextures[r];return s&&s.length>0?s.pop():null}isPatternMissing(r){return r===null||r!==void 0&&!this.imageManager.getPattern(r.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const r=this.terrain&&this.terrain.renderingToTexture,s=this.terrain&&this.terrain.exaggeration()===0,f=this.style&&this.style.fog,g=[];return this.terrainRenderModeElevated()&&g.push("TERRAIN"),this.transform.projection.name==="globe"&&g.push("GLOBE"),s&&g.push("ZERO_EXAGGERATION"),f&&!r&&f.getOpacity(this.transform.pitch)!==0&&g.push("FOG"),r&&g.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&g.push("OVERDRAW_INSPECTOR"),g}useProgram(r,s,f){this.cache=this.cache||{};const g=f||[],y=this.currentGlobalDefines().concat(g),w=Ac.cacheKey(Bi[r],r,y,s);return this.cache[w]||(this.cache[w]=new Ac(this.context,r,Bi[r],s,Nm[r],y)),this.cache[w]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const r=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(r.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=u.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new u.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(r,s,f){if(this.terrain&&this.terrain.renderingToTexture)return;const g=this.style.fog;if(g){const y=g.getOpacity(this.transform.pitch),w=((E,C,z,D,B,j,W,X,Y,G,q)=>{const ee=E.transform,Q=C.properties.get("color").toArray01();Q[3]=D;const ae=E.frameCounter/1e3%1;return{u_fog_matrix:z?ee.calculateFogTileMatrix(z):E.identityMat,u_fog_range:C.getFovAdjustedRange(ee._fov),u_fog_color:Q,u_fog_horizon_blend:C.properties.get("horizon-blend"),u_fog_temporal_offset:ae,u_frustum_tl:B,u_frustum_tr:j,u_frustum_br:W,u_frustum_bl:X,u_globe_pos:Y,u_globe_radius:G,u_viewport:q,u_globe_transition:u.globeToMercatorTransition(ee.zoom),u_is_globe:+(ee.projection.name==="globe")}})(this,g,f,y,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*u.exported.devicePixelRatio,this.transform.height*u.exported.devicePixelRatio]);s.setFogUniformValues(r,w)}}setTileLoadedFlag(r){this.tileLoaded=r}saveCanvasCopy(){this.frameCopies.push(this.canvasCopy()),this.tileLoaded=!1}canvasCopy(){const r=this.context.gl,s=r.createTexture();return r.bindTexture(r.TEXTURE_2D,s),r.copyTexImage2D(r.TEXTURE_2D,0,r.RGBA,0,0,r.drawingBufferWidth,r.drawingBufferHeight,0),s}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const r=this.style&&this.style.fog;return!!r&&r.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const r=this._backgroundTiles,s=this._backgroundTiles={},f=this.transform.coveringTiles({tileSize:512});for(const g of f)s[g.key]=r[g.key]||new u.Tile(g,512,this.transform.tileZoom,this);return s}clearBackgroundTiles(){this._backgroundTiles={}}}class Ph{constructor(r=0,s=0,f=0,g=0){if(isNaN(r)||r<0||isNaN(s)||s<0||isNaN(f)||f<0||isNaN(g)||g<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=r,this.bottom=s,this.left=f,this.right=g}interpolate(r,s,f){return s.top!=null&&r.top!=null&&(this.top=u.number(r.top,s.top,f)),s.bottom!=null&&r.bottom!=null&&(this.bottom=u.number(r.bottom,s.bottom,f)),s.left!=null&&r.left!=null&&(this.left=u.number(r.left,s.left,f)),s.right!=null&&r.right!=null&&(this.right=u.number(r.right,s.right,f)),this}getCenter(r,s){const f=u.clamp((this.left+r-this.right)/2,0,r),g=u.clamp((this.top+s-this.bottom)/2,0,s);return new u.pointGeometry(f,g)}equals(r){return this.top===r.top&&this.bottom===r.bottom&&this.left===r.left&&this.right===r.right}clone(){return new Ph(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function ku(h,r){const s=u.getColumn(h,3);u.fromQuat(h,r),u.setColumn(h,3,s)}function $d(h,r){const s=u.identity$1([]);return u.rotateZ$1(s,s,-r),u.rotateX$1(s,s,-h),s}function pp(h,r){const s=[h[0],h[1],0],f=[r[0],r[1],0];if(u.length(s)>=1e-15){const w=u.normalize([],s);u.scale$2(f,w,u.dot(f,w)),r[0]=f[0],r[1]=f[1]}const g=u.cross([],r,h);if(u.len(g)<1e-15)return null;const y=Math.atan2(-g[1],g[0]);return $d(Math.atan2(Math.sqrt(h[0]*h[0]+h[1]*h[1]),-h[2]),y)}class qd{constructor(r,s){this.position=r,this.orientation=s}get position(){return this._position}set position(r){if(r){const s=r instanceof u.MercatorCoordinate?r:new u.MercatorCoordinate(r[0],r[1],r[2]);this._renderWorldCopies&&(s.x=u.wrap(s.x,0,1)),this._position=s}else this._position=null}lookAtPoint(r,s){if(this.orientation=null,!this.position)return;const f=this._elevation?this._elevation.getAtPointOrZero(u.MercatorCoordinate.fromLngLat(r)):0,g=this.position,y=u.MercatorCoordinate.fromLngLat(r,f),w=[y.x-g.x,y.y-g.y,y.z-g.z];s||(s=[0,0,1]),s[2]=Math.abs(s[2]),this.orientation=pp(w,s)}setPitchBearing(r,s){this.orientation=$d(u.degToRad(r),u.degToRad(-s))}}class Bh{constructor(r,s){this._transform=u.identity([]),this.orientation=s,this.position=r}get mercatorPosition(){const r=this.position;return new u.MercatorCoordinate(r[0],r[1],r[2])}get position(){const r=u.getColumn(this._transform,3);return[r[0],r[1],r[2]]}set position(r){var s;r&&u.setColumn(this._transform,3,[(s=r)[0],s[1],s[2],1])}get orientation(){return this._orientation}set orientation(r){this._orientation=r||u.identity$1([]),r&&ku(this._transform,this._orientation)}getPitchBearing(){const r=this.forward(),s=this.right();return{bearing:Math.atan2(-s[1],s[0]),pitch:Math.atan2(Math.sqrt(r[0]*r[0]+r[1]*r[1]),-r[2])}}setPitchBearing(r,s){this._orientation=$d(r,s),ku(this._transform,this._orientation)}forward(){const r=u.getColumn(this._transform,2);return[-r[0],-r[1],-r[2]]}up(){const r=u.getColumn(this._transform,1);return[-r[0],-r[1],-r[2]]}right(){const r=u.getColumn(this._transform,0);return[r[0],r[1],r[2]]}getCameraToWorld(r,s){const f=new Float64Array(16);return u.invert(f,this.getWorldToCamera(r,s)),f}getWorldToCameraPosition(r,s,f){const g=this.position;u.scale$2(g,g,-r);const y=new Float64Array(16);return u.fromScaling(y,[f,f,f]),u.translate(y,y,g),y[10]*=s,y}getWorldToCamera(r,s){const f=new Float64Array(16),g=new Float64Array(4),y=this.position;return u.conjugate(g,this._orientation),u.scale$2(y,y,-r),u.fromQuat(f,g),u.translate(f,f,y),f[1]*=-1,f[5]*=-1,f[9]*=-1,f[13]*=-1,f[8]*=s,f[9]*=s,f[10]*=s,f[11]*=s,f}getCameraToClipPerspective(r,s,f,g){const y=new Float64Array(16);return u.perspective(y,r,s,f,g),y}getDistanceToElevation(r,s=!1){const f=r===0?0:u.mercatorZfromAltitude(r,s?u.latFromMercatorY(this.position[1]):this.position[1]),g=this.forward();return(f-this.position[2])/g[2]}clone(){return new Bh([...this.position],[...this.orientation])}}function Lu(h,r){const s=ul(h.projection,h.zoom,h.width,h.height),f=function(y,w,E,C,z){const D=new u.LngLat(E.lng-180*vo,E.lat),B=new u.LngLat(E.lng+180*vo,E.lat),j=y.project(D.lng,D.lat),W=y.project(B.lng,B.lat),X=-Math.atan2(W.y-j.y,W.x-j.x),Y=u.MercatorCoordinate.fromLngLat(E);Y.y=u.clamp(Y.y,-.999975,.999975);const G=Y.toLngLat(),q=y.project(G.lng,G.lat),ee=u.MercatorCoordinate.fromLngLat(G);ee.x+=vo;const Q=ee.toLngLat(),ae=y.project(Q.lng,Q.lat),fe=Hd(ae.x-q.x,ae.y-q.y,X),le=u.MercatorCoordinate.fromLngLat(G);le.y+=vo;const re=le.toLngLat(),Ce=y.project(re.lng,re.lat),we=Hd(Ce.x-q.x,Ce.y-q.y,X),ve=Math.abs(fe.x)/Math.abs(we.y),nt=u.identity([]);u.rotateZ(nt,nt,-X*(1-(z?0:C)));const Ee=u.identity([]);return u.scale(Ee,Ee,[1,1-(1-ve)*C,1]),Ee[4]=-we.x/we.y*C,u.rotateZ(Ee,Ee,X),u.multiply(Ee,nt,Ee),Ee}(h.projection,0,h.center,s,r),g=Fs(h);return u.scale(f,f,[g,g,1]),f}function Fs(h){const r=h.projection,s=ul(h.projection,h.zoom,h.width,h.height),f=Fh(r,h.center),g=Fh(r,u.LngLat.convert(r.center));return Math.pow(2,f*s+(1-s)*g)}function ul(h,r,s,f,g=1/0){const y=h.range;if(!y)return 0;const w=Math.min(g,Math.max(s,f)),E=Math.log(w/1024)/Math.LN2;return u.smoothstep(y[0]+E,y[1]+E,r)}const vo=1/4e4;function Fh(h,r){const s=u.clamp(r.lat,-u.MAX_MERCATOR_LATITUDE,u.MAX_MERCATOR_LATITUDE),f=new u.LngLat(r.lng-180*vo,s),g=new u.LngLat(r.lng+180*vo,s),y=h.project(f.lng,s),w=h.project(g.lng,s),E=u.MercatorCoordinate.fromLngLat(f),C=u.MercatorCoordinate.fromLngLat(g),z=w.x-y.x,D=w.y-y.y,B=C.x-E.x,j=C.y-E.y,W=Math.sqrt((B*B+j*j)/(z*z+D*D));return Math.log(W)/Math.LN2}function Hd(h,r,s){const f=Math.cos(s),g=Math.sin(s);return{x:h*f-r*g,y:h*g+r*f}}class Ou{constructor(r,s,f,g,y,w,E){this.tileSize=512,this._renderWorldCopies=y===void 0||y,this._minZoom=r||0,this._maxZoom=s||22,this._minPitch=f??0,this._maxPitch=g??60,this.setProjection(w),this.setMaxBounds(E),this.width=0,this.height=0,this._center=new u.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Ph,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Bh,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const r=new Ou(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return r._elevation=this._elevation,r._centerAltitude=this._centerAltitude,r._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,r.tileSize=this.tileSize,r.mercatorFromTransition=this.mercatorFromTransition,r.width=this.width,r.height=this.height,r.cameraElevationReference=this.cameraElevationReference,r._center=this._center,r._setZoom(this.zoom),r._seaLevelZoom=this._seaLevelZoom,r.angle=this.angle,r._fov=this._fov,r._pitch=this._pitch,r._nearZ=this._nearZ,r._farZ=this._farZ,r._averageElevation=this._averageElevation,r._unmodified=this._unmodified,r._edgeInsets=this._edgeInsets.clone(),r._camera=this._camera.clone(),r._calcMatrices(),r.freezeTileCoverage=this.freezeTileCoverage,r.frustumCorners=this.frustumCorners,r}get elevation(){return this._elevation}set elevation(r){this._elevation!==r&&(this._elevation=r,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(r,s=!1){const f=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||f)&&this._updateCameraOnTerrain(),(r||f)&&this._constrainCamera(s),this._calcMatrices()}getProjection(){return u.pick(this.projection,["name","center","parallels"])}setProjection(r){this.projectionOptions=r||{name:"mercator"};const s=this.projection?this.getProjection():void 0;this.projection=u.getProjection(this.projectionOptions);const f=!Oe(s,this.getProjection());return f&&this._calcMatrices(),this.mercatorFromTransition=!1,f}setMercatorFromTransition(){const r=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=u.getProjection({name:"mercator"});const s=r!==this.projection.name;return s&&this._calcMatrices(),s}get minZoom(){return this._minZoom}set minZoom(r){this._minZoom!==r&&(this._minZoom=r,this.zoom=Math.max(this.zoom,r))}get maxZoom(){return this._maxZoom}set maxZoom(r){this._maxZoom!==r&&(this._maxZoom=r,this.zoom=Math.min(this.zoom,r))}get minPitch(){return this._minPitch}set minPitch(r){this._minPitch!==r&&(this._minPitch=r,this.pitch=Math.max(this.pitch,r))}get maxPitch(){return this._maxPitch}set maxPitch(r){this._maxPitch!==r&&(this._maxPitch=r,this.pitch=Math.min(this.pitch,r))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(r){r===void 0?r=!0:r===null&&(r=!1),this._renderWorldCopies=r}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const r=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(r))}get cameraWorldSize(){const r=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(r))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return u.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new u.pointGeometry(this.width,this.height)}get bearing(){return u.wrap(this.rotation,-180,180)}set bearing(r){this.rotation=r}get rotation(){return-this.angle/Math.PI*180}set rotation(r){const s=-r*Math.PI/180;var f;this.angle!==s&&(this._unmodified=!1,this.angle=s,this._calcMatrices(),this.rotationMatrix=(f=new u.ARRAY_TYPE(4),u.ARRAY_TYPE!=Float32Array&&(f[1]=0,f[2]=0),f[0]=1,f[3]=1,f),function(g,y,w){var E=y[0],C=y[1],z=y[2],D=y[3],B=Math.sin(w),j=Math.cos(w);g[0]=E*j+z*B,g[1]=C*j+D*B,g[2]=E*-B+z*j,g[3]=C*-B+D*j}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(r){const s=u.clamp(r,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==s&&(this._unmodified=!1,this._pitch=s,this._calcMatrices())}get aspect(){return this.width/this.height}get fovX(){return this._fov}get fovY(){const r=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/r)}set fov(r){r=Math.max(.01,Math.min(60,r)),this._fov!==r&&(this._unmodified=!1,this._fov=u.degToRad(r),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(r){this._averageElevation=r,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(r){const s=Math.min(Math.max(r,this.minZoom),this.maxZoom);this._zoom!==s&&(this._unmodified=!1,this._setZoom(s),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(r){this._zoom=r,this.scale=this.zoomScale(r),this.tileZoom=Math.floor(r),this.zoomFraction=r-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const r=this._elevation;this._centerAltitude=r.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=r.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const r=this._elevation,s=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],f=this.horizonLineFromTop();let g=0,y=0;for(let w=0;w<s.length;w++){const E=new u.pointGeometry(s[w][0]*this.width,f+s[w][1]*(this.height-f)),C=r.pointCoordinate(E);if(!C)continue;const z=1/Math.hypot(C[0]-this._camera.position[0],C[1]-this._camera.position[1]);g+=C[3]*z,y+=z}return y===0?NaN:g/y}get center(){return this._center}set center(r){r.lat===this._center.lat&&r.lng===this._center.lng||(this._unmodified=!1,this._center=r,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const r=this._seaLevelZoom,s=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),f=this.pixelsPerMeter/this.worldSize*s,g=this._mercatorZfromZoom(r),y=this._mercatorZfromZoom(this._maxZoom),w=Math.max(g-f,y);this._setZoom(this._zoomFromMercatorZ(w))}get padding(){return this._edgeInsets.toJSON()}set padding(r){this._edgeInsets.equals(r)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,r,1),this._calcMatrices())}computeZoomRelativeTo(r){const s=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,r.toAltitude()));let f;f=r.z<this._camera.position[2]?[s.x,s.y,s.z]:[r.x,r.y,r.z];const g=u.length(u.sub([],this._camera.position,f));return u.clamp(this._zoomFromMercatorZ(g),this._minZoom,this._maxZoom)}setFreeCameraOptions(r){if(!this.height||!r.position&&!r.orientation)return;this._updateCameraState();let s=!1;if(r.orientation&&!u.exactEquals(r.orientation,this._camera.orientation)&&(s=this._setCameraOrientation(r.orientation)),r.position){const f=[r.position.x,r.position.y,r.position.z];u.exactEquals$1(f,this._camera.position)||(this._setCameraPosition(f),s=!0)}s&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const r=this._camera.position,s=new qd;return s.position=new u.MercatorCoordinate(r[0],r[1],r[2]),s.orientation=this._camera.orientation,s._elevation=this.elevation,s._renderWorldCopies=this.renderWorldCopies,s}_setCameraOrientation(r){if(!u.length$1(r))return!1;u.normalize$1(r,r);const s=u.transformQuat([],[0,0,-1],r),f=u.transformQuat([],[0,-1,0],r);if(f[2]<0)return!1;const g=pp(s,f);return!!g&&(this._camera.orientation=g,!0)}_setCameraPosition(r){const s=this.zoomScale(this.minZoom)*this.tileSize,f=this.zoomScale(this.maxZoom)*this.tileSize,g=this.cameraToCenterDistance;r[2]=u.clamp(r[2],g/f,g/s),this._camera.position=r}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(r){return this._edgeInsets.equals(r)}interpolatePadding(r,s,f){this._unmodified=!1,this._edgeInsets.interpolate(r,s,f),this._constrain(),this._calcMatrices()}coveringZoomLevel(r){const s=(r.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/r.tileSize));return Math.max(0,s)}getVisibleUnwrappedCoordinates(r){const s=[new u.UnwrappedTileID(0,r)];if(this.renderWorldCopies){const f=this.pointCoordinate(new u.pointGeometry(0,0)),g=this.pointCoordinate(new u.pointGeometry(this.width,0)),y=this.pointCoordinate(new u.pointGeometry(this.width,this.height)),w=this.pointCoordinate(new u.pointGeometry(0,this.height)),E=Math.floor(Math.min(f.x,g.x,y.x,w.x)),C=Math.floor(Math.max(f.x,g.x,y.x,w.x)),z=1;for(let D=E-z;D<=C+z;D++)D!==0&&s.push(new u.UnwrappedTileID(D,r))}return s}coveringTiles(r){let s=this.coveringZoomLevel(r);const f=s,g=this.elevation&&!r.isTerrainDEM,y=this.projection.name==="mercator";if(r.minzoom!==void 0&&s<r.minzoom)return[];r.maxzoom!==void 0&&s>r.maxzoom&&(s=r.maxzoom);const w=this.locationCoordinate(this.center),E=this.center.lat,C=1<<s,z=[C*w.x,C*w.y,0],D=this.projection.name==="globe",B=!D,j=u.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,s,B),W=D?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),X=C*u.mercatorZfromAltitude(1,this.center.lat),Y=this._camera.position[2]/u.mercatorZfromAltitude(1,this.center.lat),G=[C*W.x,C*W.y,Y*(B?1:X)],q=this.cameraToCenterDistance/r.tileSize*(r.roundZoom?1:.502),ee=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?s:0,Q=r.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,ae=r.isTerrainDEM?-Q:this._elevation?this._elevation.getMinElevationBelowMSL():0,fe=this.projection.isReprojectedInTileSpace?Fs(this):1,le=Le=>{const it=new u.MercatorCoordinate(Le.x+25e-6,Le.y,Le.z),be=new u.MercatorCoordinate(Le.x,Le.y+25e-6,Le.z),Re=Le.toLngLat(),wt=it.toLngLat(),Pt=be.toLngLat(),St=this.locationCoordinate(Re),Ht=this.locationCoordinate(wt),fn=this.locationCoordinate(Pt),Bt=Math.hypot(Ht.x-St.x,Ht.y-St.y),yt=Math.hypot(fn.x-St.x,fn.y-St.y);return Math.sqrt(Bt*yt)*fe/25e-6},re=Le=>{const Ye=Q,it=ae;return{aabb:u.tileAABB(this,C,0,0,0,Le,it,Ye,this.projection),zoom:0,x:0,y:0,minZ:it,maxZ:Ye,wrap:Le,fullyVisible:!1}},Ce=[];let we=[];const ve=s,nt=r.reparseOverscaled?f:s,Ee=Le=>Le*Le,je=Ee((Y-this._centerAltitude)*X),De=Le=>{if(!this._elevation||!Le.tileID||!y)return;const Ye=this._elevation.getMinMaxForTile(Le.tileID),it=Le.aabb;Ye?(it.min[2]=Ye.min,it.max[2]=Ye.max,it.center[2]=(it.min[2]+it.max[2])/2):(Le.shouldSplit=Ze(Le),Le.shouldSplit||(it.min[2]=it.max[2]=it.center[2]=this._centerAltitude))},Ze=Le=>{if(Le.zoom<ee)return!0;if(Le.zoom===ve)return!1;if(Le.shouldSplit!=null)return Le.shouldSplit;const Ye=Le.aabb.distanceX(G),it=Le.aabb.distanceY(G);let be=je,Re=1;if(D){be=Ee(Le.aabb.distanceZ(G));const St=Math.pow(2,Le.zoom),Ht=u.latFromMercatorY((Le.y+1)/St),fn=u.latFromMercatorY(Le.y/St),Bt=Math.min(Math.max(E,Ht),fn),yt=u.circumferenceAtLatitude(Bt)/u.circumferenceAtLatitude(E);if(Re=Bt===E?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,yt/this._mercatorScaleRatio),this.zoom<=u.GLOBE_ZOOM_THRESHOLD_MIN&&Le.zoom===ve-1&&yt>=.9)return!0}else if(g&&(be=Ee(Le.aabb.distanceZ(G)*X)),this.projection.isReprojectedInTileSpace&&f<=5){const St=Math.pow(2,Le.zoom),Ht=le(new u.MercatorCoordinate((Le.x+.5)/St,(Le.y+.5)/St));Re=Ht>.85?1:Ht}const wt=Ye*Ye+it*it+be,Pt=Ee((1<<ve-Le.zoom)*q*Re*((St,Ht)=>{if(Ht*Ee(.707)<St)return 1;const fn=Math.sqrt(Ht/St);return fn/(1.4144271570014144+(Math.pow(1.1,fn-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(be,je),wt));return wt<Pt};if(this.renderWorldCopies)for(let Le=1;Le<=3;Le++)Ce.push(re(-Le)),Ce.push(re(Le));for(Ce.push(re(0));Ce.length>0;){const Le=Ce.pop(),Ye=Le.x,it=Le.y;let be=Le.fullyVisible;if(!be){const Re=Le.aabb.intersects(j);if(Re===0)continue;be=Re===2}if(Le.zoom!==ve&&Ze(Le))for(let Re=0;Re<4;Re++){const wt=(Ye<<1)+Re%2,Pt=(it<<1)+(Re>>1),St={aabb:y?Le.aabb.quadrant(Re):u.tileAABB(this,C,Le.zoom+1,wt,Pt,Le.wrap,Le.minZ,Le.maxZ,this.projection),zoom:Le.zoom+1,x:wt,y:Pt,wrap:Le.wrap,fullyVisible:be,tileID:void 0,shouldSplit:void 0,minZ:Le.minZ,maxZ:Le.maxZ};g&&!D&&(St.tileID=new u.OverscaledTileID(Le.zoom+1===ve?nt:Le.zoom+1,Le.wrap,Le.zoom+1,wt,Pt),De(St)),Ce.push(St)}else{const Re=Le.zoom===ve?nt:Le.zoom;if(r.minzoom&&r.minzoom>Re)continue;const wt=z[0]-(.5+Ye+(Le.wrap<<Le.zoom))*(1<<s-Le.zoom),Pt=z[1]-.5-it,St=Le.tileID?Le.tileID:new u.OverscaledTileID(Re,Le.wrap,Le.zoom,Ye,it);we.push({tileID:St,distanceSq:wt*wt+Pt*Pt})}}if(this.fogCullDistSq){const Le=this.fogCullDistSq,Ye=this.horizonLineFromTop();we=we.filter(it=>{const be=[0,0,0,1],Re=[u.EXTENT,u.EXTENT,0,1],wt=this.calculateFogTileMatrix(it.tileID.toUnwrapped());u.transformMat4$1(be,be,wt),u.transformMat4$1(Re,Re,wt);const Pt=u.getAABBPointSquareDist(be,Re);if(Pt===0)return!0;let St=!1;const Ht=this._elevation;if(Ht&&Pt>Le&&Ye!==0){const fn=this.calculateProjMatrix(it.tileID.toUnwrapped());let Bt;r.isTerrainDEM||(Bt=Ht.getMinMaxForTile(it.tileID)),Bt||(Bt={min:ae,max:Q});const yt=u.furthestTileCorner(this.rotation),ei=[yt[0]*u.EXTENT,yt[1]*u.EXTENT,Bt.max];u.transformMat4(ei,ei,fn),St=(1-ei[1])*this.height*.5<Ye}return Pt<Le||St})}return we.sort((Le,Ye)=>Le.distanceSq-Ye.distanceSq).map(Le=>Le.tileID)}resize(r,s){this.width=r,this.height=s,this.pixelsToGLUnits=[2/r,-2/s],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(r){return Math.pow(2,r)}scaleZoom(r){return Math.log(r)/Math.LN2}project(r){const s=u.clamp(r.lat,-u.MAX_MERCATOR_LATITUDE,u.MAX_MERCATOR_LATITUDE),f=this.projection.project(r.lng,s);return new u.pointGeometry(f.x*this.worldSize,f.y*this.worldSize)}unproject(r){return this.projection.unproject(r.x/this.worldSize,r.y/this.worldSize)}get point(){return this.project(this.center)}setLocationAtPoint(r,s){let f,g;const y=this.centerPoint;if(this.projection.name==="globe"){const E=this.worldSize;f=(s.x-y.x)/E,g=(s.y-y.y)/E}else{const E=this.pointCoordinate(s),C=this.pointCoordinate(y);f=E.x-C.x,g=E.y-C.y}const w=this.locationCoordinate(r);this.setLocation(new u.MercatorCoordinate(w.x-f,w.y-g))}setLocation(r){this.center=this.coordinateLocation(r),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(r){return this.projection.locationPoint(this,r)}locationPoint3D(r){return this.projection.locationPoint(this,r,!0)}pointLocation(r){return this.coordinateLocation(this.pointCoordinate(r))}pointLocation3D(r){return this.coordinateLocation(this.pointCoordinate3D(r))}locationCoordinate(r,s){const f=s?u.mercatorZfromAltitude(s,r.lat):void 0,g=this.projection.project(r.lng,r.lat);return new u.MercatorCoordinate(g.x,g.y,f)}coordinateLocation(r){return this.projection.unproject(r.x,r.y)}pointRayIntersection(r,s){const f=s??this._centerAltitude,g=[r.x,r.y,0,1],y=[r.x,r.y,1,1];u.transformMat4$1(g,g,this.pixelMatrixInverse),u.transformMat4$1(y,y,this.pixelMatrixInverse);const w=y[3];u.scale$1(g,g,1/g[3]),u.scale$1(y,y,1/w);const E=g[2],C=y[2];return{p0:g,p1:y,t:E===C?0:(f-E)/(C-E)}}screenPointToMercatorRay(r){const s=[r.x,r.y,0,1],f=[r.x,r.y,1,1];return u.transformMat4$1(s,s,this.pixelMatrixInverse),u.transformMat4$1(f,f,this.pixelMatrixInverse),u.scale$1(s,s,1/s[3]),u.scale$1(f,f,1/f[3]),s[2]=u.mercatorZfromAltitude(s[2],this._center.lat)*this.worldSize,f[2]=u.mercatorZfromAltitude(f[2],this._center.lat)*this.worldSize,u.scale$1(s,s,1/this.worldSize),u.scale$1(f,f,1/this.worldSize),new u.Ray([s[0],s[1],s[2]],u.normalize([],u.sub([],f,s)))}rayIntersectionCoordinate(r){const{p0:s,p1:f,t:g}=r,y=u.mercatorZfromAltitude(s[2],this._center.lat),w=u.mercatorZfromAltitude(f[2],this._center.lat);return new u.MercatorCoordinate(u.number(s[0],f[0],g)/this.worldSize,u.number(s[1],f[1],g)/this.worldSize,u.number(y,w,g))}pointCoordinate(r,s=this._centerAltitude){return this.projection.pointCoordinate(this,r.x,r.y,s)}pointCoordinate3D(r){if(!this.elevation)return this.pointCoordinate(r);let s=this.projection.pointCoordinate3D(this,r.x,r.y);if(s)return new u.MercatorCoordinate(s[0],s[1],s[2]);let f=0,g=this.horizonLineFromTop();if(r.y>g)return this.pointCoordinate(r);const y=.02*g,w=r.clone();for(let E=0;E<10&&g-f>y;E++){w.y=u.number(f,g,.66);const C=this.projection.pointCoordinate3D(this,w.x,w.y);C?(g=w.y,s=C):f=w.y}return s?new u.MercatorCoordinate(s[0],s[1],s[2]):this.pointCoordinate(r)}isPointAboveHorizon(r){return this.projection.isPointAboveHorizon(this,r)}_coordinatePoint(r,s){const f=s&&this.elevation?this.elevation.getAtPointOrZero(r,this._centerAltitude):this._centerAltitude,g=[r.x*this.worldSize,r.y*this.worldSize,f+r.toAltitude(),1];return u.transformMat4$1(g,g,this.pixelMatrix),g[3]>0?new u.pointGeometry(g[0]/g[3],g[1]/g[3]):new u.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getGlobeBounds(){const{top:r,left:s}=this._edgeInsets,f=this.height-this._edgeInsets.bottom,g=this.width-this._edgeInsets.right,y=this.pointCoordinate3D(new u.pointGeometry(s,r)),w=this.pointCoordinate3D(new u.pointGeometry(g,r)),E=this.pointCoordinate3D(new u.pointGeometry(g,f)),C=this.pointCoordinate3D(new u.pointGeometry(s,f));let z=Math.min(y.x,C.x),D=Math.max(w.x,E.x),B=Math.min(y.y,w.y),j=Math.max(C.y,E.y);const W=Math.pow(2,-this.zoom)/16,X=(le,re,Ce,we)=>{const ve=(le+Ce)/2,nt=(re+we)/2,Ee=new u.pointGeometry(ve,nt),je=this.pointCoordinate3D(Ee),De=Math.max(0,z-je.x,B-je.y,je.x-D,je.y-j);z=Math.min(z,je.x),D=Math.max(D,je.x),B=Math.min(B,je.y),j=Math.max(j,je.y),De>W&&(X(le,re,ve,nt),X(ve,nt,Ce,we))};X(s,r,g,r),X(g,r,g,f),X(g,f,s,f),X(s,f,s,r);const[Y,G]=u.polesInViewport(this),q=Y||G,ee=Y?90:u.latFromMercatorY(B),Q=q?180:u.lngFromMercatorX(D),ae=G?-90:u.latFromMercatorY(j),fe=q?-180:u.lngFromMercatorX(z);return new u.LngLatBounds(new u.LngLat(fe,ae),new u.LngLat(Q,ee))}_getBounds(r,s){if(this.projection.name==="globe")return this._getGlobeBounds();const f=new u.pointGeometry(this._edgeInsets.left,this._edgeInsets.top),g=new u.pointGeometry(this.width-this._edgeInsets.right,this._edgeInsets.top),y=new u.pointGeometry(this.width-this._edgeInsets.right,this.height-this._edgeInsets.bottom),w=new u.pointGeometry(this._edgeInsets.left,this.height-this._edgeInsets.bottom);let E=this.pointCoordinate(f,r),C=this.pointCoordinate(g,r);const z=this.pointCoordinate(y,s),D=this.pointCoordinate(w,s),B=(j,W)=>(W.y-j.y)/(W.x-j.x);return E.y>1&&C.y>=0?E=new u.MercatorCoordinate((1-D.y)/B(D,E)+D.x,1):E.y<0&&C.y<=1&&(E=new u.MercatorCoordinate(-D.y/B(D,E)+D.x,0)),C.y>1&&E.y>=0?C=new u.MercatorCoordinate((1-z.y)/B(z,C)+z.x,1):C.y<0&&E.y<=1&&(C=new u.MercatorCoordinate(-z.y/B(z,C)+z.x,0)),new u.LngLatBounds().extend(this.coordinateLocation(E)).extend(this.coordinateLocation(C)).extend(this.coordinateLocation(D)).extend(this.coordinateLocation(z))}_getBounds3D(){const r=this.elevation;if(!r.visibleDemTiles.length||r.isUsingMockSource())return this._getBounds(0,0);const s=r.visibleDemTiles.reduce((f,g)=>{if(g.dem){const y=g.dem.tree;f.min=Math.min(f.min,y.minimums[0]),f.max=Math.max(f.max,y.maximums[0])}return f},{min:Number.MAX_VALUE,max:0});return this._getBounds(s.min*r.exaggeration(),s.max*r.exaggeration())}getBounds(){return this._terrainEnabled()?this._getBounds3D():this._getBounds(0,0)}horizonLineFromTop(r=!0){const s=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,f=this.height/2-s*(1-this._horizonShift);return r?Math.max(0,f):f}getMaxBounds(){return this.maxBounds}setMaxBounds(r){this.maxBounds=r,this.minLat=-u.MAX_MERCATOR_LATITUDE,this.maxLat=u.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,r&&(this.minLat=r.getSouth(),this.maxLat=r.getNorth(),this.minLng=r.getWest(),this.maxLng=r.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=u.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=u.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=u.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=u.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(r,s){return this.projection.createTileMatrix(this,s,r)}calculateDistanceTileData(r){const s=r.key,f=this._distanceTileDataCache;if(f[s])return f[s];const g=r.canonical,y=1/this.height,w=this.cameraWorldSize,E=w/this.zoomScale(g.z),C=(g.x+Math.pow(2,g.z)*r.wrap)*E,z=g.y*E,D=this.point;D.x*=w/this.worldSize,D.y*=w/this.worldSize;const B=this.angle,j=Math.sin(-B),W=-Math.cos(-B);return f[s]={bearing:[j,W],center:[(D.x-C)*y,(D.y-z)*y],scale:E/u.EXTENT*y},f[s]}calculateFogTileMatrix(r){const s=r.key,f=this._fogTileMatrixCache;if(f[s])return f[s];const g=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,r);return u.multiply(g,this.worldToFogMatrix,g),f[s]=new Float32Array(g),f[s]}calculateProjMatrix(r,s=!1){const f=r.key,g=s?this._alignedProjMatrixCache:this._projMatrixCache;if(g[f])return g[f];const y=this.calculatePosMatrix(r,this.worldSize);return u.multiply(y,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:s?this.alignedProjMatrix:this.projMatrix,y),g[f]=new Float32Array(y),g[f]}calculatePixelsToTileUnitsMatrix(r){const s=r.tileID.key,f=this._pixelsToTileUnitsCache;if(f[s])return f[s];const g=function(y,w){const{scale:E}=y.tileTransform,C=E*u.EXTENT/(y.tileSize*Math.pow(2,w.zoom-y.tileID.overscaledZ+y.tileID.canonical.z));return z=new Float32Array(4),j=(D=w.inverseAdjustmentMatrix)[1],W=D[2],X=D[3],G=(B=[C,C])[1],z[0]=D[0]*(Y=B[0]),z[1]=j*Y,z[2]=W*G,z[3]=X*G,z;var z,D,B,j,W,X,Y,G}(r,this);return f[s]=g,f[s]}customLayerMatrix(){return this.mercatorMatrix.slice()}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const r=this._elevation;this._updateCameraState();const s=u.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,f=this._computeCameraPosition(s),g=this._camera.forward(),y=u.mercatorZfromAltitude(1,this._center.lat);f[2]/=y,g[2]/=y,u.normalize(g,g);const w=r.raycast(f,g,r.exaggeration());if(w){const E=u.scaleAndAdd([],f,g,w),C=new u.MercatorCoordinate(E[0],E[1],u.mercatorZfromAltitude(E[2],u.latFromMercatorY(E[1]))),z=(C.z+u.length([C.x-f[0],C.y-f[1],C.z-f[2]*y]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(z),this._centerAltitude=C.toAltitude(),this._center=this.coordinateLocation(C),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(r=!1){if(!this._elevation)return;const s=this._elevation,f=u.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,g=this._computeCameraPosition(f),y=s.getAtPointOrZero(new u.MercatorCoordinate(...g)),w=this.pixelsPerMeter/this.worldSize*y,E=this._minimumHeightOverTerrain(),C=g[2]-w;if(C<=E)if(C<0||r){const z=this.locationCoordinate(this._center,this._centerAltitude),D=[g[0],g[1],z.z-g[2]],B=u.length(D);D[2]-=(E-C)/this._pixelsPerMercatorPixel;const j=u.length(D);if(j===0)return;u.scale$2(D,D,B/j*this._pixelsPerMercatorPixel),this._camera.position=[g[0],g[1],z.z*this._pixelsPerMercatorPixel-D[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const r=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||r){const j=this.center;return j.lat=u.clamp(j.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!r)&&(j.lng=u.clamp(j.lng,this.minLng,this.maxLng)),this.center=j,void(this._constraining=!1)}const s=this._unmodified,{x:f,y:g}=this.point;let y=0,w=f,E=g;const C=this.width/2,z=this.height/2,D=this.worldMinY*this.scale,B=this.worldMaxY*this.scale;if(g-z<D&&(E=D+z),g+z>B&&(E=B-z),B-D<this.height&&(y=Math.max(y,this.height/(B-D)),E=(B+D)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const j=this.worldMinX*this.scale,W=this.worldMaxX*this.scale,X=this.worldSize/2-(j+W)/2;w=(f+X+this.worldSize)%this.worldSize-X,w-C<j&&(w=j+C),w+C>W&&(w=W-C),W-j<this.width&&(y=Math.max(y,this.width/(W-j)),w=(W+j)/2)}w===f&&E===g||(this.center=this.unproject(new u.pointGeometry(w,E))),y&&(this.zoom+=this.scaleZoom(y)),this._constrainCamera(),this._unmodified=s,this._constraining=!1}_minZoomForBounds(){let r=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(r=Math.max(r,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),r}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const r=this.centerOffset,s=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=u.mercatorZfromAltitude(1,this.center.lat)/u.mercatorZfromAltitude(1,u.GLOBE_SCALE_MATCH_LATITUDE));const f=ul(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,f),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const g=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?s:1),y=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);y[8]=2*-r.x/this.width,y[9]=2*r.y/this.height;let w=u.mul([],y,g);if(this.projection.isReprojectedInTileSpace){const fe=this.locationCoordinate(this.center),le=u.identity([]);u.translate(le,le,[fe.x*this.worldSize,fe.y*this.worldSize,0]),u.multiply(le,le,Lu(this)),u.translate(le,le,[-fe.x*this.worldSize,-fe.y*this.worldSize,0]),u.multiply(w,w,le),this.inverseAdjustmentMatrix=function(re){const Ce=Lu(re,!0);return Wt([],[Ce[0],Ce[1],Ce[4],Ce[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=u.scale([],w,[this.worldSize,this.worldSize,this.worldSize/s,1]),this.projMatrix=w,this.invProjMatrix=u.invert(new Float64Array(16),this.projMatrix);const E=u.invert([],y);this.frustumCorners=u.FrustumCorners.fromInvProjectionMatrix(E,this.horizonLineFromTop(),this.height);const C=new Float32Array(16);u.identity(C),u.scale(C,C,[1,-1,1]),u.rotateX(C,C,this._pitch),u.rotateZ(C,C,this.angle);const z=u.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),D=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;z[8]=2*-r.x/this.width,z[9]=2*(r.y+D)/this.height,this.skyboxMatrix=u.multiply(C,z,C);const B=this.point,j=B.x,W=B.y,X=this.width%2/2,Y=this.height%2/2,G=Math.cos(this.angle),q=Math.sin(this.angle),ee=j-Math.round(j)+G*X+q*Y,Q=W-Math.round(W)+G*Y+q*X,ae=new Float64Array(w);if(u.translate(ae,ae,[ee>.5?ee-1:ee,Q>.5?Q-1:Q,0]),this.alignedProjMatrix=ae,w=u.create(),u.scale(w,w,[this.width/2,-this.height/2,1]),u.translate(w,w,[1,-1,0]),this.labelPlaneMatrix=w,w=u.create(),u.scale(w,w,[1,-1,1]),u.translate(w,w,[-1,-1,0]),u.scale(w,w,[2/this.width,2/this.height,1]),this.glCoordMatrix=w,this.pixelMatrix=u.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},w=u.invert(new Float64Array(16),this.pixelMatrix),!w)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=w,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=u.calculateGlobeMatrix(this);const fe=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=u.transformMat4(fe,fe,g),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=w;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const r=this.cameraWorldSizeForFog,s=this.cameraPixelsPerMeter,f=this._camera.position,g=1/this.height/this._pixelsPerMercatorPixel,y=[r,r,s];u.scale$2(y,y,g),u.scale$2(f,f,-1),u.multiply$2(f,f,y);const w=u.create();u.translate(w,w,f),u.scale(w,w,y),this.mercatorFogMatrix=w,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(r,s,g)}_computeCameraPosition(r){const s=(r=r||this.pixelsPerMeter)/this.pixelsPerMeter,f=this._camera.forward(),g=this.point,y=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*s-r/this.worldSize*this._centerAltitude;return[g.x/this.worldSize-f[0]*y,g.y/this.worldSize-f[1]*y,r/this.worldSize*this._centerAltitude-f[2]*y]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(r){const s=this._maxCameraBoundsDistance()*Math.cos(this._pitch),f=this._camera.position[2],g=r[2];let y=1;this.projection.wrap&&(this.center=this.center.wrap()),g>0&&(y=Math.min((s-f)/g,1)),this._camera.position=u.scaleAndAdd([],this._camera.position,r,y),this._updateStateFromCamera()}_updateStateFromCamera(){const r=this._camera.position,s=this._camera.forward(),{pitch:f,bearing:g}=this._camera.getPitchBearing(),y=u.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,w=this._mercatorZfromZoom(this._maxZoom)*Math.cos(u.degToRad(this._maxPitch)),E=Math.max((r[2]-y)/Math.cos(f),w),C=this._zoomFromMercatorZ(E);u.scaleAndAdd(r,r,s,E),this._pitch=u.clamp(f,u.degToRad(this.minPitch),u.degToRad(this.maxPitch)),this.angle=u.wrap(g,-Math.PI,Math.PI),this._setZoom(u.clamp(C,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new u.MercatorCoordinate(r[0],r[1],r[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(r){return Math.pow(2,r)*this.tileSize}_mercatorZfromZoom(r){return this.cameraToCenterDistance/this._worldSizeFromZoom(r)}_minimumHeightOverTerrain(){const r=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(r)}_zoomFromMercatorZ(r){return this.scaleZoom(this.cameraToCenterDistance/(r*this.tileSize))}zoomFromMercatorZAdjusted(r){const s=w=>{const E=this.getCameraToCenterDistance(this.projection,w);return this.scaleZoom(E/(r*this.tileSize))};let f,g=s(this.zoom),y=Math.abs(g-s(g));for(;f!==y;)g=s(g),f=y,y=Math.abs(g-s(g));return g}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(u.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(r,s){const f=Math.min(r.x,s.x),g=Math.max(r.x,s.x),y=Math.min(r.y,s.y),w=Math.max(r.y,s.y);if(y<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const E=[new u.pointGeometry(f,y),new u.pointGeometry(g,w),new u.pointGeometry(f,w),new u.pointGeometry(g,y)],C=this.renderWorldCopies?-3:0,z=this.renderWorldCopies?4:1;for(const D of E){const B=this.pointRayIntersection(D);if(B.t<0)return!0;const j=this.rayIntersectionCoordinate(B);if(j.x<C||j.y<0||j.x>z||j.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+u.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new u.pointGeometry(0,0),new u.pointGeometry(this.width,this.height))}zoomDeltaToMovement(r,s){const f=u.length(u.sub([],this._camera.position,r)),g=this._zoomFromMercatorZ(f)+s;return f-this._mercatorZfromZoom(g)}getCameraPoint(){if(this.projection.name==="globe"){const r=function([s,f,g],y){const w=[s,f,g,1];u.transformMat4$1(w,w,y);const E=w[3]=Math.max(w[3],1e-6);return w[0]/=E,w[1]/=E,w[2]/=E,w}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new u.pointGeometry(r[0],r[1])}{const r=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new u.pointGeometry(0,r))}}getCameraToCenterDistance(r,s=this.zoom){const f=ul(r,s,this.width,this.height,1024),g=r.pixelSpaceConversion(this.center.lat,this.worldSize,f);return .5/Math.tan(.5*this._fov)*this.height*g}getWorldToCameraMatrix(){const r=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&u.multiply(r,r,this.globeMatrix),r}}function Gl(h,r){let s=!1,f=null;const g=()=>{f=null,s&&(h(),f=setTimeout(g,r),s=!1)};return()=>(s=!0,f||g(),f)}class mt{constructor(r){this._hashName=r&&encodeURIComponent(r),u.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Gl(this._updateHashUnthrottled.bind(this),300)}addTo(r){return this._map=r,u.window.addEventListener("hashchange",this._onHashChange,!1),r.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),u.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const r=this._map;if(!r)return"";const s=na(r);if(this._hashName){const f=this._hashName;let g=!1;const y=u.window.location.hash.slice(1).split("&").map(w=>{const E=w.split("=")[0];return E===f?(g=!0,`${E}=${s}`):w}).filter(w=>w);return g||y.push(`${f}=${s}`),`#${y.join("&")}`}return`#${s}`}_getCurrentHash(){const r=u.window.location.hash.replace("#","");if(this._hashName){let s;return r.split("&").map(f=>f.split("=")).forEach(f=>{f[0]===this._hashName&&(s=f)}),(s&&s[1]||"").split("/")}return r.split("/")}_onHashChange(){const r=this._map;if(!r)return!1;const s=this._getCurrentHash();if(s.length>=3&&!s.some(f=>isNaN(f))){const f=r.dragRotate.isEnabled()&&r.touchZoomRotate.isEnabled()?+(s[3]||0):r.getBearing();return r.jumpTo({center:[+s[2],+s[1]],zoom:+s[0],bearing:f,pitch:+(s[4]||0)}),!0}return!1}_updateHashUnthrottled(){const r=u.window.location.href.replace(/(#.+)?$/,this.getHashString());u.window.history.replaceState(u.window.history.state,null,r)}}function na(h,r){const s=h.getCenter(),f=Math.round(100*h.getZoom())/100,g=Math.ceil((f*Math.LN2+Math.log(512/360/.5))/Math.LN10),y=Math.pow(10,g),w=Math.round(s.lng*y)/y,E=Math.round(s.lat*y)/y,C=h.getBearing(),z=h.getPitch();let D=r?`/${w}/${E}/${f}`:`${f}/${E}/${w}`;return(C||z)&&(D+="/"+Math.round(10*C)/10),z&&(D+=`/${Math.round(z)}`),D}const ls={linearity:.3,easing:u.bezier(0,0,.3,1)},Zd=u.extend({deceleration:2500,maxSpeed:1400},ls),mp=u.extend({deceleration:20,maxSpeed:1400},ls),$l=u.extend({deceleration:1e3,maxSpeed:360},ls),gp=u.extend({deceleration:1e3,maxSpeed:90},ls);class Fc{constructor(r){this._map=r,this.clear()}clear(){this._inertiaBuffer=[]}record(r){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:u.exported.now(),settings:r})}_drainInertiaBuffer(){const r=this._inertiaBuffer,s=u.exported.now();for(;r.length>0&&s-r[0].time>160;)r.shift()}_onMoveEnd(r){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const s={zoom:0,bearing:0,pitch:0,pan:new u.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:y}of this._inertiaBuffer)s.zoom+=y.zoomDelta||0,s.bearing+=y.bearingDelta||0,s.pitch+=y.pitchDelta||0,y.panDelta&&s.pan._add(y.panDelta),y.around&&(s.around=y.around),y.pinchAround&&(s.pinchAround=y.pinchAround);const f=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,g={};if(s.pan.mag()){const y=cl(s.pan.mag(),f,u.extend({},Zd,r||{}));g.offset=s.pan.mult(y.amount/s.pan.mag()),g.center=this._map.transform.center,ql(g,y)}if(s.zoom){const y=cl(s.zoom,f,mp);g.zoom=this._map.transform.zoom+y.amount,ql(g,y)}if(s.bearing){const y=cl(s.bearing,f,$l);g.bearing=this._map.transform.bearing+u.clamp(y.amount,-179,179),ql(g,y)}if(s.pitch){const y=cl(s.pitch,f,gp);g.pitch=this._map.transform.pitch+y.amount,ql(g,y)}if(g.zoom||g.bearing){const y=s.pinchAround===void 0?s.around:s.pinchAround;g.around=y?this._map.unproject(y):this._map.getCenter()}return this.clear(),g.noMoveStart=!0,g}}function ql(h,r){(!h.duration||h.duration<r.duration)&&(h.duration=r.duration,h.easing=r.easing)}function cl(h,r,s){const{maxSpeed:f,linearity:g,deceleration:y}=s,w=u.clamp(h*g/(r/1e3),-f,f),E=Math.abs(w)/(y*g);return{easing:s.easing,duration:1e3*E,amount:w*(E/2)}}class xa extends u.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,s,f,g={}){const y=Ge(s.getCanvasContainer(),f),w=s.unproject(y);super(r,u.extend({point:y,lngLat:w,originalEvent:f},g)),this._defaultPrevented=!1,this.target=s}}class Uc extends u.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,s,f){const g=r==="touchend"?f.changedTouches:f.touches,y=Nn(s.getCanvasContainer(),g),w=y.map(C=>s.unproject(C)),E=y.reduce((C,z,D,B)=>C.add(z.div(B.length)),new u.pointGeometry(0,0));super(r,{points:y,point:E,lngLats:w,lngLat:s.unproject(E),originalEvent:f}),this._defaultPrevented=!1}}class Hl extends u.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,s,f){super(r,{originalEvent:f}),this._defaultPrevented=!1}}class qm{constructor(r,s){this._map=r,this._clickTolerance=s.clickTolerance}reset(){this._mousedownPos=void 0}wheel(r){return this._firePreventable(new Hl(r.type,this._map,r))}mousedown(r,s){return this._mousedownPos=s,this._firePreventable(new xa(r.type,this._map,r))}mouseup(r){this._map.fire(new xa(r.type,this._map,r))}preclick(r){const s=u.extend({},r);s.type="preclick",this._map.fire(new xa(s.type,this._map,s))}click(r,s){this._mousedownPos&&this._mousedownPos.dist(s)>=this._clickTolerance||(this.preclick(r),this._map.fire(new xa(r.type,this._map,r)))}dblclick(r){return this._firePreventable(new xa(r.type,this._map,r))}mouseover(r){this._map.fire(new xa(r.type,this._map,r))}mouseout(r){this._map.fire(new xa(r.type,this._map,r))}touchstart(r){return this._firePreventable(new Uc(r.type,this._map,r))}touchmove(r){this._map.fire(new Uc(r.type,this._map,r))}touchend(r){this._map.fire(new Uc(r.type,this._map,r))}touchcancel(r){this._map.fire(new Uc(r.type,this._map,r))}_firePreventable(r){if(this._map.fire(r),r.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Hm{constructor(r){this._map=r}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(r){this._map.fire(new xa(r.type,this._map,r))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new xa("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(r){this._delayContextMenu?this._contextMenuEvent=r:this._map.fire(new xa(r.type,this._map,r)),this._map.listens("contextmenu")&&r.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class _p{constructor(r,s){this._map=r,this._el=r.getCanvasContainer(),this._container=r.getContainer(),this._clickTolerance=s.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(r,s){this.isEnabled()&&r.shiftKey&&r.button===0&&(kr(),this._startPos=this._lastPos=s,this._active=!0)}mousemoveWindow(r,s){if(!this._active)return;const f=s,g=this._startPos,y=this._lastPos;if(!g||!y||y.equals(f)||!this._box&&f.dist(g)<this._clickTolerance)return;this._lastPos=f,this._box||(this._box=gt("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",r));const w=Math.min(g.x,f.x),E=Math.max(g.x,f.x),C=Math.min(g.y,f.y),z=Math.max(g.y,f.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${w}px,${C}px)`,this._box.style.width=E-w+"px",this._box.style.height=z-C+"px")})}mouseupWindow(r,s){if(!this._active)return;const f=this._startPos,g=s;if(f&&r.button===0){if(this.reset(),Oi(),f.x!==g.x||f.y!==g.y)return this._map.fire(new u.Event("boxzoomend",{originalEvent:r})),{cameraAnimation:y=>y.fitScreenCoordinates(f,g,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",r)}}keydown(r){this._active&&r.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",r))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),zn(),delete this._startPos,delete this._lastPos}_fireEvent(r,s){return this._map.fire(new u.Event(r,{originalEvent:s}))}}function us(h,r){const s={};for(let f=0;f<h.length;f++)s[h[f].identifier]=r[f];return s}class Nc{constructor(r){this.reset(),this.numTouches=r.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(r,s,f){(this.centroid||f.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=r.timeStamp),f.length===this.numTouches&&(this.centroid=function(g){const y=new u.pointGeometry(0,0);for(const w of g)y._add(w);return y.div(g.length)}(s),this.touches=us(f,s)))}touchmove(r,s,f){if(this.aborted||!this.centroid)return;const g=us(f,s);for(const y in this.touches){const w=this.touches[y],E=g[y];(!E||E.dist(w)>30)&&(this.aborted=!0)}}touchend(r,s,f){if((!this.centroid||r.timeStamp-this.startTime>500)&&(this.aborted=!0),f.length===0){const g=!this.aborted&&this.centroid;if(this.reset(),g)return g}}}class hl{constructor(r){this.singleTap=new Nc(r),this.numTaps=r.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(r,s,f){this.singleTap.touchstart(r,s,f)}touchmove(r,s,f){this.singleTap.touchmove(r,s,f)}touchend(r,s,f){const g=this.singleTap.touchend(r,s,f);if(g){const y=r.timeStamp-this.lastTime<500,w=!this.lastTap||this.lastTap.dist(g)<30;if(y&&w||this.reset(),this.count++,this.lastTime=r.timeStamp,this.lastTap=g,this.count===this.numTaps)return this.reset(),g}}}class Xd{constructor(){this._zoomIn=new hl({numTouches:1,numTaps:2}),this._zoomOut=new hl({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(r,s,f){this._zoomIn.touchstart(r,s,f),this._zoomOut.touchstart(r,s,f)}touchmove(r,s,f){this._zoomIn.touchmove(r,s,f),this._zoomOut.touchmove(r,s,f)}touchend(r,s,f){const g=this._zoomIn.touchend(r,s,f),y=this._zoomOut.touchend(r,s,f);return g?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:w.getZoom()+1,around:w.unproject(g)},{originalEvent:r})}):y?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:w.getZoom()-1,around:w.unproject(y)},{originalEvent:r})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Vc={0:1,2:2};class Zl{constructor(r){this.reset(),this._clickTolerance=r.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(r,s){return!1}_move(r,s){return{}}mousedown(r,s){if(this._lastPoint)return;const f=xn(r);this._correctButton(r,f)&&(this._lastPoint=s,this._eventButton=f)}mousemoveWindow(r,s){const f=this._lastPoint;if(f){if(r.preventDefault(),this._eventButton!=null&&function(g,y){const w=Vc[y];return g.buttons===void 0||(g.buttons&w)!==w}(r,this._eventButton))this.reset();else if(this._moved||!(s.dist(f)<this._clickTolerance))return this._moved=!0,this._lastPoint=s,this._move(f,s)}}mouseupWindow(r){this._lastPoint&&xn(r)===this._eventButton&&(this._moved&&Oi(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class yp extends Zl{mousedown(r,s){super.mousedown(r,s),this._lastPoint&&(this._active=!0)}_correctButton(r,s){return s===0&&!r.ctrlKey}_move(r,s){return{around:s,panDelta:s.sub(r)}}}class dl extends Zl{_correctButton(r,s){return s===0&&r.ctrlKey||s===2}_move(r,s){const f=.8*(s.x-r.x);if(f)return this._active=!0,{bearingDelta:f}}contextmenu(r){r.preventDefault()}}class Pu extends Zl{_correctButton(r,s){return s===0&&r.ctrlKey||s===2}_move(r,s){const f=-.5*(s.y-r.y);if(f)return this._active=!0,{pitchDelta:f}}contextmenu(r){r.preventDefault()}}class jc{constructor(r,s){this._map=r,this._el=r.getCanvasContainer(),this._minTouches=1,this._clickTolerance=s.clickTolerance||1,this.reset(),u.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new u.pointGeometry(0,0)}touchstart(r,s,f){return this._calculateTransform(r,s,f)}touchmove(r,s,f){if(this._active&&!(f.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(f.length===1&&!u.isFullscreen())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return r.cancelable&&r.preventDefault(),this._calculateTransform(r,s,f)}}touchend(r,s,f){this._calculateTransform(r,s,f),this._active&&f.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(r,s,f){f.length>0&&(this._active=!0);const g=us(f,s),y=new u.pointGeometry(0,0),w=new u.pointGeometry(0,0);let E=0;for(const z in g){const D=g[z],B=this._touches[z];B&&(y._add(D),w._add(D.sub(B)),E++,g[z]=D)}if(this._touches=g,E<this._minTouches||!w.mag())return;const C=w.div(E);return this._sum._add(C),this._sum.mag()<this._clickTolerance?void 0:{around:y.div(E),panDelta:C}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=gt("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class Bu{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(r){}_move(r,s,f){return{}}touchstart(r,s,f){this._firstTwoTouches||f.length<2||(this._firstTwoTouches=[f[0].identifier,f[1].identifier],this._start([s[0],s[1]]))}touchmove(r,s,f){const g=this._firstTwoTouches;if(!g)return;r.preventDefault();const[y,w]=g,E=Us(f,s,y),C=Us(f,s,w);if(!E||!C)return;const z=this._aroundCenter?null:E.add(C).div(2);return this._move([E,C],z,r)}touchend(r,s,f){if(!this._firstTwoTouches)return;const[g,y]=this._firstTwoTouches,w=Us(f,s,g),E=Us(f,s,y);w&&E||(this._active&&Oi(),this.reset())}touchcancel(){this.reset()}enable(r){this._enabled=!0,this._aroundCenter=!!r&&r.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Us(h,r,s){for(let f=0;f<h.length;f++)if(h[f].identifier===s)return r[f]}function Gc(h,r){return Math.log(h/r)/Math.LN2}class vp extends Bu{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(r){this._startDistance=this._distance=r[0].dist(r[1])}_move(r,s){const f=this._distance;if(this._distance=r[0].dist(r[1]),this._active||!(Math.abs(Gc(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Gc(this._distance,f),pinchAround:s}}}function xp(h,r){return 180*h.angleWith(r)/Math.PI}class bp extends Bu{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(r){this._startVector=this._vector=r[0].sub(r[1]),this._minDiameter=r[0].dist(r[1])}_move(r,s){const f=this._vector;if(this._vector=r[0].sub(r[1]),f&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:xp(this._vector,f),pinchAround:s}}_isBelowThreshold(r){this._minDiameter=Math.min(this._minDiameter,r.mag());const s=25/(Math.PI*this._minDiameter)*360,f=this._startVector;if(!f)return!1;const g=xp(r,f);return Math.abs(g)<s}}function Fu(h){return Math.abs(h.y)>Math.abs(h.x)}class Xl extends Bu{constructor(r){super(),this._map=r}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(r){this._lastPoints=r,Fu(r[0].sub(r[1]))&&(this._valid=!1)}_move(r,s,f){const g=this._lastPoints;if(!g)return;const y=r[0].sub(g[0]),w=r[1].sub(g[1]);return this._map._cooperativeGestures&&!u.isFullscreen()&&f.touches.length<3||(this._valid=this.gestureBeginsVertically(y,w,f.timeStamp),!this._valid)?void 0:(this._lastPoints=r,this._active=!0,{pitchDelta:(y.y+w.y)/2*-.5})}gestureBeginsVertically(r,s,f){if(this._valid!==void 0)return this._valid;const g=r.mag()>=2,y=s.mag()>=2;if(!g&&!y)return;if(!g||!y)return this._firstMove==null&&(this._firstMove=f),f-this._firstMove<100&&void 0;const w=r.y>0==s.y>0;return Fu(r)&&Fu(s)&&w}}const wp={panStep:100,bearingStep:15,pitchStep:10};class ba{constructor(){const r=wp;this._panStep=r.panStep,this._bearingStep=r.bearingStep,this._pitchStep=r.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(r){if(r.altKey||r.ctrlKey||r.metaKey)return;let s=0,f=0,g=0,y=0,w=0;switch(r.keyCode){case 61:case 107:case 171:case 187:s=1;break;case 189:case 109:case 173:s=-1;break;case 37:r.shiftKey?f=-1:(r.preventDefault(),y=-1);break;case 39:r.shiftKey?f=1:(r.preventDefault(),y=1);break;case 38:r.shiftKey?g=1:(r.preventDefault(),w=-1);break;case 40:r.shiftKey?g=-1:(r.preventDefault(),w=1);break;default:return}return this._rotationDisabled&&(f=0,g=0),{cameraAnimation:E=>{const C=E.getZoom();E.easeTo({duration:300,easeId:"keyboardHandler",easing:Kt,zoom:s?Math.round(C)+s*(r.shiftKey?2:1):C,bearing:E.getBearing()+f*this._bearingStep,pitch:E.getPitch()+g*this._pitchStep,offset:[-y*this._panStep,-w*this._panStep],center:E.getCenter()},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Kt(h){return h*(2-h)}const fl=4.000244140625;class Rr{constructor(r,s){this._map=r,this._el=r.getCanvasContainer(),this._handler=s,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,u.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(r){this._defaultZoomRate=r}setWheelZoomRate(r){this._wheelZoomRate=r}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(r){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!r&&r.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(r){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(r.ctrlKey||r.metaKey||this.isZooming()||u.isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let s=r.deltaMode===u.window.WheelEvent.DOM_DELTA_LINE?40*r.deltaY:r.deltaY;const f=u.exported.now(),g=f-(this._lastWheelEventTime||0);this._lastWheelEventTime=f,s!==0&&s%fl==0?this._type="wheel":s!==0&&Math.abs(s)<4?this._type="trackpad":g>400?(this._type=null,this._lastValue=s,this._timeout=setTimeout(this._onTimeout,40,r)):this._type||(this._type=Math.abs(g*s)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,s+=this._lastValue)),r.shiftKey&&s&&(s/=4),this._type&&(this._lastWheelEvent=r,this._delta-=s,this._active||this._start(r)),r.preventDefault()}_onTimeout(r){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(r)}_start(r){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const s=Ge(this._el,r);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:s,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const r=this._map.transform;this._type==="wheel"&&r.projection.wrap&&(r._center.lng>=180||r._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const s=()=>r._terrainEnabled()&&this._aroundCoord?r.computeZoomRelativeTo(this._aroundCoord):r.zoom;if(this._delta!==0){const C=this._type==="wheel"&&Math.abs(this._delta)>fl?this._wheelZoomRate:this._defaultZoomRate;let z=2/(1+Math.exp(-Math.abs(this._delta*C)));this._delta<0&&z!==0&&(z=1/z);const D=s(),B=Math.pow(2,D),j=typeof this._targetZoom=="number"?r.zoomScale(this._targetZoom):B;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom(j*z))),this._type==="wheel"&&(this._startZoom=D,this._easing=this._smoothOutEasing(200)),this._delta=0}const f=typeof this._targetZoom=="number"?this._targetZoom:s(),g=this._startZoom,y=this._easing;let w,E=!1;if(this._type==="wheel"&&g&&y){const C=Math.min((u.exported.now()-this._lastWheelEventTime)/200,1),z=y(C);w=u.number(g,f,z),C<1?this._frameId||(this._frameId=!0):E=!0}else w=f,E=!0;return this._active=!0,E&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!E,zoomDelta:w-s(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(r){let s=u.ease;if(this._prevEase){const f=this._prevEase,g=(u.exported.now()-f.start)/f.duration,y=f.easing(g+.01)-f.easing(g),w=.27/Math.sqrt(y*y+1e-4)*.01,E=Math.sqrt(.0729-w*w);s=u.bezier(w,E,.25,1)}return this._prevEase={start:u.exported.now(),duration:r,easing:s},s}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=gt("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(u.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class jn{constructor(r,s){this._clickZoom=r,this._tapZoom=s}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Ca{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(r,s){return r.preventDefault(),{cameraAnimation:f=>{f.easeTo({duration:300,zoom:f.getZoom()+(r.shiftKey?-1:1),around:f.unproject(s)},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Uu{constructor(){this._tap=new hl({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(r,s,f){this._swipePoint||(this._tapTime&&r.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?f.length>0&&(this._swipePoint=s[0],this._swipeTouch=f[0].identifier):this._tap.touchstart(r,s,f))}touchmove(r,s,f){if(this._tapTime){if(this._swipePoint){if(f[0].identifier!==this._swipeTouch)return;const g=s[0],y=g.y-this._swipePoint.y;return this._swipePoint=g,r.preventDefault(),this._active=!0,{zoomDelta:y/128}}}else this._tap.touchmove(r,s,f)}touchend(r,s,f){this._tapTime?this._swipePoint&&f.length===0&&this.reset():this._tap.touchend(r,s,f)&&(this._tapTime=r.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class pl{constructor(r,s,f){this._el=r,this._mousePan=s,this._touchPan=f}enable(r){this._inertiaOptions=r||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class wn{constructor(r,s,f){this._pitchWithRotate=r.pitchWithRotate,this._mouseRotate=s,this._mousePitch=f}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class xo{constructor(r,s,f,g){this._el=r,this._touchZoom=s,this._touchRotate=f,this._tapDragZoom=g,this._rotationDisabled=!1,this._enabled=!0}enable(r){this._touchZoom.enable(r),this._rotationDisabled||this._touchRotate.enable(r),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const ft=h=>h.zoom||h.drag||h.pitch||h.rotate;class ml extends u.Event{}class bo{constructor(){this.constants=[1,1,.01],this.radius=0}setup(r,s){const f=u.sub([],s,r);this.radius=u.length(f[2]<0?u.div([],f,this.constants):[f[0],f[1],0])}projectRay(r){u.div(r,r,this.constants),u.normalize(r,r),u.mul$1(r,r,this.constants);const s=u.scale$2([],r,this.radius);if(s[2]>0){const f=u.scale$2([],[0,0,1],u.dot(s,[0,0,1])),g=u.scale$2([],u.normalize([],[s[0],s[1],0]),this.radius),y=u.add([],s,u.scale$2([],u.sub([],u.add([],g,f),s),2));s[0]=y[0],s[1]=y[1]}return s}}function wa(h){return h.panDelta&&h.panDelta.mag()||h.zoomDelta||h.bearingDelta||h.pitchDelta}class Fo{constructor(r,s){this._map=r,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Fc(r),this._bearingSnap=s.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new bo,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(s),u.bindAll(["handleEvent","handleWindowEvent"],this);const f=this._el;this._listeners=[[f,"touchstart",{passive:!0}],[f,"touchmove",{passive:!1}],[f,"touchend",void 0],[f,"touchcancel",void 0],[f,"mousedown",void 0],[f,"mousemove",void 0],[f,"mouseup",void 0],[u.window.document,"mousemove",{capture:!0}],[u.window.document,"mouseup",void 0],[f,"mouseover",void 0],[f,"mouseout",void 0],[f,"dblclick",void 0],[f,"click",void 0],[f,"keydown",{capture:!1}],[f,"keyup",void 0],[f,"wheel",{passive:!1}],[f,"contextmenu",void 0],[u.window,"blur",void 0]];for(const[g,y,w]of this._listeners)g.addEventListener(y,g===u.window.document?this.handleWindowEvent:this.handleEvent,w)}destroy(){for(const[r,s,f]of this._listeners)r.removeEventListener(s,r===u.window.document?this.handleWindowEvent:this.handleEvent,f)}_addDefaultHandlers(r){const s=this._map,f=s.getCanvasContainer();this._add("mapEvent",new qm(s,r));const g=s.boxZoom=new _p(s,r);this._add("boxZoom",g);const y=new Xd,w=new Ca;s.doubleClickZoom=new jn(w,y),this._add("tapZoom",y),this._add("clickZoom",w);const E=new Uu;this._add("tapDragZoom",E);const C=s.touchPitch=new Xl(s);this._add("touchPitch",C);const z=new dl(r),D=new Pu(r);s.dragRotate=new wn(r,z,D),this._add("mouseRotate",z,["mousePitch"]),this._add("mousePitch",D,["mouseRotate"]);const B=new yp(r),j=new jc(s,r);s.dragPan=new pl(f,B,j),this._add("mousePan",B),this._add("touchPan",j,["touchZoom","touchRotate"]);const W=new bp,X=new vp;s.touchZoomRotate=new xo(f,X,W,E),this._add("touchRotate",W,["touchPan","touchZoom"]),this._add("touchZoom",X,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Hm(s));const Y=s.scrollZoom=new Rr(s,this);this._add("scrollZoom",Y,["mousePan"]);const G=s.keyboard=new ba;this._add("keyboard",G);for(const q of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])r.interactive&&r[q]&&s[q].enable(r[q])}_add(r,s,f){this._handlers.push({handlerName:r,handler:s,allowed:f}),this._handlersById[r]=s}stop(r){if(!this._updatingCamera){for(const{handler:s}of this._handlers)s.reset();this._inertia.clear(),this._fireEvents({},{},r),this._changes=[]}}isActive(){for(const{handler:r}of this._handlers)if(r.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!ft(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(r,s,f){for(const g in r)if(g!==f&&(!s||s.indexOf(g)<0))return!0;return!1}handleWindowEvent(r){this.handleEvent(r,`${r.type}Window`)}_getMapTouches(r){const s=[];for(const f of r)this._el.contains(f.target)&&s.push(f);return s}handleEvent(r,s){this._updatingCamera=!0;const f=r.type==="renderFrame",g=f?void 0:r,y={needsRenderFrame:!1},w={},E={},C=r.touches?this._getMapTouches(r.touches):void 0,z=C?Nn(this._el,C):f?void 0:Ge(this._el,r);for(const{handlerName:j,handler:W,allowed:X}of this._handlers){if(!W.isEnabled())continue;let Y;this._blockedByActive(E,X,j)?W.reset():W[s||r.type]&&(Y=W[s||r.type](r,z,C),this.mergeHandlerResult(y,w,Y,j,g),Y&&Y.needsRenderFrame&&this._triggerRenderFrame()),(Y||W.isActive())&&(E[j]=W)}const D={};for(const j in this._previousActiveHandlers)E[j]||(D[j]=g);this._previousActiveHandlers=E,(Object.keys(D).length||wa(y))&&(this._changes.push([y,w,D]),this._triggerRenderFrame()),(Object.keys(E).length||wa(y))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:B}=y;B&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],B(this._map))}mergeHandlerResult(r,s,f,g,y){if(!f)return;u.extend(r,f);const w={handlerName:g,originalEvent:f.originalEvent||y};f.zoomDelta!==void 0&&(s.zoom=w),f.panDelta!==void 0&&(s.drag=w),f.pitchDelta!==void 0&&(s.pitch=w),f.bearingDelta!==void 0&&(s.rotate=w)}_applyChanges(){const r={},s={},f={};for(const[g,y,w]of this._changes)g.panDelta&&(r.panDelta=(r.panDelta||new u.pointGeometry(0,0))._add(g.panDelta)),g.zoomDelta&&(r.zoomDelta=(r.zoomDelta||0)+g.zoomDelta),g.bearingDelta&&(r.bearingDelta=(r.bearingDelta||0)+g.bearingDelta),g.pitchDelta&&(r.pitchDelta=(r.pitchDelta||0)+g.pitchDelta),g.around!==void 0&&(r.around=g.around),g.aroundCoord!==void 0&&(r.aroundCoord=g.aroundCoord),g.pinchAround!==void 0&&(r.pinchAround=g.pinchAround),g.noInertia&&(r.noInertia=g.noInertia),u.extend(s,y),u.extend(f,w);this._updateMapTransform(r,s,f),this._changes=[]}_updateMapTransform(r,s,f){const g=this._map,y=g.transform,w=ee=>[ee.x,ee.y,ee.z];if((ee=>{const Q=this._eventsInProgress.drag;return Q&&!this._handlersById[Q.handlerName].isActive()})()&&!wa(r)){const ee=y.zoom;y.cameraElevationReference="sea",y.recenterOnTerrain(),y.cameraElevationReference="ground",ee!==y.zoom&&this._map._update(!0)}if(y._isCameraConstrained&&g._stop(!0),!wa(r))return void this._fireEvents(s,f,!0);let{panDelta:E,zoomDelta:C,bearingDelta:z,pitchDelta:D,around:B,aroundCoord:j,pinchAround:W}=r;y._isCameraConstrained&&(C>0&&(C=0),y._isCameraConstrained=!1),W!==void 0&&(B=W),(ee=>s.drag&&!this._eventsInProgress.drag)()&&B&&(this._dragOrigin=w(y.pointCoordinate3D(B)),this._trackingEllipsoid.setup(y._camera.position,this._dragOrigin)),y.cameraElevationReference="sea",g._stop(!0),B=B||g.transform.centerPoint,z&&(y.bearing+=z),D&&(y.pitch+=D),y._updateCameraState();const X=[0,0,0];if(E)if(y.projection.name==="mercator"){const ee=this._trackingEllipsoid.projectRay(y.screenPointToMercatorRay(B).dir),Q=this._trackingEllipsoid.projectRay(y.screenPointToMercatorRay(B.sub(E)).dir);X[0]=Q[0]-ee[0],X[1]=Q[1]-ee[1]}else{const ee=y.pointCoordinate(B);if(y.projection.name==="globe"){E=E.rotate(-y.angle);const Q=y._pixelsPerMercatorPixel/y.worldSize;X[0]=-E.x*u.mercatorScale(u.latFromMercatorY(ee.y))*Q,X[1]=-E.y*u.mercatorScale(y.center.lat)*Q}else{const Q=y.pointCoordinate(B.sub(E));ee&&Q&&(X[0]=Q.x-ee.x,X[1]=Q.y-ee.y)}}const Y=y.zoom,G=[0,0,0];if(C){const ee=w(j||y.pointCoordinate3D(B)),Q={dir:u.normalize([],u.sub([],ee,y._camera.position))};if(Q.dir[2]<0){const ae=y.zoomDeltaToMovement(ee,C);u.scale$2(G,Q.dir,ae)}}const q=u.add(X,X,G);y._translateCameraConstrained(q),C&&Math.abs(y.zoom-Y)>1e-4&&y.recenterOnTerrain(),y.cameraElevationReference="ground",this._map._update(),r.noInertia||this._inertia.record(r),this._fireEvents(s,f,!0)}_fireEvents(r,s,f){const g=ft(this._eventsInProgress),y=ft(r),w={};for(const D in r){const{originalEvent:B}=r[D];this._eventsInProgress[D]||(w[`${D}start`]=B),this._eventsInProgress[D]=r[D]}!g&&y&&this._fireEvent("movestart",y.originalEvent);for(const D in w)this._fireEvent(D,w[D]);y&&this._fireEvent("move",y.originalEvent);for(const D in r){const{originalEvent:B}=r[D];this._fireEvent(D,B)}const E={};let C;for(const D in this._eventsInProgress){const{handlerName:B,originalEvent:j}=this._eventsInProgress[D];this._handlersById[B].isActive()||(delete this._eventsInProgress[D],C=s[B]||j,E[`${D}end`]=C)}for(const D in E)this._fireEvent(D,E[D]);const z=ft(this._eventsInProgress);if(f&&(g||y)&&!z){this._updatingCamera=!0;const D=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),B=j=>j!==0&&-this._bearingSnap<j&&j<this._bearingSnap;D?(B(D.bearing||this._map.getBearing())&&(D.bearing=0),this._map.easeTo(D,{originalEvent:C})):(this._map.fire(new u.Event("moveend",{originalEvent:C})),B(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(r,s){this._map.fire(new u.Event(r,s?{originalEvent:s}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(r=>{this._frameId=void 0,this.handleEvent(new ml("renderFrame",{timeStamp:r})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Nu="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Tp extends u.Evented{constructor(r,s){super(),this._moving=!1,this._zooming=!1,this.transform=r,this._bearingSnap=s.bearingSnap,u.bindAll(["_renderFrameCallback"],this)}getCenter(){return new u.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(r,s){return this.jumpTo({center:r},s)}panBy(r,s,f){return r=u.pointGeometry.convert(r).mult(-1),this.panTo(this.transform.center,u.extend({offset:r},s),f)}panTo(r,s,f){return this.easeTo(u.extend({center:r},s),f)}getZoom(){return this.transform.zoom}setZoom(r,s){return this.jumpTo({zoom:r},s),this}zoomTo(r,s,f){return this.easeTo(u.extend({zoom:r},s),f)}zoomIn(r,s){return this.zoomTo(this.getZoom()+1,r,s),this}zoomOut(r,s){return this.zoomTo(this.getZoom()-1,r,s),this}getBearing(){return this.transform.bearing}setBearing(r,s){return this.jumpTo({bearing:r},s),this}getPadding(){return this.transform.padding}setPadding(r,s){return this.jumpTo({padding:r},s),this}rotateTo(r,s,f){return this.easeTo(u.extend({bearing:r},s),f)}resetNorth(r,s){return this.rotateTo(0,u.extend({duration:1e3},r),s),this}resetNorthPitch(r,s){return this.easeTo(u.extend({bearing:0,pitch:0,duration:1e3},r),s),this}snapToNorth(r,s){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(r,s):this}getPitch(){return this.transform.pitch}setPitch(r,s){return this.jumpTo({pitch:r},s),this}cameraForBounds(r,s){r=u.LngLatBounds.convert(r);const f=s&&s.bearing||0,g=s&&s.pitch||0,y=r.getNorthWest(),w=r.getSouthEast();return this._cameraForBounds(this.transform,y,w,f,g,s)}_extendCameraOptions(r){const s={top:0,bottom:0,right:0,left:0};if(typeof(r=u.extend({padding:s,offset:[0,0],maxZoom:this.transform.maxZoom},r)).padding=="number"){const f=r.padding;r.padding={top:f,bottom:f,right:f,left:f}}return r.padding=u.extend(s,r.padding),r}_minimumAABBFrustumDistance(r,s){const f=s.max[0]-s.min[0],g=s.max[1]-s.min[1];return f/g>r.aspect?f/(2*Math.tan(.5*r.fovX)*r.aspect):g/(2*Math.tan(.5*r.fovY)*r.aspect)}_cameraForBoundsOnGlobe(r,s,f,g,y,w){const E=r.clone(),C=this._extendCameraOptions(w);E.bearing=g,E.pitch=y;const z=u.LngLat.convert(s),D=u.LngLat.convert(f),B=.5*(z.lat+D.lat),j=.5*(z.lng+D.lng),W=u.latLngToECEF(B,j),X=u.normalize([],W),Y=u.normalize([],u.cross([],X,[0,1,0])),G=u.cross([],Y,X),q=[Y[0],Y[1],Y[2],0,G[0],G[1],G[2],0,X[0],X[1],X[2],0,0,0,0,1],ee=[W,u.latLngToECEF(z.lat,z.lng),u.latLngToECEF(D.lat,z.lng),u.latLngToECEF(D.lat,D.lng),u.latLngToECEF(z.lat,D.lng),u.latLngToECEF(B,z.lng),u.latLngToECEF(B,D.lng),u.latLngToECEF(z.lat,j),u.latLngToECEF(D.lat,j)];let Q=u.Aabb.fromPoints(ee.map(be=>[u.dot(Y,be),u.dot(G,be),u.dot(X,be)]));const ae=u.transformMat4([],Q.center,q);u.squaredLength(ae)===0&&u.set(ae,0,0,1),u.normalize(ae,ae),u.scale$2(ae,ae,u.GLOBE_RADIUS),E.center=u.ecefToLatLng(ae);const fe=E.getWorldToCameraMatrix(),le=u.invert(new Float64Array(16),fe);Q=u.Aabb.applyTransform(Q,u.multiply([],fe,q)),u.transformMat4(ae,ae,fe);const re=.5*(Q.max[2]-Q.min[2]),Ce=this._minimumAABBFrustumDistance(E,Q),we=u.scale$2([],[0,0,1],re),ve=u.add(we,ae,we),nt=Ce+(E.pitch===0?0:u.distance(ae,ve)),Ee=E.globeCenterInViewSpace,je=u.sub([],ae,[Ee[0],Ee[1],Ee[2]]);u.normalize(je,je),u.scale$2(je,je,nt);const De=u.add([],ae,je);u.transformMat4(De,De,le);const Ze=u.earthRadius/u.GLOBE_RADIUS,Le=u.length(De),Ye=u.mercatorZfromAltitude(Le*Ze-u.earthRadius,0),it=Math.min(E.zoomFromMercatorZAdjusted(Ye),C.maxZoom);return it>.5*(u.GLOBE_ZOOM_THRESHOLD_MIN+u.GLOBE_ZOOM_THRESHOLD_MAX)?(E.setProjection({name:"mercator"}),E.zoom=it,this._cameraForBounds(E,s,f,g,y,w)):{center:E.center,zoom:it,bearing:g,pitch:y}}queryTerrainElevation(r,s){const f=this.transform.elevation;return f?(s=u.extend({},{exaggerated:!0},s),f.getAtPoint(u.MercatorCoordinate.fromLngLat(r),null,s.exaggerated)):null}_cameraForBounds(r,s,f,g,y,w){if(r.projection.name==="globe")return this._cameraForBoundsOnGlobe(r,s,f,g,y,w);const E=r.clone(),C=this._extendCameraOptions(w),z=E.padding;E.bearing=g,E.pitch=y;const D=u.LngLat.convert(s),B=u.LngLat.convert(f),j=new u.LngLat(D.lng,B.lat),W=new u.LngLat(B.lng,D.lat),X=E.project(D),Y=E.project(B),G=this.queryTerrainElevation(D),q=this.queryTerrainElevation(B),ee=this.queryTerrainElevation(j),Q=this.queryTerrainElevation(W),ae=[[X.x,X.y,Math.min(G||0,q||0,ee||0,Q||0)],[Y.x,Y.y,Math.max(G||0,q||0,ee||0,Q||0)]];let fe=u.Aabb.fromPoints(ae);const le=E.getWorldToCameraMatrix(),re=u.invert(new Float64Array(16),le);fe=u.Aabb.applyTransform(fe,le);const Ce=u.sub([],fe.max,fe.min),we=z.left||0,ve=z.right||0,nt=z.bottom||0,Ee=z.top||0,{left:je,right:De,top:Ze,bottom:Le}=C.padding,Ye=.5*(we+ve),it=.5*(Ee+nt),be=Math.min(E.scaleZoom(E.scale*Math.min((E.width-(we+ve+je+De))/Ce[0],(E.height-(nt+Ee+Le+Ze))/Ce[1])),C.maxZoom),Re=E.scale/E.zoomScale(be);fe=new u.Aabb([fe.min[0]-(je+Ye)*Re,fe.min[1]-(Le+it)*Re,fe.min[2]],[fe.max[0]+(De+Ye)*Re,fe.max[1]+(Ze+it)*Re,fe.max[2]]);const wt=.5*Ce[2],Pt=this._minimumAABBFrustumDistance(E,fe),St=[0,0,1,0];u.transformMat4$1(St,St,le),u.normalize$2(St,St);const Ht=u.scale$2([],St,Pt+wt),fn=u.add([],fe.center,Ht),Bt=(typeof C.offset.x=="number"&&typeof C.offset.y=="number"?new u.pointGeometry(C.offset.x,C.offset.y):u.pointGeometry.convert(C.offset)).rotate(-u.degToRad(g));fe.center[0]-=Bt.x*Re,fe.center[1]+=Bt.y*Re,u.transformMat4(fe.center,fe.center,re),u.transformMat4(fn,fn,re);const yt=[fe.center[0],fe.center[1],fn[2]*E.pixelsPerMeter];u.scale$2(yt,yt,1/E.worldSize);const ei=u.lngFromMercatorX(yt[0]),Gn=u.latFromMercatorY(yt[1]),_i=Math.min(E._zoomFromMercatorZ(yt[2]),C.maxZoom),hi=new u.LngLat(ei,Gn);return E.mercatorFromTransition&&_i<.5*(u.GLOBE_ZOOM_THRESHOLD_MIN+u.GLOBE_ZOOM_THRESHOLD_MAX)?(E.setProjection({name:"globe"}),E.zoom=_i,this._cameraForBounds(E,s,f,g,y,w)):{center:hi,zoom:_i,bearing:g,pitch:y}}fitBounds(r,s,f){const g=this.cameraForBounds(r,s);return this._fitInternal(g,s,f)}fitScreenCoordinates(r,s,f,g,y){const w=u.pointGeometry.convert(r),E=u.pointGeometry.convert(s),C=new u.pointGeometry(Math.min(w.x,E.x),Math.min(w.y,E.y)),z=new u.pointGeometry(Math.max(w.x,E.x),Math.max(w.y,E.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(w,E))return this;const D=this.transform.pointLocation3D(C),B=this.transform.pointLocation3D(z),j=this.transform.pointLocation3D(new u.pointGeometry(C.x,z.y)),W=this.transform.pointLocation3D(new u.pointGeometry(z.x,C.y)),X=[Math.min(D.lng,B.lng,j.lng,W.lng),Math.min(D.lat,B.lat,j.lat,W.lat)],Y=[Math.max(D.lng,B.lng,j.lng,W.lng),Math.max(D.lat,B.lat,j.lat,W.lat)],G=g&&g.pitch?g.pitch:this.getPitch(),q=this._cameraForBounds(this.transform,X,Y,f,G,g);return this._fitInternal(q,g,y)}_fitInternal(r,s,f){return r?(delete(s=u.extend(r,s)).padding,s.linear?this.easeTo(s,f):this.flyTo(s,f)):this}jumpTo(r,s){this.stop();const f=r.preloadOnly?this.transform.clone():this.transform;let g=!1,y=!1,w=!1;return"zoom"in r&&f.zoom!==+r.zoom&&(g=!0,f.zoom=+r.zoom),r.center!==void 0&&(f.center=u.LngLat.convert(r.center)),"bearing"in r&&f.bearing!==+r.bearing&&(y=!0,f.bearing=+r.bearing),"pitch"in r&&f.pitch!==+r.pitch&&(w=!0,f.pitch=+r.pitch),r.padding==null||f.isPaddingEqual(r.padding)||(f.padding=r.padding),r.preloadOnly?(this._preloadTiles(f),this):(this.fire(new u.Event("movestart",s)).fire(new u.Event("move",s)),g&&this.fire(new u.Event("zoomstart",s)).fire(new u.Event("zoom",s)).fire(new u.Event("zoomend",s)),y&&this.fire(new u.Event("rotatestart",s)).fire(new u.Event("rotate",s)).fire(new u.Event("rotateend",s)),w&&this.fire(new u.Event("pitchstart",s)).fire(new u.Event("pitch",s)).fire(new u.Event("pitchend",s)),this.fire(new u.Event("moveend",s)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||u.warnOnce(Nu),this.transform.getFreeCameraOptions()}setFreeCameraOptions(r,s){const f=this.transform;if(!f.projection.supportsFreeCamera)return u.warnOnce(Nu),this;this.stop();const g=f.zoom,y=f.pitch,w=f.bearing;f.setFreeCameraOptions(r);const E=g!==f.zoom,C=y!==f.pitch,z=w!==f.bearing;return this.fire(new u.Event("movestart",s)).fire(new u.Event("move",s)),E&&this.fire(new u.Event("zoomstart",s)).fire(new u.Event("zoom",s)).fire(new u.Event("zoomend",s)),z&&this.fire(new u.Event("rotatestart",s)).fire(new u.Event("rotate",s)).fire(new u.Event("rotateend",s)),C&&this.fire(new u.Event("pitchstart",s)).fire(new u.Event("pitch",s)).fire(new u.Event("pitchend",s)),this.fire(new u.Event("moveend",s)),this}easeTo(r,s){this._stop(!1,r.easeId),((r=u.extend({offset:[0,0],duration:500,easing:u.ease},r)).animate===!1||!r.essential&&u.exported.prefersReducedMotion)&&(r.duration=0);const f=this.transform,g=this.getZoom(),y=this.getBearing(),w=this.getPitch(),E=this.getPadding(),C="zoom"in r?+r.zoom:g,z="bearing"in r?this._normalizeBearing(r.bearing,y):y,D="pitch"in r?+r.pitch:w,B="padding"in r?r.padding:f.padding,j=u.pointGeometry.convert(r.offset);let W,X,Y;if(f.projection.name==="globe"){const we=u.MercatorCoordinate.fromLngLat(f.center),ve=j.rotate(-f.angle);we.x+=ve.x/f.worldSize,we.y+=ve.y/f.worldSize;const nt=we.toLngLat(),Ee=u.LngLat.convert(r.center||nt);this._normalizeCenter(Ee),W=f.centerPoint.add(ve),X=new u.pointGeometry(we.x,we.y).mult(f.worldSize),Y=new u.pointGeometry(u.mercatorXfromLng(Ee.lng),u.mercatorYfromLat(Ee.lat)).mult(f.worldSize).sub(X)}else{W=f.centerPoint.add(j);const we=f.pointLocation(W),ve=u.LngLat.convert(r.center||we);this._normalizeCenter(ve),X=f.project(we),Y=f.project(ve).sub(X)}const G=f.zoomScale(C-g);let q,ee;r.around&&(q=u.LngLat.convert(r.around),ee=f.locationPoint(q));const Q=this._zooming||C!==g,ae=this._rotating||y!==z,fe=this._pitching||D!==w,le=!f.isPaddingEqual(B),re=we=>ve=>{if(Q&&(we.zoom=u.number(g,C,ve)),ae&&(we.bearing=u.number(y,z,ve)),fe&&(we.pitch=u.number(w,D,ve)),le&&(we.interpolatePadding(E,B,ve),W=we.centerPoint.add(j)),q)we.setLocationAtPoint(q,ee);else{const nt=we.zoomScale(we.zoom-g),Ee=C>g?Math.min(2,G):Math.max(.5,G),je=Math.pow(Ee,1-ve),De=we.unproject(X.add(Y.mult(ve*je)).mult(nt));we.setLocationAtPoint(we.renderWorldCopies?De.wrap():De,W)}return r.preloadOnly||this._fireMoveEvents(s),we};if(r.preloadOnly){const we=this._emulate(re,r.duration,f);return this._preloadTiles(we),this}const Ce={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Q,this._rotating=ae,this._pitching=fe,this._padding=le,this._easeId=r.easeId,this._prepareEase(s,r.noMoveStart,Ce),this._ease(re(f),we=>{f.recenterOnTerrain(),this._afterEase(s,we)},r),this}_prepareEase(r,s,f={}){this._moving=!0,this.transform.cameraElevationReference="sea",s||f.moving||this.fire(new u.Event("movestart",r)),this._zooming&&!f.zooming&&this.fire(new u.Event("zoomstart",r)),this._rotating&&!f.rotating&&this.fire(new u.Event("rotatestart",r)),this._pitching&&!f.pitching&&this.fire(new u.Event("pitchstart",r))}_fireMoveEvents(r){this.fire(new u.Event("move",r)),this._zooming&&this.fire(new u.Event("zoom",r)),this._rotating&&this.fire(new u.Event("rotate",r)),this._pitching&&this.fire(new u.Event("pitch",r))}_afterEase(r,s){if(this._easeId&&s&&this._easeId===s)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const f=this._zooming,g=this._rotating,y=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,f&&this.fire(new u.Event("zoomend",r)),g&&this.fire(new u.Event("rotateend",r)),y&&this.fire(new u.Event("pitchend",r)),this.fire(new u.Event("moveend",r))}flyTo(r,s){if(!r.essential&&u.exported.prefersReducedMotion){const be=u.pick(r,["center","zoom","bearing","pitch","around"]);return this.jumpTo(be,s)}this.stop(),r=u.extend({offset:[0,0],speed:1.2,curve:1.42,easing:u.ease},r);const f=this.transform,g=this.getZoom(),y=this.getBearing(),w=this.getPitch(),E=this.getPadding(),C="zoom"in r?u.clamp(+r.zoom,f.minZoom,f.maxZoom):g,z="bearing"in r?this._normalizeBearing(r.bearing,y):y,D="pitch"in r?+r.pitch:w,B="padding"in r?r.padding:f.padding,j=f.zoomScale(C-g),W=u.pointGeometry.convert(r.offset);let X=f.centerPoint.add(W);const Y=f.pointLocation(X),G=u.LngLat.convert(r.center||Y);this._normalizeCenter(G);const q=f.project(Y),ee=f.project(G).sub(q);let Q=r.curve;const ae=Math.max(f.width,f.height),fe=ae/j,le=ee.mag();if("minZoom"in r){const be=u.clamp(Math.min(r.minZoom,g,C),f.minZoom,f.maxZoom),Re=ae/f.zoomScale(be-g);Q=Math.sqrt(Re/le*2)}const re=Q*Q;function Ce(be){const Re=(fe*fe-ae*ae+(be?-1:1)*re*re*le*le)/(2*(be?fe:ae)*re*le);return Math.log(Math.sqrt(Re*Re+1)-Re)}function we(be){return(Math.exp(be)-Math.exp(-be))/2}function ve(be){return(Math.exp(be)+Math.exp(-be))/2}const nt=Ce(0);let Ee=function(be){return ve(nt)/ve(nt+Q*be)},je=function(be){return ae*((ve(nt)*(we(Re=nt+Q*be)/ve(Re))-we(nt))/re)/le;var Re},De=(Ce(1)-nt)/Q;if(Math.abs(le)<1e-6||!isFinite(De)){if(Math.abs(ae-fe)<1e-6)return this.easeTo(r,s);const be=fe<ae?-1:1;De=Math.abs(Math.log(fe/ae))/Q,je=function(){return 0},Ee=function(Re){return Math.exp(be*Q*Re)}}r.duration="duration"in r?+r.duration:1e3*De/("screenSpeed"in r?+r.screenSpeed/Q:+r.speed),r.maxDuration&&r.duration>r.maxDuration&&(r.duration=0);const Ze=y!==z,Le=D!==w,Ye=!f.isPaddingEqual(B),it=be=>Re=>{const wt=Re*De,Pt=1/Ee(wt);be.zoom=Re===1?C:g+be.scaleZoom(Pt),Ze&&(be.bearing=u.number(y,z,Re)),Le&&(be.pitch=u.number(w,D,Re)),Ye&&(be.interpolatePadding(E,B,Re),X=be.centerPoint.add(W));const St=Re===1?G:be.unproject(q.add(ee.mult(je(wt))).mult(Pt));return be.setLocationAtPoint(be.renderWorldCopies?St.wrap():St,X),be._updateCameraOnTerrain(),r.preloadOnly||this._fireMoveEvents(s),be};if(r.preloadOnly){const be=this._emulate(it,r.duration,f);return this._preloadTiles(be),this}return this._zooming=!0,this._rotating=Ze,this._pitching=Le,this._padding=Ye,this._prepareEase(s,!1),this._ease(it(f),()=>this._afterEase(s),r),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(r,s){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const f=this._onEaseEnd;this._onEaseEnd=void 0,f.call(this,s)}if(!r){const f=this.handlers;f&&f.stop(!1)}return this}_ease(r,s,f){f.animate===!1||f.duration===0?(r(1),s()):(this._easeStart=u.exported.now(),this._easeOptions=f,this._onEaseFrame=r,this._onEaseEnd=s,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const r=Math.min((u.exported.now()-this._easeStart)/this._easeOptions.duration,1),s=this._onEaseFrame;s&&s(this._easeOptions.easing(r)),r<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(r,s){r=u.wrap(r,-180,180);const f=Math.abs(r-s);return Math.abs(r-360-s)<f&&(r-=360),Math.abs(r+360-s)<f&&(r+=360),r}_normalizeCenter(r){const s=this.transform;if(!s.renderWorldCopies||s.maxBounds)return;const f=r.lng-s.center.lng;r.lng+=f>180?-360:f<-180?360:0}_emulate(r,s,f){const g=Math.ceil(15*s/1e3),y=[],w=r(f.clone());for(let E=0;E<=g;E++){const C=w(E/g);y.push(C.clone())}return y}}class Wd{constructor(r={}){this.options=r,u.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(r){const s=this.options&&this.options.compact;return this._map=r,this._container=gt("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=gt("button","mapboxgl-ctrl-attrib-button",this._container),gt("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=gt("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),s&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),s===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(r,s){const f=this._map._getUIString(`AttributionControl.${s}`);r.setAttribute("aria-label",f),r.removeAttribute("title"),r.firstElementChild&&r.firstElementChild.setAttribute("title",f)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let r=this._editLink;r||(r=this._editLink=this._container.querySelector(".mapbox-improve-map"));const s=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||u.config.ACCESS_TOKEN}];if(r){const f=s.reduce((g,y,w)=>(y.value&&(g+=`${y.key}=${y.value}${w<s.length-1?"&":""}`),g),"?");r.href=`${u.config.FEEDBACK_URL}/${f}#${na(this._map,!0)}`,r.rel="noopener nofollow",this._setElementTitle(r,"MapFeedback")}}_updateData(r){!r||r.sourceDataType!=="metadata"&&r.sourceDataType!=="visibility"&&r.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let r=[];if(this._map.style.stylesheet){const g=this._map.style.stylesheet;this.styleOwner=g.owner,this.styleId=g.id}const s=this._map.style._sourceCaches;for(const g in s){const y=s[g];if(y.used){const w=y.getSource();w.attribution&&r.indexOf(w.attribution)<0&&r.push(w.attribution)}}r.sort((g,y)=>g.length-y.length),r=r.filter((g,y)=>{for(let w=y+1;w<r.length;w++)if(r[w].indexOf(g)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?r=[...this.options.customAttribution,...r]:r.unshift(this.options.customAttribution));const f=r.join(" | ");f!==this._attribHTML&&(this._attribHTML=f,r.length?(this._innerContainer.innerHTML=f,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Wl{constructor(){u.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(r){this._map=r,this._container=gt("div","mapboxgl-ctrl");const s=gt("a","mapboxgl-ctrl-logo");return s.target="_blank",s.rel="noopener nofollow",s.href="https://www.mapbox.com/",s.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),s.setAttribute("rel","noopener nofollow"),this._container.appendChild(s),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(r){r&&r.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const r=this._map.style._sourceCaches;if(Object.entries(r).length===0)return!0;for(const s in r){const f=r[s].getSource();if(f.hasOwnProperty("mapbox_logo")&&!f.mapbox_logo)return!1}return!0}_updateCompact(){const r=this._container.children;if(r.length){const s=r[0];this._map.getCanvasContainer().offsetWidth<250?s.classList.add("mapboxgl-compact"):s.classList.remove("mapboxgl-compact")}}}class ia{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(r){const s=++this._id;return this._queue.push({callback:r,id:s,cancelled:!1}),s}remove(r){const s=this._currentlyRunning,f=s?this._queue.concat(s):this._queue;for(const g of f)if(g.id===r)return void(g.cancelled=!0)}run(r=0){const s=this._currentlyRunning=this._queue;this._queue=[];for(const f of s)if(!f.cancelled&&(f.callback(r),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function $c(h,r,s){if(h=new u.LngLat(h.lng,h.lat),r){const f=new u.LngLat(h.lng-360,h.lat),g=new u.LngLat(h.lng+360,h.lat),y=360*Math.ceil(Math.abs(h.lng-s.center.lng)/360),w=s.locationPoint(h).distSqr(r),E=r.x<0||r.y<0||r.x>s.width||r.y>s.height;s.locationPoint(f).distSqr(r)<w&&(E||Math.abs(f.lng-s.center.lng)<y)?h=f:s.locationPoint(g).distSqr(r)<w&&(E||Math.abs(g.lng-s.center.lng)<y)&&(h=g)}for(;Math.abs(h.lng-s.center.lng)>180;){const f=s.locationPoint(h);if(f.x>=0&&f.y>=0&&f.x<=s.width&&f.y<=s.height)break;h.lng>s.center.lng?h.lng-=360:h.lng+=360}return h}const Yl={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Kl extends u.Evented{constructor(r,s){if(super(),(r instanceof u.window.HTMLElement||s)&&(r=u.extend({element:r},s)),u.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=r&&r.anchor||"center",this._color=r&&r.color||"#3FB1CE",this._scale=r&&r.scale||1,this._draggable=r&&r.draggable||!1,this._clickTolerance=r&&r.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=r&&r.rotation||0,this._rotationAlignment=r&&r.rotationAlignment||"auto",this._pitchAlignment=r&&r.pitchAlignment&&r.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=r&&r.occludedOpacity||.2,r&&r.element)this._element=r.element,this._offset=u.pointGeometry.convert(r&&r.offset||[0,0]);else{this._defaultMarker=!0,this._element=gt("div");const g=41,y=27,w=bt("svg",{display:"block",height:g*this._scale+"px",width:y*this._scale+"px",viewBox:`0 0 ${y} ${g}`},this._element),E=bt("radialGradient",{id:"shadowGradient"},bt("defs",{},w));bt("stop",{offset:"10%","stop-opacity":.4},E),bt("stop",{offset:"100%","stop-opacity":.05},E),bt("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},w),bt("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},w),bt("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},w),bt("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},w),this._offset=u.pointGeometry.convert(r&&r.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",g=>{g.preventDefault()}),this._element.addEventListener("mousedown",g=>{g.preventDefault()});const f=this._element.classList;for(const g in Yl)f.remove(`mapboxgl-marker-anchor-${g}`);f.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(r){return r===this._map||(this.remove(),this._map=r,r.getCanvasContainer().appendChild(this._element),r.on("move",this._updateMoving),r.on("moveend",this._update),r.on("remove",this._clearFadeTimer),r._addMarker(this),this.setDraggable(this._draggable),this._update(),r.on("click",this._onMapClick)),this}remove(){const r=this._map;return r&&(r.off("click",this._onMapClick),r.off("move",this._updateMoving),r.off("moveend",this._update),r.off("mousedown",this._addDragHandler),r.off("touchstart",this._addDragHandler),r.off("mouseup",this._onUp),r.off("touchend",this._onUp),r.off("mousemove",this._onMove),r.off("touchmove",this._onMove),r.off("remove",this._clearFadeTimer),r._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(r){return this._lngLat=u.LngLat.convert(r),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(r){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),r){if(!("offset"in r.options)){const g=Math.sqrt(Math.pow(13.5,2)/2);r.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[g,-1*(38.1-13.5+g)],"bottom-right":[-g,-1*(38.1-13.5+g)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=r,r._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(r){const s=r.code,f=r.charCode||r.keyCode;s!=="Space"&&s!=="Enter"&&f!==32&&f!==13||this.togglePopup()}_onMapClick(r){const s=r.originalEvent.target,f=this._element;this._popup&&(s===f||f.contains(s))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const r=this._popup;return r?(r.isOpen()?(r.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(r.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const r=this._map,s=this._pos;if(!r||!s)return!1;const f=r.unproject(s),g=r.getFreeCameraOptions();if(!g.position)return!1;const y=g.position.toLngLat();return y.distanceTo(f)<.9*y.distanceTo(this._lngLat)}_evaluateOpacity(){const r=this._map;if(!r)return;const s=this._pos;if(!s||s.x<0||s.x>r.transform.width||s.y<0||s.y>r.transform.height)return void this._clearFadeTimer();const f=r.unproject(s);let g;r._showingGlobe()&&u.isLngLatBehindGlobe(r.transform,this._lngLat)?g=0:(g=1-r._queryFogOpacity(f),r.transform._terrainEnabled()&&r.getTerrain()&&this._behindTerrain()&&(g*=this._occludedOpacity)),this._element.style.opacity=`${g}`,this._element.style.pointerEvents=g>0?"auto":"none",this._popup&&this._popup._setOpacity(g),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const r=this._pos;if(!r||!this._map)return;const s=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${r.x}px,${r.y}px)
            ${Yl[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${s.x}px,${s.y}px)
        `}_calculateXYTransform(){const r=this._pos,s=this._map,f=this.getPitchAlignment();if(!s||!r||f!=="map")return"";if(!s._showingGlobe()){const C=s.getPitch();return C?`rotateX(${C}deg)`:""}const g=u.radToDeg(u.globeTiltAtLngLat(s.transform,this._lngLat)),y=r.sub(u.globeCenterToScreenPoint(s.transform)),w=Math.abs(y.x)+Math.abs(y.y);if(w===0)return"";const E=g/w;return`rotateX(${-y.y*E}deg) rotateY(${y.x*E}deg)`}_calculateZTransform(){const r=this._pos,s=this._map;if(!s||!r)return"";let f=0;const g=this.getRotationAlignment();if(g==="map")if(s._showingGlobe()){const y=s.project(new u.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),w=s.project(new u.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(y);f=u.radToDeg(Math.atan2(w.y,w.x))-90}else f=-s.getBearing();else if(g==="horizon"){const y=u.smoothstep(4,6,s.getZoom()),w=u.globeCenterToScreenPoint(s.transform);w.y+=y*s.transform.height;const E=r.sub(w),C=u.radToDeg(Math.atan2(E.y,E.x));f=(C>90?C-270:C+90)*(1-y)}return f+=this._rotation,f?`rotateZ(${f}deg)`:""}_update(r){u.window.cancelAnimationFrame(this._updateFrameId);const s=this._map;s&&(s.transform.renderWorldCopies&&(this._lngLat=$c(this._lngLat,this._pos,s.transform)),this._pos=s.project(this._lngLat),r===!0?this._updateFrameId=u.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),s._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(s._showingGlobe()||s.getTerrain()||s.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(r){return this._offset=u.pointGeometry.convert(r),this._update(),this}_onMove(r){const s=this._map;if(!s)return;const f=this._pointerdownPos,g=this._positionDelta;if(f&&g){if(!this._isDragging){const y=this._clickTolerance||s._clickTolerance;if(r.point.dist(f)<y)return;this._isDragging=!0}this._pos=r.point.sub(g),this._lngLat=s.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new u.Event("dragstart"))),this.fire(new u.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const r=this._map;r&&(r.off("mousemove",this._onMove),r.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new u.Event("dragend")),this._state="inactive"}_addDragHandler(r){const s=this._map,f=this._pos;s&&f&&this._element.contains(r.originalEvent.target)&&(r.preventDefault(),this._positionDelta=r.point.sub(f),this._pointerdownPos=r.point,this._state="pending",s.on("mousemove",this._onMove),s.on("touchmove",this._onMove),s.once("mouseup",this._onUp),s.once("touchend",this._onUp))}setDraggable(r){this._draggable=!!r;const s=this._map;return s&&(r?(s.on("mousedown",this._addDragHandler),s.on("touchstart",this._addDragHandler)):(s.off("mousedown",this._addDragHandler),s.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(r){return this._rotation=r||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(r){return this._rotationAlignment=r||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(r){return this._pitchAlignment=r||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(r){return this._occludedOpacity=r||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const cs={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Uh=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Uo(h=new u.pointGeometry(0,0),r="bottom"){if(typeof h=="number"){const s=Math.round(Math.sqrt(.5*Math.pow(h,2)));switch(r){case"top":return new u.pointGeometry(0,h);case"top-left":return new u.pointGeometry(s,s);case"top-right":return new u.pointGeometry(-s,s);case"bottom":return new u.pointGeometry(0,-h);case"bottom-left":return new u.pointGeometry(s,-s);case"bottom-right":return new u.pointGeometry(-s,-s);case"left":return new u.pointGeometry(h,0);case"right":return new u.pointGeometry(-h,0)}return new u.pointGeometry(0,0)}return h instanceof u.pointGeometry||Array.isArray(h)?u.pointGeometry.convert(h):u.pointGeometry.convert(h[r]||[0,0])}class qc{constructor(r){this.jumpTo(r)}getValue(r){if(r<=this._startTime)return this._start;if(r>=this._endTime)return this._end;const s=u.easeCubicInOut((r-this._startTime)/(this._endTime-this._startTime));return this._start*(1-s)+this._end*s}isEasing(r){return r>=this._startTime&&r<=this._endTime}jumpTo(r){this._startTime=-1/0,this._endTime=-1/0,this._start=r,this._end=r}easeTo(r,s,f){this._start=this.getValue(s),this._end=r,this._startTime=s,this._endTime=s+f}}const Nh={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use ⌘ + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},Vh={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Vu={showCompass:!0,showZoom:!0,visualizePitch:!1};class Jl{constructor(r,s,f=!1){this._clickTolerance=10,this.element=s,this.mouseRotate=new dl({clickTolerance:r.dragRotate._mouseRotate._clickTolerance}),this.map=r,f&&(this.mousePitch=new Pu({clickTolerance:r.dragRotate._mousePitch._clickTolerance})),u.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),s.addEventListener("mousedown",this.mousedown),s.addEventListener("touchstart",this.touchstart,{passive:!1}),s.addEventListener("touchmove",this.touchmove),s.addEventListener("touchend",this.touchend),s.addEventListener("touchcancel",this.reset)}down(r,s){this.mouseRotate.mousedown(r,s),this.mousePitch&&this.mousePitch.mousedown(r,s),kr()}move(r,s){const f=this.map,g=this.mouseRotate.mousemoveWindow(r,s),y=g&&g.bearingDelta;if(y&&f.setBearing(f.getBearing()+y),this.mousePitch){const w=this.mousePitch.mousemoveWindow(r,s),E=w&&w.pitchDelta;E&&f.setPitch(f.getPitch()+E)}}off(){const r=this.element;r.removeEventListener("mousedown",this.mousedown),r.removeEventListener("touchstart",this.touchstart,{passive:!1}),r.removeEventListener("touchmove",this.touchmove),r.removeEventListener("touchend",this.touchend),r.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){zn(),u.window.removeEventListener("mousemove",this.mousemove),u.window.removeEventListener("mouseup",this.mouseup)}mousedown(r){this.down(u.extend({},r,{ctrlKey:!0,preventDefault:()=>r.preventDefault()}),Ge(this.element,r)),u.window.addEventListener("mousemove",this.mousemove),u.window.addEventListener("mouseup",this.mouseup)}mousemove(r){this.move(r,Ge(this.element,r))}mouseup(r){this.mouseRotate.mouseupWindow(r),this.mousePitch&&this.mousePitch.mouseupWindow(r),this.offTemp()}touchstart(r){r.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Nn(this.element,r.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>r.preventDefault()},this._startPos))}touchmove(r){r.targetTouches.length!==1?this.reset():(this._lastPos=Nn(this.element,r.targetTouches)[0],this.move({preventDefault:()=>r.preventDefault()},this._lastPos))}touchend(r){r.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const No={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Ep={maxWidth:100,unit:"metric"};function gl(h,r,s){const f=jh(r),g=f/r,y={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"}[s];this._map._requestDomTask(()=>{this._container.style.width=h*g+"px",this._container.innerHTML=`${f}&nbsp;${y}`})}function jh(h){const r=Math.pow(10,`${Math.floor(h)}`.length-1);let s=h/r;return s=s>=10?10:s>=5?5:s>=3?3:s>=2?2:s>=1?1:function(f){const g=Math.pow(10,Math.ceil(-Math.log(f)/Math.LN10));return Math.round(f*g)/g}(s),r*s}const ju={version:u.version,supported:Ft,setRTLTextPlugin:u.setRTLTextPlugin,getRTLTextPluginStatus:u.getRTLTextPluginStatus,Map:class extends Tp{constructor(h){if(u.LivePerformanceUtils.mark(u.PerformanceMarkers.create),(h=u.extend({},Vh,h)).minZoom!=null&&h.maxZoom!=null&&h.minZoom>h.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(h.minPitch!=null&&h.maxPitch!=null&&h.minPitch>h.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(h.minPitch!=null&&h.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(h.maxPitch!=null&&h.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(h.antialias&&u.isSafariWithAntialiasingBug(u.window)&&(h.antialias=!1,u.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Ou(h.minZoom,h.maxZoom,h.minPitch,h.maxPitch,h.renderWorldCopies),h),this._interactive=h.interactive,this._minTileCacheSize=h.minTileCacheSize,this._maxTileCacheSize=h.maxTileCacheSize,this._failIfMajorPerformanceCaveat=h.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=h.preserveDrawingBuffer,this._antialias=h.antialias,this._trackResize=h.trackResize,this._bearingSnap=h.bearingSnap,this._refreshExpiredTiles=h.refreshExpiredTiles,this._fadeDuration=h.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=h.crossSourceCollisions,this._collectResourceTiming=h.collectResourceTiming,this._optimizeForTerrain=h.optimizeForTerrain,this._language=this._parseLanguage(h.language),this._worldview=h.worldview,this._renderTaskQueue=new ia,this._domRenderTaskQueue=new ia,this._controls=[],this._markers=[],this._popups=[],this._mapId=u.uniqueId(),this._locale=u.extend({},Nh,h.locale),this._clickTolerance=h.clickTolerance,this._cooperativeGestures=h.cooperativeGestures,this._performanceMetricsCollection=h.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new qc(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new u.RequestManager(h.transformRequest,h.accessToken,h.testMode),this._silenceAuthErrors=!!h.testMode,typeof h.container=="string"){if(this._container=u.window.document.getElementById(h.container),!this._container)throw new Error(`Container '${h.container}' not found.`)}else{if(!(h.container instanceof u.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=h.container}if(this._container.childNodes.length>0&&u.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),h.maxBounds&&this.setMaxBounds(h.maxBounds),u.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),u.window!==void 0&&(u.window.addEventListener("online",this._onWindowOnline,!1),u.window.addEventListener("resize",this._onWindowResize,!1),u.window.addEventListener("orientationchange",this._onWindowResize,!1),u.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),u.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new Fo(this,h),this._localFontFamily=h.localFontFamily,this._localIdeographFontFamily=h.localIdeographFontFamily,h.style&&this.setStyle(h.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),h.projection&&this.setProjection(h.projection),this._hash=h.hash&&new mt(typeof h.hash=="string"&&h.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:h.center,zoom:h.zoom,bearing:h.bearing,pitch:h.pitch}),h.bounds&&(this.resize(),this.fitBounds(h.bounds,u.extend({},h.fitBoundsOptions,{duration:0})))),this.resize(),h.attributionControl&&this.addControl(new Wd({customAttribution:h.customAttribution})),this._logoControl=new Wl,this.addControl(this._logoControl,h.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",r=>{this._update(r.dataType==="style"),this.fire(new u.Event(`${r.dataType}data`,r))}),this.on("dataloading",r=>{this.fire(new u.Event(`${r.dataType}dataloading`,r))})}_getMapId(){return this._mapId}addControl(h,r){if(r===void 0&&(r=h.getDefaultPosition?h.getDefaultPosition():"top-right"),!h||!h.onAdd)return this.fire(new u.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const s=h.onAdd(this);this._controls.push(h);const f=this._controlPositions[r];return r.indexOf("bottom")!==-1?f.insertBefore(s,f.firstChild):f.appendChild(s),this}removeControl(h){if(!h||!h.onRemove)return this.fire(new u.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const r=this._controls.indexOf(h);return r>-1&&this._controls.splice(r,1),h.onRemove(this),this}hasControl(h){return this._controls.indexOf(h)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(h){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const r=!this._moving;return r&&this.fire(new u.Event("movestart",h)).fire(new u.Event("move",h)),this.fire(new u.Event("resize",h)),r&&this.fire(new u.Event("moveend",h)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(h){return this.transform.setMaxBounds(u.LngLatBounds.convert(h)),this._update()}setMinZoom(h){if((h=h??-2)>=-2&&h<=this.transform.maxZoom)return this.transform.minZoom=h,this._update(),this.getZoom()<h?this.setZoom(h):this.fire(new u.Event("zoomstart")).fire(new u.Event("zoom")).fire(new u.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(h){if((h=h??22)>=this.transform.minZoom)return this.transform.maxZoom=h,this._update(),this.getZoom()>h?this.setZoom(h):this.fire(new u.Event("zoomstart")).fire(new u.Event("zoom")).fire(new u.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(h){if((h=h??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(h>=0&&h<=this.transform.maxPitch)return this.transform.minPitch=h,this._update(),this.getPitch()<h?this.setPitch(h):this.fire(new u.Event("pitchstart")).fire(new u.Event("pitch")).fire(new u.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(h){if((h=h??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(h>=this.transform.minPitch)return this.transform.maxPitch=h,this._update(),this.getPitch()>h?this.setPitch(h):this.fire(new u.Event("pitchstart")).fire(new u.Event("pitch")).fire(new u.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(h){return this.transform.renderWorldCopies=h,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(h){return h==="auto"?u.window.navigator.language:Array.isArray(h)?h.length===0?void 0:h.map(r=>r==="auto"?u.window.navigator.language:r):h}setLanguage(h){const r=this._parseLanguage(h);if(!this.style||r===this._language)return this;this._language=r,this.style._reloadSources();for(const s of this._controls)s._setLanguage&&s._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(h){return this.style&&h!==this._worldview?(this._worldview=h,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(h){return this._lazyInitEmptyStyle(),h?typeof h=="string"&&(h={name:h}):h=null,this._useExplicitProjection=!!h,this._prioritizeAndUpdateProjection(h,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const h=this.transform,r=h.projection.name;let s;r==="globe"&&h.zoom>=u.GLOBE_ZOOM_THRESHOLD_MAX?(h.setMercatorFromTransition(),s=!0):r==="mercator"&&h.zoom<u.GLOBE_ZOOM_THRESHOLD_MAX&&(h.setProjection({name:"globe"}),s=!0),s&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(h,r){return this._updateProjection(h||r||{name:"mercator"})}_updateProjection(h){let r;if(r=h.name==="globe"&&this.transform.zoom>=u.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(h),this.style.applyProjectionUpdate(),r){this.painter.clearBackgroundTiles();for(const s in this.style._sourceCaches)this.style._sourceCaches[s].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(h){return this.transform.locationPoint3D(u.LngLat.convert(h))}unproject(h){return this.transform.pointLocation3D(u.pointGeometry.convert(h))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(h,r,s){if(h==="mouseenter"||h==="mouseover"){let f=!1;const g=w=>{const E=r.filter(z=>this.getLayer(z)),C=E.length?this.queryRenderedFeatures(w.point,{layers:E}):[];C.length?f||(f=!0,s.call(this,new xa(h,this,w.originalEvent,{features:C}))):f=!1},y=()=>{f=!1};return{layers:new Set(r),listener:s,delegates:{mousemove:g,mouseout:y}}}if(h==="mouseleave"||h==="mouseout"){let f=!1;const g=w=>{const E=r.filter(C=>this.getLayer(C));(E.length?this.queryRenderedFeatures(w.point,{layers:E}):[]).length?f=!0:f&&(f=!1,s.call(this,new xa(h,this,w.originalEvent)))},y=w=>{f&&(f=!1,s.call(this,new xa(h,this,w.originalEvent)))};return{layers:new Set(r),listener:s,delegates:{mousemove:g,mouseout:y}}}{const f=g=>{const y=r.filter(E=>this.getLayer(E)),w=y.length?this.queryRenderedFeatures(g.point,{layers:y}):[];w.length&&(g.features=w,s.call(this,g),delete g.features)};return{layers:new Set(r),listener:s,delegates:{[h]:f}}}}on(h,r,s){if(s===void 0)return super.on(h,r);Array.isArray(r)||(r=[r]);const f=this._createDelegatedListener(h,r,s);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[h]=this._delegatedListeners[h]||[],this._delegatedListeners[h].push(f);for(const g in f.delegates)this.on(g,f.delegates[g]);return this}once(h,r,s){if(s===void 0)return super.once(h,r);Array.isArray(r)||(r=[r]);const f=this._createDelegatedListener(h,r,s);for(const g in f.delegates)this.once(g,f.delegates[g]);return this}off(h,r,s){if(s===void 0)return super.off(h,r);r=new Set(Array.isArray(r)?r:[r]);const f=(y,w)=>{if(y.size!==w.size)return!1;for(const E of y)if(!w.has(E))return!1;return!0},g=this._delegatedListeners?this._delegatedListeners[h]:void 0;return g&&(y=>{for(let w=0;w<y.length;w++){const E=y[w];if(E.listener===s&&f(E.layers,r)){for(const C in E.delegates)this.off(C,E.delegates[C]);return y.splice(w,1),this}}})(g),this}queryRenderedFeatures(h,r){return this.style?(r!==void 0||h===void 0||h instanceof u.pointGeometry||Array.isArray(h)||(r=h,h=void 0),this.style.queryRenderedFeatures(h=h||[[0,0],[this.transform.width,this.transform.height]],r=r||{},this.transform)):[]}querySourceFeatures(h,r){return this.style.querySourceFeatures(h,r)}setStyle(h,r){return(r=u.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},r)).diff!==!1&&r.localIdeographFontFamily===this._localIdeographFontFamily&&r.localFontFamily===this._localFontFamily&&this.style&&h?(this._diffStyle(h,r),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._localFontFamily=r.localFontFamily,this._updateStyle(h,r))}_getUIString(h){const r=this._locale[h];if(r==null)throw new Error(`Missing UI string '${h}'`);return r}_updateStyle(h,r){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),h&&(this.style=new U(this,r||{}),this.style.setEventedParent(this,{style:this.style}),typeof h=="string"?this.style.loadURL(h):this.style.loadJSON(h)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new U(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(h,r){if(typeof h=="string"){const s=this._requestManager.normalizeStyleURL(h),f=this._requestManager.transformRequest(s,u.ResourceType.Style);u.getJSON(f,(g,y)=>{g?this.fire(new u.ErrorEvent(g)):y&&this._updateDiff(y,r)})}else typeof h=="object"&&this._updateDiff(h,r)}_updateDiff(h,r){try{this.style.setState(h)&&this._update(!0)}catch(s){u.warnOnce(`Unable to perform style diff: ${s.message||s.error||s}.  Rebuilding the style from scratch.`),this._updateStyle(h,r)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(u.warnOnce("There is no style added to the map."),!1)}addSource(h,r){return this._lazyInitEmptyStyle(),this.style.addSource(h,r),this._update(!0)}isSourceLoaded(h){return!!this.style&&this.style._isSourceCacheLoaded(h)}areTilesLoaded(){const h=this.style&&this.style._sourceCaches;for(const r in h){const s=h[r]._tiles;for(const f in s){const g=s[f];if(g.state!=="loaded"&&g.state!=="errored")return!1}}return!0}addSourceType(h,r,s){this._lazyInitEmptyStyle(),this.style.addSourceType(h,r,s)}removeSource(h){return this.style.removeSource(h),this._updateTerrain(),this._update(!0)}getSource(h){return this.style.getSource(h)}addImage(h,r,{pixelRatio:s=1,sdf:f=!1,stretchX:g,stretchY:y,content:w}={}){if(this._lazyInitEmptyStyle(),r instanceof u.window.HTMLImageElement||u.window.ImageBitmap&&r instanceof u.window.ImageBitmap){const{width:E,height:C,data:z}=u.exported.getImageData(r);this.style.addImage(h,{data:new u.RGBAImage({width:E,height:C},z),pixelRatio:s,stretchX:g,stretchY:y,content:w,sdf:f,version:0})}else if(r.width===void 0||r.height===void 0)this.fire(new u.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:E,height:C}=r,z=r;this.style.addImage(h,{data:new u.RGBAImage({width:E,height:C},new Uint8Array(z.data)),pixelRatio:s,stretchX:g,stretchY:y,content:w,sdf:f,version:0,userImage:z}),z.onAdd&&z.onAdd(this,h)}}updateImage(h,r){const s=this.style.getImage(h);if(!s)return void this.fire(new u.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const f=r instanceof u.window.HTMLImageElement||u.window.ImageBitmap&&r instanceof u.window.ImageBitmap?u.exported.getImageData(r):r,{width:g,height:y}=f;g!==void 0&&y!==void 0?g===s.data.width&&y===s.data.height?(s.data.replace(f.data,!(r instanceof u.window.HTMLImageElement||u.window.ImageBitmap&&r instanceof u.window.ImageBitmap)),this.style.updateImage(h,s)):this.fire(new u.ErrorEvent(new Error(`The width and height of the updated image (${g}, ${y})
                must be that same as the previous version of the image
                (${s.data.width}, ${s.data.height})`))):this.fire(new u.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(h){return h?!!this.style.getImage(h):(this.fire(new u.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(h){this.style.removeImage(h)}loadImage(h,r){u.getImage(this._requestManager.transformRequest(h,u.ResourceType.Image),(s,f)=>{r(s,f instanceof u.window.HTMLImageElement?u.exported.getImageData(f):f)})}listImages(){return this.style.listImages()}addLayer(h,r){return this._lazyInitEmptyStyle(),this.style.addLayer(h,r),this._update(!0)}moveLayer(h,r){return this.style.moveLayer(h,r),this._update(!0)}removeLayer(h){return this.style.removeLayer(h),this._update(!0)}getLayer(h){return this.style.getLayer(h)}setLayerZoomRange(h,r,s){return this.style.setLayerZoomRange(h,r,s),this._update(!0)}setFilter(h,r,s={}){return this.style.setFilter(h,r,s),this._update(!0)}getFilter(h){return this.style.getFilter(h)}setPaintProperty(h,r,s,f={}){return this.style.setPaintProperty(h,r,s,f),this._update(!0)}getPaintProperty(h,r){return this.style.getPaintProperty(h,r)}setLayoutProperty(h,r,s,f={}){return this.style.setLayoutProperty(h,r,s,f),this._update(!0)}getLayoutProperty(h,r){return this.style.getLayoutProperty(h,r)}setLight(h,r={}){return this._lazyInitEmptyStyle(),this.style.setLight(h,r),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(h){return this._lazyInitEmptyStyle(),!h&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(h),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(h){return this._lazyInitEmptyStyle(),this.style.setFog(h),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(h){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(u.LngLat.convert(h),this.transform):0}setFeatureState(h,r){return this.style.setFeatureState(h,r),this._update()}removeFeatureState(h,r){return this.style.removeFeatureState(h,r),this._update()}getFeatureState(h){return this.style.getFeatureState(h)}_updateContainerDimensions(){if(!this._container)return;const h=this._container.getBoundingClientRect().width||400,r=this._container.getBoundingClientRect().height||300;let s,f,g,y=this._container;for(;y&&(!f||!g);){const w=u.window.getComputedStyle(y).transform;w&&w!=="none"&&(s=w.match(/matrix.*\((.+)\)/)[1].split(", "),s[0]&&s[0]!=="0"&&s[0]!=="1"&&(f=s[0]),s[3]&&s[3]!=="0"&&s[3]!=="1"&&(g=s[3])),y=y.parentElement}this._containerWidth=f?Math.abs(h/f):h,this._containerHeight=g?Math.abs(r/g):r}_detectMissingCSS(){u.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&u.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const h=this._container;h.classList.add("mapboxgl-map"),(this._missingCSSCanary=gt("div","mapboxgl-canary",h)).style.visibility="hidden",this._detectMissingCSS();const r=this._canvasContainer=gt("div","mapboxgl-canvas-container",h);this._interactive&&r.classList.add("mapboxgl-interactive"),this._canvas=gt("canvas","mapboxgl-canvas",r),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const s=this._controlContainer=gt("div","mapboxgl-control-container",h),f=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(g=>{f[g]=gt("div",`mapboxgl-ctrl-${g}`,s)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(h,r){const s=u.exported.devicePixelRatio||1;this._canvas.width=s*Math.ceil(h),this._canvas.height=s*Math.ceil(r),this._canvas.style.width=`${h}px`,this._canvas.style.height=`${r}px`}_addMarker(h){this._markers.push(h)}_removeMarker(h){const r=this._markers.indexOf(h);r!==-1&&this._markers.splice(r,1)}_addPopup(h){this._popups.push(h)}_removePopup(h){const r=this._popups.indexOf(h);r!==-1&&this._popups.splice(r,1)}_setupPainter(){const h=u.extend({},Ft.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),r=this._canvas.getContext("webgl",h)||this._canvas.getContext("experimental-webgl",h);r?(u.storeAuthState(r,!0),this.painter=new fp(r,this.transform),this.on("data",s=>{s.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),u.exported$1.testSupport(r)):this.fire(new u.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(h){h.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new u.Event("webglcontextlost",{originalEvent:h}))}_contextRestored(h){this._setupPainter(),this.resize(),this._update(),this.fire(new u.Event("webglcontextrestored",{originalEvent:h}))}_onMapScroll(h){if(h.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(h){return this.style?(this._styleDirty=this._styleDirty||h,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(h){return this._update(),this._renderTaskQueue.add(h)}_cancelRenderFrame(h){this._renderTaskQueue.remove(h)}_requestDomTask(h){!this.loaded()||this.loaded()&&!this.isMoving()?h():this._domRenderTaskQueue.add(h)}_render(h){let r;const s=this.painter.context.extTimerQuery,f=u.exported.now();if(this.listens("gpu-timing-frame")&&(r=s.createQueryEXT(),s.beginQueryEXT(s.TIME_ELAPSED_EXT,r)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],u.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],u.window.performance.now())),this._renderTaskQueue.run(h),this._domRenderTaskQueue.run(h),this._removed)return;this._updateProjectionTransition();const g=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const E=this.transform.zoom,C=this.transform.pitch,z=u.exported.now(),D=new u.EvaluationParameters(E,{now:z,fadeDuration:g,pitch:C,transition:this.style.getTransition()});this.style.update(D)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let y=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),y=this._updateAverageElevation(f),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):y=this._updateAverageElevation(f),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,g,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:g,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new u.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new u.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),r){const E=u.exported.now()-f;s.endQueryEXT(s.TIME_ELAPSED_EXT,r),setTimeout(()=>{const C=s.getQueryObjectEXT(r,s.QUERY_RESULT_EXT)/1e6;s.deleteQueryEXT(r),this.fire(new u.Event("gpu-timing-frame",{cpuTime:E,gpuTime:C})),u.window.performance.mark("frame-gpu",{startTime:f,detail:{gpuTime:C}})},50)}if(this.listens("gpu-timing-layer")){const E=this.painter.collectGpuTimers();setTimeout(()=>{const C=this.painter.queryGpuTimers(E);this.fire(new u.Event("gpu-timing-layer",{layerTimes:C}))},50)}if(this.listens("gpu-timing-deferred-render")){const E=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const C=this.painter.queryGpuTimeDeferredRender(E);this.fire(new u.Event("gpu-timing-deferred-render",{gpuTime:C}))},50)}const w=this._sourcesDirty||this._styleDirty||this._placementDirty||y;if(w||this._repaint)this.triggerRepaint();else{const E=!this.isMoving()&&this.loaded();if(E&&(y=this._updateAverageElevation(f,!0)),y)this.triggerRepaint();else if(this._triggerFrame(!1),E&&(this.fire(new u.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const C=this._calculateSpeedIndex();this.fire(new u.Event("speedindexcompleted",{speedIndex:C})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||w||(this._fullyLoaded=!0,u.LivePerformanceUtils.mark(u.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&u.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(h){for(const r of this._markers)h&&!this.getRenderWorldCopies()&&(r._lngLat=r._lngLat.wrap()),r._update();for(const r of this._popups)!h||this.getRenderWorldCopies()||r._trackPointer||(r._lngLat=r._lngLat.wrap()),r._update()}_updateAverageElevation(h,r=!1){const s=f=>(this.transform.averageElevation=f,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&s(0);if((r||h-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(h)){const f=this.transform.averageElevation;let g=this.transform.sampleAverageElevation(),y=!1;this.transform.elevation&&(y=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(g)?g=0:this._averageElevationLastSampledAt=h;const w=Math.abs(f-g);if(w>1){if(this._isInitialLoad||y)return this._averageElevation.jumpTo(g),s(g);this._averageElevation.easeTo(g,h,300)}else if(w>1e-4)return this._averageElevation.jumpTo(g),s(g)}return!!this._averageElevation.isEasing(h)&&s(this._averageElevation.getValue(h))}_authenticate(){u.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,h=>{if(h&&(h.message===u.AUTH_ERR_MSG||h.status===401)){const r=this.painter.context.gl;u.storeAuthState(r,!1),this._logoControl instanceof Wl&&this._logoControl._updateLogo(),r&&r.clear(r.DEPTH_BUFFER_BIT|r.COLOR_BUFFER_BIT|r.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new u.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),u.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const h=this._isDragging();this.painter.updateTerrain(this.style,h)}_calculateSpeedIndex(){const h=this.painter.canvasCopy(),r=this.painter.getCanvasCopiesAndTimestamps();r.timeStamps.push(performance.now());const s=this.painter.context.gl,f=s.createFramebuffer();function g(y){s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,y,0);const w=new Uint8Array(s.drawingBufferWidth*s.drawingBufferHeight*4);return s.readPixels(0,0,s.drawingBufferWidth,s.drawingBufferHeight,s.RGBA,s.UNSIGNED_BYTE,w),w}return s.bindFramebuffer(s.FRAMEBUFFER,f),this._canvasPixelComparison(g(h),r.canvasCopies.map(g),r.timeStamps)}_canvasPixelComparison(h,r,s){let f=s[1]-s[0];const g=h.length/4;for(let y=0;y<r.length;y++){const w=r[y];let E=0;for(let C=0;C<w.length;C+=4)w[C]===h[C]&&w[C+1]===h[C+1]&&w[C+2]===h[C+2]&&w[C+3]===h[C+3]&&(E+=1);f+=(s[y+2]-s[y+1])*(1-E/g)}return f}remove(){this._hash&&this._hash.remove();for(const r of this._controls)r.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),u.window!==void 0&&(u.window.removeEventListener("resize",this._onWindowResize,!1),u.window.removeEventListener("orientationchange",this._onWindowResize,!1),u.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),u.window.removeEventListener("online",this._onWindowOnline,!1),u.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const h=this.painter.context.gl.getExtension("WEBGL_lose_context");h&&h.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),u.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new u.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(h){this._renderNextFrame=this._renderNextFrame||h,this.style&&!this._frame&&(this._frame=u.exported.frame(r=>{const s=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,s&&this._render(r)}))}_preloadTiles(h){const r=this.style?Object.values(this.style._sourceCaches):[];return u.asyncAll(r,(s,f)=>s._preloadTiles(h,f),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(h){this._trackResize&&this.resize({originalEvent:h})._update()}_onVisibilityChange(){u.window.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(h){this._showTileBoundaries!==h&&(this._showTileBoundaries=h,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(h){this._showTerrainWireframe!==h&&(this._showTerrainWireframe=h,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(h){this._speedIndexTiming!==h&&(this._speedIndexTiming=h,this._update())}get showPadding(){return!!this._showPadding}set showPadding(h){this._showPadding!==h&&(this._showPadding=h,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(h){this._showCollisionBoxes!==h&&(this._showCollisionBoxes=h,h?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(h){this._showOverdrawInspector!==h&&(this._showOverdrawInspector=h,this._update())}get repaint(){return!!this._repaint}set repaint(h){this._repaint!==h&&(this._repaint=h,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(h){this._vertices=h,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(h){this._showTileAABBs!==h&&(this._showTileAABBs=h,h&&this._update())}_setCacheLimits(h,r){u.setCacheLimits(h,r)}get version(){return u.version}},NavigationControl:class{constructor(h){this.options=u.extend({},Vu,h),this._container=gt("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",r=>r.preventDefault()),this.options.showZoom&&(u.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",r=>{this._map&&this._map.zoomIn({},{originalEvent:r})}),gt("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",r=>{this._map&&this._map.zoomOut({},{originalEvent:r})}),gt("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(u.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",r=>{const s=this._map;s&&(this.options.visualizePitch?s.resetNorthPitch({},{originalEvent:r}):s.resetNorth({},{originalEvent:r}))}),this._compassIcon=gt("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const h=this._map;if(!h)return;const r=h.getZoom(),s=r===h.getMaxZoom(),f=r===h.getMinZoom();this._zoomInButton.disabled=s,this._zoomOutButton.disabled=f,this._zoomInButton.setAttribute("aria-disabled",s.toString()),this._zoomOutButton.setAttribute("aria-disabled",f.toString())}_rotateCompassArrow(){const h=this._map;if(!h)return;const r=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(h.transform.pitch*(Math.PI/180)),.5)}) rotateX(${h.transform.pitch}deg) rotateZ(${h.transform.angle*(180/Math.PI)}deg)`:`rotate(${h.transform.angle*(180/Math.PI)}deg)`;h._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=r)})}onAdd(h){return this._map=h,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),h.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&h.on("pitch",this._rotateCompassArrow),h.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Jl(h,this._compass,this.options.visualizePitch)),this._container}onRemove(){const h=this._map;h&&(this._container.remove(),this.options.showZoom&&h.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&h.off("pitch",this._rotateCompassArrow),h.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(h,r){const s=gt("button",h,this._container);return s.type="button",s.addEventListener("click",r),s}_setButtonTitle(h,r){if(!this._map)return;const s=this._map._getUIString(`NavigationControl.${r}`);h.setAttribute("aria-label",s),h.firstElementChild&&h.firstElementChild.setAttribute("title",s)}},GeolocateControl:class extends u.Evented{constructor(h){super(),this.options=u.extend({geolocation:u.window.navigator.geolocation},No,h),u.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Gl(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(h){return this._map=h,this._container=gt("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(h){const r=(s=!!this.options.geolocation)=>{this._supportsGeolocation=s,h(s)};this._supportsGeolocation!==void 0?h(this._supportsGeolocation):u.window.navigator.permissions!==void 0?u.window.navigator.permissions.query({name:"geolocation"}).then(s=>r(s.state!=="denied")).catch(()=>r()):r()}_isOutOfMapMaxBounds(h){const r=this._map.getMaxBounds(),s=h.coords;return!!r&&(s.longitude<r.getWest()||s.longitude>r.getEast()||s.latitude<r.getSouth()||s.latitude>r.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(h){if(this._map){if(this._isOutOfMapMaxBounds(h))return this._setErrorState(),this.fire(new u.Event("outofmaxbounds",h)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=h,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(h),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(h),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new u.Event("geolocate",h)),this._finish()}}_updateCamera(h){const r=new u.LngLat(h.coords.longitude,h.coords.latitude),s=h.coords.accuracy,f=this._map.getBearing(),g=u.extend({bearing:f},this.options.fitBoundsOptions);this._map.fitBounds(r.toBounds(s),g,{geolocateSource:!0})}_updateMarker(h){if(h){const r=new u.LngLat(h.coords.longitude,h.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=h.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const h=this._map.transform,r=u.mercatorZfromAltitude(1,h._center.lat)*h.worldSize,s=Math.ceil(2*this._accuracy*r);this._circleElement.style.width=`${s}px`,this._circleElement.style.height=`${s}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(h){if(this._map){if(this.options.trackUserLocation)if(h.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(h.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new u.Event("error",h)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(h){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",r=>r.preventDefault()),this._geolocateButton=gt("button","mapboxgl-ctrl-geolocate",this._container),gt("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",h===!1){u.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}else{const r=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=gt("div","mapboxgl-user-location"),this._dotElement.appendChild(gt("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(gt("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Kl({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=gt("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Kl({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",r=>{r.geolocateSource||this._watchState!=="ACTIVE_LOCK"||r.originalEvent&&r.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new u.Event("trackuserlocationend")))})}}_onDeviceOrientation(h){this._userLocationDotMarker&&(h.webkitCompassHeading?this._heading=h.webkitCompassHeading:h.absolute===!0&&(this._heading=-1*h.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return u.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new u.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new u.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new u.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let h;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(h={maximumAge:6e5,timeout:0},this._noTimeout=!0):(h=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,h),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const h=()=>{u.window.addEventListener("ondeviceorientationabsolute"in u.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};u.window.DeviceMotionEvent!==void 0&&typeof u.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(r=>{r==="granted"&&h()}).catch(console.error):h()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),u.window.removeEventListener("deviceorientation",this._onDeviceOrientation),u.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Wd,ScaleControl:class{constructor(h){this.options=u.extend({},Ep,h),function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"narrow",unit:"meter"}),!0}catch{return!1}}()||(this._setScale=gl.bind(this)),u.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const h=this.options.maxWidth||100,r=this._map,s=r._containerHeight/2,f=r._containerWidth/2-h/2,g=r.unproject([f,s]),y=r.unproject([f+h,s]),w=g.distanceTo(y);if(this.options.unit==="imperial"){const E=3.2808*w;E>5280?this._setScale(h,E/5280,"mile"):this._setScale(h,E,"foot")}else this.options.unit==="nautical"?this._setScale(h,w/1852,"nautical-mile"):w>=1e3?this._setScale(h,w/1e3,"kilometer"):this._setScale(h,w,"meter")}_setScale(h,r,s){const f=jh(r),g=f/r;this._map._requestDomTask(()=>{this._container.style.width=h*g+"px",this._container.innerHTML=s!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"narrow",unit:s}).format(f):`${f}&nbsp;nm`})}onAdd(h){return this._map=h,this._language=h.getLanguage(),this._container=gt("div","mapboxgl-ctrl mapboxgl-ctrl-scale",h.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(h){this._language=h,this._update()}setUnit(h){this.options.unit=h,this._update()}},FullscreenControl:class{constructor(h){this._fullscreen=!1,h&&h.container&&(h.container instanceof u.window.HTMLElement?this._container=h.container:u.warnOnce("Full screen control 'container' must be a DOM element.")),u.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in u.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in u.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(h){return this._map=h,this._container||(this._container=this._map.getContainer()),this._controlContainer=gt("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",u.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,u.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!u.window.document.fullscreenEnabled&&!u.window.document.webkitFullscreenEnabled)}_setupUI(){const h=this._fullscreenButton=gt("button","mapboxgl-ctrl-fullscreen",this._controlContainer);gt("span","mapboxgl-ctrl-icon",h).setAttribute("aria-hidden","true"),h.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),u.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const h=this._getTitle();this._fullscreenButton.setAttribute("aria-label",h),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",h)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(u.window.document.fullscreenElement||u.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?u.window.document.exitFullscreen?u.window.document.exitFullscreen():u.window.document.webkitCancelFullScreen&&u.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends u.Evented{constructor(h){super(),this.options=u.extend(Object.create(cs),h),u.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(h&&h.className?h.className.trim().split(/\s+/):[])}addTo(h){return this._map&&this.remove(),this._map=h,this.options.closeOnClick&&h.on("preclick",this._onClose),this.options.closeOnMove&&h.on("move",this._onClose),h.on("remove",this.remove),this._update(),h._addPopup(this),this._focusFirstElement(),this._trackPointer?(h.on("mousemove",this._onMouseEvent),h.on("mouseup",this._onMouseEvent),h._canvasContainer.classList.add("mapboxgl-track-pointer")):h.on("move",this._update),this.fire(new u.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const h=this._map;return h&&(h.off("move",this._update),h.off("move",this._onClose),h.off("preclick",this._onClose),h.off("click",this._onClose),h.off("remove",this.remove),h.off("mousemove",this._onMouseEvent),h.off("mouseup",this._onMouseEvent),h.off("drag",this._onMouseEvent),h._canvasContainer&&h._canvasContainer.classList.remove("mapboxgl-track-pointer"),h._removePopup(this),this._map=void 0),this.fire(new u.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(h){this._lngLat=u.LngLat.convert(h),this._pos=null,this._trackPointer=!1,this._update();const r=this._map;return r&&(r.on("move",this._update),r.off("mousemove",this._onMouseEvent),r._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const h=this._map;return h&&(h.off("move",this._update),h.on("mousemove",this._onMouseEvent),h.on("drag",this._onMouseEvent),h._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(h){return this.setDOMContent(u.window.document.createTextNode(h))}setHTML(h){const r=u.window.document.createDocumentFragment(),s=u.window.document.createElement("body");let f;for(s.innerHTML=h;f=s.firstChild,f;)r.appendChild(f);return this.setDOMContent(r)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(h){return this.options.maxWidth=h,this._update(),this}setDOMContent(h){let r=this._content;if(r)for(;r.hasChildNodes();)r.firstChild&&r.removeChild(r.firstChild);else r=this._content=gt("div","mapboxgl-popup-content",this._container||void 0);if(r.appendChild(h),this.options.closeButton){const s=this._closeButton=gt("button","mapboxgl-popup-close-button",r);s.type="button",s.setAttribute("aria-label","Close popup"),s.setAttribute("aria-hidden","true"),s.innerHTML="&#215;",s.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(h){return this._classList.add(h),this._updateClassList(),this}removeClassName(h){return this._classList.delete(h),this._updateClassList(),this}setOffset(h){return this.options.offset=h,this._update(),this}toggleClassName(h){let r;return this._classList.delete(h)?r=!1:(this._classList.add(h),r=!0),this._updateClassList(),r}_onMouseEvent(h){this._update(h.point)}_getAnchor(h){if(this.options.anchor)return this.options.anchor;const r=this._map,s=this._container,f=this._pos;if(!r||!s||!f)return"bottom";const g=s.offsetWidth,y=s.offsetHeight,w=f.x<g/2,E=f.x>r.transform.width-g/2;if(f.y+h<y)return w?"top-left":E?"top-right":"top";if(f.y>r.transform.height-y){if(w)return"bottom-left";if(E)return"bottom-right"}return w?"left":E?"right":"bottom"}_updateClassList(){const h=this._container;if(!h)return;const r=[...this._classList];r.push("mapboxgl-popup"),this._anchor&&r.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&r.push("mapboxgl-popup-track-pointer"),h.className=r.join(" ")}_update(h){const r=this._map,s=this._content;if(!r||!this._lngLat&&!this._trackPointer||!s)return;let f=this._container;if(f||(f=this._container=gt("div","mapboxgl-popup",r.getContainer()),this._tip=gt("div","mapboxgl-popup-tip",f),f.appendChild(s)),this.options.maxWidth&&f.style.maxWidth!==this.options.maxWidth&&(f.style.maxWidth=this.options.maxWidth),r.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=$c(this._lngLat,this._pos,r.transform)),!this._trackPointer||h){const g=this._pos=this._trackPointer&&h?h:r.project(this._lngLat),y=Uo(this.options.offset),w=this._anchor=this._getAnchor(y.y),E=Uo(this.options.offset,w),C=g.add(E).round();r._requestDomTask(()=>{this._container&&w&&(this._container.style.transform=`${Yl[w]} translate(${C.x}px,${C.y}px)`)})}if(!this._marker&&r._showingGlobe()){const g=u.isLngLatBehindGlobe(r.transform,this._lngLat)?0:1;this._setOpacity(g)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const h=this._container.querySelector(Uh);h&&h.focus()}_onClose(){this.remove()}_setOpacity(h){this._container&&(this._container.style.opacity=`${h}`),this._content&&(this._content.style.pointerEvents=h?"auto":"none")}},Marker:Kl,Style:U,LngLat:u.LngLat,LngLatBounds:u.LngLatBounds,Point:u.pointGeometry,MercatorCoordinate:u.MercatorCoordinate,FreeCameraOptions:qd,Evented:u.Evented,config:u.config,prewarm:function(){Lt().acquire(ct)},clearPrewarmedResources:function(){const h=_t;h&&(h.isPreloaded()&&h.numActive()===1?(h.release(ct),_t=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return u.config.ACCESS_TOKEN},set accessToken(h){u.config.ACCESS_TOKEN=h},get baseApiUrl(){return u.config.API_URL},set baseApiUrl(h){u.config.API_URL=h},get workerCount(){return ot.workerCount},set workerCount(h){ot.workerCount=h},get maxParallelImageRequests(){return u.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(h){u.config.MAX_PARALLEL_IMAGE_REQUESTS=h},clearStorage(h){u.clearTileCache(h)},workerUrl:"",workerClass:null,setNow:u.exported.setNow,restoreNow:u.exported.restoreNow};return ju});var de=Ei;return de})})(j2);const uE=tp;const G2={type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[105.8033,21.0281]},properties:{name:"Giao Thong van Tai University"}},{type:"Feature",geometry:{type:"Point",coordinates:[105.8133,21.1281]},properties:{name:"AKA Office"}}]};uE.accessToken="pk.eyJ1Ijoic2Nob2xhcjk5IiwiYSI6ImNsY3VjZmU2MzE4aXAzbmxodXU2OWR4NG0ifQ.YYLY0bNRrEfRR4ZPH3rD7A";function $2(){const At=kl.useRef(null),xt=kl.useRef(null),[li,Qi]=kl.useState(-122.48),[Ei,Sn]=kl.useState(37.83),[de,u]=kl.useState(9),[Oe,Ft]=kl.useState(!0);return kl.useEffect(()=>{if(xt.current)return;xt.current=new uE.Map({container:At.current,style:"mapbox://styles/scholar99/clcy8xgq9000a14n90kj3vb3r",center:[li,Ei],zoom:de,hash:!0}),new tp.Marker({anchor:"top",draggable:!0}).setLngLat([105.8033,21.0281]).setPopup(new tp.Popup().setHTML('<div style="color:black;">Hello world</div>')).addTo(xt.current).on("dragend",()=>{console.log("Draged")}),xt.current.on("move",()=>{let{lng:at,lat:gt}=xt.current.getCenter(),bt=xt.current.getZoom();Qi(at.toFixed(5)),Sn(gt.toFixed(5)),u(bt.toFixed(4))}),xt.current.on("load",at=>{xt.current.addSource("example-source",{type:"geojson",data:G2}),xt.current.addSource("route",{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:[[-122.483696,37.833818],[-122.483482,37.833174],[-122.483396,37.8327],[-122.483568,37.832056],[-122.48404,37.831141],[-122.48404,37.830497],[-122.483482,37.82992],[-122.483568,37.829548],[-122.48507,37.829446],[-122.4861,37.828802],[-122.486958,37.82931],[-122.487001,37.830802],[-122.487516,37.831683],[-122.488031,37.832158],[-122.488889,37.832971],[-122.489876,37.832632],[-122.490434,37.832937],[-122.49125,37.832429],[-122.491636,37.832564],[-122.492237,37.833378],[-122.493782,37.833683]]}}}),xt.current.addLayer({id:"route",type:"line",source:"route",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#888","line-width":8}}),xt.current.addLayer({id:"AKA Tek work",type:"circle",source:"example-source",paint:{"circle-radius":10,"circle-color":"red"}}),xt.current.addLayer({id:"place-name",type:"symbol",source:"example-source",layout:{"text-field":["format",["get","name"],{"font-scale":1}],"text-size":12,"text-offset":[0,1]},paint:{"text-color":"#4D4D4D"}}),xt.current.on("click",gt=>{let bt=xt.current.querySourceFeatures("example-source");console.log(bt)})}),xt.current.addControl(new tp.NavigationControl,"bottom-right"),xt.current.addControl(new tp.GeolocateControl({showAccuracyCircle:!0,trackUserLocation:!0,positionOptions:{enableHighAccuracy:!0},showUserHeading:!0})).on("trackuserlocationstart",at=>{alert("Start")}).on("trackuserlocationend",at=>{alert("End")})}),Fd("div",{className:"main",children:[Fd("div",{className:"sidebar",style:{width:Oe?180:0,padding:Oe?"6px 12px":0},children:[Oe&&Fd("h2",{children:"MyMap"},void 0,!1,{fileName:"C:/Users/tuanx/Documents/code space/mapbox-research/src/App.tsx",lineNumber:147,columnNumber:25},this),Oe&&Fd("input",{type:"search",placeholder:"Tìm địa điểm",className:"isearch"},void 0,!1,{fileName:"C:/Users/tuanx/Documents/code space/mapbox-research/src/App.tsx",lineNumber:148,columnNumber:25},this),Fd("div",{className:"sidebarCircle",onClick:()=>Ft(!Oe),style:{cursor:"pointer"},children:"o"},void 0,!1,{fileName:"C:/Users/tuanx/Documents/code space/mapbox-research/src/App.tsx",lineNumber:149,columnNumber:7},this)]},void 0,!0,{fileName:"C:/Users/tuanx/Documents/code space/mapbox-research/src/App.tsx",lineNumber:146,columnNumber:5},this),Fd("div",{ref:At,className:"map-container"},void 0,!1,{fileName:"C:/Users/tuanx/Documents/code space/mapbox-research/src/App.tsx",lineNumber:151,columnNumber:5},this)]},void 0,!0,{fileName:"C:/Users/tuanx/Documents/code space/mapbox-research/src/App.tsx",lineNumber:145,columnNumber:10},this)}v1.createRoot(document.getElementById("root")).render(Fd(U2.StrictMode,{children:Fd($2,{},void 0,!1,{fileName:"C:/Users/tuanx/Documents/code space/mapbox-research/src/main.tsx",lineNumber:8,columnNumber:5},globalThis)},void 0,!1,{fileName:"C:/Users/tuanx/Documents/code space/mapbox-research/src/main.tsx",lineNumber:7,columnNumber:3},globalThis));
